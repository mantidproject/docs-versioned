<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MDNormDirectSC v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=94a1c62f"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MDNormSCD v1" href="MDNormSCD-v1.html" />
    <link rel="prev" title="MDNorm v1" href="MDNorm-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.12</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">MDNormDirectSC v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="mdnormdirectsc-v1">
<span id="algm-mdnormdirectsc"></span><span id="algm-mdnormdirectsc-v1"></span><h1>MDNormDirectSC v1<a class="headerlink" href="#mdnormdirectsc-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id2">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id5">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id6">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Calculate normalization for an MDEvent workspace for single crystal direct geometry inelastic measurement.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="MDNormSCD-v1.html#algm-mdnormscd"><span class="std std-ref">MDNormSCD</span></a>, <a class="reference internal" href="MDNormSCDPreprocessIncoherent-v1.html#algm-mdnormscdpreprocessincoherent"><span class="std std-ref">MDNormSCDPreprocessIncoherent</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MDWorkspace.html#mdworkspace"><span class="std std-ref">MDEventWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>An input MDWorkspace.</p></td>
</tr>
<tr class="row-odd"><td><p>AlignedDim0</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Binning parameters for the 0th dimension. Enter it as a comma-separated list of values with the format: ‘name,minimum,maximum,number_of_bins’. Leave blank for NONE.</p></td>
</tr>
<tr class="row-even"><td><p>AlignedDim1</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Binning parameters for the 1th dimension. Enter it as a comma-separated list of values with the format: ‘name,minimum,maximum,number_of_bins’. Leave blank for NONE.</p></td>
</tr>
<tr class="row-odd"><td><p>AlignedDim2</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Binning parameters for the 2th dimension. Enter it as a comma-separated list of values with the format: ‘name,minimum,maximum,number_of_bins’. Leave blank for NONE.</p></td>
</tr>
<tr class="row-even"><td><p>AlignedDim3</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Binning parameters for the 3th dimension. Enter it as a comma-separated list of values with the format: ‘name,minimum,maximum,number_of_bins’. Leave blank for NONE.</p></td>
</tr>
<tr class="row-odd"><td><p>AlignedDim4</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Binning parameters for the 4th dimension. Enter it as a comma-separated list of values with the format: ‘name,minimum,maximum,number_of_bins’. Leave blank for NONE.</p></td>
</tr>
<tr class="row-even"><td><p>AlignedDim5</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Binning parameters for the 5th dimension. Enter it as a comma-separated list of values with the format: ‘name,minimum,maximum,number_of_bins’. Leave blank for NONE.</p></td>
</tr>
<tr class="row-odd"><td><p>SolidAngleWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td><p>An input workspace containing integrated vanadium (a measure of the solid angle).</p></td>
</tr>
<tr class="row-even"><td><p>SkipSafetyCheck</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>If set to true, the algorithm does not check history if the workspace was modified since theConvertToMD algorithm was run, and assume that the direct geometry inelastic mode is used.</p></td>
</tr>
<tr class="row-odd"><td><p>TemporaryNormalizationWorkspace</p></td>
<td><p>Input</p></td>
<td><p>IMDHistoWorkspace</p></td>
<td></td>
<td><p>An input MDHistoWorkspace used to accumulate normalization from multiple MDEventWorkspaces. If unspecified a blank MDHistoWorkspace will be created.</p></td>
</tr>
<tr class="row-even"><td><p>TemporaryDataWorkspace</p></td>
<td><p>Input</p></td>
<td><p>IMDHistoWorkspace</p></td>
<td></td>
<td><p>An input MDHistoWorkspace used to accumulate data from multiple MDEventWorkspaces. If unspecified a blank MDHistoWorkspace will be created.</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>A name for the output data MDHistoWorkspace.</p></td>
</tr>
<tr class="row-even"><td><p>OutputNormalizationWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>A name for the output normalization MDHistoWorkspace.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>The algorithm calculates a normalization MD workspace for single crystal direct geometry inelastic experiments.
Trajectories of each detector in reciprocal space are calculated, and the flux is integrated between intersections with each
MDBox. A brief introduction to the multi-dimensional data normalization can be found <a class="reference internal" href="../concepts/MDNorm.html#mdnorm"><span class="std std-ref">here</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the MDEvent input workspace is generated from an event workspace, the algorithm gives the correct normalization
only if the event workspace is cropped and binned to the same energy transfer range. If the workspace is not cropped,
one might have events in places where the normalization is calculated to be 0.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of <a class="reference internal" href="../release/v4.0.0/index.html#v4-0-0"><span class="std std-ref">Release 4.0.0</span></a>, the algorithm can handle merged MD workspaces. Make sure all original MDEvent workspaces have the same dimensions</p>
</div>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path.
In Mantid this is done using <a class="reference internal" href="../interfaces/framework/ManageUserDirectories.html#manageuserdirectories"><span class="std std-ref">Manage User Directories</span></a>.</p>
</div>
<p><strong>Example - MDNormDirectSC</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">mantid</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mantid.simpleapi</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="n">config</span><span class="p">[</span><span class="s1">&#39;default.facility&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;SNS&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">DGS_input_data</span><span class="o">=</span><span class="n">Load</span><span class="p">(</span><span class="s2">&quot;CNCS_7860&quot;</span><span class="p">)</span>
<span class="c1"># Keep events (SofPhiEIsDistribution=False)</span>
<span class="c1"># Do not normalize by proton charge in DgsReduction</span>
<span class="n">DGS_output_data</span><span class="o">=</span><span class="n">DgsReduction</span><span class="p">(</span>
         <span class="n">SampleInputWorkspace</span><span class="o">=</span><span class="n">DGS_input_data</span><span class="p">,</span>
         <span class="n">SofPhiEIsDistribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
         <span class="n">IncidentBeamNormalisation</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span>
         <span class="n">EnergyTransferRange</span><span class="o">=</span><span class="s2">&quot;-1.5,0.01,2.7&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="n">DGS_output_data</span><span class="o">=</span><span class="n">DGS_output_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">SetGoniometer</span><span class="p">(</span><span class="n">DGS_output_data</span><span class="p">,</span><span class="n">Axis0</span><span class="o">=</span><span class="s2">&quot;10.,0,1,0,1&quot;</span><span class="p">)</span>
<span class="n">SetUB</span><span class="p">(</span><span class="n">DGS_output_data</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span><span class="mf">3.2</span><span class="p">,</span><span class="mf">7.2</span><span class="p">)</span>
<span class="n">DGS_output_data</span><span class="o">=</span><span class="n">CropWorkspace</span><span class="p">(</span><span class="n">DGS_output_data</span><span class="p">,</span><span class="n">XMin</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span><span class="n">XMax</span><span class="o">=</span><span class="mf">2.7</span><span class="p">)</span>
<span class="n">MDE</span><span class="o">=</span><span class="n">ConvertToMD</span><span class="p">(</span><span class="n">DGS_output_data</span><span class="p">,</span>
        <span class="n">QDimensions</span><span class="o">=</span><span class="s2">&quot;Q3D&quot;</span><span class="p">,</span>
        <span class="n">dEAnalysisMode</span><span class="o">=</span><span class="s2">&quot;Direct&quot;</span><span class="p">,</span>
        <span class="n">Q3DFrames</span><span class="o">=</span><span class="s2">&quot;HKL&quot;</span><span class="p">,</span>
        <span class="n">QConversionScales</span><span class="o">=</span><span class="s2">&quot;HKL&quot;</span><span class="p">)</span>
<span class="n">histoData</span><span class="p">,</span><span class="n">histoNorm</span><span class="o">=</span><span class="n">MDNormDirectSC</span><span class="p">(</span><span class="n">MDE</span><span class="p">,</span>
        <span class="n">AlignedDim0</span><span class="o">=</span><span class="s2">&quot;[H,0,0],-0.2,1.6,100&quot;</span><span class="p">,</span>
        <span class="n">AlignedDim1</span><span class="o">=</span><span class="s2">&quot;DeltaE,-1.5,3.,100&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="n">normalized</span><span class="o">=</span><span class="n">histoData</span><span class="o">/</span><span class="n">histoNorm</span>
<span class="n">histoShape</span><span class="o">=</span><span class="n">histoNorm</span><span class="o">.</span><span class="n">getSignalArray</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The normalization workspace shape is (</span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">histoShape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Out of those elements, &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nonzero</span><span class="p">(</span><span class="n">histoNorm</span><span class="o">.</span><span class="n">getSignalArray</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; are nonzero&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The normalization workspace shape is (100, 100)
Out of those elements, 6712 are nonzero
</pre></div>
</div>
<p>The output would look like:</p>
<figure class="align-default">
<img alt="MDNormDirectSC.png" src="../_images/MDNormDirectSC.png" />
</figure>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/MDAlgorithms/Normalisation.html">MDAlgorithms\Normalisation</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/a8f64cccc781eac9892433e956bab7104ebf1213/Framework/MDAlgorithms/inc/MantidMDAlgorithms/MDNormDirectSC.h">MDNormDirectSC.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/a8f64cccc781eac9892433e956bab7104ebf1213/Framework/MDAlgorithms/src/MDNormDirectSC.cpp">MDNormDirectSC.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="MDNorm-v1.html" title="Previous Chapter: MDNorm v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; MDNorm v1</span>
    </a>
  </li>
  <li>
    <a href="MDNormSCD-v1.html" title="Next Chapter: MDNormSCD v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">MDNormSCD v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>