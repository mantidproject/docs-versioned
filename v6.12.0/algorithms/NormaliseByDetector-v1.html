<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>NormaliseByDetector v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=94a1c62f"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NormaliseByPeakArea v1" href="NormaliseByPeakArea-v1.html" />
    <link rel="prev" title="NormaliseByCurrent v1" href="NormaliseByCurrent-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.12</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">NormaliseByDetector v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="normalisebydetector-v1">
<span id="algm-normalisebydetector"></span><span id="algm-normalisebydetector-v1"></span><h1>NormaliseByDetector v1<a class="headerlink" href="#normalisebydetector-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id2">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#prerequisites" id="id5">Prerequisites</a></p>
<ul>
<li><p><a class="reference internal" href="#the-input-workspace" id="id6">The Input Workspace</a></p></li>
<li><p><a class="reference internal" href="#the-instrument-definition-file" id="id7">The Instrument Definition File</a></p></li>
<li><p><a class="reference internal" href="#background" id="id8">Background</a></p></li>
<li><p><a class="reference internal" href="#recommended-working" id="id9">Recommended Working</a></p></li>
<li><p><a class="reference internal" href="#examples" id="id10">Examples</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id11">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id12">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Normalise the input workspace by the detector efficiency.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="Divide-v1.html#algm-divide"><span class="std std-ref">Divide</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>An input workspace in wavelength</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>An output workspace.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>This algorithm is designed to normalise a workspace via detector
efficiency functions. <strong>For this algorithm to work, the Instrument
Definition File</strong> (<a class="reference internal" href="../concepts/InstrumentDefinitionFile.html#instrumentdefinitionfile"><span class="std std-ref">IDF</span></a>) <strong>must have fitting functions on the
component tree</strong>. The setup information for this, as well as some
examples, are provided below.</p>
<p>At a high-level, the algorithm does this:</p>
<ol class="arabic simple">
<li><p>Extract a detector efficiency function <span class="math notranslate nohighlight">\(e = f(\lambda)\)</span></p></li>
<li><p>Using the bin boundaries on the input workspace, calculate efficiency
Y and E values and generate a new workspace from the results</p></li>
<li><p>Divide the input workspace by the efficiency workspace</p></li>
</ol>
</section>
<section id="prerequisites">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Prerequisites</a><a class="headerlink" href="#prerequisites" title="Link to this heading">¶</a></h2>
<section id="the-input-workspace">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">The Input Workspace</a><a class="headerlink" href="#the-input-workspace" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>The input workspace must be a MatrixWorkspace</p></li>
<li><p>The input workspace must have X-units of Wavelength, run
<a class="reference internal" href="ConvertUnits-v1.html#algm-convertunits"><span class="std std-ref">ConvertUnits v1</span></a> on your input workspace if it is not
already in Wavelength.</p></li>
<li><p>The input workspace must be a histogram workspace run
<a class="reference internal" href="ConvertToHistogram-v1.html#algm-converttohistogram"><span class="std std-ref">ConvertToHistogram v1</span></a> on your input workspace
if it is not already histogrammed.</p></li>
</ol>
</section>
<section id="the-instrument-definition-file">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">The Instrument Definition File</a><a class="headerlink" href="#the-instrument-definition-file" title="Link to this heading">¶</a></h3>
</section>
<section id="background">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Background</a><a class="headerlink" href="#background" title="Link to this heading">¶</a></h3>
<p>In brief, the components in the IDF file form a tree structure.
Detectors and Instruments are both types of component. Detectors are
ultimately children of Instruments in the tree structure. For a more
complete description see <a class="reference internal" href="../concepts/InstrumentDefinitionFile.html#instrumentdefinitionfile"><span class="std std-ref">IDF</span></a>. The tree structure of the
components, mean that fitting functions do not necessarily have to be
assigned on a detector-by-detector basis. Applying a fit function to the
instrument, will ensure that all subcomponents (including detectors),
pick-up that function. However, functions assigned to lower-level
components (such as detectors) take precedence over and existing
functions that might exist on parent components (such as the
instrument). You can even, have some parameters for a function provided
against the detector, and pick up defaults from the bank, or instrument
if they have been specified there.</p>
</section>
<section id="recommended-working">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Recommended Working</a><a class="headerlink" href="#recommended-working" title="Link to this heading">¶</a></h3>
<p>The IDF is intended to be a definitive description of the components in
the instrument at any time. This should be the most generic form of the
instrument setup possible. To complement this, you may provide
additional Instrument Parameter files, which can be used to overload
settings in the IDF for purposes of configuration and calibration. <strong>We
strongly recommend that fitting functions are provided via Instrument
Parameter Files rather than directly in the IDF</strong>. This will give you
more flexibility to change your fitting functions without the problems
of synchronising the IDF across Mantid, and possible corruption
resulting from ad-hoc changes.</p>
<p>Instrument Parameter Files that take the form
{InstrumentName}_Parameters.xml and live in the Instrument directory of
Mantid are automatically loaded along with the IDF when a workspace is
loaded into Mantid. However, you can apply any number of additional
parameter files over the top of an existing workspace using
<a class="reference internal" href="LoadParameterFile-v1.html#algm-loadparameterfile"><span class="std std-ref">LoadParameterFile v1</span></a>.</p>
</section>
<section id="examples">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Examples</a><a class="headerlink" href="#examples" title="Link to this heading">¶</a></h3>
<p>Applying a LinearFunction to the whole instrument, hard-coded with A1=2
and A0=1. Fictional instrument is called basic_rect.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;parameter-file</span><span class="w"> </span><span class="na">instrument =</span><span class="w"> </span><span class="s">&quot;basic_rect&quot;</span><span class="w"> </span><span class="na">date =</span><span class="w"> </span><span class="s">&quot;2012-01-31T00:00:00&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;component-link</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;basic_rect&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LinearBackground:A0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;fitting&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;formula</span><span class="w"> </span><span class="na">eq=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">result-unit=</span><span class="s">&quot;Wavelength&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;fixed</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/parameter&gt;</span>
<span class="w">  </span><span class="nt">&lt;parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LinearBackground:A1&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;fitting&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;formula</span><span class="w"> </span><span class="na">eq=</span><span class="s">&quot;2&quot;</span><span class="w"> </span><span class="na">result-unit=</span><span class="s">&quot;Wavelength&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;fixed</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/parameter&gt;</span>
<span class="w">  </span><span class="nt">&lt;/component-link&gt;</span>
<span class="nt">&lt;/parameter-file&gt;</span>
</pre></div>
</div>
<p>Applying the same LinearFunction to two different detectors, with
different coefficients is shown below:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;parameter-file</span><span class="w"> </span><span class="na">instrument =</span><span class="w"> </span><span class="s">&quot;basic_rect&quot;</span><span class="w"> </span><span class="na">date =</span><span class="w"> </span><span class="s">&quot;2012-01-31T00:00:00&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;component-link</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;bank1(0,0)&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LinearBackground:A0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;fitting&quot;</span><span class="nt">&gt;</span>
<span class="w">       </span><span class="nt">&lt;formula</span><span class="w"> </span><span class="na">eq=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">result-unit=</span><span class="s">&quot;Wavelength&quot;</span><span class="nt">/&gt;</span>
<span class="w">       </span><span class="nt">&lt;fixed</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/parameter&gt;</span>
<span class="w">   </span><span class="nt">&lt;parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LinearBackground:A1&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;fitting&quot;</span><span class="nt">&gt;</span>
<span class="w">       </span><span class="nt">&lt;formula</span><span class="w"> </span><span class="na">eq=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">result-unit=</span><span class="s">&quot;Wavelength&quot;</span><span class="nt">/&gt;</span>
<span class="w">       </span><span class="nt">&lt;fixed</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/parameter&gt;</span>
<span class="nt">&lt;/component-link&gt;</span>
<span class="nt">&lt;component-link</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;bank2(0,0)&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LinearBackground:A0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;fitting&quot;</span><span class="nt">&gt;</span>
<span class="w">       </span><span class="nt">&lt;formula</span><span class="w"> </span><span class="na">eq=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">result-unit=</span><span class="s">&quot;Wavelength&quot;</span><span class="nt">/&gt;</span>
<span class="w">       </span><span class="nt">&lt;fixed</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/parameter&gt;</span>
<span class="w">   </span><span class="nt">&lt;parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LinearBackground:A1&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;fitting&quot;</span><span class="nt">&gt;</span>
<span class="w">       </span><span class="nt">&lt;formula</span><span class="w"> </span><span class="na">eq=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">result-unit=</span><span class="s">&quot;Wavelength&quot;</span><span class="nt">/&gt;</span>
<span class="w">       </span><span class="nt">&lt;fixed</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/parameter&gt;</span>
<span class="nt">&lt;/component-link&gt;</span>
<span class="nt">&lt;/parameter-file&gt;</span>
</pre></div>
</div>
<p>In the following the LinearFunction A0 coefficient is set globally for
all detectors at the instrument level, while the A1 coefficient is
provided for each detector. In this way the Algorithm sees a complete
definition for the Linear function (both A1 and A0) from two incomplete
definitions on different components in the tree.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;parameter-file</span><span class="w"> </span><span class="na">instrument =</span><span class="w"> </span><span class="s">&quot;basic_rect&quot;</span><span class="w"> </span><span class="na">date =</span><span class="w"> </span><span class="s">&quot;2012-01-31T00:00:00&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;component-link</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;basic_rect&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LinearBackground:A0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;fitting&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;formula</span><span class="w"> </span><span class="na">eq=</span><span class="s">&quot;3&quot;</span><span class="w"> </span><span class="na">result-unit=</span><span class="s">&quot;Wavelength&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;fixed</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/parameter&gt;</span>
<span class="nt">&lt;/component-link&gt;</span>
<span class="nt">&lt;component-link</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;bank1(0,0)&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LinearBackground:A1&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;fitting&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;formula</span><span class="w"> </span><span class="na">eq=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">result-unit=</span><span class="s">&quot;Wavelength&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;fixed</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/parameter&gt;</span>
<span class="nt">&lt;/component-link&gt;</span>
<span class="nt">&lt;component-link</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;bank2(0,0)&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LinearBackground:A1&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;fitting&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;formula</span><span class="w"> </span><span class="na">eq=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">result-unit=</span><span class="s">&quot;Wavelength&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;fixed</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/parameter&gt;</span>
<span class="nt">&lt;/component-link&gt;</span>
<span class="nt">&lt;/parameter-file&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Example - A simple linear correction</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="c1">#create a param file</span>
<span class="n">param_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;&lt;parameter-file instrument = &quot;basic_rect&quot; date = &quot;2012-01-31T00:00:00&quot;&gt;</span>
<span class="s1">      &lt;component-link name=&quot;basic_rect&quot;&gt;</span>
<span class="s1">      &lt;parameter name=&quot;LinearBackground:A0&quot; type=&quot;fitting&quot;&gt;</span>
<span class="s1">        &lt;formula eq=&quot;1&quot; result-unit=&quot;Wavelength&quot;/&gt;</span>
<span class="s1">        &lt;fixed /&gt;</span>
<span class="s1">      &lt;/parameter&gt;</span>
<span class="s1">      &lt;parameter name=&quot;LinearBackground:A1&quot; type=&quot;fitting&quot;&gt;</span>
<span class="s1">        &lt;formula eq=&quot;2&quot; result-unit=&quot;Wavelength&quot;/&gt;</span>
<span class="s1">        &lt;fixed /&gt;</span>
<span class="s1">      &lt;/parameter&gt;</span>
<span class="s1">      &lt;/component-link&gt;</span>
<span class="s1">    &lt;/parameter-file&gt;&#39;&#39;&#39;</span>

<span class="c1">#find a suitable directory to save the param file</span>
<span class="n">param_dir</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;defaultsave.directory&quot;</span><span class="p">]</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">param_dir</span><span class="p">):</span>
  <span class="c1">#use the users home directory if default save is not set</span>
  <span class="n">param_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
<span class="n">param_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">param_dir</span><span class="p">,</span><span class="s2">&quot;NormByDet_Ex_param.xml&quot;</span><span class="p">)</span>
<span class="c1">#write the param file out</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">param_file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">param_file</span><span class="p">:</span>
  <span class="n">param_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">param_text</span><span class="p">)</span>


<span class="c1"># a sample workspace with a sample instrument</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c1"># convert to Wavelength</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">ConvertUnits</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="s2">&quot;Wavelength&quot;</span><span class="p">)</span>
<span class="c1">#Load the param file into the workspace</span>
<span class="n">LoadParameterFile</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">param_file_path</span><span class="p">)</span>

<span class="c1">#Now we are ready to run the correction</span>
<span class="n">wsCorrected</span> <span class="o">=</span> <span class="n">NormaliseByDetector</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The correction will divide the data by an increasing linear function.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f(x) = 2x + 1&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">wsCorrected</span><span class="o">.</span><span class="n">blocksize</span><span class="p">(),</span><span class="mi">10</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The correct value in bin </span><span class="si">{}</span><span class="s2"> is </span><span class="si">{:.2f}</span><span class="s2"> compared to </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">wsCorrected</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">i</span><span class="p">],</span><span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">i</span><span class="p">]))</span>

<span class="c1">#clean up the file</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">param_file_path</span><span class="p">):</span>
  <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">param_file_path</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The correction will divide the data by an increasing linear function.
f(x) = 2x + 1
The correct value in bin 0 is 0.28 compared to 0.30
The correct value in bin 10 is 0.14 compared to 0.30
The correct value in bin 20 is 0.09 compared to 0.30
The correct value in bin 30 is 0.07 compared to 0.30
The correct value in bin 40 is 0.06 compared to 0.30
The correct value in bin 50 is 1.63 compared to 10.30
The correct value in bin 60 is 0.04 compared to 0.30
The correct value in bin 70 is 0.04 compared to 0.30
The correct value in bin 80 is 0.03 compared to 0.30
The correct value in bin 90 is 0.03 compared to 0.30
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/CorrectionFunctions/NormalisationCorrections.html">CorrectionFunctions\NormalisationCorrections</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/a8f64cccc781eac9892433e956bab7104ebf1213/Framework/Algorithms/inc/MantidAlgorithms/NormaliseByDetector.h">NormaliseByDetector.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/a8f64cccc781eac9892433e956bab7104ebf1213/Framework/Algorithms/src/NormaliseByDetector.cpp">NormaliseByDetector.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="NormaliseByCurrent-v1.html" title="Previous Chapter: NormaliseByCurrent v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; NormaliseByCurrent v1</span>
    </a>
  </li>
  <li>
    <a href="NormaliseByPeakArea-v1.html" title="Next Chapter: NormaliseByPeakArea v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">NormaliseByPe... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>