<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DirectILLReduction v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=94a1c62f"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="DirectILLSelfShielding v1" href="DirectILLSelfShielding-v1.html" />
    <link rel="prev" title="DirectILLIntegrateVanadium v1" href="DirectILLIntegrateVanadium-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.12</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">DirectILLReduction v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="directillreduction-v1">
<span id="algm-directillreduction"></span><span id="algm-directillreduction-v1"></span><h1>DirectILLReduction v1<a class="headerlink" href="#directillreduction-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#input-workspaces" id="id6">Input workspaces</a></p></li>
<li><p><a class="reference internal" href="#outputs" id="id7">Outputs</a></p></li>
<li><p><a class="reference internal" href="#normalisation-to-absolute-units" id="id8">Normalisation to absolute units</a></p></li>
<li><p><a class="reference internal" href="#re-binning-in-energy-and-momentum-transfer" id="id9">(Re)binning in energy and momentum transfer</a></p></li>
<li><p><a class="reference internal" href="#transposing-output" id="id10">Transposing output</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id11">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id12">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Data reduction workflow for the direct geometry time-of-flight spectrometers at ILL.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="DirectILLApplySelfShielding-v1.html#algm-directillapplyselfshielding"><span class="std std-ref">DirectILLApplySelfShielding</span></a>, <a class="reference internal" href="DirectILLCollectData-v1.html#algm-directillcollectdata"><span class="std std-ref">DirectILLCollectData</span></a>, <a class="reference internal" href="DirectILLDiagnostics-v1.html#algm-directilldiagnostics"><span class="std std-ref">DirectILLDiagnostics</span></a>, <a class="reference internal" href="DirectILLIntegrateVanadium-v1.html#algm-directillintegratevanadium"><span class="std std-ref">DirectILLIntegrateVanadium</span></a>, <a class="reference internal" href="DirectILLSelfShielding-v1.html#algm-directillselfshielding"><span class="std std-ref">DirectILLSelfShielding</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>A workspace to reduce.</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The reduced S(Q, DeltaE) workspace.</p></td>
</tr>
<tr class="row-even"><td><p>Cleanup</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Cleanup ON</p></td>
<td><p>What to do with intermediate workspaces. Allowed values: [‘Cleanup ON’, ‘Cleanup OFF’]</p></td>
</tr>
<tr class="row-odd"><td><p>SubalgorithmLogging</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Logging OFF</p></td>
<td><p>Enable or disable subalgorithms to print in the logs. Allowed values: [‘Logging OFF’, ‘Logging ON’]</p></td>
</tr>
<tr class="row-even"><td><p>IntegratedVanadiumWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td><p>An integrated vanadium workspace.</p></td>
</tr>
<tr class="row-odd"><td><p>AbsoluteUnitsNormalisation</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Absolute Units OFF</p></td>
<td><p>Enable or disable normalisation to absolute units. Allowed values: [‘Absolute Units OFF’, ‘Absolute Units ON’]</p></td>
</tr>
<tr class="row-even"><td><p>DiagnosticsWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td><p>Detector diagnostics workspace for masking.</p></td>
</tr>
<tr class="row-odd"><td><p>GroupingAngleStep</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>A scattering angle step to which to group detectors, in degrees.</p></td>
</tr>
<tr class="row-even"><td><p>EnergyRebinningParams</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>Manual energy rebinning parameters.</p></td>
</tr>
<tr class="row-odd"><td><p>EnergyRebinning</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Energy rebinning when mixing manual and automatic binning parameters.</p></td>
</tr>
<tr class="row-even"><td><p>QBinningParams</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>Manual q rebinning parameters.</p></td>
</tr>
<tr class="row-odd"><td><p>Transposing</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Transposing ON</p></td>
<td><p>Enable or disable OutputWorkspace transposing. Allowed values: [‘Transposing ON’, ‘Transposing OFF’]</p></td>
</tr>
<tr class="row-even"><td><p>OutputSofThetaEnergyWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td></td>
<td><p>Output workspace for reduced S(theta, DeltaE).</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>This is the main data reduction algorithm in <a class="reference internal" href="../techniques/DirectILL.html#directill"><span class="std std-ref">ILL’s time-of-flight reduction suite</span></a>. It performs the last steps of the reduction workflow, namely vanadium normalisation and transformation to <span class="math notranslate nohighlight">\(S(q,\omega)\)</span> space (optionally <span class="math notranslate nohighlight">\(S(2\theta,\omega)\)</span>). The algorithm’s workflow diagram is shown below:</p>
<figure class="align-default" id="id1">
<img alt="../_images/ImageNotFound.png" src="../_images/ImageNotFound.png" />
<figcaption>
<p><span class="caption-text">diagram generation was disabled</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<section id="input-workspaces">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Input workspaces</a><a class="headerlink" href="#input-workspaces" title="Link to this heading">¶</a></h3>
<p><em>InputWorkspace</em> should contain data treated by <a class="reference internal" href="DirectILLCollectData-v1.html#algm-directillcollectdata"><span class="std std-ref">DirectILLCollectData</span></a> and, optionally, by <a class="reference internal" href="DirectILLApplySelfShielding-v1.html#algm-directillapplyselfshielding"><span class="std std-ref">DirectILLApplySelfShielding</span></a>.</p>
<p>The mandatory <em>IntegratedVanadiumWorkspace</em> should have gone through <a class="reference internal" href="DirectILLIntegrateVanadium-v1.html#algm-directillintegratevanadium"><span class="std std-ref">DirectILLIntegrateVanadium</span></a>. This workspace is used for the vanadium normalisation.</p>
<p><em>DiagnosticsWorkspace</em> should be a product of <a class="reference internal" href="DirectILLDiagnostics-v1.html#algm-directilldiagnostics"><span class="std std-ref">DirectILLDiagnostics</span></a>. It is used to mask the spectra of <em>InputWorkspace</em>.</p>
</section>
<section id="outputs">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Outputs</a><a class="headerlink" href="#outputs" title="Link to this heading">¶</a></h3>
<p>The algorithm will transform the time-of-flight and spectrum numbers of <em>InputWorkspace</em> into <span class="math notranslate nohighlight">\(S(q,\omega)\)</span> at its output. For <span class="math notranslate nohighlight">\(2\theta\)</span> to <span class="math notranslate nohighlight">\(q\)</span> transformation, <a class="reference internal" href="SofQWNormalisedPolygon-v1.html#algm-sofqwnormalisedpolygon"><span class="std std-ref">SofQWNormalisedPolygon</span></a> is used. By default, the output is transposed by <a class="reference internal" href="Transpose-v1.html#algm-transpose"><span class="std std-ref">Transpose</span></a>. This behavior can be turned off by the <em>Transpose</em> property.</p>
<p>The optional <span class="math notranslate nohighlight">\(S(2\theta,\omega)\)</span> output can be enabled by the <em>OutputSofThetaEnergyWorkspace</em>. This is the processed data right after detector grouping and before the transformation to <span class="math notranslate nohighlight">\(S(q,\omega)\)</span>.</p>
</section>
<section id="normalisation-to-absolute-units">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Normalisation to absolute units</a><a class="headerlink" href="#normalisation-to-absolute-units" title="Link to this heading">¶</a></h3>
<p>Normalisation to absolute units can be enabled by setting <em>AbsoluteUnitsNormalisation</em> to <code class="docutils literal notranslate"><span class="pre">'Absolute</span> <span class="pre">Units</span> <span class="pre">ON'</span></code>. In this case the data is multiplied by a factor</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(f = \frac{N_V \sigma_V}{N_S}\)</span></p>
</div></blockquote>
<p>after normalisation to vanadium giving units of barn to the data. In the above, <span class="math notranslate nohighlight">\(N_V\)</span> stands for the vanadium number density, <span class="math notranslate nohighlight">\(\sigma_V\)</span> for vanadium total scattering cross section and <span class="math notranslate nohighlight">\(N_S\)</span> sample number density.</p>
<p>The material properties should be set for <em>InputWorkspace</em> and <em>IntegratedVanadiumWorkspace</em> by <a class="reference internal" href="SetSample-v1.html#algm-setsample"><span class="std std-ref">SetSample</span></a> before running this algorithm .</p>
</section>
<section id="re-binning-in-energy-and-momentum-transfer">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">(Re)binning in energy and momentum transfer</a><a class="headerlink" href="#re-binning-in-energy-and-momentum-transfer" title="Link to this heading">¶</a></h3>
<p>After conversion from time-of-flight to energy transfer, the binning may differ from spectrum to spectrum if the sample to detector distances are unequal. The <a class="reference internal" href="SofQWNormalisedPolygon-v1.html#algm-sofqwnormalisedpolygon"><span class="std std-ref">SofQWNormalisedPolygon</span></a> algorithm cannot work with such ragged workspaces and thus rebinning in energy transfer is necessary. By default, the algorithm uses automatic rebinning:
- For negative energy transfers, copy binning from the spectrum which covers the largest negative energy transfer range.
- For positive energy transfers, use the median bin width over all spectra at zero energy transfer.</p>
<p>The automatic rebinning can be overriden by the <em>EnergyRebinningParams</em> or <em>EnergyRebinning</em> properties. <em>EnergyRebinningParams</em> is directly passed to <a class="reference internal" href="Rebin-v1.html#algm-rebin"><span class="std std-ref">Rebin</span></a> as the <em>Params</em> property. On the other hand, <em>EnergyRebinning</em> allows for mixture of automatic and user specified rebinning. Its syntax is a comma separated list of letters <cite>a</cite> for automatic binning and numbers for ranges and user-specified bin widths. Here are some examples:</p>
<dl class="simple">
<dt><cite>‘a’</cite></dt><dd><p>Rebin the entire energy transfer axis automatically. Same as the defalt behavior.</p>
</dd>
<dt><cite>‘-4, a, 8’</cite></dt><dd><p>Rebin the energy transfer axis from -4 to 8 meV automatically.</p>
</dd>
<dt><cite>‘a, -1, 0.01, 1, a’</cite></dt><dd><p>Rebin everything automatically except from -1 to 1 meV, where the bin width is set to 0.01 meV.</p>
</dd>
<dt><cite>‘a, -5, 0.1, -1, 0.01, 1’</cite></dt><dd><p>Automatic rebinning from minimum energy transfer up to -5 meV, after which use user defined binning: between -5 and -1 meV the bin width is 0.1 mev, while between -1 and 1 meV, it is 0.01.</p>
</dd>
<dt><cite>‘-10, a, -1, 0.01, 1, a, 4’</cite></dt><dd><p>Start the energy transfer axis at -10 meV, use automatic binning up to -1 meV. Between -1 and 1 meV use bin width of 0.01 meV. Use automatic binning again from 1 to 4 meV.</p>
</dd>
</dl>
<p><em>QBinningParams</em> are passed to <a class="reference internal" href="SofQWNormalisedPolygon-v1.html#algm-sofqwnormalisedpolygon"><span class="std std-ref">SofQWNormalisedPolygon</span></a> and have the same format as <em>EnergyRebinningParamas</em>. If the property is not specified, <span class="math notranslate nohighlight">\(q\)</span> is binned to a value that depends on the wavelength and the <span class="math notranslate nohighlight">\(2\theta\)</span> separation of the grouped detectors. By default, the detectors are grouped to 0.01 degree wide bins in <span class="math notranslate nohighlight">\(2\theta\)</span> or to the value of the <code class="docutils literal notranslate"><span class="pre">natural-angle-step</span></code> instrument parameter. The default behavior can be overriden by the <em>GroupingAngleStep</em> property.</p>
</section>
<section id="transposing-output">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Transposing output</a><a class="headerlink" href="#transposing-output" title="Link to this heading">¶</a></h3>
<p>After conversion to momentum transfer, the vertical axis of the data is in units of momentum transfer while the horizontal axis is in energy transfer. By default, the data is transposed such that momentum transfer is on the horizontal axis and energy transfer in the vertical. This can be turned off by setting <em>Transposing</em> to <code class="docutils literal notranslate"><span class="pre">'Transposing</span> <span class="pre">OFF'</span></code>.</p>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p>For usage of this algorithm, check the examples <a class="reference internal" href="../techniques/DirectILL.html#directill"><span class="std std-ref">here</span></a>.</p>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/ILL/Direct.html">ILL\Direct</a> | <a class="reference external" href="categories/Inelastic/Reduction.html">Inelastic\Reduction</a> | <a class="reference external" href="categories/Workflow/Inelastic.html">Workflow\Inelastic</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/a8f64cccc781eac9892433e956bab7104ebf1213/Framework/PythonInterface/plugins/algorithms/WorkflowAlgorithms/DirectILLReduction.py">DirectILLReduction.py</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="DirectILLIntegrateVanadium-v1.html" title="Previous Chapter: DirectILLIntegrateVanadium v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; DirectILLInte...</span>
    </a>
  </li>
  <li>
    <a href="DirectILLSelfShielding-v1.html" title="Next Chapter: DirectILLSelfShielding v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">DirectILLSelf... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>