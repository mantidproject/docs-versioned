<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Diffraction Changes</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <script src="../../_static/documentation_options.js?v=94a1c62f"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Direct Geometry Changes" href="direct_geometry.html" />
    <link rel="prev" title="Mantid 6.7.0 Release Notes" href="index.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.12</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="../index.html" >Release Notes</a> &#187;</li>
          
            <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Mantid 6.7.0 Release Notes</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">Diffraction Changes</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="diffraction-changes">
<h1>Diffraction Changes<a class="headerlink" href="#diffraction-changes" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#powder-diffraction" id="id5">Powder Diffraction</a></p>
<ul>
<li><p><a class="reference internal" href="#new-features" id="id6">New features</a></p></li>
<li><p><a class="reference internal" href="#bugfixes" id="id7">Bugfixes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#engineering-diffraction" id="id8">Engineering Diffraction</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id9">New features</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id10">Bugfixes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#single-crystal-diffraction" id="id11">Single Crystal Diffraction</a></p>
<ul>
<li><p><a class="reference internal" href="#id3" id="id12">New features</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id13">Bugfixes</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="powder-diffraction">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Powder Diffraction</a><a class="headerlink" href="#powder-diffraction" title="Link to this heading">¶</a></h2>
<section id="new-features">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">New features</a><a class="headerlink" href="#new-features" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>For the ILL/D2B instrument, only calibrated data are loaded from the nexus file.</p></li>
<li><p>The ISIS powder diffraction scripts now support per detector Vanadium normalisation. So far this has only been enabled on the POLARIS instrument.</p></li>
<li><p>It is now possible to provide more than one detector height range in <a class="reference internal" href="../../algorithms/PowderILLDetectorScan-v1.html#algm-powderilldetectorscan"><span class="std std-ref">PowderILLDetectorScan</span></a>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">InitialMask</span></code> and <code class="docutils literal notranslate"><span class="pre">FinalMask</span></code> properties of <a class="reference internal" href="../../algorithms/PowderILLDetectorScan-v1.html#algm-powderilldetectorscan"><span class="std std-ref">PowderILLDetectorScan</span></a> have been removed.</p></li>
<li><p>Improvements to <a class="reference internal" href="../../techniques/ISISPowder-Pearl-v1.html#isis-powder-diffraction-pearl-ref"><span class="std std-ref">PEARL powder</span></a> reduction output file and directory naming; <code class="docutils literal notranslate"><span class="pre">.gss</span></code> files and TOF and d-spacing <code class="docutils literal notranslate"><span class="pre">.xye</span></code> files are now in separate directories.</p></li>
<li><p>OSIRIS scripts now use a new <a class="reference internal" href="../../techniques/ISISPowder-OSIRIS-v1.html#focus-osiris-isis-powder-diffraction-ref"><span class="std std-ref">focus function</span></a> instead of the <code class="docutils literal notranslate"><span class="pre">run_diffraction_focusing</span></code> function to perform the focusing. Results should be the same.</p></li>
<li><p>The <a class="reference internal" href="../../techniques/ISISPowder-OSIRIS-v1.html#create-vanadium-osiris-isis-powder-diffraction-ref"><span class="std std-ref">create_vanadium</span></a> function has been added to the OSIRIS object which should be called before the <code class="docutils literal notranslate"><span class="pre">focus</span></code> function to create the vanadium runs.</p></li>
<li><p>It is now possible to mask out detectors in the absorption and multiple scattering calculations <a class="reference internal" href="../../algorithms/AbsorptionCorrection-v1.html#algm-absorptioncorrection"><span class="std std-ref">AbsorptionCorrection</span></a>, <a class="reference internal" href="../../algorithms/PaalmanPingsAbsorptionCorrection-v1.html#algm-paalmanpingsabsorptioncorrection"><span class="std std-ref">PaalmanPingsAbsorptionCorrection</span></a>, and <a class="reference internal" href="../../algorithms/MultipleScatteringCorrection-v1.html#algm-multiplescatteringcorrection"><span class="std std-ref">MultipleScatteringCorrection</span></a>.</p></li>
<li><p>New parameter <code class="docutils literal notranslate"><span class="pre">MinimumSignalToNoiseRatio</span></code> has been added to the <a class="reference internal" href="../../algorithms/FitPeaks-v1.html#algm-fitpeaks"><span class="std std-ref">FitPeaks</span></a> and <a class="reference internal" href="../../algorithms/PDCalibration-v1.html#algm-pdcalibration"><span class="std std-ref">PDCalibration</span></a> algorithms. This will exclude peaks from automated fitting below a threshold signal-to-noise ratio estimated from the data in the fitting window.</p></li>
<li><p>Additional, optional, source terms added to the <a class="reference internal" href="../../algorithms/EstimateResolutionDiffraction-v1.html#algm-estimateresolutiondiffraction"><span class="std std-ref">EstimateResolutionDiffraction</span></a>. For instruments with small detector pixels (e.g. SNAP), the size of the source is the overwhelming contributor to the resolution calculation.</p></li>
<li><p><a class="reference internal" href="../../algorithms/EstimateResolutionDiffraction-v1.html#algm-estimateresolutiondiffraction"><span class="std std-ref">EstimateResolutionDiffraction</span></a> will average the resolution from summed pixels.</p></li>
</ul>
<a class="reference internal image-reference" href="../../_images/SNAP_Resolution.png"><img alt="Instrument view showing the calculated dTOF/TOF resolution for the SNAP instrument (SNS) using the EstimateResolutionDiffraction algorithm." class="align-center" src="../../_images/SNAP_Resolution.png" style="width: 300px;" />
</a>
</section>
<section id="bugfixes">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Bugfixes</a><a class="headerlink" href="#bugfixes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>The <a class="reference internal" href="../../techniques/ISISPowder-OSIRIS-v1.html#isis-powder-diffraction-osiris-ref"><span class="std std-ref">Osiris script</span></a> and the <a class="reference internal" href="../../interfaces/indirect/Indirect%20Diffraction.html#interface-indirect-diffraction"><span class="std std-ref">Indirect Diffraction UI</span></a> now produces the same results.</p></li>
</ul>
</section>
</section>
<section id="engineering-diffraction">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Engineering Diffraction</a><a class="headerlink" href="#engineering-diffraction" title="Link to this heading">¶</a></h2>
<section id="id1">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">New features</a><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>The GSASII tab outputs the sample logs attached to the relevant focused data, as specified in the Engineering Diffraction settings. This behaves in the same way as before for the fitting tab.</p></li>
<li><p>It is now possible to load and plot multiple phases in the GSASII tab.</p></li>
</ul>
</section>
<section id="id2">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Bugfixes</a><a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Extra validation has been added to the <code class="docutils literal notranslate"><span class="pre">Path</span> <span class="pre">to</span> <span class="pre">GSASII</span></code> setting so that Workbench no longer crashes if a GSAS refinement is run with an invalid GSASII path in settings.</p></li>
<li><p>Loading or creating a calibration now fills the GSASII tab with the currently loaded calibration’s <code class="docutils literal notranslate"><span class="pre">.prm</span></code> file.</p></li>
<li><p>Check GSASII reflection file output exists before loading results in GSASII tab (this can happen if no reflections are within the TOF limits specified).</p></li>
<li><p>Prevent TOF limits having min &gt; max in GSASII tab.</p></li>
</ul>
</section>
</section>
<section id="single-crystal-diffraction">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Single Crystal Diffraction</a><a class="headerlink" href="#single-crystal-diffraction" title="Link to this heading">¶</a></h2>
<section id="id3">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">New features</a><a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Added new methods to calculate the directions of the reverse incident and scattered beam within <code class="docutils literal notranslate"><span class="pre">Peak</span></code>.</p></li>
<li><p>Added new method to calculate the direction cosine from a provided direction within <code class="docutils literal notranslate"><span class="pre">OrientedLattice</span></code>.</p></li>
<li><p><a class="reference internal" href="../../algorithms/OptimizeLatticeForCellType-v1.html#algm-optimizelatticeforcelltype"><span class="std std-ref">OptimizeLatticeForCellType</span></a> now properly supports mnp-modulation vectors.</p></li>
<li><p><a class="reference internal" href="../../algorithms/SaveHKL-v1.html#algm-savehkl"><span class="std std-ref">SaveHKL</span></a> supports 6-column <code class="docutils literal notranslate"><span class="pre">hklmnp</span></code> format.</p></li>
<li><p><a class="reference internal" href="../../algorithms/LoadHKL-v1.html#algm-loadhkl"><span class="std std-ref">LoadHKL</span></a> supports 6-column <code class="docutils literal notranslate"><span class="pre">hklmnp</span></code> format.</p></li>
<li><p><a class="reference internal" href="../../algorithms/FilterPeaks-v1.html#algm-filterpeaks"><span class="std std-ref">FilterPeaks</span></a> can now filter out modulation vectors by <span class="math notranslate nohighlight">\(m^2+n^2+p^2\)</span>.</p></li>
<li><p><a class="reference internal" href="../../algorithms/SortHKL-v1.html#algm-sorthkl"><span class="std std-ref">SortHKL</span></a> skips modulation vectors.</p></li>
<li><p><a class="reference internal" href="../../algorithms/StatisticsOfPeaksWorkspace-v1.html#algm-statisticsofpeaksworkspace"><span class="std std-ref">StatisticsOfPeaksWorkspace</span></a> skips modulation vectors.</p></li>
<li><p><a class="reference internal" href="../../algorithms/SaveNexus-v1.html#algm-savenexus"><span class="std std-ref">SaveNexus</span></a> now supports modulation vectors.</p></li>
<li><p><a class="reference internal" href="../../algorithms/LoadNexus-v1.html#algm-loadnexus"><span class="std std-ref">LoadNexus</span></a> now supports modulation vectors.</p></li>
<li><p><a class="reference internal" href="../../algorithms/CompareWorkspaces-v1.html#algm-compareworkspaces"><span class="std std-ref">CompareWorkspaces</span></a> now supports modulation vectors.</p></li>
<li><p>Peaks workspaces now display <code class="docutils literal notranslate"><span class="pre">IntHKL</span></code> and <code class="docutils literal notranslate"><span class="pre">IntMNP</span></code> columns.</p></li>
<li><p>Add new instrument definition for SXD post bank 1 detector upgrade.</p></li>
<li><p>Add option <code class="docutils literal notranslate"><span class="pre">OptimiseXWindowSize</span></code> to fix TOF (or d-spacing) window extent below a threshold <span class="math notranslate nohighlight">\(intensity/sigma\)</span> (<code class="docutils literal notranslate"><span class="pre">ThresholdIoverSigma</span></code>) in <a class="reference internal" href="../../algorithms/IntegratePeaksSkew-v1.html#algm-integratepeaksskew"><span class="std std-ref">IntegratePeaksSkew</span></a>.</p></li>
<li><p>Improved formatting of plots in pdf output of <a class="reference internal" href="../../algorithms/IntegratePeaksSkew-v1.html#algm-integratepeaksskew"><span class="std std-ref">IntegratePeaksSkew</span></a>.</p></li>
<li><p>Parameter <code class="docutils literal notranslate"><span class="pre">NTOFBinsMin</span></code> in <a class="reference internal" href="../../algorithms/IntegratePeaksSkew-v1.html#algm-integratepeaksskew"><span class="std std-ref">IntegratePeaksSkew</span></a> now refers to the number of non-zero bins in the integration window with <span class="math notranslate nohighlight">\(y/error &gt; 1\)</span>.</p></li>
<li><p>Support workspaces with d-spacing xunit in <a class="reference internal" href="../../algorithms/IntegratePeaksSkew-v1.html#algm-integratepeaksskew"><span class="std std-ref">IntegratePeaksSkew</span></a>.</p></li>
</ul>
<a class="reference internal image-reference" href="../../_images/IntegratePeaksSkew_dSpacing.png"><img alt="Output from IntegratePeaksSkew algorithm run on a workspace with xunit of d-spacing." class="align-center" src="../../_images/IntegratePeaksSkew_dSpacing.png" style="width: 300px;" />
</a>
</section>
<section id="id4">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Bugfixes</a><a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Increased the number of nearest neighbor detector pixels to search for in <a class="reference internal" href="../../algorithms/PredictPeaks-v1.html#algm-predictpeaks"><span class="std std-ref">PredictPeaks</span></a> that caused some obvious peaks on detector to be missed.</p></li>
<li><p>Fixed the calculation of direction cosines in <a class="reference internal" href="../../algorithms/SaveHKL-v1.html#algm-savehkl"><span class="std std-ref">SaveHKL</span></a> and <a class="reference internal" href="../../algorithms/SaveHKLCW-v1.html#algm-savehklcw"><span class="std std-ref">SaveHKLCW</span></a></p></li>
<li><p>Added back in <code class="docutils literal notranslate"><span class="pre">Peak</span></code> method <code class="docutils literal notranslate"><span class="pre">getDetectorID()</span></code> that was removed in previous release associated with <code class="docutils literal notranslate"><span class="pre">LeanElasticPeak</span></code>.</p></li>
<li><p>Fixed a bug in estimating TOF window parameters in <a class="reference internal" href="../../algorithms/IntegratePeaksSkew-v1.html#algm-integratepeaksskew"><span class="std std-ref">IntegratePeaksSkew</span></a>.</p></li>
<li><p><a class="reference internal" href="../../algorithms/IndexPeaks-v1.html#algm-indexpeaks"><span class="std std-ref">IndexPeaks</span></a> now properly accounts for fractional offsets when <code class="docutils literal notranslate"><span class="pre">RoundHKLs=True</span></code>.</p></li>
</ul>
<p><a class="reference internal" href="index.html#v6-7-0"><span class="std std-ref">Release 6.7.0</span></a></p>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="index.html" title="Previous Chapter: Mantid 6.7.0 Release Notes"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Mantid 6.7.0 ...</span>
    </a>
  </li>
  <li>
    <a href="direct_geometry.html" title="Next Chapter: Direct Geometry Changes"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Direct Geomet... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>