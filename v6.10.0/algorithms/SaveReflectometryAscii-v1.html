<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SaveReflectometryAscii v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=770b529d"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SaveSESANS v1" href="SaveSESANS-v1.html" />
    <link rel="prev" title="SaveReflections v1" href="SaveReflections-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.10</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">SaveReflectometryAscii v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="savereflectometryascii-v1">
<span id="algm-savereflectometryascii"></span><span id="algm-savereflectometryascii-v1"></span><h1>SaveReflectometryAscii v1<a class="headerlink" href="#savereflectometryascii-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id2">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#computation-of-resolution-values" id="id5">Computation of resolution values</a></p></li>
<li><p><a class="reference internal" href="#mft-file-format" id="id6">MFT File Format</a></p></li>
<li><p><a class="reference internal" href="#txt-file-format" id="id7">TXT File Format</a></p></li>
<li><p><a class="reference internal" href="#dat-file-format" id="id8">DAT File Format</a></p></li>
<li><p><a class="reference internal" href="#custom-file-format-empty-field" id="id9">Custom File Format (Empty Field)</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id10">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id11">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Saves a 2D workspace to an ascii file</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="SaveAscii-v2.html#algm-saveascii"><span class="std std-ref">SaveAscii</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the workspace containing the data you want to save.</p></td>
</tr>
<tr class="row-odd"><td><p>Filename</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The output filename</p></td>
</tr>
<tr class="row-even"><td><p>FileExtension</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>.mft</p></td>
<td><p>Choose the file extension according to the file format. Allowed values: [‘.mft’, ‘.txt’, ‘.dat’, ‘.lam’, ‘custom’]</p></td>
</tr>
<tr class="row-odd"><td><p>LogList</p></td>
<td><p>Input</p></td>
<td><p>str list</p></td>
<td></td>
<td><p>List of logs to write to file.</p></td>
</tr>
<tr class="row-even"><td><p>WriteHeader</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Whether to write header lines.</p></td>
</tr>
<tr class="row-odd"><td><p>WriteResolution</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>Whether to compute resolution values and write them as fourth data column.</p></td>
</tr>
<tr class="row-even"><td><p>Separator</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>tab</p></td>
<td><p>The separator used for splitting data columns. Allowed values: [‘comma’, ‘space’, ‘tab’]</p></td>
</tr>
<tr class="row-odd"><td><p>Theta</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The angle (in deg) used to calculate wavelength from momentum exchange.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>This algorithm saves the first spectrum of a workspace in ASCII format in order to be processed by software, e.g. Motofit.
It is possible to provide a group of workspaces as input.
In this case, each filename contains the corresponding workspace name.
The choice of the file extension (<cite>.mft</cite>, <cite>.txt</cite>, <cite>.dat</cite>) defines the file format and appends the <cite>Filename</cite> with the corresponding extension except for the <cite>custom</cite> field, which represents a custom format where the <cite>Filename</cite> can be chosen freely.
In case of histogrammed input data, the resulting file will contain the bin centre for the x-values representing the quantity <cite>q</cite>.
It is especially useful for saving reflectometry reduction data.
A file can be loaded back into Mantid by <a class="reference internal" href="LoadAscii-v2.html#algm-loadascii"><span class="std std-ref">LoadAscii v2</span></a>, which will not have an instrument defined and <cite>Sample Logs</cite> are missing.
This algorithm writes data in scientific exponential notation (E-notation) of double-precision.
Please note that <cite>SampleLog</cite> entries are not case sensitive, editing fields <cite>Title</cite> and <cite>title</cite> both edit the field <cite>title</cite>.</p>
</section>
<section id="computation-of-resolution-values">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Computation of resolution values</a><a class="headerlink" href="#computation-of-resolution-values" title="Link to this heading">¶</a></h2>
<p>For the <a class="reference internal" href="#custom-file-format-empty-field">Custom File Format (Empty Field)</a> and the <a class="reference internal" href="#txt-file-format">TXT File Format</a> file format, the option <cite>WriteResolution</cite> enables the computation of the resolution values from existing x-values (points):</p>
<p><span class="math notranslate nohighlight">\(x_i \cdot \frac{x_1 - x_0}{x_1}\)</span>,</p>
<p>where the bin centre <span class="math notranslate nohighlight">\(x_i\)</span> will be multiplied by the qutient of first and second bin centre <span class="math notranslate nohighlight">\(x_{0}\)</span> and <span class="math notranslate nohighlight">\(x_{1}\)</span>, respectively.</p>
</section>
<section id="mft-file-format">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">MFT File Format</a><a class="headerlink" href="#mft-file-format" title="Link to this heading">¶</a></h2>
<p>The file contains minimum 21 header lines each separating its name and value by a colon, followed by an empty line and a line describing the quantities of each column which are <cite>q</cite>, <cite>refl</cite>, <cite>refl_error</cite> and eventually <cite>q_res (FWHM)</cite>, if present, and the data.
The header lines contain the following information: <cite>Instrument</cite>, <cite>User-local contact</cite>, <cite>Title</cite>, <cite>Subtitle</cite>, <cite>Start date + time</cite>, <cite>End date + time</cite>, <cite>Theta 1 + dir + ref numbers</cite>, <cite>Theta 2 + dir + ref numbers</cite>, <cite>Theta 3 + dir + ref numbers</cite>, (foreseen potentially added angle(s),) followed by 9 user defined parameter lines, followed by potentially added user defined parameter lines, <cite>Number of file format</cite>, <cite>Number of data points</cite>.
The version of the file format is set randomly to the high value 40 in order to exceed all ILL Cosmos versions.
For the ILL instruments D17 and FIGARO, obligatory header lines will be automatically filled by using the workspaces <cite>Sample Logs</cite> information which can be modified as shown in the <a class="reference internal" href="#usage">Usage</a>.
The algorithm seeks to add the values for the following SampleLog entries: <cite>instrument.name</cite>, <cite>user.namelocalcontact</cite>, <cite>title</cite>, <cite>start_time</cite> and <cite>end_time</cite> which correspond to the header lines of names <cite>Instrument</cite>, <cite>User-local contact</cite>, <cite>Title</cite>, <cite>Start date + time</cite>, <cite>End date + time</cite>, respectively.
The options <cite>WriteHeader</cite>, <cite>WriteResolution</cite> and <cite>Separator</cite> do not have any effect and are not visible in the user interface.</p>
</section>
<section id="txt-file-format">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">TXT File Format</a><a class="headerlink" href="#txt-file-format" title="Link to this heading">¶</a></h2>
<p>This file format (ANSTO Ascii format) writes four columns of data without any additional information.
If the resolution values are not present will be optionally computed, see <a class="reference internal" href="#computation-of-resolution-values">Computation of resolution values</a>.
The options <cite>LogList</cite>, <cite>WriteHeader</cite>, <cite>WriteResolution</cite> and <cite>Separator</cite> do not have any effect and are not visible in the user interface.</p>
</section>
<section id="dat-file-format">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">DAT File Format</a><a class="headerlink" href="#dat-file-format" title="Link to this heading">¶</a></h2>
<p>Stores first the number of lines followed by three columns of data.
The option <cite>LogList</cite>, <cite>WriteResolution</cite> and <cite>Separator</cite> do not have any effect and are not visible in the user interface.</p>
</section>
<section id="custom-file-format-empty-field">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Custom File Format (Empty Field)</a><a class="headerlink" href="#custom-file-format-empty-field" title="Link to this heading">¶</a></h2>
<p>Enables a selection to write header lines via the option <cite>WriteHeader</cite> and the separator via the option <cite>Separator</cite> as well as the number of columns to write, i.e. three or four via the option <cite>WriteResolution</cite>.
The header follows the specification of the <a class="reference internal" href="#mft-file-format">MFT File format</a>, if enabled.
Please consider to directly provide the desired file extension via the input <cite>Filename</cite>.
All options are taken into account and are visible in the user interface.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Example - Save a workspace in reflectometry ASCII format</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># import the os path libraries for directory functions</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># create histogram workspace</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
<span class="n">dx</span> <span class="o">=</span> <span class="p">[</span><span class="mf">9.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>

<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">DataY</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">DataE</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">Dx</span><span class="o">=</span><span class="n">dx</span><span class="p">)</span>

<span class="c1"># Create an absolute path by joining the proposed filename to a directory</span>
<span class="c1"># os.path.expanduser(&quot;~&quot;) used in this case returns the home directory of the current user</span>
<span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;ws&quot;</span><span class="p">)</span>

<span class="c1"># Add Sample Log entries</span>
<span class="c1"># Add a Title entry:</span>
<span class="n">AddSampleLog</span><span class="p">(</span><span class="n">Workspace</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">LogName</span><span class="o">=</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">LogText</span><span class="o">=</span><span class="s1">&#39;MyTest&#39;</span><span class="p">,</span> <span class="n">LogType</span><span class="o">=</span><span class="s1">&#39;String&#39;</span><span class="p">)</span>
<span class="c1"># Add an entry called d as a Parameter (then, only eight not defined parameter lines remain):</span>
<span class="n">AddSampleLog</span><span class="p">(</span><span class="n">Workspace</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">LogName</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">LogText</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">LogType</span><span class="o">=</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="n">LogUnit</span><span class="o">=</span><span class="s1">&#39;mm&#39;</span><span class="p">,</span> <span class="n">NumberType</span><span class="o">=</span><span class="s1">&#39;Double&#39;</span><span class="p">)</span>

<span class="c1"># Save with mft extension and using the option LogList: title will be added to a required header line and d will be additionally added</span>
<span class="c1"># to the first parameter field.</span>
<span class="n">SaveReflectometryAscii</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">Filename</span><span class="o">=</span><span class="n">file</span><span class="p">,</span> <span class="n">LogList</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file</span> <span class="o">+</span> <span class="s2">&quot;.mft&quot;</span><span class="p">):</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">((</span><span class="n">file</span> <span class="o">+</span> <span class="s2">&quot;.mft&quot;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">myFile</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">myFile</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MFT
Instrument : Not defined
User-local contact : Not defined
Title : MyTest
Subtitle : Not defined
Start date + time : Not defined
End date + time : Not defined
Theta 1 + dir + ref numbers : Not defined
Theta 2 + dir + ref numbers : Not defined
Theta 3 + dir + ref numbers : Not defined
d : 0.29999999999999999 mm
Parameter  : Not defined
Parameter  : Not defined
Parameter  : Not defined
Parameter  : Not defined
Parameter  : Not defined
Parameter  : Not defined
Parameter  : Not defined
Parameter  : Not defined
Number of file format : 40
Number of data points : 3

                           q                        refl                    refl_err                q_res (FWHM)
       5.000000000000000e-01       0.000000000000000e+00       1.000000000000000e+00       9.500000000000000e+00
       1.500000000000000e+00       1.000000000000000e+00       1.000000000000000e+00       9.500000000000000e+00
       2.500000000000000e+00       2.000000000000000e+00       1.000000000000000e+00       9.500000000000000e+00
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/DataHandling/Text.html">DataHandling\Text</a> | <a class="reference external" href="categories/ILL/Reflectometry.html">ILL\Reflectometry</a> | <a class="reference external" href="categories/Reflectometry.html">Reflectometry</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/1b00e0b0644260219c488cf4142569b296f21ab0/Framework/DataHandling/inc/MantidDataHandling/SaveReflectometryAscii.h">SaveReflectometryAscii.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/1b00e0b0644260219c488cf4142569b296f21ab0/Framework/DataHandling/src/SaveReflectometryAscii.cpp">SaveReflectometryAscii.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="SaveReflections-v1.html" title="Previous Chapter: SaveReflections v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SaveReflections v1</span>
    </a>
  </li>
  <li>
    <a href="SaveSESANS-v1.html" title="Next Chapter: SaveSESANS v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SaveSESANS v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>