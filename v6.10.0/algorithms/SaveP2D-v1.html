<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SaveP2D v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=770b529d"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SavePAR v1" href="SavePAR-v1.html" />
    <link rel="prev" title="SaveOpenGenieAscii v1" href="SaveOpenGenieAscii-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.10</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">SaveP2D v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="savep2d-v1">
<span id="algm-savep2d"></span><span id="algm-savep2d-v1"></span><h1>SaveP2D v1<a class="headerlink" href="#savep2d-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id2">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#input" id="id5">Input</a></p></li>
<li><p><a class="reference internal" href="#output" id="id6">Output</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id7">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id8">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>The algorithm used to create a multidimensional ‘.p2d’ file from a 2D workspace.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="Bin2DPowderDiffraction-v1.html#algm-bin2dpowderdiffraction"><span class="std std-ref">Bin2DPowderDiffraction</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Workspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Workspace that should be used.</p></td>
</tr>
<tr class="row-odd"><td><p>OutputFile</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Output File for “.p2d” Data.</p></td>
</tr>
<tr class="row-even"><td><p>RemoveNaN</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>Remove DataPoints with NaN as intensity value</p></td>
</tr>
<tr class="row-odd"><td><p>RemoveNegatives</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>Remove data points with negative intensity values</p></td>
</tr>
<tr class="row-even"><td><p>CutData</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Use the following inputs to limit data in Theta, lambda, d and dp</p></td>
</tr>
<tr class="row-odd"><td><p>TthMin</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>50</p></td>
<td><p>Minimum for tth values</p></td>
</tr>
<tr class="row-even"><td><p>TthMax</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>120</p></td>
<td><p>Maximum  for tth values</p></td>
</tr>
<tr class="row-odd"><td><p>LambdaMin</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.3</p></td>
<td><p>Minimum  for lambda values</p></td>
</tr>
<tr class="row-even"><td><p>LambdaMax</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1.1</p></td>
<td><p>Maximum  for lambda values</p></td>
</tr>
<tr class="row-odd"><td><p>DMin</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.11</p></td>
<td><p>Minimum  for d values</p></td>
</tr>
<tr class="row-even"><td><p>DMax</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1.37</p></td>
<td><p>Maximum  for d values</p></td>
</tr>
<tr class="row-odd"><td><p>DpMin</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.48</p></td>
<td><p>Minimum  for dp values</p></td>
</tr>
<tr class="row-even"><td><p>DpMax</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1.76</p></td>
<td><p>Maximum  for dp values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<section id="input">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Input</a><a class="headerlink" href="#input" title="Link to this heading">¶</a></h3>
<p>This algorithm can be used to create a powder pattern 2d (“.p2d”) output file as useable for
multidimensional Rietveld refinements.
The input for this algorithm needs to be a 2D workspace containing information about dSpacing and
dSpacingPerpendicular. A 2D workspace can be created using the <a class="reference internal" href="Bin2DPowderDiffraction-v1.html#algm-bin2dpowderdiffraction"><span class="std std-ref">Bin2DPowderDiffraction</span></a> algorithm.
The input values <code class="docutils literal notranslate"><span class="pre">removeNaN</span></code> and <code class="docutils literal notranslate"><span class="pre">removeNegatives</span></code> control whether intensity values that are negative
or NaN, respectively, are automatically removed from the dataset.
<code class="docutils literal notranslate"><span class="pre">RemoveNegatives</span></code> also removes intensities equal to zero.
Turning <code class="docutils literal notranslate"><span class="pre">cutDdata</span></code> on, allows to cut the measuring data to the specified ranges of
theta, lambda, dSpacing and dSpacingPerpendicular.</p>
</section>
<section id="output">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Output</a><a class="headerlink" href="#output" title="Link to this heading">¶</a></h3>
<p>The output file contains a short comment header giving the title, the instrument parameter file,
the binning parameters of the workspace and the used instrument/detector bank.
Thereafter the measuring data is written into 5 columns, namely, 2theta, lambda, dSpacing,
dSpacingPerpendicular and intensity.</p>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Example: Create a “.p2d” file from a 2D Workspace. Remember to change the Filepath for the OutputFile!</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># create a 2D Workspace</span>
<span class="c1"># repeat this block for each spectrum</span>
<span class="n">xData</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">6.0</span><span class="p">,</span><span class="mf">7.0</span><span class="p">,</span><span class="mf">8.0</span><span class="p">,</span><span class="mf">9.0</span><span class="p">]</span>                    <span class="c1"># d values for one spectrum (one dPerpendicular value)</span>
<span class="n">yData</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">]</span>                                                <span class="c1"># dPerpendicular binedges</span>
<span class="n">zData</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>                    <span class="c1"># intensity values</span>
<span class="n">eData</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>                              <span class="c1"># error values</span>

<span class="c1"># used to join all spectra</span>
<span class="n">xDataTotal</span> <span class="o">=</span> <span class="p">[]</span>                                                              <span class="c1"># d Values for all spectra</span>
<span class="n">zDataTotal</span> <span class="o">=</span> <span class="p">[]</span>                                                              <span class="c1"># intensity values for all spectra</span>
<span class="n">eDataTotal</span> <span class="o">=</span> <span class="p">[]</span>                                          <span class="c1"># error values for all spectra</span>
<span class="n">nSpec</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">yData</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>                                     <span class="c1"># number of spectra</span>

<span class="c1"># Create d and intensity lists for workspace</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nSpec</span><span class="p">):</span>
    <span class="n">xDataTotal</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">xData</span><span class="p">)</span>           <span class="c1"># extends the list of x values in accordance to the number of spectra used</span>
    <span class="n">zDataTotal</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">zData</span><span class="p">)</span>           <span class="c1"># extends the list of intensity values in accordance to the number of spectra used</span>
    <span class="n">eDataTotal</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">eData</span><span class="p">)</span>       <span class="c1"># extends the list of error values in accordance to the number of spectra used</span>

<span class="c1"># Create a 2D Workspace containing d and dPerpendicular values with intensities</span>
<span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">OutputWorkspace</span> <span class="o">=</span> <span class="s1">&#39;Usage_Example&#39;</span><span class="p">,</span> <span class="n">DataX</span> <span class="o">=</span> <span class="n">xDataTotal</span><span class="p">,</span> <span class="n">DataY</span> <span class="o">=</span> <span class="n">zDataTotal</span><span class="p">,</span> <span class="n">DataE</span> <span class="o">=</span> <span class="n">eDataTotal</span><span class="p">,</span> <span class="n">WorkspaceTitle</span> <span class="o">=</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">NSpec</span> <span class="o">=</span> <span class="n">nSpec</span><span class="p">,</span> <span class="n">UnitX</span> <span class="o">=</span> <span class="s1">&#39;dSpacing&#39;</span><span class="p">,</span> <span class="n">VerticalAxisUnit</span> <span class="o">=</span> <span class="s1">&#39;dSpacingPerpendicular&#39;</span><span class="p">,</span> <span class="n">VerticalAxisValues</span> <span class="o">=</span> <span class="n">yData</span><span class="p">)</span>

<span class="c1"># Save to the users home directory</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;Usage_Example&quot;</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="n">file_name</span><span class="p">)</span>

<span class="c1"># Create a .p2d file containing the testdata</span>
<span class="n">SaveP2D</span><span class="p">(</span><span class="n">Workspace</span> <span class="o">=</span> <span class="s2">&quot;Usage_Example&quot;</span><span class="p">,</span> <span class="n">OutputFile</span> <span class="o">=</span> <span class="n">path</span><span class="p">,</span> <span class="n">RemoveNaN</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">RemoveNegatives</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">CutData</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># Does the file exist? If it exists, print it!</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s1">&#39;.p2d&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">of</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">of</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">entry</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># leave out the last character to remove unnecessary newlines</span>
</pre></div>
</div>
<p>Output:
The resulting output file (Usage_Example.p2d) looks like this(2theta and lambda get calculated in the algorithm):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> Exporting: ...

    0%
   33%
   67%


 Exported: ...
 #Title: test
 #Inst: .prm
 #Binning: ddperp   0.8888889    1.0000000
 #Bank: 1
 #2theta   lambda   d-value   dp-value   counts
   81.3046911      1.3029352      1.0000000      1.5000000      1.0000000
   42.5730378      1.4521280      2.0000000      1.5000000      1.0000000
   28.5401669      1.4789581      3.0000000      1.5000000      1.0000000
   21.4420009      1.4882141      4.0000000      1.5000000      1.0000000
   17.1666094      1.4924723      5.0000000      1.5000000      1.0000000
   14.3112545      1.4947782      6.0000000      1.5000000      1.0000000
   12.2697184      1.4961662      7.0000000      1.5000000      1.0000000
   10.7376523      1.4970660      8.0000000      1.5000000      1.0000000
    9.5455787      1.4976825      9.0000000      1.5000000      1.0000000
  147.7039064      1.9210925      1.0000000      2.5000000      1.0000000
   74.0366222      2.4082809      2.0000000      2.5000000      1.0000000
   48.4687709      2.4628222      3.0000000      2.5000000      1.0000000
   36.1141714      2.4797153      4.0000000      2.5000000      1.0000000
   28.8035116      2.4871957      5.0000000      2.5000000      1.0000000
   23.9632304      2.4911738      6.0000000      2.5000000      1.0000000
   20.5194188      2.4935442      7.0000000      2.5000000      1.0000000
   17.9428625      2.4950714      8.0000000      2.5000000      1.0000000
   15.9421282      2.4961135      9.0000000      2.5000000      1.0000000
  178.1486860      1.9997390      1.0000000      3.5000000      1.0000000
  112.5838945      3.3275045      2.0000000      3.5000000      1.0000000
   70.0240404      3.4424897      3.0000000      3.5000000      1.0000000
   51.4130764      3.4700953      4.0000000      3.5000000      1.0000000
   40.7483187      3.4814929      5.0000000      3.5000000      1.0000000
   33.7894761      3.4873718      6.0000000      3.5000000      1.0000000
   28.8774112      3.4908181      7.0000000      3.5000000      1.0000000
   25.2199975      3.4930167      8.0000000      3.5000000      1.0000000
   22.3888960      3.4945073      9.0000000      3.5000000      1.0000000
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Diffraction/DataHandling.html">Diffraction\DataHandling</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/1b00e0b0644260219c488cf4142569b296f21ab0/Framework/PythonInterface/plugins/algorithms/SaveP2D.py">SaveP2D.py</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="SaveOpenGenieAscii-v1.html" title="Previous Chapter: SaveOpenGenieAscii v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SaveOpenGenieAscii v1</span>
    </a>
  </li>
  <li>
    <a href="SavePAR-v1.html" title="Next Chapter: SavePAR v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SavePAR v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>