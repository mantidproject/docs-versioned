<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PoldiLoadRuns v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=770b529d"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PoldiMerge v1" href="PoldiMerge-v1.html" />
    <link rel="prev" title="PoldiIndexKnownCompounds v1" href="PoldiIndexKnownCompounds-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.10</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">PoldiLoadRuns v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="poldiloadruns-v1">
<span id="algm-poldiloadruns"></span><span id="algm-poldiloadruns-v1"></span><h1>PoldiLoadRuns v1<a class="headerlink" href="#poldiloadruns-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id2">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id3">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id4">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id5">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>PoldiLoadRuns loads, checks and merges ranges of POLDI data files for further processing.</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Year</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>2024</p></td>
<td><p>The year in which all runs were recorded.</p></td>
</tr>
<tr class="row-odd"><td><p>FirstRun</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1</p></td>
<td><p>Run number of the first run. If only this number is supplied, only this run is processed.</p></td>
</tr>
<tr class="row-even"><td><p>LastRun</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1</p></td>
<td><p>Run number of the last run.</p></td>
</tr>
<tr class="row-odd"><td><p>MergeWidth</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1</p></td>
<td><p>Number of runs to merge.</p></td>
</tr>
<tr class="row-even"><td><p>OverwriteExistingWorkspace</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>If a WorkspaceGroup already exists, overwrite it.</p></td>
</tr>
<tr class="row-odd"><td><p>EnableMergeCheck</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>Enable all the checks in PoldiMerge. Do not deactivate without very good reason.</p></td>
</tr>
<tr class="row-even"><td><p>MaskBadDetectors</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>Automatically disable detectors with unusually small or large values, in addition to those masked in the instrument definition.</p></td>
</tr>
<tr class="row-odd"><td><p>BadDetectorThreshold</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>3</p></td>
<td><p>Detectors are masked based on how much their intensity (integrated over time) deviates from the median calculated from all detectors. This parameter indicates how many times bigger the intensity needs to be for a detector to be masked.</p></td>
</tr>
<tr class="row-even"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of the output group workspace that contains all data workspaces.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>This algorithm makes it easier to load POLDI data. Besides importing the raw data (<a class="reference internal" href="LoadSINQ-v1.html#algm-loadsinq"><span class="std std-ref">LoadSINQ v1</span></a>), it performsthe otherwise manually performed steps of instrument loading (<a class="reference internal" href="LoadInstrument-v1.html#algm-loadinstrument"><span class="std std-ref">LoadInstrument v1</span></a>), truncation (<a class="reference internal" href="PoldiTruncateData-v1.html#algm-polditruncatedata"><span class="std std-ref">PoldiTruncateData v1</span></a>). To make the algorithm more useful, it is possible to load data from multiple runs by specifying a range. In many cases, data files need to be merged in a systematic manner, which is also covered by this algorithm. For this purpose there is a parameter that specifies how the files of the specified range should be merged. The data files are named following the scheme <cite>group_data_run</cite>, where <cite>group</cite> is the name specified in <cite>OutputWorkspace</cite> and <cite>run</cite> is the run number and placed into a WorkspaceGroup with the name given in <cite>OutputWorkspace</cite>.</p>
<p>By default, detectors that show unusually large integrated intensities are excluded if the pass a certain threshold
with respect to the median of integrated intensities in all detectors. The threshold can be adjusted using an
additional parameter. Detectors that are masked in the instrument definition are always masked.</p>
<p>The data loaded in this way can be used directly for further processing with <a class="reference internal" href="PoldiAutoCorrelation-v5.html#algm-poldiautocorrelation"><span class="std std-ref">PoldiAutoCorrelation v5</span></a>.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path.
In Mantid this is done using <a class="reference internal" href="../interfaces/framework/ManageUserDirectories.html#manageuserdirectories"><span class="std std-ref">Manage User Directories</span></a>.</p>
</div>
<p>To load only one POLDI data file (in this case a run from a calibration measurement with silicon standard), it’s enough to specify the year and the run number. Nevertheless it will be placed in a WorkspaceGroup.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">calibration</span> <span class="o">=</span> <span class="n">PoldiLoadRuns</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">6903</span><span class="p">)</span>

<span class="c1"># calibration is a WorkspaceGroup, so we can use getNames() to query what&#39;s inside.</span>
<span class="n">workspaceNames</span> <span class="o">=</span> <span class="n">calibration</span><span class="o">.</span><span class="n">getNames</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of data files loaded: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">workspaceNames</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Name of data workspace: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">workspaceNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<p>Since only one run number was supplied, only one workspace is loaded. The name corresponds to the scheme described above:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Number of data files loaded: 1
Name of data workspace: calibration_data_6903
</pre></div>
</div>
<p>Actually, the silicon calibration measurement consists of more than one run, so in fact it would be better to load all the files at once, so the start and end of the range to be loaded is provided:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load two calibration data files (6903 and 6904)</span>
<span class="n">calibration</span> <span class="o">=</span> <span class="n">PoldiLoadRuns</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">6903</span><span class="p">,</span> <span class="mi">6904</span><span class="p">)</span>

<span class="n">workspaceNames</span> <span class="o">=</span> <span class="n">calibration</span><span class="o">.</span><span class="n">getNames</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of data files loaded: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">workspaceNames</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Names of data workspaces: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">workspaceNames</span><span class="p">))</span>
</pre></div>
</div>
<p>Now all files from the specified range are in the <cite>calibration</cite> WorkspaceGroup:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Number of data files loaded: 2
Names of data workspaces: [&#39;calibration_data_6903&#39;,&#39;calibration_data_6904&#39;]
</pre></div>
</div>
<p>But in fact, these data files should not be processed separately, they belong to the same measurement and should be merged together. Instead of using <a class="reference internal" href="PoldiMerge-v1.html#algm-poldimerge"><span class="std std-ref">PoldiMerge v1</span></a> directly to merge the data files, it’s possible to tell the algorithm to merge the files directly after loading, by specifying how many of the files should be merged together. Setting the parameter to the value <cite>2</cite> means that the whole range will be iterated and files will be merged together in pairs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load two calibration data files (6903 and 6904) and merge them</span>
<span class="n">calibration</span> <span class="o">=</span> <span class="n">PoldiLoadRuns</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">6903</span><span class="p">,</span> <span class="mi">6904</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">workspaceNames</span> <span class="o">=</span> <span class="n">calibration</span><span class="o">.</span><span class="n">getNames</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of data files loaded: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">workspaceNames</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Names of data workspaces: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">workspaceNames</span><span class="p">))</span>
</pre></div>
</div>
<p>The merged files will receive the name of the last file in the merged range:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Number of data files loaded: 1
Names of data workspaces: [&#39;calibration_data_6904&#39;]
</pre></div>
</div>
<p>When the merge parameter and the number of runs in the specified range are not compatible (for example specifying <cite>3</cite> in the above code), the algorithm will merge files in the range as long as it can and leave out the rest. In the above example that would result in no data files being loaded at all.</p>
<p>A situation that occurs often is that one sample consists of multiple ranges of runs, which can not be expressed as one range. It’s nevertheless possible to collect them all in one WorkspaceGroup. In fact, that is the default behavior of the algorithm if the supplied <cite>OutputWorkspace</cite> already exists:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load calibration data</span>
<span class="n">calibration</span> <span class="o">=</span> <span class="n">PoldiLoadRuns</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">6903</span><span class="p">)</span>

<span class="c1"># Add another file to the calibration WorkspaceGroup</span>
<span class="n">calibration</span> <span class="o">=</span> <span class="n">PoldiLoadRuns</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">6904</span><span class="p">)</span>

<span class="n">workspaceNames</span> <span class="o">=</span> <span class="n">calibration</span><span class="o">.</span><span class="n">getNames</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of data files loaded: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">workspaceNames</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Names of data workspaces: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">workspaceNames</span><span class="p">))</span>
</pre></div>
</div>
<p>The result is the same as in the example above, two files are in the WorkspaceGroup:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Number of data files loaded: 2
Names of data workspaces: [&#39;calibration_data_6903&#39;,&#39;calibration_data_6904&#39;]
</pre></div>
</div>
<p>On the other hand it is also possible to overwrite an existing WorkspaceGroup, for example if there was a mistake with the previous data loading. The parameter needs to be specified explicitly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load calibration data, forget merging</span>
<span class="n">calibration</span> <span class="o">=</span> <span class="n">PoldiLoadRuns</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">6903</span><span class="p">,</span> <span class="mi">6904</span><span class="p">)</span>

<span class="c1"># Load data again, this time with correct merging</span>
<span class="n">calibration</span> <span class="o">=</span> <span class="n">PoldiLoadRuns</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">6903</span><span class="p">,</span> <span class="mi">6904</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">OverwriteExistingWorkspace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">workspaceNames</span> <span class="o">=</span> <span class="n">calibration</span><span class="o">.</span><span class="n">getNames</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of data files loaded: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">workspaceNames</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Names of data workspaces: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">workspaceNames</span><span class="p">))</span>
</pre></div>
</div>
<p>The data loaded in the first call to the algorithm have been overwritten with the merged data set:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Number of data files loaded: 1
Names of data workspaces: [&#39;calibration_data_6904&#39;]
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/SINQ/Poldi.html">SINQ\Poldi</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/1b00e0b0644260219c488cf4142569b296f21ab0/Framework/PythonInterface/plugins/algorithms/PoldiLoadRuns.py">PoldiLoadRuns.py</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="PoldiIndexKnownCompounds-v1.html" title="Previous Chapter: PoldiIndexKnownCompounds v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; PoldiIndexKno...</span>
    </a>
  </li>
  <li>
    <a href="PoldiMerge-v1.html" title="Next Chapter: PoldiMerge v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">PoldiMerge v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>