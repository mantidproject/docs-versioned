<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>BASISReduction v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=770b529d"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="BayesQuasi v1" href="BayesQuasi-v1.html" />
    <link rel="prev" title="BASISPowderDiffraction v1" href="BASISPowderDiffraction-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.10</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">BASISReduction v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="basisreduction-v1">
<span id="algm-basisreduction"></span><span id="algm-basisreduction-v1"></span><h1>BASISReduction v1<a class="headerlink" href="#basisreduction-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#reflection-selector" id="id5">Reflection Selector</a></p></li>
<li><p><a class="reference internal" href="#vanadium-normalization" id="id6">Vanadium Normalization</a></p></li>
<li><p><a class="reference internal" href="#saving-nxspe-files" id="id7">Saving NXSPE files</a></p></li>
<li><p><a class="reference internal" href="#dynamic-susceptibility" id="id8">Dynamic Susceptibility</a></p></li>
<li><p><a class="reference internal" href="#powder-diffraction" id="id9">Powder Diffraction</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id10">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id11">Source</a></p></li>
<li><p><a class="reference internal" href="#workflow" id="id12">Workflow</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Multiple-file BASIS reduction for its two reflections.</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>RunNumbers</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Sample run numbers</p></td>
</tr>
<tr class="row-odd"><td><p>DoIndividual</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Do each run individually</p></td>
</tr>
<tr class="row-even"><td><p>ExcludeTimeSegment</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Exclude a contigous time segment; Examples: “71546:0-60” filter run 71546 from start to 60 seconds, “71546:300-600”, “71546:120-end” from 120s to the end of the run</p></td>
</tr>
<tr class="row-odd"><td><p>RetainTimeSegment</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Only retain events occurring within a time segment. Examples: 71546:0-3600 only retains events from the first hour of run 71546. 71546:3600-7200 retain only the second hour. 71546:7200-end retain events after the first two hours</p></td>
</tr>
<tr class="row-even"><td><p>GroupDetectors</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>None</p></td>
<td><p>Switch for grouping detectors. Allowed values: [‘None’, ‘Low-Resolution’, ‘By-Tube’]</p></td>
</tr>
<tr class="row-odd"><td><p>DoFluxNormalization</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>Do we normalize data by incoming flux?</p></td>
</tr>
<tr class="row-even"><td><p>FluxNormalizationType</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Monitor</p></td>
<td><p>Flux Normalization Type. Allowed values: [‘Monitor’, ‘Proton Charge’, ‘Duration’]</p></td>
</tr>
<tr class="row-odd"><td><p>NormalizeToFirst</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Normalize spectra to intensity of spectrum with lowest Q?</p></td>
</tr>
<tr class="row-even"><td><p>ReflectionType</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>silicon_111</p></td>
<td><p>Analyzer. Documentation lists typical                              associated property values. Allowed values: [‘silicon_111’, ‘silicon_311’, ‘silicon_333’]</p></td>
</tr>
<tr class="row-odd"><td><p>EnergyBins</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p>-150,0.4,500</p></td>
<td><p>Energy transfer binning scheme (in ueV)</p></td>
</tr>
<tr class="row-even"><td><p>MomentumTransferBins</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p>0.3,0.2,1.9</p></td>
<td><p>Momentum transfer binning scheme</p></td>
</tr>
<tr class="row-odd"><td><p>MaskFile</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>See documentation for latest mask files. Allowed extensions: [‘.xml’]</p></td>
</tr>
<tr class="row-even"><td><p>DivideByVanadium</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Do we normalize by the vanadium intensity?</p></td>
</tr>
<tr class="row-odd"><td><p>NormalizationType</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>by Q slice</p></td>
<td><p>Select a Vanadium normalization. Allowed values: [‘by Q slice’, ‘by detector ID’]</p></td>
</tr>
<tr class="row-even"><td><p>NormRunNumbers</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Normalization run numbers</p></td>
</tr>
<tr class="row-odd"><td><p>SaveNXSPE</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Do we save to NXSPE format?</p></td>
</tr>
<tr class="row-even"><td><p>PsiAngleLog</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>SE50Rot</p></td>
<td><p>name of entry in the logs storing the psi                              angle</p></td>
</tr>
<tr class="row-odd"><td><p>PsiOffset</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>add this quantity to the psi angle stored                              in the log</p></td>
</tr>
<tr class="row-even"><td><p>OutputSusceptibility</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Output dynamic susceptibility (Xqw)</p></td>
</tr>
<tr class="row-odd"><td><p>OutputPowderSpectrum</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Output S(Q) and S(theta) powder diffraction</p></td>
</tr>
<tr class="row-even"><td><p>RemoveTemporaryWorkspaces</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>Remove temporary workspaces and files</p></td>
</tr>
</tbody>
</table>
<p>For each property, the algorithm will remember the last value used. If user deletes
this value and leaves blank the property field, the default value will be used. Default
values are typical of the silicon111 reflection.</p>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p><strong>Run numbers</strong>:
Reduction can be carried out for each run or all runs can be aggregated into
a single data collection.</p>
<p>Examples:</p>
<ul class="simple">
<li><p>2144-2147: runs from 2144 to 2147.</p></li>
<li><p>2144-2147,2149,2156: runs from 2144 to 2147 and also runs 2149 and 156</p></li>
</ul>
<p>If <em>DoIndividual</em> is checked, then each run number is reduced separately
from the rest.</p>
<p><strong>ExcludeTimeSegment</strong>:
Events happening in a time segment with no proton charge are most likely
noise. Those events can be filtered out of the reduction process.</p>
<p>Example:</p>
<ul class="simple">
<li><p>“71465:0-500,71466:900-2100,71467:4000-end” will filter out events
happening between the start of the run and 500 seconds for run 71465, then
between 900 and 2100 seconds for run 71466 and between 4000 seconds and the
end of the run for 71467. Only one time segment can be excluded per run number.</p></li>
</ul>
<p><strong>RetainTimeSegment</strong>:
When interested only in a single and contiguous part of the run. Only events
within that time window can be kept.</p>
<p>Examples:
- “71465:0-3600,71466:3600-7200,71467:3600-end” will retain events of the first
hour of run 71465, events of the second hour of run 71466, and events after
the first hour of run 71467. Events outside these time windows will not be
taken into account.</p>
<p><strong>Momentum transfer binning scheme</strong>: Three values are required, the
center of the bin with the minimum momentum, the bin width, and the
center of the bin with the maximum momentum.</p>
<p><strong>Rescaling to first spectrum</strong>: Since the Y-scale has arbitrary units, a
rescaling convention is taken whereby the maximum of the
first spectrum (lowest Q-value) is rescaled to 1.0. This rescaling may not
be employed when the intent is to compare to other runs, like can substraction
of comparison between deuterated and hydrogenated samples.</p>
<section id="reflection-selector">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Reflection Selector</a><a class="headerlink" href="#reflection-selector" title="Link to this heading">¶</a></h3>
<p>Currently three types of reflection are possible, associated with the
silicon analyzers of BASIS. These are typical binning values for each
reflection:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Reflection</p></th>
<th class="head"><dl class="simple">
<dt>Energy bins</dt><dd><p>(micro-eV)</p>
</dd>
</dl>
</th>
<th class="head"><dl class="simple">
<dt>Momentum transfer bins</dt><dd><p>(inverse Angstroms)</p>
</dd>
</dl>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>silicon111</p></td>
<td><p>-150, 0.4, 500</p></td>
<td><p>0.3, 0.2, 1.9</p></td>
</tr>
<tr class="row-odd"><td><p>silicon311</p></td>
<td><p>-740, 1.6, 740</p></td>
<td><p>0.5, 0.2, 3.7</p></td>
</tr>
<tr class="row-even"><td><p>silicon333</p></td>
<td><p>-1500, 3.2 1500</p></td>
<td><p>0.5, 0.2, 3.7</p></td>
</tr>
</tbody>
</table>
<p>Also the following default mask files are associated to each reflection:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Reflection</p></th>
<th class="head"><p>Mask file</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>silicon111</p></td>
<td><p>BASIS_Mask_default_111.xml</p></td>
</tr>
<tr class="row-odd"><td><p>silicon311</p></td>
<td><p>BASIS_Mask_default_311.xml</p></td>
</tr>
<tr class="row-even"><td><p>silicon333</p></td>
<td><p>BASIS_Mask_default_333.xml</p></td>
</tr>
</tbody>
</table>
<p>Note: masks for reflections 111 and 333 are actually the same since both
reflections take place at the same silicon crystal analyzers.</p>
<p>These mask files can be found in the SNS filesystem
(<strong>/SNS/BSS/shared/autoreduce/new_masks_08_12_2015/</strong>)</p>
</section>
<section id="vanadium-normalization">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Vanadium Normalization</a><a class="headerlink" href="#vanadium-normalization" title="Link to this heading">¶</a></h3>
<p>The syntax for the vanadium run numbers designation (<strong>NormRunNumbers</strong>) is the same as in
the case of the sample (hyphens and commas are understood).
All runs are jointly reduced into a single vanadium workspace.</p>
<p>Normalization type <strong>by Q slice</strong> is the default
normalization. In this case, the sample is reduced into <span class="math notranslate nohighlight">\(S_{s}(Q,E)\)</span> and
the vanadium is reduced into <span class="math notranslate nohighlight">\(S_{v}(Q,E)\)</span>. Later, <span class="math notranslate nohighlight">\(S_{v}(Q,E)\)</span> is integrated
along the energy axis in the range [-0.034, 0.034]meV to produce <span class="math notranslate nohighlight">\(S_{v}(Q)\)</span>.
Finally the sample is divided by the vanadium, <span class="math notranslate nohighlight">\(S_{s}(Q,E) / S_{v}(Q)\)</span>.</p>
<p>Normalization type <strong>by detector ID</strong> carries out the division on each
detector of the instrument. If we have for detector <span class="math notranslate nohighlight">\(i\)</span> sample <span class="math notranslate nohighlight">\(S_s(\lambda, i)\)</span>
and vanadium <span class="math notranslate nohighlight">\(S_v(\lambda, i)\)</span>, we integrate along the <span class="math notranslate nohighlight">\(\lambda\)</span> axis in the
range given by <strong>NormWavelengthRange</strong> to obtain
<span class="math notranslate nohighlight">\(S_v(i)\)</span> and then divide <span class="math notranslate nohighlight">\(S_s(\lambda, i)/S_v(i)=S'_s(\lambda, i)\)</span>. From this
point on, the reduction process continues using <span class="math notranslate nohighlight">\(S'_s\)</span> in place of <span class="math notranslate nohighlight">\(S_s\)</span>.</p>
</section>
<section id="saving-nxspe-files">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Saving NXSPE files</a><a class="headerlink" href="#saving-nxspe-files" title="Link to this heading">¶</a></h3>
<p>NXSPE files are suitable for intensity visualization in <span class="math notranslate nohighlight">\(\vec{Q}\)</span> space with
<a class="reference external" href="http://mslice.isis.rl.ac.uk/Main_Page">MSLICE</a>. When using this program, make
sure you select the <em>inverse</em> geometry.</p>
<a class="reference internal image-reference" href="../_images/BASISReduction_NXSPE.png"><img alt="Wavelength spectrum." src="../_images/BASISReduction_NXSPE.png" style="width: 50%;" /></a>
<p>Also, make sure that the sample rotation angle is stored in the logs of the run,
since this is a required property of the algorithm.</p>
</section>
<section id="dynamic-susceptibility">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Dynamic Susceptibility</a><a class="headerlink" href="#dynamic-susceptibility" title="Link to this heading">¶</a></h3>
<p>If &lt;i&gt;OutputSusceptibility&lt;/i&gt; is checked, one additional workspace and one Nexus file will be generated,
both containing the dynamic susceptibility as a function of frequency, in units of GHz.
The extension denoting this quantity in the workspace and file names is “Xqw”
(the extension for the structure factor is “sqw”).</p>
</section>
<section id="powder-diffraction">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Powder Diffraction</a><a class="headerlink" href="#powder-diffraction" title="Link to this heading">¶</a></h3>
<p>If &lt;i&gt;OutputPowderSpectrum&lt;/i&gt; is checked,
two additional workspaces are created
after a call to algorithm <a class="reference internal" href="BASISPowderDiffraction-v1.html#algm-basispowderdiffraction"><span class="std std-ref">BASISPowderDiffraction v1</span></a>
- <cite>BSS_XXXX_sq_angle</cite>: Intensity versus scattering angle <span class="math notranslate nohighlight">\(\vec{2\theta}\)</span>
- <cite>BSS_XXXX_sq</cite>: Intensity versus momentum transfer</p>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Perform a reduction:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">BASISReduction</span><span class="p">(</span><span class="n">RunNumbers</span><span class="o">=</span><span class="s2">&quot;59671&quot;</span><span class="p">,</span>
               <span class="n">EnergyBins</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mi">120</span><span class="p">],</span>
               <span class="n">MomentumTransferBins</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">],</span>
               <span class="n">DivideByVanadium</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">NormRunNumbers</span><span class="o">=</span><span class="s2">&quot;58183&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Inelastic/Reduction.html">Inelastic\Reduction</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/1b00e0b0644260219c488cf4142569b296f21ab0/Framework/PythonInterface/plugins/algorithms/BASISReduction.py">BASISReduction.py</a></p>
</section>
<section id="workflow">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Workflow</a><a class="headerlink" href="#workflow" title="Link to this heading">¶</a></h2>
<figure class="align-default" id="id1">
<img alt="../_images/ImageNotFound.png" src="../_images/ImageNotFound.png" />
<figcaption>
<p><span class="caption-text">diagram generation was disabled</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="BASISPowderDiffraction-v1.html" title="Previous Chapter: BASISPowderDiffraction v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; BASISPowderDi...</span>
    </a>
  </li>
  <li>
    <a href="BayesQuasi-v1.html" title="Next Chapter: BayesQuasi v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">BayesQuasi v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>