<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PoldiAutoCorrelation v5</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=06de18c4"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PoldiCreatePeaksFromCell v1" href="PoldiCreatePeaksFromCell-v1.html" />
    <link rel="prev" title="PoldiAnalyseResiduals v1" href="PoldiAnalyseResiduals-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.11</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">PoldiAutoCorrelation v5</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="poldiautocorrelation-v5">
<span id="algm-poldiautocorrelation"></span><span id="algm-poldiautocorrelation-v5"></span><h1>PoldiAutoCorrelation v5<a class="headerlink" href="#poldiautocorrelation-v5" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id3">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id6">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id7">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Performs correlation analysis of POLDI 2D-data.</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>InOut</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace2D.html#workspace2d"><span class="std std-ref">Workspace2D</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Input workspace containing raw POLDI data.</p></td>
</tr>
<tr class="row-odd"><td><p>wlenmin</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1.1</p></td>
<td><p>Minimum wavelength considered</p></td>
</tr>
<tr class="row-even"><td><p>wlenmax</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>5</p></td>
<td><p>Maximum wavelength considered</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace2D.html#workspace2d"><span class="std std-ref">Workspace2D</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Output workspace containing the correlation spectrum.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<figure class="align-right" id="id1" style="width: 10cm">
<img alt="Raw POLDI data for Silicon powder standard (simulated)." src="../_images/PoldiAutoCorrelation_Si_2D.png" />
<figcaption>
<p><span class="caption-text">Raw POLDI data for Silicon powder standard. The spectrum is simulated.</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>PoldiAutoCorrelation is a core part of the POLDI data analysis process. It takes a 2D-spectrum from POLDI as input, with arrival time <span class="math notranslate nohighlight">\(t\)</span> as x-axis and scattering angle <span class="math notranslate nohighlight">\(2\theta\)</span> as y-axis. In Mantid, the data is represented by a MatrixWorkspace, which contains one spectrum for each <span class="math notranslate nohighlight">\(2\theta\)</span>-value of the detector, each containing usually 500 time-bins.</p>
<p>Without any <em>a-priori</em> information about the sample, a correlation spectrum is calculated, where <em>correlation counts</em> are plotted against <span class="math notranslate nohighlight">\(Q\)</span>. Bragg-reflections will appear in this correlation spectrum as well defined peaks, surrounded by a dip which depends on the height of the peak. These spectra may be indexed like powder diffraction diagrams and the extracted peak profile information (location, intensity, FWHM) can be used as starting point for subsequent fits of the raw 2D data. For analysis of the correlaton spectrum, <a class="reference internal" href="PoldiPeakSearch-v1.html#algm-poldipeaksearch"><span class="std std-ref">PoldiPeakSearch v1</span></a> and <a class="reference internal" href="PoldiFitPeaks1D-v2.html#algm-poldifitpeaks1d"><span class="std std-ref">PoldiFitPeaks1D v2</span></a> can be used.</p>
<figure class="align-right" id="id2" style="width: 10cm">
<img alt="Correlation spectrum of Silicon powder standard." src="../_images/PoldiAutoCorrelation_Si_1D.png" />
<figcaption>
<p><span class="caption-text">Correlation spectrum of Silicon powder standard.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>A full description of the procedure goes beyond the scope of this documentation. Detailed information about this procedure is available on the <a class="reference external" href="http://www.psi.ch/sinq/poldi">POLDI website</a> and more specifically in the paper describing the pulse overlap concept (U. Stuhr, Nuclear Instruments and Methods in Physics Research A 545, S. 319, 2005).</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path.
In Mantid this is done using <a class="reference internal" href="../interfaces/framework/ManageUserDirectories.html#manageuserdirectories"><span class="std std-ref">Manage User Directories</span></a>.</p>
</div>
<p>PoldiAutoCorrelation operates on a MatrixWorkspace with a valid POLDI instrument definition. The following short example demonstrates how to use the algorithm, processing data obtained from recording the spectrum of a Silicon standard material (powder).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load data file with Si spectrum, this loads the HDF-data into a MatrixWorkspace named raw_6904</span>
<span class="n">raw_6904</span> <span class="o">=</span> <span class="n">LoadSINQFile</span><span class="p">(</span><span class="n">Filename</span> <span class="o">=</span> <span class="s2">&quot;poldi2013n006904.hdf&quot;</span><span class="p">,</span> <span class="n">Instrument</span> <span class="o">=</span> <span class="s2">&quot;POLDI&quot;</span><span class="p">)</span>

<span class="c1"># Print the number of spectra in the workspace. It should be 400, one for each detector wire</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The workspace contains </span><span class="si">{}</span><span class="s2"> spectra.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">raw_6904</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>

<span class="c1"># For most calculations, an instrument definition is needed, so it&#39;s loaded as well</span>
<span class="n">LoadInstrument</span><span class="p">(</span><span class="n">raw_6904</span><span class="p">,</span> <span class="n">InstrumentName</span> <span class="o">=</span> <span class="s2">&quot;POLDI&quot;</span><span class="p">,</span> <span class="n">RewriteSpectraMap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Call the actual algorithm.</span>
<span class="n">correlated_6904</span> <span class="o">=</span> <span class="n">PoldiAutoCorrelation</span><span class="p">(</span><span class="n">raw_6904</span><span class="p">)</span>

<span class="c1"># The first spectrum contains the correlation data. In this case there should be 5531 bins.</span>
<span class="c1"># On other data or different wavelength limits, this number will be different.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The correlation spectrum has </span><span class="si">{}</span><span class="s2"> data points.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">correlated_6904</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">))))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The workspace contains 400 spectra.
The correlation spectrum has 5531 data points.
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/SINQ/Poldi.html">SINQ\Poldi</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c66b9d75d3432a3fcde604fac070fd25fe61daf8/Framework/SINQ/inc/MantidSINQ/PoldiAutoCorrelation5.h">PoldiAutoCorrelation5.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c66b9d75d3432a3fcde604fac070fd25fe61daf8/Framework/SINQ/src/PoldiAutoCorrelation5.cpp">PoldiAutoCorrelation5.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="PoldiAnalyseResiduals-v1.html" title="Previous Chapter: PoldiAnalyseResiduals v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; PoldiAnalyseR...</span>
    </a>
  </li>
  <li>
    <a href="PoldiCreatePeaksFromCell-v1.html" title="Next Chapter: PoldiCreatePeaksFromCell v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">PoldiCreatePe... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>