<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DownloadInstrument v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=06de18c4"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="EQSANSAzimuthalAverage1D v1" href="EQSANSAzimuthalAverage1D-v1.html" />
    <link rel="prev" title="DownloadFile v1" href="DownloadFile-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.11</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">DownloadInstrument v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="downloadinstrument-v1">
<span id="algm-downloadinstrument"></span><span id="algm-downloadinstrument-v1"></span><h1>DownloadInstrument v1<a class="headerlink" href="#downloadinstrument-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id2">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#mantid-property-keys" id="id5">Mantid Property Keys</a></p></li>
<li><p><a class="reference internal" href="#output-messages" id="id6">Output Messages</a></p></li>
<li><p><a class="reference internal" href="#the-details" id="id7">The details</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id8">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id9">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Checks the Mantid instrument repository against the local instrument files, and downloads updates as appropriate.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="LoadInstrument-v1.html#algm-loadinstrument"><span class="std std-ref">LoadInstrument</span></a>, <a class="reference internal" href="UpdateScriptRepository-v1.html#algm-updatescriptrepository"><span class="std std-ref">UpdateScriptRepository</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ForceUpdate</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Ignore cache information</p></td>
</tr>
<tr class="row-odd"><td><p>FileDownloadCount</p></td>
<td><p>Output</p></td>
<td><p>number</p></td>
<td></td>
<td><p>The number of files downloaded by this algorithm</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>This algorithm connects with the cloud based Mantid Instrument Definition
Repository and downloads any updated instrument files for use within Mantid.</p>
<p>This algorithm is normally run on startup of Mantid for official installed
releases of Mantid from version 3.3 onwards.</p>
<section id="mantid-property-keys">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Mantid Property Keys</a><a class="headerlink" href="#mantid-property-keys" title="Link to this heading">¶</a></h3>
<p>The code is configured using he following Mantid.Property, or Mantid.User.Property keys.</p>
<dl class="simple">
<dt>UpdateInstrumentDefinitions.OnStartup = 1</dt><dd><p>This controls whether this algorithm is run on startup of Mantid.  1 = Run on startup, 0 = don’t.</p>
</dd>
<dt>UpdateInstrumentDefinitions.URL = <a class="reference external" href="https://api.github.com/repos/mantidproject/mantid/contents/instrument">https://api.github.com/repos/mantidproject/mantid/contents/instrument</a></dt><dd><p>This stores the url used to access the contents of the Mantid Instrument Definition Repository.</p>
</dd>
<dt>network.github.api_token = (not shown)</dt><dd><p>This overrides the github api token that is used by the algorithm. To use unauthenticated requests, set it to an empty string or the values <code class="docutils literal notranslate"><span class="pre">unset</span></code>.</p>
</dd>
</dl>
</section>
<section id="output-messages">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Output Messages</a><a class="headerlink" href="#output-messages" title="Link to this heading">¶</a></h3>
<p>The following may be logged at Notice</p>
<dl class="simple">
<dt>All instrument definitions up to date</dt><dd><p>Everything is fine, there are no updates to download.</p>
</dd>
<dt>Downloading n files from the instrument repository</dt><dd><p>Some files have changed or been added to the Instrument Repository, they are being downloaded.</p>
</dd>
<dt>Internet Connection Failed - cannot update instrument definitions.</dt><dd><p>The connection to the instrument Repository failed.  This could be down to your network connection, proxy settings (we use the system proxy settings).  More details will be logged as another message at information level.</p>
</dd>
<dt>Instrument Definition Update: The Github API rate limit has been reached, try again after 19-Feb-2015 11:23:34</dt><dd><p>There is a limit of how many calls we are allowed to make to Github per hour.  Try again after the time specified.  If this keeps occurring let the development team know.</p>
</dd>
</dl>
</section>
<section id="the-details">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">The details</a><a class="headerlink" href="#the-details" title="Link to this heading">¶</a></h3>
<p>The Mantid Instrument Definition Repository is currently a directory within the Mantid code repository on Github.
<a class="reference external" href="https://github.com/mantidproject/mantid">https://github.com/mantidproject/mantid</a></p>
<p>The instrument files within Mantid can be accessed in three locations.</p>
<ol class="arabic simple">
<li><p>The mantid install directory [Install Dir] (windows default “C:mantidinstallinstrument”).</p></li>
<li><p>The local user appdata directory [Appdata Dir] (windows “%APPDATA%mantidprojectmantidinstrument”, linux/Mac “~/.mantid/instrument”).</p></li>
<li><p>Mantid Instrument repository [Instrument Repo] on Github</p></li>
</ol>
<p>When running the algorithm the processing takes the following steps.</p>
<ol class="arabic simple">
<li><p>The description of the contents of the Instrument Repo is downloaded and stored in a file github.json to the Appdata Dir.</p></li>
<li><p>A file of the description of xml files in  Appdata Dir and Install Dir are updated or created and saved into AppData Dir as install.json and appdata.json.</p></li>
<li><p>The contents of all 3 are inspected and new or updated files (based on the git checksum) are added to a download list.</p></li>
<li><p>The list of files are downloaded to the Appdata Dir.</p></li>
<li><p><a class="reference internal" href="LoadInstrument-v1.html#algm-loadinstrument"><span class="std std-ref">LoadInstrument v1</span></a> will load files in Appdata Dir in preference to those in the Install Dir if both are valid.</p></li>
</ol>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">updatedFileCount</span> <span class="o">=</span> <span class="n">DownloadInstrument</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The number of files updated was &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">updatedFileCount</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The number of files updated was ...
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/DataHandling/Instrument.html">DataHandling\Instrument</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c66b9d75d3432a3fcde604fac070fd25fe61daf8/Framework/DataHandling/inc/MantidDataHandling/DownloadInstrument.h">DownloadInstrument.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c66b9d75d3432a3fcde604fac070fd25fe61daf8/Framework/DataHandling/src/DownloadInstrument.cpp">DownloadInstrument.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="DownloadFile-v1.html" title="Previous Chapter: DownloadFile v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; DownloadFile v1</span>
    </a>
  </li>
  <li>
    <a href="EQSANSAzimuthalAverage1D-v1.html" title="Next Chapter: EQSANSAzimuthalAverage1D v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">EQSANSAzimuth... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>