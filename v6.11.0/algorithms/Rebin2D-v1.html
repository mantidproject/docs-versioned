<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Rebin2D v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=06de18c4"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="RebinByPulseTimes v1" href="RebinByPulseTimes-v1.html" />
    <link rel="prev" title="Rebin v1" href="Rebin-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.11</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">Rebin2D v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="rebin2d-v1">
<span id="algm-rebin2d"></span><span id="algm-rebin2d-v1"></span><h1>Rebin2D v1<a class="headerlink" href="#rebin2d-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id2">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#requirements" id="id5">Requirements</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id6">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id7">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Rebins both axes of a 2D workspace using the given parameters</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="Rebin-v1.html#algm-rebin"><span class="std std-ref">Rebin</span></a>, <a class="reference internal" href="SofQW-v1.html#algm-sofqw"><span class="std std-ref">SofQW</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>An input workspace.</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>An output workspace.</p></td>
</tr>
<tr class="row-even"><td><p>Axis1Binning</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>A comma separated list of first bin boundary, width, last bin boundary. Optionally this can be followed by a comma and more widths and last boundary pairs. Negative width values indicate logarithmic binning.</p></td>
</tr>
<tr class="row-odd"><td><p>Axis2Binning</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>A comma separated list of first bin boundary, width, last bin boundary. Optionally this can be followed by a comma and more widths and last boundary pairs. Negative width values indicate logarithmic binning.</p></td>
</tr>
<tr class="row-even"><td><p>UseFractionalArea</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Flag to turn on the using the fractional area tracking RebinnedOutput workspace .Default is false.</p></td>
</tr>
<tr class="row-odd"><td><p>Transpose</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Run the Transpose algorithm on the resulting matrix.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>The bin parameters are used to form an output grid. A positive
<span class="math notranslate nohighlight">\(\Delta x_i\,\)</span> makes constant width bins, whilst negative ones
create logarithmic binning using the formula
<span class="math notranslate nohighlight">\(x(j+1)=x(j)(1+|\Delta x_i|)\,\)</span>. The overlap of the polygons
formed from the old and new grids is tested to compute the required
signal weight for the each of the new bins on the workspace, like in
<a class="reference internal" href="Rebin-v1.html#algm-rebin"><span class="std std-ref">Rebin v1</span></a>, and the errors are summed in quadrature, as:</p>
<div class="math notranslate nohighlight">
\[Y^{\mathrm{new}} = \sum_i Y^{\mathrm{old}}_i F_i\]</div>
<div class="math notranslate nohighlight">
\[E^{\mathrm{new}} = \sqrt{\sum_i (E^{\mathrm{old}}_i)^2 F_i}\]</div>
<p>where <span class="math notranslate nohighlight">\(F_i = A^{\mathrm{overlap}}_i / A^{\mathrm{old}}_i\)</span> is the
ratio of the overlap area of the new and old bin over the area of the
old bin.</p>
<p>If the input to <a class="reference internal" href="#algm-rebin2d"><span class="std std-ref">Rebin2D v1</span></a> is a <strong>RebinnedOutput</strong> workspace,
the algorithm will make use of the fractional weights stored in each bin of
the input <strong>RebinnedOutput</strong> workspace. A more detailed explanation of this
appproach is described in <a class="reference internal" href="../concepts/FractionalRebinning.html#fractionalrebinning"><span class="std std-ref">FractionalRebinning</span></a>.</p>
<p>If the <cite>UseFractionalArea</cite> option is set to <cite>True</cite> and the input workspace
is not of type <strong>RebinnedOutput</strong>, the algorithm will be correct if the input
workspace has not been previously rebinned, but will give incorrect
error (standard deviation) estimates if it has been rebinned. You can find more
information on why this is the case in <a class="reference internal" href="../concepts/FractionalRebinning.html#fractionalrebinning"><span class="std std-ref">FractionalRebinning</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Rebin2D looks at the histogram representation of the input
workspace, so while it will accept EventWorkspaces, number of bins
will affect the numerical results.</p>
</div>
</section>
<section id="requirements">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Requirements</a><a class="headerlink" href="#requirements" title="Link to this heading">¶</a></h2>
<p>The algorithms currently requires the second axis on the workspace to be
a numerical axis so <a class="reference internal" href="ConvertSpectrumAxis-v2.html#algm-convertspectrumaxis"><span class="std std-ref">ConvertSpectrumAxis v2</span></a> may
need to run first.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Example - A simple example using the fractional area</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c1">#Convert the Spectrum Axis to theta</span>
<span class="n">wsc</span> <span class="o">=</span> <span class="n">ConvertSpectrumAxis</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="s2">&quot;theta&quot;</span><span class="p">)</span>

<span class="n">rb</span> <span class="o">=</span> <span class="n">Rebin2D</span><span class="p">(</span><span class="n">wsc</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">20000</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">1.2</span><span class="p">],</span><span class="n">UseFractionalArea</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bins in the X axis: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bins in the Y axis: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Bins in the X axis: 200
Bins in the Y axis: 120
</pre></div>
</div>
<p><strong>Example - Transposing the Result</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c1">#Convert the Spectrum Axis to theta</span>
<span class="n">wsc</span> <span class="o">=</span> <span class="n">ConvertSpectrumAxis</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="s2">&quot;theta&quot;</span><span class="p">)</span>

<span class="n">rb</span> <span class="o">=</span> <span class="n">Rebin2D</span><span class="p">(</span><span class="n">wsc</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">20000</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">1.2</span><span class="p">],</span><span class="n">Transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bins in the X axis: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bins in the Y axis: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Bins in the X axis: 120
Bins in the Y axis: 200
</pre></div>
</div>
<p><strong>Example - Rebinning twice preserves signal/errors</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># prepare an input workspace</span>
<span class="n">theta_tof</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">theta_tof</span> <span class="o">=</span> <span class="n">ConvertSpectrumAxis</span><span class="p">(</span><span class="n">theta_tof</span><span class="p">,</span> <span class="s2">&quot;theta&quot;</span><span class="p">)</span>

<span class="n">theta_tof_rb1</span> <span class="o">=</span> <span class="n">Rebin2D</span><span class="p">(</span><span class="n">theta_tof</span><span class="p">,</span> <span class="s1">&#39;100,400,20000&#39;</span><span class="p">,</span> <span class="s1">&#39;0, 0.001,1&#39;</span><span class="p">,</span> <span class="n">UseFractionalArea</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">theta_tof_rb2</span> <span class="o">=</span> <span class="n">Rebin2D</span><span class="p">(</span><span class="n">theta_tof_rb1</span><span class="p">,</span> <span class="s1">&#39;100,400,20000&#39;</span><span class="p">,</span> <span class="s1">&#39;0, 0.004,1&#39;</span><span class="p">,</span> <span class="n">UseFractionalArea</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">theta_tof_rb_final</span> <span class="o">=</span> <span class="n">Rebin2D</span><span class="p">(</span><span class="n">theta_tof</span><span class="p">,</span>  <span class="s1">&#39;100,400,20000&#39;</span><span class="p">,</span> <span class="s1">&#39;0, 0.004, 1&#39;</span><span class="p">,</span> <span class="n">UseFractionalArea</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Signal difference = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">theta_tof_rb_final</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">theta_tof_rb2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Errors difference = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">theta_tof_rb_final</span><span class="o">.</span><span class="n">readE</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">theta_tof_rb2</span><span class="o">.</span><span class="n">readE</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Signal difference = 0.000
Errors difference = 0.000
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Transforms/Rebin.html">Transforms\Rebin</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c66b9d75d3432a3fcde604fac070fd25fe61daf8/Framework/Algorithms/inc/MantidAlgorithms/Rebin2D.h">Rebin2D.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c66b9d75d3432a3fcde604fac070fd25fe61daf8/Framework/Algorithms/src/Rebin2D.cpp">Rebin2D.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="Rebin-v1.html" title="Previous Chapter: Rebin v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Rebin v1</span>
    </a>
  </li>
  <li>
    <a href="RebinByPulseTimes-v1.html" title="Next Chapter: RebinByPulseTimes v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">RebinByPulseTimes v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>