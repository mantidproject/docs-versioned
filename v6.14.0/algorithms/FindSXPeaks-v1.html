<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>FindSXPeaks v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=6b2f7db8"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FindSXPeaksConvolve v1" href="FindSXPeaksConvolve-v1.html" />
    <link rel="prev" title="FindReflectometryLines v2" href="FindReflectometryLines-v2.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.14</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">FindSXPeaks v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="findsxpeaks-v1">
<span id="algm-findsxpeaks"></span><span id="algm-findsxpeaks-v1"></span><h1>FindSXPeaks v1<a class="headerlink" href="#findsxpeaks-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id2">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id5">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id6">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Takes a 2D workspace as input and finds the highest intensity point in each 1D spectrum. This is used in particular for single crystal as a quick way to find strong peaks.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="IndexSXPeaks-v1.html#algm-indexsxpeaks"><span class="std std-ref">IndexSXPeaks</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the Workspace2D to take as input</p></td>
</tr>
<tr class="row-odd"><td><p>RangeLower</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The X value to search from (default 0)</p></td>
</tr>
<tr class="row-even"><td><p>RangeUpper</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The X value to search to (default total number of bins)</p></td>
</tr>
<tr class="row-odd"><td><p>StartWorkspaceIndex</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Start workspace index (default 0)</p></td>
</tr>
<tr class="row-even"><td><p>EndWorkspaceIndex</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>End workspace index (default to total number of histograms)</p></td>
</tr>
<tr class="row-odd"><td><p>PeakFindingStrategy</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>StrongestPeakOnly</p></td>
<td><p>Different options for peak finding.1. StrongestPeakOnly: Looks only for the strongest peak in each spectrum (provided there is one). This options is more performant than the AllPeaks option. 2. AllPeaks: This strategy will find all peaks in each spectrum. This is slower than StrongestPeakOnly. Note that the recommended ResolutionStrategy in this mode is AbsoluteResolution. 3. AllPeaksNSigma: This stratergy will look for peaks by bins that are more than nsigma different in intensity. Note that the recommended ResolutionStrategy in this mode is AbsoluteResolution.  Allowed values: [‘StrongestPeakOnly’, ‘AllPeaks’, ‘AllPeaksNSigma’]</p></td>
</tr>
<tr class="row-even"><td><p>SignalBackground</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>10</p></td>
<td><p>Multiplication factor for the signal background. Peaks which are below the estimated background are discarded. The background is estimated to be an average of the first and the last signal and multiplied by the SignalBackground property.</p></td>
</tr>
<tr class="row-odd"><td><p>AbsoluteBackground</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>30</p></td>
<td><p>Peaks which are below the specified absolute background are discarded. The background is gloabally specified for all spectra. Inspect your data in the InstrumentView to get a good feeling for the background threshold. Background thresholds which are too low will mistake noise for peaks.</p></td>
</tr>
<tr class="row-even"><td><p>NSigma</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>5</p></td>
<td><p>Multiplication factor on error used to compare the difference in intensity between consecutive bins.</p></td>
</tr>
<tr class="row-odd"><td><p>ResolutionStrategy</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>RelativeResolution</p></td>
<td><p>Different options for the resolution.1. RelativeResolution: This defines a relative tolerance needed to avoid peak duplication in number of pixels. This selection will enable the Resolution property and disable the XResolution, PhiResolution, ThetaResolution. 1. AbsoluteResolution: This defines an absolute tolerance needed to avoid peak duplication in number of pixels. This selection will disable the Resolution property and enable the XResolution, PhiResolution, ThetaResolution.  Allowed values: [‘RelativeResolution’, ‘AbsoluteResolution’]</p></td>
</tr>
<tr class="row-even"><td><p>Resolution</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.01</p></td>
<td><p>Tolerance needed to avoid peak duplication in number of pixels</p></td>
</tr>
<tr class="row-odd"><td><p>XResolution</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Absolute tolerance in time-of-flight or d-spacing needed to avoid peak duplication in number of pixels. The values are specified in either microseconds or angstroms.</p></td>
</tr>
<tr class="row-even"><td><p>PhiResolution</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1</p></td>
<td><p>Absolute tolerance in the phi coordinate needed to avoid peak duplication in number of pixels. The values are specified in degrees.</p></td>
</tr>
<tr class="row-odd"><td><p>TwoThetaResolution</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1</p></td>
<td><p>Absolute tolerance of two theta value needed to avoid peak duplication in number of pixels. The values are specified in degrees.</p></td>
</tr>
<tr class="row-even"><td><p>MinNBinsPerPeak</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Minimum number of bins contributing to a peak in an individual spectrum</p></td>
</tr>
<tr class="row-odd"><td><p>MinNSpectraPerPeak</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Minimum number of spectra contributing to a peak after they are grouped</p></td>
</tr>
<tr class="row-even"><td><p>MaxNSpectraPerPeak</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Maximum number of spectra contributing to a peak after they are grouped</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p>PeaksWorkspace</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the PeaksWorkspace in which to store the list of peaks found</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>Detector-space, single crystal peak finding. The algorithm can be used to
search through each spectra and find either all peaks or only the strongest
peak within a given x range. The x units of each spectrum can either be TOF or
d-spacing.</p>
<p>Strongest peak mode:</p>
<ul class="simple">
<li><p>The highest intensity bin is taken to be the peak, so the algorithm only
finds one peak per spectra. In this case the background is calculated as the
average of the start and end intensity multiplied by the provided
SignalBackground parameter. Peaks that are not above the background are
culled.</p></li>
<li><p>This peak finding mode is mainly used with the ResolutionStrategy set to
RelativeResolution.  In this case, the resolution parameter defines a
tolerance which is compared to the absolute difference between the parameters
<span class="math notranslate nohighlight">\(\phi\)</span>, <span class="math notranslate nohighlight">\(2\theta\)</span>, and <span class="math notranslate nohighlight">\(t\)</span> of two found peaks.  If the
absolute difference between any of the parameters for two peaks is greater
than the product of the tolerance value and the parameter value then the two
peaks are classed as not the same. i.e. if <span class="math notranslate nohighlight">\(|\phi_1 - \phi_2| &gt; tolerance * \phi_1\)</span>
then peaks 1 &amp; 2 are not the same (as well as similar
definitions for <span class="math notranslate nohighlight">\(2\theta\)</span> and <span class="math notranslate nohighlight">\(t\)</span>).</p></li>
</ul>
<p>All peaks mode:</p>
<ul class="simple">
<li><p>All peaks in each spectra above a certain threshold are detected as peaks
(see below for the threshold).</p></li>
<li><p>In this case the user provides an absolute, global background/threshold
value which is set with the AbsoluteBackground parameter. Peaks that are not
above the absolute background are culled. A good way of identifying the
background is to inspect your data set in pick mode within the
InstrumentView. Ensure that your absolute background has been set high
enough, else the algorithm will pick up noise as peaks.</p></li>
<li><p>This peak finding mode provides the best results when used with the
ResolutionStrategy set to AbsoluteResolution, which allows the user to set
absolute resolution values for the XUnitResolution (either in units of TOF or
d-spacing), PhiResolution and the TwoThetaResolution parameters. These
resolution parameters define tolerances which are compared to the absolute
difference between the parameters <span class="math notranslate nohighlight">\(\phi\)</span>, <span class="math notranslate nohighlight">\(2\theta\)</span>, and
<span class="math notranslate nohighlight">\(t\)</span> of two found peaks.  If the absolute difference between any of the
parameters for two peaks is greater than the absolute tolerance then the two
peaks are classed as not the same. i.e. if <span class="math notranslate nohighlight">\(|\phi_1 - \phi_2| &gt;  PhiTolerance\)</span>
then peaks 1 &amp; 2 are not the same (as well as similar
definitions for <span class="math notranslate nohighlight">\(2\theta\)</span> and <span class="math notranslate nohighlight">\(t\)</span>).</p></li>
</ul>
<p>General points:</p>
<ul class="simple">
<li><p>Calculated Qlab follows the Busy, Levy 1967 convention.</p></li>
</ul>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create histogram workspace</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>

<span class="n">wsPeaks</span> <span class="o">=</span> <span class="n">FindSXPeaks</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Peaks found: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsPeaks</span><span class="o">.</span><span class="n">getNumberPeaks</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Peaks found: 174
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Crystal/Peaks.html">Crystal\Peaks</a> | <a class="reference external" href="categories/Optimization/PeakFinding.html">Optimization\PeakFinding</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/20c62d1ebd11f750ec28d7c63ea79789b04adf61/Framework/Crystal/inc/MantidCrystal/FindSXPeaks.h">FindSXPeaks.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/20c62d1ebd11f750ec28d7c63ea79789b04adf61/Framework/Crystal/src/FindSXPeaks.cpp">FindSXPeaks.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="FindReflectometryLines-v2.html" title="Previous Chapter: FindReflectometryLines v2"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; FindReflectom...</span>
    </a>
  </li>
  <li>
    <a href="FindSXPeaksConvolve-v1.html" title="Next Chapter: FindSXPeaksConvolve v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">FindSXPeaksCo... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>