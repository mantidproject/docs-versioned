<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>GenerateGroupingPowder v2</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=6b2f7db8"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GenerateGroupingSNSInelastic v1" href="GenerateGroupingSNSInelastic-v1.html" />
    <link rel="prev" title="GenerateGroupingPowder v1" href="GenerateGroupingPowder-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.14</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">GenerateGroupingPowder v2</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="generategroupingpowder-v2">
<span id="algm-generategroupingpowder"></span><span id="algm-generategroupingpowder-v2"></span><h1>GenerateGroupingPowder v2<a class="headerlink" href="#generategroupingpowder-v2" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id2">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id5">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id6">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Generate grouping by angles.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="LoadDetectorsGroupingFile-v1.html#algm-loaddetectorsgroupingfile"><span class="std std-ref">LoadDetectorsGroupingFile</span></a>, <a class="reference internal" href="GroupDetectors-v2.html#algm-groupdetectors"><span class="std std-ref">GroupDetectors</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>A workspace from which to generate the grouping.</p></td>
</tr>
<tr class="row-odd"><td><p>GroupingWorkspace</p></td>
<td><p>Output</p></td>
<td><p>GroupingWorkspace</p></td>
<td></td>
<td><p>The grouping workspace created</p></td>
</tr>
<tr class="row-even"><td><p>AngleStep</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The polar angle step for grouping, in degrees.</p></td>
</tr>
<tr class="row-odd"><td><p>AzimuthalStep</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>360</p></td>
<td><p>The azimuthal angle step for grouping, in degrees.</p></td>
</tr>
<tr class="row-even"><td><p>AzimuthalStart</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The azimuthal angle start location, in degrees.</p></td>
</tr>
<tr class="row-odd"><td><p>NumberByAngle</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>If true, divide sphere into groups labeled by angular sector.Empty parts of the instrument will effectively have group numbers that do not exist in the output.If false, labels will be assigned in order of highest angle.</p></td>
</tr>
<tr class="row-even"><td><p>GroupingFilename</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>A grouping file that will be created. Allowed values: [‘xml’, ‘nxs’, ‘nx5’]</p></td>
</tr>
<tr class="row-odd"><td><p>GenerateParFile</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>If true, a par file with a corresponding name to the grouping file will be generated. Ignored if grouping file is not specified.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>For powder samples, with no texture, the scattering consists only of
rings. This algorithm reads a workspace and an angle step, then
generates a grouping file (.xml or .nxs) and an optional par file (.par),
by grouping detectors in one of several methods:</p>
<ul class="simple">
<li><p>Divide ring into circular sectors labeled i*step to (i+1)*step (see note below).
The original and default behavior.</p></li>
<li><p>Divide sphere into spherical sectors, similarly to above but including azimuthal angles (see note below).
Use NumberByAngle set to true and specify AzimuthalStep and AzimuthalStart.</p></li>
<li><p>Divide ring into circular sectors labeled in order, from large 2theta to low 2theta.
Use NumberByAngle set to false and specify only AngleStep (or set AzimuthalStep to its default at 360).</p></li>
<li><p>Divide ring into circular sectors labeled in order, splitting left/right sides from large 2theta to low 2theta.
One side is labeled first, then the other.
Use NumberByAngle set to false, specify AngleStep, and specify AzimuthalStep as anything other than 360.</p></li>
</ul>
<p>The par file is required
for saving in the NXSPE format, since Mantid does not correctly
calculate the angles for detector groups. It will contain
average distances to the detector groups, and average scattering angles.
The x and y extents in the par file are radians(step)*distance and
0.01, and are not supposed to be accurate.  A par file can only be saved using the original default labeling scheme.</p>
<p>The grouping file (.xml) can be used with <a class="reference internal" href="GroupDetectors-v2.html#algm-groupdetectors"><span class="std std-ref">GroupDetectors</span></a> to perform the grouping.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path.
In Mantid this is done using <a class="reference internal" href="../interfaces/framework/ManageUserDirectories.html#manageuserdirectories"><span class="std std-ref">Manage User Directories</span></a>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create some grouping file</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">mantid</span>
<span class="n">outputFilename</span><span class="o">=</span><span class="n">mantid</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="s2">&quot;defaultsave.directory&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;powder.xml&quot;</span>

<span class="c1">#load some file</span>
<span class="n">ws</span><span class="o">=</span><span class="n">Load</span><span class="p">(</span><span class="s2">&quot;CNCS_7860&quot;</span><span class="p">)</span>

<span class="c1">#generate the files</span>
<span class="n">GenerateGroupingPowder</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="n">GroupingFilename</span><span class="o">=</span><span class="n">outputFilename</span><span class="p">)</span>

<span class="c1">#check that it works</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os.path</span>
<span class="k">if</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">outputFilename</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found file powder.xml&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">mantid</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="s2">&quot;defaultsave.directory&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;powder.par&quot;</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found file powder.par&quot;</span><span class="p">)</span>
<span class="n">wsg</span><span class="o">=</span><span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">outputFilename</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The grouping workspace has </span><span class="si">{}</span><span class="s2"> histograms&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Found file powder.xml
Found file powder.par
The grouping workspace has 14 histograms
</pre></div>
</div>
<hr class="docutils" />
<p>Similarly, one could instead specify the grouping workspace:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#load some file</span>
<span class="n">ws</span><span class="o">=</span><span class="n">Load</span><span class="p">(</span><span class="s2">&quot;CNCS_7860&quot;</span><span class="p">)</span>
<span class="n">gws_name</span><span class="o">=</span> <span class="s2">&quot;a_nice_name_for_grouping_workspace&quot;</span>

<span class="c1">#generate the files</span>
<span class="n">GenerateGroupingPowder</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="n">GroupingWorkspace</span><span class="o">=</span><span class="n">gws_name</span><span class="p">)</span>

<span class="c1">#check that it works</span>
<span class="n">gws</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="n">gws_name</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The grouping workspace has </span><span class="si">{}</span><span class="s2"> histograms&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The grouping workspace has 51200 histograms
</pre></div>
</div>
<p>If one would use LoadDetectorsGroupingFile on powder.xml one would get a workspace that looks like</p>
<figure class="align-default">
<img alt="GenerateGroupingPowder.png" src="../_images/GenerateGroupingPowder.png" />
</figure>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/DataHandling/Grouping.html">DataHandling\Grouping</a> | <a class="reference external" href="categories/Transforms/Grouping.html">Transforms\Grouping</a> | <a class="reference external" href="categories/Diffraction/Utility.html">Diffraction\Utility</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/20c62d1ebd11f750ec28d7c63ea79789b04adf61/Framework/DataHandling/inc/MantidDataHandling/GenerateGroupingPowder2.h">GenerateGroupingPowder2.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/20c62d1ebd11f750ec28d7c63ea79789b04adf61/Framework/DataHandling/src/GenerateGroupingPowder2.cpp">GenerateGroupingPowder2.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="GenerateGroupingPowder-v1.html" title="Previous Chapter: GenerateGroupingPowder v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; GenerateGroup...</span>
    </a>
  </li>
  <li>
    <a href="GenerateGroupingSNSInelastic-v1.html" title="Next Chapter: GenerateGroupingSNSInelastic v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">GenerateGroup... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>