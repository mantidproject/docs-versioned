<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>CreatePoleFigureTableWorkspace v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=4468db6d" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=9aca6aaf" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=2d21b807"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CreateSampleShape v1" href="CreateSampleShape-v1.html" />
    <link rel="prev" title="CreatePolarizationEfficiencies v1" href="CreatePolarizationEfficiencies-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





<nav id="navbar" class="navbar navbar-default navbar-fixed-top">
  <div id="navbar-main" class="container">
    <ul class="nav navbar-nav">
      
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <li>
        <a class="navbar-brand" href="http://www.mantidproject.org">
         </a>
      </li>
      <span class="navbar-text navbar-version pull-left"><b>6.15</b></span>
    </ul>

    
    <div class="collapse navbar-collapse nav-collapse">
    
      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        
          <li>
            <a href="https://www.mantidproject.org">Home</a>
          </li>
          <li>
            <a href="https://download.mantidproject.org">Download</a>
          </li>
          <li>
            <a href="https://docs.mantidproject.org">Documentation</a>
          </li>
          <li>
            <a href="https://www.mantidproject.org/contact">Contact Us</a>
          </li>
        
        
          
          
        
        
        
        
      </ul>
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          </div>
  </div> <!-- /navbar-main -->
<div id="navbar-breadcrumbs" class="related" role="navigation" aria-label="related navigation">
  <h3>Navigation</h3>
  <ul>
    <li class="nav-item nav-item-0">
      <a href="../index.html">Documentation</a>
         &#187;
    </li>
    
    <li class="nav-item nav-item-1">
      <a href="index.html" accesskey="U">
        Algorithms
      </a>
       &#187;
    </li>
    
    
    
    
    <li class="nav-item nav-item-this">
      <a href="">CreatePoleFigureTableWorkspace v1</a>
    </li>
    
    
  </ul>
</div>
</nav>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="createpolefiguretableworkspace-v1">
<span id="algm-createpolefiguretableworkspace"></span><span id="algm-createpolefiguretableworkspace-v1"></span><h1>CreatePoleFigureTableWorkspace v1<a class="headerlink" href="#createpolefiguretableworkspace-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id3">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p></li>
<li><p><a class="reference internal" href="#references" id="id6">References</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id7">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id8">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Creates a table storing the pole figure data extracted from the input workspaces.</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The workspace containing the input data.</p></td>
</tr>
<tr class="row-odd"><td><p>PeakParameterWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></p></td>
<td></td>
<td><p>Optional workspace containing the fitted peak data.</p></td>
</tr>
<tr class="row-even"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Output workspace containing the table of alphas, betas and intensities.</p></td>
</tr>
<tr class="row-odd"><td><p>SpectraWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td><p>Output workspace containing the spectra corresponding to each row of the Output Table Workspace.</p></td>
</tr>
<tr class="row-even"><td><p>ReadoutColumn</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>I</p></td>
<td><p>The column from the Peak Parameter Workspace which should be used for populating the final column in the output table</p></td>
</tr>
<tr class="row-odd"><td><p>Reflection</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p>0,0,0</p></td>
<td><p>Reflection number for peak being fit. If given, algorithm will attempt to use the CrystalStructure on the InputWorkspace to adjust intensity for scattering power.</p></td>
</tr>
<tr class="row-even"><td><p>Chi2Threshold</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>2</p></td>
<td><p>Minimum chi^2 value to include in table. If set to 0.0, no chi^2 filtering will be performed.</p></td>
</tr>
<tr class="row-odd"><td><p>PeakPositionThreshold</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.1</p></td>
<td><p>Maximum distance of fitted peak X0 from HKL X0 value to include in table.If set to 0.0, no positional filtering will be performed. If no Reflection is specified, this tolerance can be ignored, otherwise it will assume X0 in PeakParameterWorkspace is given in dSpacing.</p></td>
</tr>
<tr class="row-even"><td><p>ApplyScatteringPowerCorrection</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>Flag for determining whether the provided intensities should be corrected for scattering power</p></td>
</tr>
<tr class="row-odd"><td><p>IncludeSpectrumInfo</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Flag for whether to include a column in the table containing focused workspace name and spectrum number</p></td>
</tr>
<tr class="row-even"><td><p>ScatteringVolumePosition</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p>0,0,0</p></td>
<td><p>Position where the diffraction vectors should be calculated from, defaults as the origin</p></td>
</tr>
<tr class="row-odd"><td><p>AxesTransform</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p>1,0,0,0,1,0,0,0,1</p></td>
<td><p>Algorithm assumes the initial orientation of the sample has the two in plane axes of the pole figure aligned with X and Z of the laboratory frame. This can be overridden by providing a flattened axes transform matrix, which transforms X and Z to the desired initial vectors</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>Create a table with the information required to produce a pole figure, namely, a collection of alphas, betas,
and intensities. Here alpha and beta are referring to spherical coordinates in the reference frame of the sample.
Alpha is described as the azimuthal angle taken from the x-axis of the sample. Beta is described as the elevation angle
from the y-axis of the sample.</p>
<p>If a peak parameters table is provided it is expected that intensities (“I”), chi squared values (“chi2”),
and peak positions (“X0”) are all present. The requirement for chi2 and peak positions can be overridden by setting
their respective thresholds to <code class="docutils literal notranslate"><span class="pre">0.0</span></code>. If no peak parameter table is given, the chi squared will be assumed to be <code class="docutils literal notranslate"><span class="pre">0</span></code>,
the intensities assumed to be <code class="docutils literal notranslate"><span class="pre">1</span></code>, and no peak positions will be considered. It is further expected that the number
of rows in this table exactly matches the number of spectra provided.</p>
<p>The algorithm supports selection of which spectra from the input are included in the final table, by use of both
a threshold on the peak position and on the chi squared value. If a reflection is specified, the algorithm will
check that the fit <code class="docutils literal notranslate"><span class="pre">X0</span></code> value in the peak parameter table is within <code class="docutils literal notranslate"><span class="pre">PeakThreshold</span></code> of the d spacing value
for the specified peak (Note: as such, specifying a reflection requires a
<a class="reference internal" href="../concepts/CrystalStructureAndReflections.html#crystal-structure-and-reflections"><span class="std std-ref">Crystal Structure concept page</span></a> be set on the Input Workspace).
If no reflection is given, this <code class="docutils literal notranslate"><span class="pre">PeakThreshold</span></code> will check <code class="docutils literal notranslate"><span class="pre">X0</span></code> is within threshold value of the mean <code class="docutils literal notranslate"><span class="pre">X0</span></code> value.
If a chi squared threshold is specified, only spectra with a fit <code class="docutils literal notranslate"><span class="pre">chi2</span></code> value in the peak parameter table lower than the threshold
will be included in the output table.</p>
<p>By default, the beam is anticipated to be incident on <code class="docutils literal notranslate"><span class="pre">(0,0,0)</span></code> for calculation of incident beam diffraction vector and the detector scattering vectors,
if this is not the case, set <code class="docutils literal notranslate"><span class="pre">ScatteringVolumePosition</span></code> to calculate scattering vectors from another position instead.</p>
<p>Note: If a reflection is provided, the intensity is also, by default, normalised by scattering power, as described in ref <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.
This can be prevented by setting, <code class="docutils literal notranslate"><span class="pre">ApplyScatteringPowerCorrection</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</section>
<section id="references">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">References</a><a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Malamud, F., Santisteban, J. R., Vicente Alvarez, M. A., Bolmaro, R., Kelleher, J., Kabra, S. &amp; Kockelmann, W. (2014). Texture analysis with a time-of-flight neutron strain scanner. J. Appl. Cryst. 47, <a class="reference external" href="https://doi.org/10.1107/S1600576714012710">https://doi.org/10.1107/S1600576714012710</a></p>
</aside>
</aside>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Create Pole Figure Table Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># import mantid algorithms, numpy and matplotlib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mantid.simpleapi</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mantid.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">CrystalStructure</span>

<span class="c1"># create a workspace</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span>
    <span class="n">DataX</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
    <span class="n">DataY</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span><span class="mf">4.</span><span class="p">],</span>
    <span class="n">NSpec</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>


<span class="c1"># set the instrument to have a detector at 2theta</span>
<span class="n">EditInstrumentGeometry</span><span class="p">(</span><span class="n">Workspace</span><span class="o">=</span><span class="s1">&#39;ws&#39;</span><span class="p">,</span>
                       <span class="n">PrimaryFlightPath</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">L2</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> <span class="n">Polar</span><span class="o">=</span><span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
                       <span class="n">Azimuthal</span><span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">45</span><span class="p">],</span> <span class="n">DetectorIDs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="c1"># set a crystal structure</span>
<span class="n">xtal</span> <span class="o">=</span> <span class="n">CrystalStructure</span><span class="p">(</span><span class="s2">&quot;5.431 5.431 5.431&quot;</span><span class="p">,</span> <span class="s2">&quot;F d -3 m&quot;</span><span class="p">,</span> <span class="s2">&quot;Si 0 0 0 1.0 0.05&quot;</span><span class="p">)</span>

<span class="c1"># declare a reflection of interest</span>
<span class="n">hkl</span> <span class="o">=</span> <span class="s2">&quot;(1,1,1)&quot;</span>

<span class="c1"># define a sample shape</span>
<span class="n">sample_shape</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;cylinder id=&quot;A&quot;&gt;</span>
<span class="s2">  &lt;centre-of-bottom-base x=&quot;0&quot; y=&quot;0&quot; z=&quot;0.05&quot; /&gt;</span>
<span class="s2">  &lt;axis x=&quot;0&quot; y=&quot;0&quot; z=&quot;-1&quot; /&gt;</span>
<span class="s2">  &lt;radius val=&quot;0.1&quot; /&gt;</span>
<span class="s2">  &lt;height val=&quot;0.1&quot; /&gt;</span>
<span class="s2">&lt;/cylinder&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># apply a generic rotation, set the sample and crystal structure</span>
<span class="n">SetGoniometer</span><span class="p">(</span><span class="s2">&quot;ws&quot;</span><span class="p">,</span> <span class="n">Axis0</span><span class="o">=</span><span class="s2">&quot;45,0,1,0,1&quot;</span><span class="p">)</span>
<span class="n">SetSample</span><span class="p">(</span><span class="s1">&#39;ws&#39;</span><span class="p">,</span> <span class="n">Geometry</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Shape&#39;</span><span class="p">:</span> <span class="s1">&#39;CSG&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">sample_shape</span><span class="p">})</span>
<span class="n">ws</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span><span class="o">.</span><span class="n">setCrystalStructure</span><span class="p">(</span><span class="n">xtal</span><span class="p">)</span>

<span class="c1"># Create an example PeakParameter Table</span>
<span class="n">peak_param_table</span> <span class="o">=</span> <span class="n">CreateEmptyTableWorkspace</span><span class="p">(</span><span class="n">OutputWorkspace</span> <span class="o">=</span> <span class="s2">&quot;PeakParameterWS&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;X0&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2&quot;</span><span class="p">):</span>
    <span class="n">peak_param_table</span><span class="o">.</span><span class="n">addColumn</span><span class="p">(</span><span class="s2">&quot;double&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">val</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">peak_param_table</span><span class="o">.</span><span class="n">addRow</span><span class="p">([</span><span class="n">val</span><span class="p">,</span> <span class="mf">3.14</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">100</span><span class="p">),</span> <span class="n">i</span><span class="p">])</span> <span class="c1"># 3.14 hkl (1,1,1) dSpacing</span>


<span class="c1"># run alg</span>
<span class="n">CreatePoleFigureTableWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span> <span class="o">=</span> <span class="s2">&quot;ws&quot;</span><span class="p">,</span>
                                       <span class="n">PeakParameterWorkspace</span> <span class="o">=</span> <span class="s2">&quot;PeakParameterWS&quot;</span><span class="p">,</span>
                                       <span class="n">OutputWorkspace</span> <span class="o">=</span> <span class="s2">&quot;outWS&quot;</span><span class="p">,</span>
                                       <span class="n">PeakPositionThreshold</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
                                       <span class="n">Chi2Threshold</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Diffraction/Engineering.html">Diffraction\Engineering</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/6762777a1cda710ac427c4efdb2a7fa75b50dc69/Framework/PythonInterface/plugins/algorithms/CreatePoleFigureTableWorkspace.py">CreatePoleFigureTableWorkspace.py</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul id="footer-nav" class="nav navbar-nav">
      
      
          
            
  <li>
    <a href="CreatePolarizationEfficiencies-v1.html" title="Previous Chapter: CreatePolarizationEfficiencies v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; CreatePolariz...</span>
    </a>
  </li>
  <li>
    <a href="CreateSampleShape-v1.html" title="Next Chapter: CreateSampleShape v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">CreateSampleShape v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>