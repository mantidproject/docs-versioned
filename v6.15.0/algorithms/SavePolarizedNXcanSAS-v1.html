<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SavePolarizedNXcanSAS v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=4468db6d" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=9aca6aaf" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=1afa37e1"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SaveRKH v1" href="SaveRKH-v1.html" />
    <link rel="prev" title="SavePlot1DAsJson v1" href="SavePlot1DAsJson-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





<nav id="navbar" class="navbar navbar-default navbar-fixed-top">
  <div id="navbar-main" class="container">
    <ul class="nav navbar-nav">
      
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <li>
        <a class="navbar-brand" href="http://www.mantidproject.org">
         </a>
      </li>
      <span class="navbar-text navbar-version pull-left"><b>6.15</b></span>
    </ul>

    
    <div class="collapse navbar-collapse nav-collapse">
    
      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        
          <li>
            <a href="https://www.mantidproject.org">Home</a>
          </li>
          <li>
            <a href="https://download.mantidproject.org">Download</a>
          </li>
          <li>
            <a href="https://docs.mantidproject.org">Documentation</a>
          </li>
          <li>
            <a href="https://www.mantidproject.org/contact">Contact Us</a>
          </li>
        
        
          
          
        
        
        
        
      </ul>
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          </div>
  </div> <!-- /navbar-main -->
<div id="navbar-breadcrumbs" class="related" role="navigation" aria-label="related navigation">
  <h3>Navigation</h3>
  <ul>
    <li class="nav-item nav-item-0">
      <a href="../index.html">Documentation</a>
         &#187;
    </li>
    
    <li class="nav-item nav-item-1">
      <a href="index.html" accesskey="U">
        Algorithms
      </a>
       &#187;
    </li>
    
    
    
    
    <li class="nav-item nav-item-this">
      <a href="">SavePolarizedNXcanSAS v1</a>
    </li>
    
    
  </ul>
</div>
</nav>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="savepolarizednxcansas-v1">
<span id="algm-savepolarizednxcansas"></span><span id="algm-savepolarizednxcansas-v1"></span><h1>SavePolarizedNXcanSAS v1<a class="headerlink" href="#savepolarizednxcansas-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id2">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id5">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id6">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Save a Group Workspace with reduced SANS polarized data in NXcanSAS Format.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="SaveNXcanSAS-v1.html#algm-savenxcansas"><span class="std std-ref">SaveNXcanSAS</span></a>, <a class="reference internal" href="LoadNXcanSAS-v1.html#algm-loadnxcansas"><span class="std std-ref">LoadNXcanSAS</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The input workspace, which must be in units of Q. Can be a 1D or a 2D workspace.</p></td>
</tr>
<tr class="row-odd"><td><p>Filename</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the .h5 file to save. Allowed extensions: [‘.h5’]</p></td>
</tr>
<tr class="row-even"><td><p>RadiationSource</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Spallation Neutron Source</p></td>
<td><p>The type of radiation used. Allowed values: [‘Spallation Neutron Source’, ‘Pulsed Reactor Neutron Source’, ‘Reactor Neutron Source’, ‘Synchrotron X-ray Source’, ‘Pulsed Muon Source’, ‘Rotating Anode X-ray’, ‘Fixed Tube X-ray’, ‘neutron’, ‘x-ray’, ‘muon’, ‘electron’]</p></td>
</tr>
<tr class="row-odd"><td><p>DetectorNames</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Specify in a comma separated list, which detectors to store information about;  where each name must match a name given for a detector in the [[IDF|instrument definition file (IDF)]].  IDFs are located in the instrument sub-directory of the Mantid install directory.</p></td>
</tr>
<tr class="row-even"><td><p>Transmission</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td><p>The transmission workspace. Optional. If given, will be saved at TransmissionSpectrum</p></td>
</tr>
<tr class="row-odd"><td><p>TransmissionCan</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td><p>The transmission workspace of the Can. Optional. If given, will be saved at TransmissionSpectrum</p></td>
</tr>
<tr class="row-even"><td><p>SampleTransmissionRunNumber</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The run number for the sample transmission workspace. Optional.</p></td>
</tr>
<tr class="row-odd"><td><p>SampleDirectRunNumber</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The run number for the sample direct workspace. Optional.</p></td>
</tr>
<tr class="row-even"><td><p>CanScatterRunNumber</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The run number for the can scatter workspace. Optional.</p></td>
</tr>
<tr class="row-odd"><td><p>CanDirectRunNumber</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The run number for the can direct workspace. Optional.</p></td>
</tr>
<tr class="row-even"><td><p>BackgroundSubtractionWorkspace</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The name of the workspace used in the scaled background subtraction, to be included in the metadata. Optional.</p></td>
</tr>
<tr class="row-odd"><td><p>BackgroundSubtractionScaleFactor</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The scale factor used in the scaled background subtraction, to be included in the metadata. Optional.</p></td>
</tr>
<tr class="row-even"><td><p>Geometry</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Unknown</p></td>
<td><p>The geometry type of the collimation. Allowed values: [‘Cylinder’, ‘FlatPlate’, ‘Flat plate’, ‘Disc’, ‘Unknown’]</p></td>
</tr>
<tr class="row-odd"><td><p>SampleHeight</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The height of the collimation element in mm. If specified as 0 it will not be recorded.</p></td>
</tr>
<tr class="row-even"><td><p>SampleWidth</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The width of the collimation element in mm. If specified as 0 it will not be recorded.</p></td>
</tr>
<tr class="row-odd"><td><p>SampleThickness</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The thickness of the sample in mm. If specified as 0 it will not be recorded.</p></td>
</tr>
<tr class="row-even"><td><p>InputSpinStates</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The order of the spin states in the input group workspace: +1 Polarization parallel to polarizer, -1 antiparallel and 0 no polarization</p></td>
</tr>
<tr class="row-odd"><td><p>PolarizerComponentName</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The name of the Polarizer Component as defined in the IDF. i.e. ‘short-polarizer’</p></td>
</tr>
<tr class="row-even"><td><p>AnalyzerComponentName</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The name of the Analyzer Component as defined in the IDF. i.e. ‘helium-analyzer’</p></td>
</tr>
<tr class="row-odd"><td><p>FlipperComponentNames</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Comma separated list of flipper components as defined in the IDF i.e. ‘RF-flipper</p></td>
</tr>
<tr class="row-even"><td><p>MagneticFieldStrengthLogName</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The name of  sample logs in which the magnetic field strength is stored</p></td>
</tr>
<tr class="row-odd"><td><p>MagneticFieldDirection</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Direction of the magnetic field on the sample: comma separated vectorwith three values: Polar, Azimuthal and Rotation angles</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>Saves a workspace with momentum transfer units into a file adhering to the NXcanSAS format specified by NXcanSAS Data
Formats Working Group <a class="reference external" href="http://cansas-org.github.io/NXcanSAS/classes/contributed_definitions/NXcanSAS.html">schema</a>.</p>
<p>This algorithm in particular, adheres to the WIP <a class="reference external" href="https://wiki.cansas.org/index.php?title=NXcanSAS_v1.1">proposal</a> to
update the format to include reduced SANS polarized data.</p>
<p>The algorithm is an extension of <a class="reference internal" href="SaveNXcanSAS-v1.html#algm-savenxcansas"><span class="std std-ref">SaveNXcanSAS v1</span></a>, all the metadata available in <a class="reference internal" href="SaveNXcanSAS-v1.html#algm-savenxcansas"><span class="std std-ref">SaveNXcanSAS v1</span></a> can be saved
here too.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">InputWorkspace</span></code> property must be a Workspace Group containing as many members as measured polarization states,
which typically would be 2 members for half-polarized SANS measurements and 4 members for full-polarized SANS.</p>
<p>The spin states are set through the <code class="docutils literal notranslate"><span class="pre">InputSpinStates</span></code> property, every polarization configuration is defined as a <em>PinPout</em> pair, with
the possible values for each spin state before (<em>Pin</em>) or after (<em>Pout</em>) the sample being “+1”, “-1” or “0” as defined in the <a class="reference external" href="https://wiki.cansas.org/index.php?title=NXcanSAS_v1.1">proposal</a>.
There must be as many <em>PinPout</em> pairs as workspace members in the <code class="docutils literal notranslate"><span class="pre">InputWorkspace</span></code> property, in the same order of polarization
as that on the workspaces. For example, a full polarized measurement could be defined in the <code class="docutils literal notranslate"><span class="pre">InputSpinStates</span></code> property
as <em>“+1+1,-1+1,-1-1,-1-1”</em> , with <em>“-1-1”</em> and <em>“+1+1”</em> being the non spin-flip configurations and <em>“-1+1 , +1-1”</em> the spin-flip ones.</p>
<p>In addition, the magnetic field strength can be added by referring to the sample log of the <code class="docutils literal notranslate"><span class="pre">InputWorkspace</span></code> containing the data in <code class="docutils literal notranslate"><span class="pre">MagneticFieldStrengthLogName</span></code>,
the direction of the magnetic field in spherical coordinates is specified in the <code class="docutils literal notranslate"><span class="pre">MagneticFieldDirection</span></code> property by setting
the dimensions of the spherical vector (polar, azimuthal, rotation angles) as comma separated values.</p>
<p>The information for the polarizing components (polarizer, flippers, analyzer) must be specified in <code class="docutils literal notranslate"><span class="pre">PolarizerComponentName</span></code>, <code class="docutils literal notranslate"><span class="pre">FlipperComponentNames</span></code>, <code class="docutils literal notranslate"><span class="pre">AnalyzerComponentName</span></code>
properties by writing the polarizer component name as defined in the corresponding Instrument Definition File (IDF). For each component; name, type and distance to sample
will be written in the the corresponding dataset. If there is more than one flipper, they can be added by their IDF component name as comma separated lists in the <code class="docutils literal notranslate"><span class="pre">FlipperComponentNames</span></code> property.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create sample workspace group with simple test data and adding ZOOM instrument.</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;out_</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="n">OutputWorkspace</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">Function</span><span class="o">=</span><span class="s2">&quot;User Defined&quot;</span><span class="p">,</span> <span class="n">UserDefinedFunction</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;name=Lorentzian, Amplitude=1000, PeakCentre=</span><span class="si">{</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">, FWHM=1&quot;</span><span class="p">,</span> <span class="n">XUnit</span><span class="o">=</span><span class="s2">&quot;MomentumTransfer&quot;</span><span class="p">,</span> <span class="n">NumBanks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">BankPixelWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">XMin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">XMax</span><span class="o">=</span><span class="mf">16.5</span><span class="p">,</span> <span class="n">BinWidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">LoadInstrument</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">InstrumentName</span><span class="o">=</span><span class="s2">&quot;ZOOM&quot;</span><span class="p">,</span> <span class="n">RewriteSpectraMap</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="n">group</span> <span class="o">=</span> <span class="n">GroupWorkspaces</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
<span class="n">SavePolarizedNXcanSAS</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s2">&quot;test_file&quot;</span><span class="p">,</span> <span class="n">InputSpinStates</span><span class="o">=</span><span class="s2">&quot;+1-1,-1-1,+1+1,-1+1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/DataHandling/Nexus.html">DataHandling\Nexus</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/6762777a1cda710ac427c4efdb2a7fa75b50dc69/Framework/DataHandling/inc/MantidDataHandling/SavePolarizedNXcanSAS.h">SavePolarizedNXcanSAS.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/6762777a1cda710ac427c4efdb2a7fa75b50dc69/Framework/DataHandling/src/SavePolarizedNXcanSAS.cpp">SavePolarizedNXcanSAS.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul id="footer-nav" class="nav navbar-nav">
      
      
          
            
  <li>
    <a href="SavePlot1DAsJson-v1.html" title="Previous Chapter: SavePlot1DAsJson v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SavePlot1DAsJson v1</span>
    </a>
  </li>
  <li>
    <a href="SaveRKH-v1.html" title="Next Chapter: SaveRKH v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SaveRKH v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>