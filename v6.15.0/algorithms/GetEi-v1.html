<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>GetEi v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=4468db6d" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=9aca6aaf" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=2d21b807"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script>window.MathJax = {"tex": {"macros": {"AA": "\\unicode{x212B}"}}, "startup": {"polyfillHasOwn": true}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GetEi v2" href="GetEi-v2.html" />
    <link rel="prev" title="GetDetectorOffsets v1" href="GetDetectorOffsets-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





<nav id="navbar" class="navbar navbar-default navbar-fixed-top">
  <div id="navbar-main" class="container">
    <ul class="nav navbar-nav">
      
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <li>
        <a class="navbar-brand" href="http://www.mantidproject.org">
         </a>
      </li>
      <span class="navbar-text navbar-version pull-left"><b>6.15</b></span>
    </ul>

    
    <div class="collapse navbar-collapse nav-collapse">
    
      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        
          <li>
            <a href="https://www.mantidproject.org">Home</a>
          </li>
          <li>
            <a href="https://download.mantidproject.org">Download</a>
          </li>
          <li>
            <a href="https://docs.mantidproject.org">Documentation</a>
          </li>
          <li>
            <a href="https://www.mantidproject.org/contact">Contact Us</a>
          </li>
        
        
          
          
        
        
        
        
      </ul>
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          </div>
  </div> <!-- /navbar-main -->
<div id="navbar-breadcrumbs" class="related" role="navigation" aria-label="related navigation">
  <h3>Navigation</h3>
  <ul>
    <li class="nav-item nav-item-0">
      <a href="../index.html">Documentation</a>
         &#187;
    </li>
    
    <li class="nav-item nav-item-1">
      <a href="index.html" accesskey="U">
        Algorithms
      </a>
       &#187;
    </li>
    
    
    
    
    <li class="nav-item nav-item-this">
      <a href="">GetEi v1</a>
    </li>
    
    
  </ul>
</div>
</nav>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="getei-v1">
<span id="algm-getei-v1"></span><h1>GetEi v1<a class="headerlink" href="#getei-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id2">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id3">Description</a></p></li>
<li><p><a class="reference internal" href="#source" id="id4">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Calculates the kinetic energy of neutrons leaving the source based on the time it takes for them to travel between two monitors.</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The X units of this workspace must be time of flight with times in micro-seconds</p></td>
</tr>
<tr class="row-odd"><td><p>Monitor1Spec</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The spectrum number of the output of the first monitor, e.g. MAPS 41474, MARI 2, MERLIN 69634</p></td>
</tr>
<tr class="row-even"><td><p>Monitor2Spec</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The spectrum number of the output of the second monitor e.g. MAPS 41475, MARI 3, MERLIN 69638</p></td>
</tr>
<tr class="row-odd"><td><p>EnergyEstimate</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>An approximate value for the typical incident energy, energy of neutrons leaving the source (meV)</p></td>
</tr>
<tr class="row-even"><td><p>IncidentEnergy</p></td>
<td><p>Output</p></td>
<td><p>number</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>FirstMonitorPeak</p></td>
<td><p>Output</p></td>
<td><p>number</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>Uses <span class="math notranslate nohighlight">\(E=\frac{1}{2}mv^2\)</span> to calculate the energy of neutrons leaving the
source. The velocity is calculated from the time it takes for the
neutron pulse to travel between the two monitors whose spectra were
specified.</p>
<p>An initial energy guess is required for the algorithm to find the
correct peak. The analysis will be done on the highest peak that is
within 8% of the estimated TOF given by the estimate.</p>
<p>Not all neutrons arrive at the monitors at the same time because their
kinetic energies, and therefore velocities, are all different. The time
of arrival of the neutron pulse is taken to be the mean of the two half
peak height locations. The half height points are found as follows:</p>
<ol class="arabic simple">
<li><p>the peak height is the largest number of counts above the background
in any bin in the window</p></li>
<li><p>the half height is half the above number</p></li>
<li><p>examine bins to the left of the bin with the highest number of counts
looking for a bin with less than half that number above background</p></li>
<li><p>interpolate between this point bin and the one immediately previous
to find the first half height location</p></li>
<li><p>repeat the steps 3 and 4 looking to the right of the highest point to
get the second half height point</p></li>
<li><p>the mean of the X-values of the two half height points is the TOF
arrival time of the neutrons</p></li>
</ol>
<p>The above process is illustrated on a peak is shown below in the image
below</p>
<a class="reference internal image-reference" href="../_images/Monitorspect_getei.jpg"><img alt="Monitor Peak" class="align-center" src="../_images/Monitorspect_getei.jpg" style="width: 618px;" />
</a>
<p>The distances between the monitors are read from the instrument
definition file. It is assumed that the source and the monitors all lie
on one line and that the monitors have the same delay time.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This version is an older algorithm and is no longer in current use, although
it is not deprecated.</p>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Inelastic/Ei.html">Inelastic\Ei</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/6762777a1cda710ac427c4efdb2a7fa75b50dc69/Framework/Algorithms/inc/MantidAlgorithms/GetEi.h">GetEi.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/6762777a1cda710ac427c4efdb2a7fa75b50dc69/Framework/Algorithms/src/GetEi.cpp">GetEi.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul id="footer-nav" class="nav navbar-nav">
      
      
          
            
  <li>
    <a href="GetDetectorOffsets-v1.html" title="Previous Chapter: GetDetectorOffsets v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; GetDetectorOffsets v1</span>
    </a>
  </li>
  <li>
    <a href="GetEi-v2.html" title="Next Chapter: GetEi v2"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">GetEi v2 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>