<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>McStas - A neutron ray-trace simulation package</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=4468db6d" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=9aca6aaf" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=2d21b807"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Modulated Structure" href="ModulatedStructure.html" />
    <link rel="prev" title="Matrix Workspace" href="MatrixWorkspace.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





<nav id="navbar" class="navbar navbar-default navbar-fixed-top">
  <div id="navbar-main" class="container">
    <ul class="nav navbar-nav">
      
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <li>
        <a class="navbar-brand" href="http://www.mantidproject.org">
         </a>
      </li>
      <span class="navbar-text navbar-version pull-left"><b>6.15</b></span>
    </ul>

    
    <div class="collapse navbar-collapse nav-collapse">
    
      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        
          <li>
            <a href="https://www.mantidproject.org">Home</a>
          </li>
          <li>
            <a href="https://download.mantidproject.org">Download</a>
          </li>
          <li>
            <a href="https://docs.mantidproject.org">Documentation</a>
          </li>
          <li>
            <a href="https://www.mantidproject.org/contact">Contact Us</a>
          </li>
        
        
          
          
        
        
        
        
      </ul>
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          </div>
  </div> <!-- /navbar-main -->
<div id="navbar-breadcrumbs" class="related" role="navigation" aria-label="related navigation">
  <h3>Navigation</h3>
  <ul>
    <li class="nav-item nav-item-0">
      <a href="../index.html">Documentation</a>
         &#187;
    </li>
    
    <li class="nav-item nav-item-1">
      <a href="index.html" accesskey="U">
        Concepts
      </a>
       &#187;
    </li>
    
    
    
    
    <li class="nav-item nav-item-this">
      <a href="">McStas - A neutron ray-trace simulation package</a>
    </li>
    
    
  </ul>
</div>
</nav>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="mcstas-a-neutron-ray-trace-simulation-package">
<span id="id1"></span><h1>McStas - A neutron ray-trace simulation package<a class="headerlink" href="#mcstas-a-neutron-ray-trace-simulation-package" title="Link to this heading">¶</a></h1>
<section id="introduction-to-mcstas">
<h2>Introduction to McStas<a class="headerlink" href="#introduction-to-mcstas" title="Link to this heading">¶</a></h2>
<p>The McStas neutron ray-tracing simulation package is a versatile tool for producing accurate
simulations of neutron scattering instruments at reactors and pulsed spallation sources. McStas is
extensively used for design and optimization of instruments, virtual experiments, and user training.
McStas is an abbreviation for Monte Carlo Simulation of triple axis spectrometers, but allows for
describing and simulating any type of neutron scattering instrument.</p>
<p>For more information see:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.mcstas.org/">McStas Homepage</a></p></li>
<li><p><a class="reference external" href="http://www.mcstas.org/documentation/manual/">McStas Manual</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1607.02498">McStas and Mantid integration</a></p></li>
</ul>
</section>
<section id="id2">
<h2>McStas and Mantid integration<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<p>McStas works by assembling a C file from instrument information which is then compiled and can be
run to simulate neutron scattering experiments.</p>
<p>When compiled, McStas instrument code is not automatically configured to produce files in
<a class="reference internal" href="NexusFile.html#nexus-file"><span class="std std-ref">NeXus</span></a> format. Mantid also requires the instrument information it reads to be saved as
an <a class="reference internal" href="InstrumentDefinitionFile.html#instrumentdefinitionfile"><span class="std std-ref">Instrument Definition File</span></a>. Instructions on how to do this can be found on the <a class="reference external" href="https://github.com/McStasMcXtrace/McCode/wiki/McStas-and-Mantid">McStas and Mantid wiki page</a> in the McStas repository.</p>
<p>Once the NeXus data has been generated it can be loaded into Mantid using <a class="reference internal" href="../algorithms/LoadMcStas-v1.html#algm-loadmcstas"><span class="std std-ref">LoadMcStas v1</span></a>.</p>
</section>
<section id="quick-mcstas-tutorial">
<h2>Quick McStas Tutorial<a class="headerlink" href="#quick-mcstas-tutorial" title="Link to this heading">¶</a></h2>
<p>This tutorial is just to generate a simple data file with McStas that Mantid is able to load.
It is recommendeed to install McStas with conda by following the instructions on the <a class="reference external" href="https://github.com/mccode-dev/McCode/blob/main/INSTALL-McStas/conda/README.md">McStas conda installation page</a>.
Once you clone the McStas repository, build with conda, and activate the McStas environment, you can run the command <code class="docutils literal notranslate"><span class="pre">mcgui</span></code> on the command line to open the McStas GUI.</p>
<ol class="arabic simple">
<li><p>On the GUI, select File -&gt; New From Template and you will see a selection for Mantid.</p></li>
<li><p>Pick a template from Mantid and you will see a save window pop up.
It should not matter which template you pick.</p></li>
<li><p>Rename the file if you wish and save it.
If you would like more info on how to make an instrument file for McStas, see <a class="reference external" href="https://github.com/mccode-dev/McCode/wiki/McStas-and-Mantid#setup-the-mcstas-instrument-to-create-a-mantid-instrument">this section in the wiki</a>.</p></li>
<li><p>On the McStas GUI, click Run and a window will pop up asking for parameters.
The main thing to change here is the output format to NeXus –IDF.
If it does not have –IDF when you generate the data, Mantid will not be able to load it properly.</p></li>
<li><p>Click start to generate the data.</p></li>
<li><p>Once the data has been generated, open Mantid and click Load -&gt; File in the workspaces box.
Alternatively, you can use the <a class="reference internal" href="../algorithms/LoadMcStas-v1.html#algm-loadmcstas"><span class="std std-ref">LoadMcStas v1</span></a> algorithm to load the data.</p></li>
<li><p>Browse to the McStas generated file and load it.
It should be in a folder titled &lt;template&gt;_&lt;date+time&gt; that is in the location used in step 3.
It will be called something like mccode.h5.
You should now see the McStas data in the workspace browser.</p></li>
</ol>
<p><strong>Category</strong>: <a class="reference external" href="../api/python/mantid/api/categories/Concepts.html">Concepts</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul id="footer-nav" class="nav navbar-nav">
      
      
          
            
  <li>
    <a href="MatrixWorkspace.html" title="Previous Chapter: Matrix Workspace"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Matrix Workspace</span>
    </a>
  </li>
  <li>
    <a href="ModulatedStructure.html" title="Next Chapter: Modulated Structure"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Modulated Structure &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>