<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Scripting SANS Reductions</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=4468db6d" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=9aca6aaf" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=2d21b807"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script>window.MathJax = {"tex": {"macros": {"AA": "\\unicode{x212B}"}}, "startup": {"polyfillHasOwn": true}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Texture Reduction" href="TextureReduction.html" />
    <link rel="prev" title="SANS TOML Files" href="SANS-Toml-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





<nav id="navbar" class="navbar navbar-default navbar-fixed-top">
  <div id="navbar-main" class="container">
    <ul class="nav navbar-nav">
      
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <li>
        <a class="navbar-brand" href="http://www.mantidproject.org">
         </a>
      </li>
      <span class="navbar-text navbar-version pull-left"><b>6.15</b></span>
    </ul>

    
    <div class="collapse navbar-collapse nav-collapse">
    
      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        
          <li>
            <a href="https://www.mantidproject.org">Home</a>
          </li>
          <li>
            <a href="https://download.mantidproject.org">Download</a>
          </li>
          <li>
            <a href="https://docs.mantidproject.org">Documentation</a>
          </li>
          <li>
            <a href="https://www.mantidproject.org/contact">Contact Us</a>
          </li>
        
        
          
          
        
        
        
        
      </ul>
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          </div>
  </div> <!-- /navbar-main -->
<div id="navbar-breadcrumbs" class="related" role="navigation" aria-label="related navigation">
  <h3>Navigation</h3>
  <ul>
    <li class="nav-item nav-item-0">
      <a href="../index.html">Documentation</a>
         &#187;
    </li>
    
    <li class="nav-item nav-item-1">
      <a href="index.html" accesskey="U">
        Techniques
      </a>
       &#187;
    </li>
    
    
    
    
    <li class="nav-item nav-item-this">
      <a href="">Scripting SANS Reductions</a>
    </li>
    
    
  </ul>
</div>
</nav>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="scripting-sans-reductions">
<span id="scriptingsansreductions"></span><h1>Scripting SANS Reductions<a class="headerlink" href="#scripting-sans-reductions" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#reference-commands" id="id2">Reference Commands</a></p>
<ul>
<li><p><a class="reference internal" href="#loq-sans2d" id="id3">LOQ / SANS2D</a></p></li>
<li><p><a class="reference internal" href="#userpath" id="id4">UserPath</a></p></li>
<li><p><a class="reference internal" href="#datapath" id="id5">DataPath</a></p></li>
<li><p><a class="reference internal" href="#maskfile" id="id6">MaskFile</a></p></li>
<li><p><a class="reference internal" href="#assignsample" id="id7">AssignSample</a></p></li>
<li><p><a class="reference internal" href="#transmissionsample" id="id8">TransmissionSample</a></p></li>
<li><p><a class="reference internal" href="#assigncan" id="id9">AssignCan</a></p></li>
<li><p><a class="reference internal" href="#transmissioncan" id="id10">TransmissionCan</a></p></li>
<li><p><a class="reference internal" href="#setmonitorspectrum" id="id11">SetMonitorSpectrum</a></p></li>
<li><p><a class="reference internal" href="#transfit" id="id12">TransFit</a></p></li>
<li><p><a class="reference internal" href="#detector" id="id13">Detector</a></p></li>
<li><p><a class="reference internal" href="#setphilimit" id="id14">SetPhiLimit</a></p></li>
<li><p><a class="reference internal" href="#wavrangereduction" id="id15">WavRangeReduction</a></p></li>
<li><p><a class="reference internal" href="#batchreduce" id="id16">BatchReduce</a></p></li>
<li><p><a class="reference internal" href="#addruns" id="id17">AddRuns</a></p></li>
<li><p><a class="reference internal" href="#phiranges" id="id18">PhiRanges</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>SANS data from ISIS can be analysed using <a class="reference internal" href="../tutorials/introduction_to_python/index.html#introduction-to-python"><span class="std std-ref">Python</span></a> commands. Below is an example of a basic reduction on LOQ.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#import Command Interface from sans library</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sans.command_interface.ISISCommandInterface</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Test script outlining the use of the command line interface to reduce and save SANS data.</span>
<span class="sd">Data is taken from the Mantid Training Data Course Set: https://www.mantidproject.org/installation/index#sample-data</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">LOQ</span><span class="p">()</span>
<span class="n">MaskFile</span><span class="p">(</span><span class="s1">&#39;MaskFile.toml&#39;</span><span class="p">)</span>

<span class="n">AssignSample</span><span class="p">(</span><span class="s1">&#39;LOQ74044.nxs&#39;</span><span class="p">)</span>
<span class="n">TransmissionSample</span><span class="p">(</span><span class="s1">&#39;LOQ74024.nxs&#39;</span><span class="p">,</span> <span class="s1">&#39;LOQ74014.nxs&#39;</span><span class="p">)</span>
<span class="n">AssignCan</span><span class="p">(</span><span class="s1">&#39;LOQ74019.nxs&#39;</span><span class="p">)</span>
<span class="n">TransmissionCan</span><span class="p">(</span><span class="s1">&#39;LOQ74020.nxs&#39;</span><span class="p">,</span> <span class="s1">&#39;LOQ74014.nxs&#39;</span><span class="p">)</span>

<span class="c1">#Performs reduction and saves data to path using SaveRKH and SaveNexus algorithms</span>
<span class="n">WavRangeReduction</span><span class="p">(</span><span class="mf">2.2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">saveAlgs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;SaveRKH&#39;</span><span class="p">:</span> <span class="s1">&#39;txt&#39;</span><span class="p">,</span><span class="s1">&#39;SaveNexus&#39;</span><span class="p">:</span> <span class="s1">&#39;nxs&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The commands are available once the ISISCommandInterface module has been imported, using the following line:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sans.command_interface.ISISCommandInterface</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>These commands are given below in the order in which they are likely to be found in a script file although,
except where stated, the order does not matter.</p>
</section>
<section id="reference-commands">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Reference Commands</a><a class="headerlink" href="#reference-commands" title="Link to this heading">¶</a></h2>
<section id="loq-sans2d">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">LOQ / SANS2D</a><a class="headerlink" href="#loq-sans2d" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">LOQ</span><span class="p">()</span> <span class="c1">#For LOQ</span>
<span class="n">SANS2D</span><span class="p">()</span> <span class="c1">#For SANS2D</span>
</pre></div>
</div>
<p>This specifies which instrument the data was collected from. Either <code class="docutils literal notranslate"><span class="pre">LOQ()</span></code> or <code class="docutils literal notranslate"><span class="pre">SANS2D()</span></code>.
The layout of the detector banks and detector efficiency files are stored here.</p>
<p><em>This line must be included, and before the</em> <code class="docutils literal notranslate"><span class="pre">MaskFile()</span></code> <em>line.</em></p>
</section>
<section id="userpath">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">UserPath</a><a class="headerlink" href="#userpath" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">UserPath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<p>Sets the directory in which Mantid should look for user settings file if a full path was not specified.</p>
<p><em>This must be specified before the</em> <code class="docutils literal notranslate"><span class="pre">MaskFile()</span></code> <em>line to have any effect.</em></p>
</section>
<section id="datapath">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">DataPath</a><a class="headerlink" href="#datapath" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DataPath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<p>This can be used to specify an extra directory in which Mantid will look for run files.
The directories that have been set in the <a class="reference internal" href="../interfaces/framework/ManageUserDirectories.html#manageuserdirectories"><span class="std std-ref">Manage User Directories</span></a> dialog,
or equivalently the <a class="reference internal" href="../concepts/PropertiesFile.html#properties-file"><span class="std std-ref">Mantid.user.properties</span></a> file, are also checked.</p>
</section>
<section id="maskfile">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">MaskFile</a><a class="headerlink" href="#maskfile" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">UserPath</span><span class="p">(</span><span class="s2">&quot;C:/SANS/masks&quot;</span><span class="p">)</span>
<span class="n">MaskFile</span><span class="p">(</span><span class="s2">&quot;ExampleMask.toml&quot;</span><span class="p">)</span> <span class="c1"># or MaskFile(&quot;C:/SANS/masks/ExampleMask.toml&quot;)</span>
</pre></div>
</div>
<p>This settings file can be either a full path or a filename found in the <code class="docutils literal notranslate"><span class="pre">UserPath()</span></code>.
The settings here are overridden by the commands listed below.</p>
</section>
<section id="assignsample">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">AssignSample</a><a class="headerlink" href="#assignsample" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">AssignSample</span><span class="p">(</span><span class="n">sample_run</span><span class="p">,</span> <span class="n">reload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">period</span><span class="p">)</span>
</pre></div>
</div>
<p>Specifies the run to analyse using the format <code class="docutils literal notranslate"><span class="pre">InstRun#.extension</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">SANS2D7777.nxs</span></code>.
This is one of the few commands that executes <a class="reference internal" href="../concepts/Algorithm.html#algorithm"><span class="std std-ref">Mantid algorithms</span></a> when called,
the effects of most commands are only felt after the reduction starts.
On calling this function the experimental run is <a class="reference internal" href="../algorithms/Load-v1.html#algm-load"><span class="std std-ref">loaded</span></a> and component positions are <a class="reference internal" href="../algorithms/MoveInstrumentComponent-v1.html#algm-moveinstrumentcomponent"><span class="std std-ref">changed</span></a>
(normally the detector bank and sample).
Currently only <code class="docutils literal notranslate"><span class="pre">reload=true</span></code> is supported.</p>
</section>
<section id="transmissionsample">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">TransmissionSample</a><a class="headerlink" href="#transmissionsample" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TransmissionSample</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">direct</span><span class="p">,</span> <span class="n">relaod</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">period_t</span><span class="p">,</span> <span class="n">period_d</span><span class="p">)</span>
</pre></div>
</div>
<p>Specifies the runs that will be used to calculate the transmission fraction for the sample run.
<code class="docutils literal notranslate"><span class="pre">sample</span></code> contains transmission monitor counts data for the sample when the sample is present,
<code class="docutils literal notranslate"><span class="pre">direct</span></code> contains similar counts data when the sample position is empty (direct beam).
The workspaces are loaded and the transmission <a class="reference internal" href="../concepts/InstrumentDefinitionFile.html#instrumentdefinitionfile"><span class="std std-ref">IDF</span></a>, if one exists for the instrument,
is loaded into the workspaces when this command is encountered. The transmission fraction is calculated later.
The <code class="docutils literal notranslate"><span class="pre">period_t</span></code> and <code class="docutils literal notranslate"><span class="pre">period_d</span></code> are used when there are multi-period files and specify the period to use for the sample and direct run respectively.</p>
</section>
<section id="assigncan">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">AssignCan</a><a class="headerlink" href="#assigncan" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">AssignCan</span><span class="p">(</span><span class="n">can_run</span><span class="p">,</span> <span class="n">reload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">period</span><span class="p">)</span>
</pre></div>
</div>
<p>The can is a scattering run made under the same conditions as the experimental run but only the sample container is in the sample position.
Hence allowing the effect of the container to be removed. The run is specified using <code class="docutils literal notranslate"><span class="pre">instrumentrunnumber.extension</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">SANS2D7777.nxs</span></code>.
On calling this function the run is loaded to a workspace and the detector banks and other components are moved as applicable.
Currently only <code class="docutils literal notranslate"><span class="pre">reload=true</span></code> is supported.</p>
</section>
<section id="transmissioncan">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">TransmissionCan</a><a class="headerlink" href="#transmissioncan" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TransmissionCan</span><span class="p">(</span><span class="n">can</span><span class="p">,</span> <span class="n">direct</span><span class="p">,</span> <span class="n">reload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">period_t</span><span class="p">,</span> <span class="n">period_d</span><span class="p">)</span>
</pre></div>
</div>
<p>Specify the transmission and direct beam runs that will be used for the analysis of the can run.
The runs are loaded and with transmission <a class="reference internal" href="../concepts/InstrumentDefinitionFile.html#instrumentdefinitionfile"><span class="std std-ref">IDF</span></a>, if applicable, when Python encounters this command.</p>
</section>
<section id="setmonitorspectrum">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">SetMonitorSpectrum</a><a class="headerlink" href="#setmonitorspectrum" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SetMonitorSpectrum</span><span class="p">(</span><span class="n">specNum</span><span class="p">,</span> <span class="n">interp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Specifies the number of the TOF spectrum that will be used to for monitor normalisation.
This value will be used in the next reduction that is called (e.g. with <a class="reference internal" href="#sansscriptingwavrangereduction"><span class="std std-ref">WavRangeReduction()</span></a>).</p>
</section>
<section id="transfit">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">TransFit</a><a class="headerlink" href="#transfit" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TransFit</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">lambdamin</span><span class="p">,</span> <span class="n">lambdamax</span><span class="p">)</span>
</pre></div>
</div>
<p>Sets the method and range over which to calculate a fit for the variation of transmission fraction with wavelength.
These arguments are passed to the algorithm <a class="reference internal" href="../algorithms/CalculateTransmission-v1.html#algm-calculatetransmission"><span class="std std-ref">CalculateTransmission v1</span></a>.
There is an extra fit mode <code class="docutils literal notranslate"><span class="pre">Off</span></code> which causes the unfitted workspace produced by <a class="reference internal" href="../algorithms/CalculateTransmission-v1.html#algm-calculatetransmission"><span class="std std-ref">CalculateTransmission v1</span></a>
to be used and <code class="docutils literal notranslate"><span class="pre">lambdamin</span></code> or <code class="docutils literal notranslate"><span class="pre">lambdamax</span></code> then have no effect.</p>
</section>
<section id="detector">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Detector</a><a class="headerlink" href="#detector" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Detector</span><span class="p">(</span><span class="n">det_name</span><span class="p">)</span>
</pre></div>
</div>
<p>Sets the detector bank to use for the reduction e.g. <code class="docutils literal notranslate"><span class="pre">front-detector</span></code>.
The lowest angle detector is assumed if this line is not given.</p>
</section>
<section id="setphilimit">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">SetPhiLimit</a><a class="headerlink" href="#setphilimit" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SetPhiLimit</span><span class="p">(</span><span class="n">phimin</span><span class="p">,</span> <span class="n">phimax</span><span class="p">,</span> <span class="n">use_mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Call this function to restrict the analysis to sectors of the detector.
<code class="docutils literal notranslate"><span class="pre">phimin</span></code> and <code class="docutils literal notranslate"><span class="pre">phimax</span></code> define the limits of the sector where <code class="docutils literal notranslate"><span class="pre">phi=0</span></code> is the x-axis and <code class="docutils literal notranslate"><span class="pre">phi=90</span></code> is the y-axis.
Setting <code class="docutils literal notranslate"><span class="pre">use_mirror</span></code> to true causes the mirror sector to be included.</p>
</section>
<section id="wavrangereduction">
<span id="sansscriptingwavrangereduction"></span><h3><a class="toc-backref" href="#id15" role="doc-backlink">WavRangeReduction</a><a class="headerlink" href="#wavrangereduction" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">WavRangeReduction</span><span class="p">(</span><span class="n">wav_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wav_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full_trans_wav</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name_suffix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">combineDet</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">saveAlgs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_as_zero_error_free</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">output_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">output_mode</span><span class="o">=</span><span class="n">OutputMode</span><span class="o">.</span><span class="n">PUBLISH_TO_ADS</span><span class="p">,</span> <span class="n">use_reduction_mode_as_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Assuming the mask file contains the correct analysis details one can proceed to calculate <span class="math notranslate nohighlight">\(I(Q)\)</span> using the
<code class="docutils literal notranslate"><span class="pre">WavRangeReduction()</span></code> function, which can be executed with no arguments.
The return value of <code class="docutils literal notranslate"><span class="pre">WavRangeReduction()</span></code> is the name of the final reduced workspace.
This function calls many algorithms ending with a call to <a class="reference internal" href="../algorithms/Q1D-v2.html#algm-q1d"><span class="std std-ref">Q1D v2</span></a> or <a class="reference internal" href="../algorithms/Qxy-v1.html#algm-qxy"><span class="std std-ref">Qxy v1</span></a>.
Several optional parameters can control different aspects of the reduction</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">wav_start</span></code>: the first wavelength to be in the output data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wav_end</span></code>: the last wavelength in the output data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">full_trans_wav</span></code>: Whether to use default’s instrument wavelength range for transmission correction calculation, default is false.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name_suffix</span></code>: Appends the created output workspace with this suffix</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">combineDet</span></code>: combineDet can be one of the following</p>
<blockquote>
<div><ul class="simple">
<li><p>‘rear’: runs one reduction for the ‘rear’ detector data</p></li>
<li><p>‘front’: run one reduction for the ‘front’ detector data, and rescale+shift ‘front’ data</p></li>
<li><p>‘both’: run both the above two reductions</p></li>
<li><p>‘merged’: run the same reductions as ‘both’ and additionally create a merged data workspace</p></li>
<li><p>None: run one reduction for whatever detector has been set as the current detector before running this method. If front apply rescale+shift)</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">saveAlgs</span></code>: A dict of save algorithms containing the names of the algorithms as key and the extension as value(ex: <code class="docutils literal notranslate"><span class="pre">saveAlgs={'SaveRKH':'txt'}</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">save_as_zero_error_free</span></code>: Should the reduced workspaces contain zero errors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_name</span></code>: Name of the output file. Default is sample run number.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_mode</span></code>: Decides the output of the reduced data, whether to publish to the ADS (<code class="docutils literal notranslate"><span class="pre">OutputMode.PUBLISH_TO_ADS</span></code>), save to file with the chosen algorithm
in <code class="docutils literal notranslate"><span class="pre">saveAlgs</span></code> (<code class="docutils literal notranslate"><span class="pre">OutputMode.SAVE_TO_FILE</span></code>) or doing both(<code class="docutils literal notranslate"><span class="pre">OutputMode.BOTH</span></code>). <code class="docutils literal notranslate"><span class="pre">OutputMode</span></code> can be imported
with <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">sans.common.enums</span> <span class="pre">import</span> <span class="pre">OutputMode</span></code>.
If this parameter is omitted, the default behaviour will be to publish the output to the ADS and save it in a file if there is a <code class="docutils literal notranslate"><span class="pre">saveAlgs</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_reduction_mode_as_suffix</span></code>: If <code class="docutils literal notranslate"><span class="pre">True</span></code>, appends second suffix to output name based on reduction mode.</p></li>
</ul>
</section>
<section id="batchreduce">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">BatchReduce</a><a class="headerlink" href="#batchreduce" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">BatchReduce</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">plotresults</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">saveAlgs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">centreit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">combineDet</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_as_zero_error_Free</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">output_mode</span><span class="o">=</span><span class="n">OutputMode</span><span class="o">.</span><span class="n">PUBLISH_TO_ADS</span><span class="p">)</span>
</pre></div>
</div>
<p>This parses a list of files to analyse from a batch file, then it calls <a class="reference internal" href="#sansscriptingwavrangereduction"><span class="std std-ref">WavRangeReduction</span></a> to perform each reduction.
The filename is a mandatory parameter:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">filename</span></code>: Name of a CSV file included in the path, where each line specifies the data for a single reduction (<a class="reference internal" href="../interfaces/isis_sans/Batch%20File%20Format.html#isis-sans-batch-file-ref"><span class="std std-ref">in this format</span></a>).</p></li>
</ul>
</div></blockquote>
<p>Optional parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plotresults</span></code>: If true, a graph with the results from each reduction will be created (only when it is called from Mantid).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">saveAlgs</span></code>: Same as <a class="reference internal" href="#sansscriptingwavrangereduction"><span class="std std-ref">WavRangeReduction</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">centreit</span></code>: Do centre finding (False by default).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">combineDet</span></code>: Same as <a class="reference internal" href="#sansscriptingwavrangereduction"><span class="std std-ref">WavRangeReduction</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">save_as_zero_error_free</span></code>: Same as <a class="reference internal" href="#sansscriptingwavrangereduction"><span class="std std-ref">WavRangeReduction</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_mode</span></code>: Same as <a class="reference internal" href="#sansscriptingwavrangereduction"><span class="std std-ref">WavRangeReduction</span></a>..</p></li>
</ul>
</div></blockquote>
<p>Function returns a dictionary with some values from the reduction (scale and shift as of now).</p>
</section>
<section id="addruns">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">AddRuns</a><a class="headerlink" href="#addruns" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">AddRuns</span><span class="p">(</span><span class="n">runs</span><span class="p">,</span> <span class="n">instrument</span> <span class="o">=</span><span class="s1">&#39;sans2d&#39;</span><span class="p">,</span> <span class="n">saveAsEvent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">binning</span> <span class="o">=</span> <span class="s2">&quot;Monitors&quot;</span><span class="p">,</span>
        <span class="n">isOverlay</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">time_shifts</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">defType</span><span class="o">=</span><span class="s1">&#39;.nxs&#39;</span><span class="p">,</span>
        <span class="n">rawTypes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;.raw&#39;</span><span class="p">,</span> <span class="s1">&#39;.s*&#39;</span><span class="p">,</span> <span class="s1">&#39;add&#39;</span><span class="p">,</span><span class="s1">&#39;.RAW&#39;</span><span class="p">),</span> <span class="n">lowMem</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>This file adds a list of run files. The <code class="docutils literal notranslate"><span class="pre">runs</span></code> variable holds a list of runs which are to be added.
The variable <code class="docutils literal notranslate"><span class="pre">instrument</span></code> specifies which instrument is currently being used.
The variable <code class="docutils literal notranslate"><span class="pre">saveAsEvent</span></code> allows the user to add multiple event files in a combined event file.
The <code class="docutils literal notranslate"><span class="pre">isOverlay</span></code> flag determines if the times of the events and sample logs should be placed on top of each other.
This is only applied if <code class="docutils literal notranslate"><span class="pre">saveAsEvent</span></code> was selected.
The <code class="docutils literal notranslate"><span class="pre">time_shifts</span></code> variable is a list of additional time shifts which will be applied if <code class="docutils literal notranslate"><span class="pre">isOverlay</span></code> is selected.
<em>Note that there has to be exactly one less time time shift than files to be added.</em></p>
</section>
<section id="phiranges">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">PhiRanges</a><a class="headerlink" href="#phiranges" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">PhiRanges</span><span class="p">(</span><span class="n">phis</span><span class="p">,</span> <span class="n">use_mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</pre></div>
</div>
<p>Takes a list of phi ranges (<code class="docutils literal notranslate"><span class="pre">phis</span></code>) either as a list [a, b, c, d] or comma-separated string of numbers “a,b,c,d”.
It reduces in the phi ranges a-b and c-d. This is equivalent to combining <code class="docutils literal notranslate"><span class="pre">SetPhiLimit</span></code> and then calling <code class="docutils literal notranslate"><span class="pre">WavRangeReduction</span></code> for
multiple phi limits. <code class="docutils literal notranslate"><span class="pre">use_mirror</span></code> selects whether to use the mirror for each phi mask. <code class="docutils literal notranslate"><span class="pre">plot</span></code> is not yet implemented.</p>
<p><strong>Category</strong>: <a class="reference external" href="categories/Techniques.html">Techniques</a></p>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul id="footer-nav" class="nav navbar-nav">
      
      
          
            
  <li>
    <a href="SANS-Toml-v1.html" title="Previous Chapter: SANS TOML Files"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SANS TOML Files</span>
    </a>
  </li>
  <li>
    <a href="TextureReduction.html" title="Next Chapter: Texture Reduction"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Texture Reduction &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>