<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Engineering Diffraction</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css?v=4468db6d" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=9aca6aaf" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <script src="../../_static/documentation_options.js?v=2d21b807"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="HFIR Single Crystal Reduction Interface" href="HFIR%20Single%20Crystal%20Reduction.html" />
    <link rel="prev" title="Save Other" href="../isis_sans/sans_save_other.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





<nav id="navbar" class="navbar navbar-default navbar-fixed-top">
  <div id="navbar-main" class="container">
    <ul class="nav navbar-nav">
      
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <li>
        <a class="navbar-brand" href="http://www.mantidproject.org">
         </a>
      </li>
      <span class="navbar-text navbar-version pull-left"><b>6.15</b></span>
    </ul>

    
    <div class="collapse navbar-collapse nav-collapse">
    
      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        
          <li>
            <a href="https://www.mantidproject.org">Home</a>
          </li>
          <li>
            <a href="https://download.mantidproject.org">Download</a>
          </li>
          <li>
            <a href="https://docs.mantidproject.org">Documentation</a>
          </li>
          <li>
            <a href="https://www.mantidproject.org/contact">Contact Us</a>
          </li>
        
        
          
          
        
        
        
        
      </ul>
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          </div>
  </div> <!-- /navbar-main -->
<div id="navbar-breadcrumbs" class="related" role="navigation" aria-label="related navigation">
  <h3>Navigation</h3>
  <ul>
    <li class="nav-item nav-item-0">
      <a href="../../index.html">Documentation</a>
         &#187;
    </li>
    
    <li class="nav-item nav-item-1">
      <a href="../index.html" accesskey="U">
        Interfaces
      </a>
       &#187;
    </li>
    
    
    
    
    <li class="nav-item nav-item-this">
      <a href="">Engineering Diffraction</a>
    </li>
    
    
  </ul>
</div>
</nav>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="engineering-diffraction">
<span id="engineering-diffraction-ref"></span><h1>Engineering Diffraction<a class="headerlink" href="#engineering-diffraction" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#interface-overview" id="id9">Interface Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#general-options" id="id10">General Options</a></p></li>
<li><p><a class="reference internal" href="#other-information" id="id11">Other Information</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#run-processing" id="id12">Run Processing</a></p>
<ul>
<li><p><a class="reference internal" href="#parameters" id="id13">Parameters</a></p></li>
<li><p><a class="reference internal" href="#calibration" id="id14">Calibration</a></p>
<ul>
<li><p><a class="reference internal" href="#cropping" id="id15">Cropping</a></p></li>
<li><p><a class="reference internal" href="#id1" id="id16">Parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#focus" id="id17">Focus</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id18">Parameters</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#absorption-correction" id="id19">Absorption Correction</a></p>
<ul>
<li><p><a class="reference internal" href="#id3" id="id20">Parameters</a></p></li>
<li><p><a class="reference internal" href="#settings-parameters" id="id21">Settings Parameters</a></p></li>
<li><p><a class="reference internal" href="#buttons-functions" id="id22">Buttons/Functions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#fitting" id="id23">Fitting</a></p>
<ul>
<li><p><a class="reference internal" href="#id4" id="id24">Parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#texture-pole-figure" id="id25">Texture (Pole Figure)</a></p>
<ul>
<li><p><a class="reference internal" href="#id5" id="id26">Parameters</a></p></li>
<li><p><a class="reference internal" href="#id6" id="id27">Settings Parameters</a></p></li>
<li><p><a class="reference internal" href="#id7" id="id28">Buttons/Functions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#gsas-ii-refinement" id="id29">GSAS-II Refinement</a></p>
<ul>
<li><p><a class="reference internal" href="#id8" id="id30">Parameters</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="interface-overview">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Interface Overview</a><a class="headerlink" href="#interface-overview" title="Link to this heading">¶</a></h2>
<p>This custom interface will integrate several tasks related to engineering
diffraction. In its current state it provides functionality for creating
and loading calibration files and focusing ENGINX run files.</p>
<p>Functionality for performing single peak fitting on focused run files is currently in progress.</p>
<p>This interface is under active development.</p>
<section id="general-options">
<span id="engineering-diffraction-options-ref"></span><h3><a class="toc-backref" href="#id10" role="doc-backlink">General Options</a><a class="headerlink" href="#general-options" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>RB Number</dt><dd><p>The reference number for the output paths (usually an experiment reference
number at ISIS). Leaving this field empty will result in no user directories
being created, and only the general directory will be used for file storage.</p>
</dd>
<dt>Instrument</dt><dd><p>Select the instrument (ENGINX or IMAT). Currently only ENGINX is fully
supported.</p>
</dd>
</dl>
<dl class="simple">
<dt>?</dt><dd><p>Show this documentation page.</p>
</dd>
<dt>Settings</dt><dd><p>Provides a range of options that apply across the entire interface, currently
providing the option to change the default output directory. The user can also select the
log values from a list which are loaded with data in the fitting tab and select
a log by which to sort the runs in a sequential fit. There is also an option to
specify a peak function to fit (limited to a subset of all peak functions that
are recommended for the UI) which will be set on opening the interface. Note that
the user can select any peak function to fit (even a non-recommended one) at a
later point when adding a peak in the fitting tab.</p>
</dd>
<dt>Close</dt><dd><p>Close the interface.</p>
</dd>
</dl>
<a class="reference internal image-reference" href="../../_images/EngDiff_Settings.png"><img alt="../../_images/EngDiff_Settings.png" class="align-center" src="../../_images/EngDiff_Settings.png" style="width: 600px;" />
</a>
</section>
<section id="other-information">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Other Information</a><a class="headerlink" href="#other-information" title="Link to this heading">¶</a></h3>
<dl>
<dt>Red Stars</dt><dd><p>Red stars next to browse boxes and other fields indicate that the file
could not be found. Hover over the star to see more information.</p>
</dd>
<dt>Status Bar</dt><dd><p>The status bar shows the calibration run numbers the GUI is currently using.
It also displays the save directory (which can be changed in the settings).</p>
</dd>
<dt>Saved File Outputs</dt><dd><p>The location of files saved by the GUI during processing will be shown in the mantid
messages log.</p>
<p><em>Note</em>: The locations are shown at “Notice” level, so may not appear if the messages log
is on the incorrect setting.</p>
</dd>
</dl>
</section>
</section>
<section id="run-processing">
<span id="ui-engineering-run-processing"></span><h2><a class="toc-backref" href="#id12" role="doc-backlink">Run Processing</a><a class="headerlink" href="#run-processing" title="Link to this heading">¶</a></h2>
<p>This tab currently provides a graphical interface to create and visualise new calibrations and focussed runs.
It also allows for the loading of GSAS parameter files (<code class="docutils literal notranslate"><span class="pre">.prm</span></code>) created by the calibration process
to load a previously created calibration into the interface.</p>
<p>It also allows for the focusing of data files - summing up spectra in a given region of interest.
To do this a new or existing calibration must be created or loaded</p>
<p>For both calibration and focussing, a vanadium run should also be supplied for normalisation.</p>
<section id="parameters">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Parameters</a><a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>Vanadium Number</dt><dd><p>The run number or file path used to correct the calibration and focused data files.</p>
</dd>
</dl>
<a class="reference internal image-reference" href="../../_images/EngDiff_RunProcessing.png"><img alt="../../_images/EngDiff_RunProcessing.png" class="align-center" src="../../_images/EngDiff_RunProcessing.png" style="width: 600px;" />
</a>
</section>
<section id="calibration">
<span id="ui-engineering-calibration"></span><h3><a class="toc-backref" href="#id14" role="doc-backlink">Calibration</a><a class="headerlink" href="#calibration" title="Link to this heading">¶</a></h3>
<p>When loading an existing calibration, the fields for creating a new calibration will be
automatically filled, allowing the recreation of the workspaces and plots generated by
creating a new calibration.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Plot</span> <span class="pre">Output</span></code> check-box will plot the fitted TOF as a function of d-spacing for the ceria peaks in each group
(typically a bank) when a new calibration is calculated.</p>
<p>Creating a new calibration file generates instrument parameter files for the selected region of interest.
If both banks are selected then two additional <code class="docutils literal notranslate"><span class="pre">.prm</span></code> files are created - one for each individual bank.
The calibration files are written to the directory:</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;CHOSEN_OUTPUT_DIRECTORY&gt;/Calibration/</span></code></p>
<p>If an RB number has been specified the files will also be saved to a user directory
in the base directory:</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;CHOSEN_OUTPUT_DIRECTORY&gt;/User/&lt;RB_NUMBER&gt;/Calibration/</span></code></p>
<p>In the case the ROI being <code class="docutils literal notranslate"><span class="pre">Texture20</span></code> or <code class="docutils literal notranslate"><span class="pre">Texture30</span></code> the files are saved to only one directory (the latter if an RB
number is specified, otherwise the former) - this is to limit the number of files being written.</p>
<section id="cropping">
<h4><a class="toc-backref" href="#id15" role="doc-backlink">Cropping</a><a class="headerlink" href="#cropping" title="Link to this heading">¶</a></h4>
<p>The interface also provides the ability to restrict a new calibration to a particular region of interest:
one of the two banks on ENGIN-X, a custom grouping file (<code class="docutils literal notranslate"><span class="pre">.cal</span></code> or <code class="docutils literal notranslate"><span class="pre">.xml</span></code> files), a list of spectra (referred to as
cropped), <code class="docutils literal notranslate"><span class="pre">Texture20</span></code> grouping (consists of 10 groupings per detector bank - 20 in total) and <code class="docutils literal notranslate"><span class="pre">Texture30</span></code> (15
groupings per detector bank - 30 in total).</p>
</section>
<section id="id1">
<h4><a class="toc-backref" href="#id16" role="doc-backlink">Parameters</a><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>Calibration Sample Number</dt><dd><p>The run number for the calibration sample run (such as ceria) used to calibrate
experiment runs.</p>
</dd>
<dt>Path</dt><dd><p>The path to the GSAS parameter file (<code class="docutils literal notranslate"><span class="pre">.prm</span></code>) to be loaded.</p>
</dd>
<dt>Region Of Interest</dt><dd><p>Select a bank to crop to or specify a custom spectra will be entered.</p>
</dd>
<dt>Custom Grouping File</dt><dd><p>The path to a custom <code class="docutils literal notranslate"><span class="pre">.cal</span></code> or <code class="docutils literal notranslate"><span class="pre">.xml</span></code> file with the desired detector groupings.</p>
</dd>
<dt>Custom Spectra</dt><dd><p>A comma separated list of spectra to restrict the calibration to. Can be provided as single spectrum numbers
or ranges using hyphens (e.g. 14-150, 405, 500-600).</p>
</dd>
</dl>
<a class="reference internal image-reference" href="../../_images/EnggDiffExpectedLinear.png"><img alt="../../_images/EnggDiffExpectedLinear.png" class="align-center" src="../../_images/EnggDiffExpectedLinear.png" style="width: 900px;" />
</a>
</section>
</section>
<section id="focus">
<span id="ui-engineering-focus"></span><h3><a class="toc-backref" href="#id17" role="doc-backlink">Focus</a><a class="headerlink" href="#focus" title="Link to this heading">¶</a></h3>
<p>The data will be focused over the region of interest selected during calibration.
Files can be selected by providing run numbers or selecting the files manually using the browse button.</p>
<p>Ticking the <code class="docutils literal notranslate"><span class="pre">Plot</span> <span class="pre">Focused</span> <span class="pre">Workspace</span></code> checkbox will create a plot of the focused spectra for each of the focused runs
when the algorithm is complete.</p>
<p>Clicking the <code class="docutils literal notranslate"><span class="pre">Focus</span></code> button will begin the focusing algorithm for the selected run files. The button and plotting
checkbox will be disabled until the fitting algorithm is complete.</p>
<p>The focused output files are saved in NeXus, GSS, and TOPAS format. All of these files are saved to:</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;CHOSEN_OUTPUT_DIRECTORY&gt;/Focus/</span></code></p>
<p>If an RB number has been specified the files will also be saved to a user directory:</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;CHOSEN_OUTPUT_DIRECTORY&gt;/User/&lt;RB_NUMBER&gt;/Focus/</span></code></p>
<p>In the case the ROI being <code class="docutils literal notranslate"><span class="pre">Texture20</span></code> or <code class="docutils literal notranslate"><span class="pre">Texture30</span></code> the files are saved to only one directory (the latter if an RB
number is specified, otherwise the former) - this is to limit the number of files being written.</p>
<section id="id2">
<h4><a class="toc-backref" href="#id18" role="doc-backlink">Parameters</a><a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>Sample Run Number</dt><dd><p>The run numbers of or file paths to the data files to be focused.</p>
</dd>
<dt>Chosen Region Of Interest</dt><dd><p>Select which bank to restrict the focusing to or allow for the entry of custom spectra (this is carried over from
the calibration).</p>
</dd>
</dl>
<a class="reference internal image-reference" href="../../_images/EnggDiffExampleFocusOutput.png"><img alt="../../_images/EnggDiffExampleFocusOutput.png" class="align-center" src="../../_images/EnggDiffExampleFocusOutput.png" style="width: 900px;" />
</a>
</section>
</section>
</section>
<section id="absorption-correction">
<span id="ui-engineering-correction"></span><h2><a class="toc-backref" href="#id19" role="doc-backlink">Absorption Correction</a><a class="headerlink" href="#absorption-correction" title="Link to this heading">¶</a></h2>
<p>This tab allows corrections to be applied to the input data files, as well as attaching sample information, such as shape, material and orientation. Additional functionality is to correct experimental intensity for beam divergence and
to calculate a table of attenuation coefficients for a given bin in the spectra.</p>
<a class="reference internal image-reference" href="../../_images/EngDiff_Correction.png"><img alt="../../_images/EngDiff_Correction.png" class="align-center" src="../../_images/EngDiff_Correction.png" style="width: 600px;" />
</a>
<section id="id3">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Parameters</a><a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>Sample Run(s)</dt><dd><p>The run numbers of or file paths to the data files to be corrected.</p>
</dd>
<dt>Reference Workspace</dt><dd><p>The file path to a reference workspace with the default sample information (sample shape in neutral positioner orientation and material)</p>
</dd>
<dt>Orientation File</dt><dd><p>The file path to the orientation data for the experiment. This is either given as a collection of flattened rotation matrices or euler rotation angles</p>
</dd>
<dt>Custom Gauge Volume File</dt><dd><p>File path to an XML file containing a Constructive Solid Geometry description of the gauge volume geometry</p>
</dd>
<dt>Evaluation point</dt><dd><p>Position along the spectra x-axis where the attenuation value saved into the table should be evaluated</p>
</dd>
<dt>Units</dt><dd><p>Unit the x-axis should be in when getting the attenuation at the evaluation point</p>
</dd>
<dt>Incident Horizontal</dt><dd><p>The horizontal component of the divergence of the incident beam (in radians)</p>
</dd>
<dt>Incident Vertical</dt><dd><p>The vertical component of the divergence of the incident beam (in radians)</p>
</dd>
<dt>Detector Horizontal</dt><dd><p>The horizontal component of the divergence of the scattered beam (in radians) - <em>currently this correction assumes this is the same for all detector groups</em></p>
</dd>
</dl>
</section>
<section id="settings-parameters">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Settings Parameters</a><a class="headerlink" href="#settings-parameters" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>Texture Directions</dt><dd><p>Defines the intrinsic directions of the sample, which will be used for plotting and calculating pole figures. The second axis (second row of the matrix) is always the normal to the pole figure plane. Both the vectors and the labels of these axes can be modified here</p>
</dd>
<dt>Monte Carlo Parameters</dt><dd><p>Python dictionary-style string for input parameters to the <a class="reference internal" href="../../algorithms/MonteCarloAbsorption-v1.html#algm-montecarloabsorption"><span class="std std-ref">MonteCarloAbsorption v1</span></a> algorithm, where keywords and values are given as <code class="docutils literal notranslate"><span class="pre">keyword1:value1,</span> <span class="pre">keyword2,</span> <span class="pre">value2</span></code></p>
</dd>
<dt>Remove File from ADS after processing</dt><dd><p>Flag for whether the calculated corrected workspaces need to be kept in the ADS (flagging them for removal frees up system memory)</p>
</dd>
<dt>Orientation File is Euler Angles</dt><dd><p>Flag for notifying whether the orientation file which will be provided in the correction tab is a text file with euler angles or whether each line is a flattened matrix</p>
</dd>
<dt>Euler Angle Scheme</dt><dd><p>Lab-frame axes that the euler angles are defined along, when in neutral position</p>
</dd>
<dt>Euler Angles Sense</dt><dd><p>The sense of the rotation around each euler axis where 1 is counter clockwise and -1 is clockwise</p>
</dd>
</dl>
</section>
<section id="buttons-functions">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Buttons/Functions</a><a class="headerlink" href="#buttons-functions" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>Browse</dt><dd><p>Opens a file navigator to find desired file</p>
</dd>
<dt>Load Files</dt><dd><p>Loads the selected sample runs into the table</p>
</dd>
<dt>Select All</dt><dd><p>Sets all of the loaded workspaces in the table to selected</p>
</dd>
<dt>Deselect All</dt><dd><p>Sets all of the loaded workspaces in the table to unselected</p>
</dd>
<dt>Delete Selected Files</dt><dd><p>Deletes all of the loaded files, which are set as selected, from the table</p>
</dd>
<dt>View/View Shape</dt><dd><p>Pops up a plot of the sample shape on a given workspace, along with the relative orientation of sample axes (defined in the settings)</p>
</dd>
</dl>
<a class="reference internal image-reference" href="../../_images/EngDiff_sample_view.png"><img alt="../../_images/EngDiff_sample_view.png" class="align-center" src="../../_images/EngDiff_sample_view.png" style="width: 500px;" />
</a>
<dl class="simple">
<dt>Create Reference Workspace</dt><dd><p>Creates an empty workspace that can hold the reference sample information that can then be copied onto each experimental workspace</p>
</dd>
<dt>Set Reference Orientation</dt><dd><p>Allows an initial orientation to be applied to the reference shape to align it correctly with the experimental sample upon a positioner with neutral/default/homed motor values</p>
</dd>
<dt>Save Reference Workspace</dt><dd><p>Saves the reference workspace into the experimental data folder</p>
</dd>
<dt>Load Reference</dt><dd><p>Loads a reference workspace from provided file path</p>
</dd>
<dt>Load Shape onto Single WS</dt><dd><p>Opens dialog for <a class="reference internal" href="../../algorithms/LoadSampleShape-v1.html#algm-loadsampleshape"><span class="std std-ref">LoadSampleShape v1</span></a>, allows loading of STL sample shape onto the reference/experimental workspaces</p>
</dd>
<dt>Set Shape onto Single WS</dt><dd><p>Opens dialog for <a class="reference internal" href="../../algorithms/CreateSampleShape-v1.html#algm-createsampleshape"><span class="std std-ref">CreateSampleShape v1</span></a>, allows defining sample shape onto the reference/experimental workspaces using constructive solid geometry XML string</p>
</dd>
<dt>Set Sample Material</dt><dd><p>Opens dialog for <a class="reference internal" href="../../algorithms/SetSampleMaterial-v1.html#algm-setsamplematerial"><span class="std std-ref">SetSampleMaterial v1</span></a>, allows definition of sample material properties onto the reference/experimental workspaces</p>
</dd>
<dt>Set Single Orientation</dt><dd><p>Opens dialog for <a class="reference internal" href="../../algorithms/SetGoniometer-v1.html#algm-setgoniometer"><span class="std std-ref">SetGoniometer v1</span></a>, allows definition of sample orientation onto individual experimental workspaces</p>
</dd>
<dt>Load Orientation File</dt><dd><p>Reads the provided orientation file and sets the orientation provided in each line onto the selected workspaces in turn</p>
</dd>
<dt>Copy Reference Sample</dt><dd><p>Copies the sample information from the reference workspace onto all of the selected workspaces</p>
</dd>
<dt>Copy WS Sample</dt><dd><p>Copies the sample information from the workspace in the dropdown menu onto all of the selected workspaces</p>
</dd>
<dt>Apply Correction</dt><dd><p>Applies all the flagged corrections according to the provided parameters onto each selected workspace in turn, saving the resulting workspaces in the indicated save directory</p>
</dd>
</dl>
</section>
</section>
<section id="fitting">
<span id="ui-engineering-fitting"></span><h2><a class="toc-backref" href="#id23" role="doc-backlink">Fitting</a><a class="headerlink" href="#fitting" title="Link to this heading">¶</a></h2>
<p>This tab will allow for plotting and peak fitting of focused run files.</p>
<a class="reference internal image-reference" href="../../_images/EngDiff_Fitting.png"><img alt="../../_images/EngDiff_Fitting.png" class="align-center" src="../../_images/EngDiff_Fitting.png" style="width: 600px;" />
</a>
<p>Focused run files can be loaded from the file system into mantid from the interface. The interface will keep track of all the
workspaces that it has created from these files. When a focused run is loaded, the proton charge weighted average (and standard deviation) of the log values set in the
settings options are calculated and stored in a grouped workspace accessible in the main mantid window.</p>
<p>Loaded workspaces can be plotted in the interface and the mantid fitting capability can be accessed from the ‘Fit’ button on the plot toolbar.
This allows for the user to select peaks of any supported type (the default is <a class="reference internal" href="../../fitting/fitfunctions/BackToBackExponential.html#func-backtobackexponential"><span class="std std-ref">BackToBackExponential</span></a>) by right-clicking on the plot. The initial parameters can be varied interactively by dragging sliders (vertical lines on the plot).
After a successful fit the best-fit model is stored as a setup in the fit browser (Setup &gt; Custom Setup) with the name of the workspace fitted.
Selecting this loads the function and the parameters and the curve can be inspected by doing Display &gt; Plot Guess.</p>
<p>The output from the fit is stored in a group of workspaces that contains a matrix workspace of the fit value and error for each parameter in the model. If there is more than one of the same function, the parameters are stored in the same workspace with different x-values. For example, if there were two Gaussian peaks then there would be a workspace for each parameter of the Gaussian (i.e. Height, PeakCentre, Sigma) each of which will have two columns corresponding to each peak. Each workspace has a spectra per run loaded (each row in the table of the UI fitting tab). In general different models/functions could be fitted to each run, so when there is a parameter that does not exist for a run (or that run has not yet been fitted), the Y and E fields in the relevant row are filled with NaNs. The group of fit workspaces also contains a table workspace that stores the model string that can be copied into the fit browser (Setup &gt; Manage Setup &gt; Load From String).</p>
<p>The workspaces can be fitted sequentially (sorted by the average of a chosen log in the settings) or serially (fitted with the same initial parameters).
If a valid model is present in the fit browser then the Sequential Fit and Serial Fit buttons (on the plot toolbar) will be enabled - it is not necessary to run an initial fit.</p>
<p>The user may want to fix or constrain certain model parameters, which can be done in the usual way in the fit browser. The sequential fit will populate the fit tables as above and store the model in the Custom Setups.</p>
<section id="id4">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">Parameters</a><a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>Focused Run Files</dt><dd><p>A comma separated list of files to load. Selecting files from the file system using the browse button will do this
for you.</p>
</dd>
<dt>File Filters</dt><dd><p>Choose to filter by xunit (TOF or d-spacing) and region of interest (e.g. North Bank).</p>
</dd>
</dl>
</section>
</section>
<section id="texture-pole-figure">
<span id="ui-engineering-texture"></span><h2><a class="toc-backref" href="#id25" role="doc-backlink">Texture (Pole Figure)</a><a class="headerlink" href="#texture-pole-figure" title="Link to this heading">¶</a></h2>
<p>This tab allows data to be reduced into pole figure tables, comprising of alpha and beta angles (location of detector
group relative to sample axes in spherical coordinates) and an optional attached value for that detector group.
The tab also plots these pole figure tables as a pole figure in the panel beneath.</p>
<a class="reference internal image-reference" href="../../_images/EngDiff_Texture.png"><img alt="../../_images/EngDiff_Texture.png" class="align-center" src="../../_images/EngDiff_Texture.png" style="width: 600px;" />
</a>
<section id="id5">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">Parameters</a><a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>Sample Run(s)</dt><dd><p>The run numbers of or file paths to the data files.</p>
</dd>
<dt>Fit Parameters</dt><dd><p>The workspace names of or file paths to the Table Workspaces with the values to be added to the pole figure table -
expected to have one row per spectra in the corresponding workspace.</p>
</dd>
<dt>Lattice</dt><dd><p>String representation of the crystal lattice (eg. <code class="docutils literal notranslate"><span class="pre">2.8665</span>&#160; <span class="pre">2.8665</span>&#160; <span class="pre">2.866</span></code>, see
<a class="reference internal" href="../../concepts/CrystalStructureAndReflections.html#crystal-structure-and-reflections"><span class="std std-ref">Crystal Structure concept page</span></a>)</p>
</dd>
<dt>Space Group</dt><dd><p>String representation of the crystal space group (eg. <code class="docutils literal notranslate"><span class="pre">I</span> <span class="pre">m</span> <span class="pre">-3</span> <span class="pre">m</span></code>, see
<a class="reference internal" href="../../concepts/CrystalStructureAndReflections.html#crystal-structure-and-reflections"><span class="std std-ref">Crystal Structure concept page</span></a>)</p>
</dd>
<dt>Basis</dt><dd><p>String representation of the crystal basis (eg. <code class="docutils literal notranslate"><span class="pre">Fe</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">1.0</span> <span class="pre">0.05;</span> <span class="pre">Fe</span> <span class="pre">0.5</span> <span class="pre">0.5</span> <span class="pre">0.5</span> <span class="pre">1.0</span> <span class="pre">0.05</span></code>, see
<a class="reference internal" href="../../concepts/CrystalStructureAndReflections.html#crystal-structure-and-reflections"><span class="std std-ref">Crystal Structure concept page</span></a>)</p>
</dd>
<dt>HKL</dt><dd><p>The HKL of the reflection that has been fit</p>
</dd>
<dt>Projection</dt><dd><p>The 2D projection method of displaying the Pole Figure Table data (options are azimuthal or stereographic)</p>
</dd>
<dt>Parameter Readout Column</dt><dd><p>Which column of the parameter table workspaces to read to find the values which should be included in the pole
figure table</p>
</dd>
</dl>
</section>
<section id="id6">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">Settings Parameters</a><a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>Cost Function Threshold</dt><dd><p>The maximum cost function value for a given spectra’s fit to be plotted in the pole figure</p>
</dd>
<dt>Peak Position Threshold</dt><dd><p>The maximum deviation in peak position from the expected position for a given spectra’s fit to be plotted in the
pole figure. Expected position is either mean of all peaks or, if provided, peak position of given HKL</p>
</dd>
<dt>Scatter Plot Experimental Pole Figure</dt><dd><p>Flag for whether the experimental pole figure should have individual detector groups plotted as scatter points
(checked), or should be interpolated and given as a contour plot (unchecked)</p>
</dd>
<dt>Contour Kernel Size</dt><dd><p>Sigma value of the gaussian smoothing kernel applied before the interpolation</p>
</dd>
</dl>
</section>
<section id="id7">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">Buttons/Functions</a><a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>Load Workspace Files</dt><dd><p>Loads the selected sample runs into the table</p>
</dd>
<dt>Load Parameter Files</dt><dd><p>Loads the selected table workspaces into the table, assigning them to each row currently without an assigned table,
in turn</p>
</dd>
<dt>Select All Files</dt><dd><p>Sets all the rows of the table as selected</p>
</dd>
<dt>Deselect All Files</dt><dd><p>Sets all the rows of the table as unselected</p>
</dd>
<dt>Delete All Selected Files</dt><dd><p>Deletes all rows of the table which are set as selected</p>
</dd>
<dt>Delete All Selected Parameter Files</dt><dd><p>Removes all the set parameter files for the rows of the table that have been selected</p>
</dd>
<dt>View Shape</dt><dd><p>Pops up a plot of the sample shape on a given workspace, along with the relative orientation of sample axes (defined
in the settings)</p>
</dd>
</dl>
<a class="reference internal image-reference" href="../../_images/EngDiff_sample_view.png"><img alt="../../_images/EngDiff_sample_view.png" class="align-center" src="../../_images/EngDiff_sample_view.png" style="width: 500px;" />
</a>
<dl class="simple">
<dt>Set Crystal</dt><dd><p>Takes the crystal structure defined in either the CIF or the lattice/space group/basis inputs and applies it to the
workspace in the drop down menu</p>
</dd>
<dt>Set Crystal to All</dt><dd><p>Takes the crystal structure defined in either the CIF or the lattice/space group/basis inputs and applies it to all
the selected workspaces</p>
</dd>
<dt>Calculate Pole Figure</dt><dd><p>Creates the pole figure tables and plots the corresponding pole figure</p>
</dd>
</dl>
</section>
</section>
<section id="gsas-ii-refinement">
<span id="ui-engineering-gsas"></span><h2><a class="toc-backref" href="#id29" role="doc-backlink">GSAS-II Refinement</a><a class="headerlink" href="#gsas-ii-refinement" title="Link to this heading">¶</a></h2>
<p>This tab calls GSAS-II python interface (path to GSAS-II supplied by the user in the interface settings).
Currently only Pawley refinements are supported and the lattice parameters in the <code class="docutils literal notranslate"><span class="pre">.cif</span></code> phase file can be overidden.</p>
<section id="id8">
<h3><a class="toc-backref" href="#id30" role="doc-backlink">Parameters</a><a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>Project Name</dt><dd><p>Name of the GSAS project file.</p>
</dd>
<dt>Instrument Group</dt><dd><p>Path to <code class="docutils literal notranslate"><span class="pre">.prm</span></code> file produced by the Calibration tab (only one instrument file is supported and will be applied to
each data file)</p>
</dd>
<dt>Phase</dt><dd><p>Path to the <code class="docutils literal notranslate"><span class="pre">.cif</span></code> file defining the initial crystal structure (more than one path can be supplied, the lattice
parameters will be overridden for the first phase only).</p>
</dd>
<dt>Focused Data</dt><dd><p>Path to focused <code class="docutils literal notranslate"><span class="pre">.gss</span></code> files (note it should have the same number of spectra as in <code class="docutils literal notranslate"><span class="pre">.prm</span></code> file and contains multiple
banks)</p>
</dd>
<dt>Refinement Method</dt><dd><p>Only Pawley refinement currently supported</p>
</dd>
<dt>Override Unit Cell Length</dt><dd><p>Lattice parameters (a, b, c, alpha, beta, gamma) can be supplied to overwrite the lattice parameters in the first
<code class="docutils literal notranslate"><span class="pre">.cif</span></code> file</p>
</dd>
</dl>
<p>Refine Microstrain</p>
<p>Refine Sigma_1</p>
<p>Refine Gamma</p>
<a class="reference internal image-reference" href="../../_images/EngDiff_GSASII.png"><img alt="../../_images/EngDiff_GSASII.png" class="align-center" src="../../_images/EngDiff_GSASII.png" style="width: 600px;" />
</a>
<p><strong>Categories</strong>: <a class="reference external" href="../ILL/categories/Interfaces.html">Interfaces</a> | <a class="reference external" href="../../algorithms/categories/Diffraction.html">Diffraction</a></p>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul id="footer-nav" class="nav navbar-nav">
      
      
          
            
  <li>
    <a href="../isis_sans/sans_save_other.html" title="Previous Chapter: Save Other"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Save Other</span>
    </a>
  </li>
  <li>
    <a href="HFIR%20Single%20Crystal%20Reduction.html" title="Next Chapter: HFIR Single Crystal Reduction Interface"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">HFIR Single C... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>