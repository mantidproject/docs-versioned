<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>AlgoTimeRegister</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/bootstrap-sphinx.css?v=4468db6d" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css?v=9aca6aaf" />
    <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
    <script src="../../../../_static/documentation_options.js?v=2d21b807"></script>
    <script src="../../../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Algorithm" href="Algorithm.html" />
    <link rel="prev" title="mantid.api" href="index.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





<nav id="navbar" class="navbar navbar-default navbar-fixed-top">
  <div id="navbar-main" class="container">
    <ul class="nav navbar-nav">
      
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <li>
        <a class="navbar-brand" href="http://www.mantidproject.org">
         </a>
      </li>
      <span class="navbar-text navbar-version pull-left"><b>6.15</b></span>
    </ul>

    
    <div class="collapse navbar-collapse nav-collapse">
    
      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        
          <li>
            <a href="https://www.mantidproject.org">Home</a>
          </li>
          <li>
            <a href="https://download.mantidproject.org">Download</a>
          </li>
          <li>
            <a href="https://docs.mantidproject.org">Documentation</a>
          </li>
          <li>
            <a href="https://www.mantidproject.org/contact">Contact Us</a>
          </li>
        
        
          
          
        
        
        
        
      </ul>
            
<form class="navbar-form navbar-right" action="../../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          </div>
  </div> <!-- /navbar-main -->
<div id="navbar-breadcrumbs" class="related" role="navigation" aria-label="related navigation">
  <h3>Navigation</h3>
  <ul>
    <li class="nav-item nav-item-0">
      <a href="../../../../index.html">Documentation</a>
         &#187;
    </li>
    
    <li class="nav-item nav-item-1">
      <a href="../../../index.html" >
        API
      </a>
       &#187;
    </li>
    
    <li class="nav-item nav-item-2">
      <a href="../../index.html" >
        Python API
      </a>
       &#187;
    </li>
    
    <li class="nav-item nav-item-3">
      <a href="../index.html" >
        <code class="xref py py-mod docutils literal notranslate"><span class="pre">mantid</span></code> — Framework package
      </a>
       &#187;
    </li>
    
    <li class="nav-item nav-item-4">
      <a href="index.html" accesskey="U">
        <code class="xref py py-mod docutils literal notranslate"><span class="pre">mantid.api</span></code>
      </a>
       &#187;
    </li>
    
    
    
    
    <li class="nav-item nav-item-this">
      <a href="">AlgoTimeRegister</a>
    </li>
    
    
  </ul>
</div>
</nav>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="algotimeregister">
<span id="id1"></span><h1>AlgoTimeRegister<a class="headerlink" href="#algotimeregister" title="Link to this heading">¶</a></h1>
<p>This is a Python binding to the C++ class Mantid::Instrumentation::AlgoTimeRegister.</p>
<p><em>bases:</em> <a class="reference internal" href="#mantid.api.AlgoTimeRegisterImpl" title="mantid.api.AlgoTimeRegisterImpl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mantid.api.AlgoTimeRegisterImpl</span></code></a></p>
<dl class="py class">
<dt class="sig sig-object py" id="mantid.api.AlgoTimeRegisterImpl">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">mantid.api.</span></span><span class="sig-name descname"><span class="pre">AlgoTimeRegisterImpl</span></span><a class="headerlink" href="#mantid.api.AlgoTimeRegisterImpl" title="Link to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="mantid.api.AlgoTimeRegisterImpl.Instance">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">Instance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">AlgoTimeRegisterImpl</span> <span class="pre">:</span></span></span><a class="headerlink" href="#mantid.api.AlgoTimeRegisterImpl.Instance" title="Link to this definition">¶</a></dt>
<dd><p>Returns a reference to the AlgoTimeRegister</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mantid.api.AlgoTimeRegisterImpl.addTime">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">addTime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">(str)name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">(int)begin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">(int)end</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span> <span class="pre">:</span></span></span><a class="headerlink" href="#mantid.api.AlgoTimeRegisterImpl.addTime" title="Link to this definition">¶</a></dt>
<dd><p>Adds a time entry in the file for a function with &lt;name&gt; that starts at &lt;begin&gt; time_ns and ends at &lt;end&gt; time_ns relative to the &lt;START_POINT&gt; clock</p>
</dd></dl>

</dd></dl>

<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p>In the beggining of the script, initialize <code class="xref py py-obj docutils literal notranslate"><span class="pre">AlgoTimeRegister</span></code> to start the clock (START_POINT).
Then use python <cite>time</cite> (time.time_ns()) to measure time (start_time and end_time in nanoseconds) and a function (name).
Afterwards, call <code class="xref py py-obj docutils literal notranslate"><span class="pre">addTime()</span></code> to store
them in the <cite>performancelog.filename</cite> log file when <cite>performancelog.write</cite> is activated (defined at <cite>Mantid.user.properties</cite> file)
in the following format:</p>
<p>ThreadID=&lt;thread_id&gt;, AlgorithmName=&lt;name&gt;, StartTime=&lt;start_time&gt;, EndTime=&lt;end_time&gt;</p>
<p><strong>Example 1 - Use AlgoTimeRegister to measure time - default case:</strong>
This example shows the initialization process and adding a time entry</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># use python time module to measure time in nanoseconds</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1">#initialize the clock *once*</span>
<span class="n">AlgoTimeRegister</span><span class="o">.</span><span class="n">Instance</span><span class="p">()</span>

<span class="c1"># get start time in nanoseconds before calling the function of interest</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span>

<span class="c1"># execute the function</span>
<span class="n">demo_function</span><span class="p">()</span>

<span class="c1"># get end time in nanoseconds after it is completed</span>
<span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span>

<span class="c1"># store the time log</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;demo_function&quot;</span>
<span class="n">AlgoTimeRegister</span><span class="o">.</span><span class="n">addTime</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">start_time</span><span class="p">,</span><span class="n">end_time</span><span class="p">)</span>
</pre></div>
</div>
<p>Example Output at <cite>Mantid.user.properties.performance.filename</cite> file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>START_POINT: 1728507408768867137 MAX_THREAD: 12
ThreadID=124522639565888, AlgorithmName=demo_function, StartTime=144539, EndTime=1346405816
</pre></div>
</div>
<p><strong>Example 2 - Use AlgoTimeRegister to measure time - overwrite the performance.log file:</strong>
The performance configuration can be overwritten in the script, by defining a custom <cite>performancelog.filename</cite>
and calling evertyhing within the <cite>amend_config</cite> with block.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define `performancelog.filenamer` filepath for ta particular script
performance_config = {&quot;performancelog.write&quot;: &quot;On&quot;, &quot;performancelog.filename&quot;: &lt;custom filepath&gt;}
with amend_config(**performance_config):
    # use python time module to measure time in nanoseconds
    import time

    #initialize the clock *once*
    AlgoTimeRegister.Instance()

    # get start time in nanoseconds before calling the function of interest
    start_time = time.time_ns()

    # execute the function
    demo_function()

    # get end time in nanoseconds after it is completed
    end_time = time.time_ns()

    # store the time log
    name = &quot;demo_function&quot;
    AlgoTimeRegister.addTime(name,start_time,end_time)
</pre></div>
</div>
<p>Example Output at <cite>performance_config.performance.filename</cite> file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>START_POINT: 1728507555711066754 MAX_THREAD: 12
ThreadID=139238466401344, AlgorithmName=demo_function, StartTime=144981, EndTime=4115162290
</pre></div>
</div>
<p><strong>Example 3 - Use AlgoTimeRegister to measure time - initialization omitted:</strong>
The <code class="xref py py-obj docutils literal notranslate"><span class="pre">AlgoTimeRegister</span></code> initialization can be omitted,
if a Mantid algorithm is the first command in the script and the time before this is not needed.
In any other case, initialization should be specified very eary on, in the script.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># use python time module to measure time in nanoseconds</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1">#call algorithm, clock initialization</span>
<span class="c1">#internally it calls AlgoTimeRegister.addTime</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>

<span class="c1"># get start time in nanoseconds before calling the function of interest</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span>

<span class="c1"># execute the function</span>
<span class="n">demo_function</span><span class="p">()</span>

<span class="c1"># get end time in nanoseconds after it is completed</span>
<span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span>

<span class="c1"># store the time log</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;demo_function&quot;</span>
<span class="n">AlgoTimeRegister</span><span class="o">.</span><span class="n">addTime</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">start_time</span><span class="p">,</span><span class="n">end_time</span><span class="p">)</span>
</pre></div>
</div>
<p>Example Output at <cite>Mantid.user.properties.performance.filename</cite> file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>START_POINT: 1728507650978221781 MAX_THREAD: 12
ThreadID=138583991714880, AlgorithmName=CreateSampleWorkspace, StartTime=154046, EndTime=1818067
ThreadID=138583991714880, AlgorithmName=demo_function, StartTime=2044656, EndTime=4117415173
</pre></div>
</div>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul id="footer-nav" class="nav navbar-nav">
      
      
          
            
  <li>
    <a href="index.html" title="Previous Chapter: mantid.api"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; mantid.api</span>
    </a>
  </li>
  <li>
    <a href="Algorithm.html" title="Next Chapter: Algorithm"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Algorithm &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>