<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>CalculateCarpenterSampleCorrection v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CalculateChiSquared v1" href="CalculateChiSquared-v1.html" />
    <link rel="prev" title="CalMuonDetectorPhases v1" href="CalMuonDetectorPhases-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.6</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">CalculateCarpenterSampleCorrection v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="calculatecarpentersamplecorrection-v1">
<span id="algm-calculatecarpentersamplecorrection"></span><span id="algm-calculatecarpentersamplecorrection-v1"></span><h1>CalculateCarpenterSampleCorrection v1<a class="headerlink" href="#calculatecarpentersamplecorrection-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id10">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/CalculateCarpenterSampleCorrection-v1_dlg.png"><img alt="../_images/CalculateCarpenterSampleCorrection-v1_dlg.png" class="screenshot" src="../_images/CalculateCarpenterSampleCorrection-v1_dlg.png" style="width: 303px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>CalculateCarpenterSampleCorrection</strong> dialog.</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id11">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id12">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id13">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id14">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id15">Usage</a></p></li>
<li><p><a class="reference internal" href="#references" id="id16">References</a></p></li>
<li><p><a class="reference internal" href="#source" id="id17">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Calculates both absorption  and multiple scattering corrections, originally used to correct vanadium spectrum at IPNS.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="CarpenterSampleCorrection-v1.html#algm-carpentersamplecorrection"><span class="std std-ref">CarpenterSampleCorrection</span></a>, <a class="reference internal" href="CylinderAbsorption-v1.html#algm-cylinderabsorption"><span class="std std-ref">CylinderAbsorption</span></a>, <a class="reference internal" href="MonteCarloAbsorption-v1.html#algm-montecarloabsorption"><span class="std std-ref">MonteCarloAbsorption</span></a>, <a class="reference internal" href="MayersSampleCorrection-v1.html#algm-mayerssamplecorrection"><span class="std std-ref">MayersSampleCorrection</span></a>, <a class="reference internal" href="PearlMCAbsorption-v1.html#algm-pearlmcabsorption"><span class="std std-ref">PearlMCAbsorption</span></a>, <a class="reference internal" href="VesuvioCalculateMS-v1.html#algm-vesuviocalculatems"><span class="std std-ref">VesuvioCalculateMS</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the input workspace.</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspaceBaseName</p></td>
<td><p>Output</p></td>
<td><p>WorkspaceGroup</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Basename of the output workspace group for corrections.Absorption suffix = ‘_abs’. Multiple Scattering suffix = ‘_ms’.</p></td>
</tr>
<tr class="row-even"><td><p>AttenuationXSection</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>2.8</p></td>
<td><p>Coefficient 1, absorption cross section / 1.81 if not set with SetSampleMaterial</p></td>
</tr>
<tr class="row-odd"><td><p>ScatteringXSection</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>5.1</p></td>
<td><p>Coefficient 3, total scattering cross section if not set with SetSampleMaterial</p></td>
</tr>
<tr class="row-even"><td><p>SampleNumberDensity</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.0721</p></td>
<td><p>Coefficient 2, density if not set with SetSampleMaterial</p></td>
</tr>
<tr class="row-odd"><td><p>CylinderSampleRadius</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.3175</p></td>
<td><p>Sample radius, in cm</p></td>
</tr>
<tr class="row-even"><td><p>Absorption</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>If True then calculates the absorption correction.</p></td>
</tr>
<tr class="row-odd"><td><p>MultipleScattering</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>If True then calculates the  multiple scattering correction.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This algorithm is a port to C++ of a multiple scattering absorption
correction, used to correct the vanadium spectrum for the GPPD
instrument at the IPNS. The correction calculation was originally worked
out by Jack Carpenter and Asfia Huq and implemented in Java by Alok
Chatterjee. The java code was translated to C++ in Mantid by Dennis
Mikkelson.</p>
<ul class="simple">
<li><p>Elastic scattering is assumed</p></li>
</ul>
<p>In <a class="footnote-reference brackets" href="#id5" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> we see that the calculation of the attenuation factor F involves
an integral over the sample cylinder. By expanding the integrands as a power series,
we can factor out any dependence on scattering cross section and radius.
These integral terms are denoted by <span class="math notranslate nohighlight">\(Z_{mn}\)</span> and so we may write:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{F} = \sum_{m=0}^\infty\sum_{n=0}^\infty\frac{(-1)^{m+n}}{m!n!}(\mu R)^{m+n} Z_{mn}(\theta)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> is the inverse scattering length.</p>
<p>The functions <span class="math notranslate nohighlight">\(Z_{mn}(\theta)\)</span> are written in terms of Chebyshev
expansion coefficients:</p>
<div class="math notranslate nohighlight">
\[Z_{mn}(\theta) = \sum_{s=0}^\infty c_{s}(m,n)cos(s\theta)\]</div>
<p>where the Chebyshev coefficients <span class="math notranslate nohighlight">\(c_{s}(m,n)\)</span> up to  m + n
<span class="math notranslate nohighlight">\(\leqslant\)</span> 5 have been tabulated and are stored as an array by the algorithm.</p>
<p>This version of the correction follows the implementation in <a class="footnote-reference brackets" href="#id5" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> in that it only calculates for the correction in-plane, unlike <a class="footnote-reference brackets" href="#id7" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>, <a class="footnote-reference brackets" href="#id9" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> that generalizes the correction to out-of-plane.</p>
<p>This algorithm calculates and outputs the absorption and/or multiple scattering correction workspaces to be applied to the InputWorkspace. Thus, there are, at most, two workspaces in the OutputWorkspaceBaseName group workspace. This allows for flexibility of applying either correction to a workspace without having to apply both (as is the case with <a class="reference internal" href="CarpenterSampleCorrection-v1.html#algm-carpentersamplecorrection"><span class="std std-ref">CarpenterSampleCorrection v1</span></a>). For the case where both corrections are calculated, the output will be the following:</p>
<ol class="arabic simple">
<li><p>The absorption correction workspace will be OutputWorkspaceBaseName + <cite>_abs</cite> and will be in <cite>.getItem(0)</cite>.</p></li>
<li><p>The multiple scattering correction workspace will be OutputWorkspaceBaseName + <cite>_ms</cite> and will be in <cite>.getItem(1)</cite>.</p></li>
</ol>
<p>This is the child algorithm that <a class="reference internal" href="CarpenterSampleCorrection-v1.html#algm-carpentersamplecorrection"><span class="std std-ref">CarpenterSampleCorrection v1</span></a> (previously known as <em>MultipleScatteringCylinderAbsorption</em>) uses to calculate and apply the correction to a sample workspace.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example: Calculate corrections for a simple cylindrical sample</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="s2">&quot;Histogram&quot;</span><span class="p">,</span><span class="n">NumBanks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">BankPixelWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">ConvertUnits</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="s2">&quot;Wavelength&quot;</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">Rebin</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">Params</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">SetSampleMaterial</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">ChemicalFormula</span><span class="o">=</span><span class="s2">&quot;V&quot;</span><span class="p">)</span>

<span class="c1">#restrict the number of wavelength points to speed up the example</span>
<span class="n">wsOut</span> <span class="o">=</span> <span class="n">CalculateCarpenterSampleCorrection</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">CylinderSampleRadius</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Absorption Correction Output:  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsOut</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multiply Scattering Correction Output:  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsOut</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Absorption Correction Output:  [ 0.85283805  0.79620318  0.74348494  0.69440412  0.64870017  0.62121997]
Multiply Scattering Correction Output:  [ 0.09633662  0.09991619  0.1034959   0.10705826  0.11058382  0.11280196]
</pre></div>
</div>
<p>To reproduce what <a class="reference internal" href="CarpenterSampleCorrection-v1.html#algm-carpentersamplecorrection"><span class="std std-ref">CarpenterSampleCorrection v1</span></a> does, you can calculate and apply the correction as follows</p>
<p><strong>Example: Apply correction for a simple cylindrical sample using getItem</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="s2">&quot;Histogram&quot;</span><span class="p">,</span><span class="n">NumBanks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">BankPixelWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">ConvertUnits</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="s2">&quot;Wavelength&quot;</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">Rebin</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">Params</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">SetSampleMaterial</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">ChemicalFormula</span><span class="o">=</span><span class="s2">&quot;V&quot;</span><span class="p">)</span>

<span class="n">corrections</span> <span class="o">=</span> <span class="n">CalculateCarpenterSampleCorrection</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">CylinderSampleRadius</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Get absorption correction</span>
<span class="n">absCorr</span> <span class="o">=</span> <span class="n">corrections</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Get multiple scattering correction</span>
<span class="n">msFactor</span>  <span class="o">=</span> <span class="n">corrections</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">msCorr</span> <span class="o">=</span> <span class="n">Multiply</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">msFactor</span><span class="p">)</span>

<span class="c1"># Apply absorption correction to workspace</span>
<span class="n">ws_abs_corrected</span> <span class="o">=</span> <span class="n">Divide</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">absCorr</span><span class="p">)</span>

<span class="c1"># Apply multiple scattering correction to workspace</span>
<span class="n">ws_ms_corrected</span> <span class="o">=</span> <span class="n">Minus</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">msCorr</span><span class="p">)</span>

<span class="c1"># Apply both corrections</span>
<span class="n">wsOut</span> <span class="o">=</span> <span class="n">Minus</span><span class="p">(</span><span class="n">ws_abs_corrected</span><span class="p">,</span> <span class="n">msCorr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Absorption Corrected Output:  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws_abs_corrected</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multiple Scattering Corrected Output:  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws_ms_corrected</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Combined Corrected Output:  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Absorption Corrected Output:  [  6.66892661   7.14329517  21.0999759    8.1904963    8.76755487
   2.51509668]
Multiple Scattering Corrected Output:  [  5.13959844   5.11923959  14.06392099   5.07861898   5.05856725
   1.38618331]
Combined Corrected Output:  [  6.1210107    6.57502041  19.47638255   7.58160094   8.13860778
   2.33885171]
</pre></div>
</div>
<p><strong>Example: Apply correction for a simple cylindrical sample using getItem</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="s2">&quot;Histogram&quot;</span><span class="p">,</span><span class="n">NumBanks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">BankPixelWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">ConvertUnits</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="s2">&quot;Wavelength&quot;</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">Rebin</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">Params</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">SetSampleMaterial</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">ChemicalFormula</span><span class="o">=</span><span class="s2">&quot;V&quot;</span><span class="p">)</span>

<span class="c1">#restrict the number of wavelength points to speed up the example</span>
<span class="n">basename</span> <span class="o">=</span> <span class="s2">&quot;corrections&quot;</span>
<span class="n">CalculateCarpenterSampleCorrection</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">OutputWorkspaceBaseName</span><span class="o">=</span><span class="n">basename</span><span class="p">,</span>
                                   <span class="n">CylinderSampleRadius</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Get absorption correction</span>
<span class="n">absCorr</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="n">basename</span><span class="o">+</span><span class="s2">&quot;_abs&quot;</span><span class="p">]</span>

<span class="c1"># Get multiple scattering correction</span>
<span class="n">msFactor</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="n">basename</span><span class="o">+</span><span class="s2">&quot;_ms&quot;</span><span class="p">]</span>
<span class="n">msCorr</span> <span class="o">=</span> <span class="n">Multiply</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">msFactor</span><span class="p">)</span>

<span class="c1"># Apply absorption correction to workspace</span>
<span class="n">ws_abs_corrected</span> <span class="o">=</span> <span class="n">Divide</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">absCorr</span><span class="p">)</span>

<span class="c1"># Apply multiple scattering correction to workspace</span>
<span class="n">ws_ms_corrected</span> <span class="o">=</span> <span class="n">Minus</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">msCorr</span><span class="p">)</span>

<span class="c1"># Apply both corrections</span>
<span class="n">wsOut</span> <span class="o">=</span> <span class="n">Minus</span><span class="p">(</span><span class="n">ws_abs_corrected</span><span class="p">,</span> <span class="n">msCorr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Absorption Corrected Output:  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws_abs_corrected</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multiple Scattering Corrected Output:  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws_ms_corrected</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Combined Corrected Output:  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Absorption Corrected Output:  [  6.66892661   7.14329517  21.0999759    8.1904963    8.76755487
   2.51509668]
Multiple Scattering Corrected Output:  [  5.13959844   5.11923959  14.06392099   5.07861898   5.05856725
   1.38618331]
Combined Corrected Output:  [  6.1210107    6.57502041  19.47638255   7.58160094   8.13860778
   2.33885171]
</pre></div>
</div>
</section>
<section id="references">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">References</a><a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id5" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id2">2</a>)</span>
<p>J.M. Carpenter <em>Attenuation Correction Factor for Scattering from Cylindrical Targets</em> Review of Scientific Instruments <strong>40.4</strong> (1969): 555. doi: <a class="reference external" href="http://dx.doi.org/10.1063/1.1684003">10.1063/1.1684003</a></p>
</aside>
<aside class="footnote brackets" id="id7" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p>D.F.R. Mildner, J.M. Carpenter, and C.A. Pelizzari <em>Generalized Attenuation Correction Factor for Scattering from Cylindrical Targets</em> Review of Scientific Instruments <strong>45.4</strong> (1974): 572. doi: <a class="reference external" href="http://dx.doi.org/10.1063/1.1686687">10.1063/1.1686687</a></p>
</aside>
<aside class="footnote brackets" id="id9" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">3</a><span class="fn-bracket">]</span></span>
<p>D.F.R. Mildner and J.M.Carpenter <em>Improvements to the Chebyshev Expansion of Attenuation Correction Factors for Cylindrical Samples.</em> J Appl Crystallogr <strong>23.5</strong> (1990): 378–386 doi: <a class="reference external" href="http://dx.doi.org/10.1107/S0021889890005258">10.1107/S0021889890005258</a></p>
</aside>
</aside>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/CorrectionFunctions/AbsorptionCorrections.html">CorrectionFunctions\AbsorptionCorrections</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/54a39e0a58206de8c1730bb3d0bdf337c05a00a9/Framework/Algorithms/inc/MantidAlgorithms/CalculateCarpenterSampleCorrection.h">CalculateCarpenterSampleCorrection.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/54a39e0a58206de8c1730bb3d0bdf337c05a00a9/Framework/Algorithms/src/CalculateCarpenterSampleCorrection.cpp">CalculateCarpenterSampleCorrection.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="CalMuonDetectorPhases-v1.html" title="Previous Chapter: CalMuonDetectorPhases v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; CalMuonDetect...</span>
    </a>
  </li>
  <li>
    <a href="CalculateChiSquared-v1.html" title="Next Chapter: CalculateChiSquared v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">CalculateChiS... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>