<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Stitch v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Stitch1D v3" href="Stitch1D-v3.html" />
    <link rel="prev" title="StepScan v1" href="StepScan-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.6</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">Stitch v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="stitch-v1">
<span id="algm-stitch"></span><span id="algm-stitch-v1"></span><h1>Stitch v1<a class="headerlink" href="#stitch-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/Stitch-v1_dlg.png"><img alt="../_images/Stitch-v1_dlg.png" class="screenshot" src="../_images/Stitch-v1_dlg.png" style="width: 302px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>Stitch</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#inputs" id="id5">Inputs</a></p>
<ul>
<li><p><a class="reference internal" href="#inputworkspaces" id="id6">InputWorkspaces</a></p></li>
<li><p><a class="reference internal" href="#referenceworkspace" id="id7">ReferenceWorkspace</a></p></li>
<li><p><a class="reference internal" href="#combinationbehaviour" id="id8">CombinationBehaviour</a></p></li>
<li><p><a class="reference internal" href="#scalefactorcalculation" id="id9">ScaleFactorCalculation</a></p></li>
<li><p><a class="reference internal" href="#manualscalefactors" id="id10">ManualScaleFactors</a></p></li>
<li><p><a class="reference internal" href="#tiescalefactors" id="id11">TieScaleFactors</a></p></li>
<li><p><a class="reference internal" href="#outputworkspace" id="id12">OutputWorkspace</a></p></li>
<li><p><a class="reference internal" href="#outputscalefactorsworkspace" id="id13">OutputScaleFactorsWorkspace</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id14">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id15">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Stitches overlapping spectra from multiple 2D workspaces.</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspaces</p></td>
<td><p>Input</p></td>
<td><p>str list</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The names of the input workspaces or groups of those as a list. At least two compatible MatrixWorkspaces are required, having one spectrum each.</p></td>
</tr>
<tr class="row-odd"><td><p>ReferenceWorkspace</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The name of the workspace that will serve as the reference; that is, the one that will not be scaled. If left blank, stitching will be performed left to right in the order of x-axes ascending, no matter the order of workspaces names in the input.</p></td>
</tr>
<tr class="row-even"><td><p>CombinationBehaviour</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Interleave</p></td>
<td><p>Allowed values: [‘Interleave’]</p></td>
</tr>
<tr class="row-odd"><td><p>ScaleFactorCalculation</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>MedianOfRatios</p></td>
<td><p>Allowed values: [‘MedianOfRatios’, ‘Manual’]</p></td>
</tr>
<tr class="row-even"><td><p>ManualScaleFactors</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>Manually specified scale factors, must follow the same order of the workspaces in the list.</p></td>
</tr>
<tr class="row-odd"><td><p>TieScaleFactors</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Whether or not to calculate a single scale factor per workspace for all the spectra.</p></td>
</tr>
<tr class="row-even"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The output workspace.</p></td>
</tr>
<tr class="row-odd"><td><p>OutputScaleFactorsWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td><p>The output workspace containing the applied scale factors.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This algorithm performs stitching of multiple 2D workspaces. Stitching is the operation of scaling one workspace to match the scale of another one in the overlap region and the combination of the workspaces after scale matching.
For each pair of adjacent workspaces in the input, it will find the overlap, interpolate one to another in the overlap region, make the ratio and find the scaling factor.
Then each workspace will be scaled with that factor, and finally all the workspaces will be combined.</p>
</section>
<section id="inputs">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Inputs</a><a class="headerlink" href="#inputs" title="Permalink to this heading">¶</a></h2>
<section id="inputworkspaces">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">InputWorkspaces</a><a class="headerlink" href="#inputworkspaces" title="Permalink to this heading">¶</a></h3>
<p>The list of input workspace or workspace group names. The workspace groups will be flattened to a list of workspaces.
Note that because of this type of input that relies on WorkspaceGroups, this algorithm is currently supported only for named workspaces present on ADS.
The inputs can be in any order in terms of their x-axis extent. The algorithm will first sort them ascending in terms of x-intervals.
Then it will start stitching iteratively to the left and to the right starting from the reference workspace. The input workspaces must be point-data and must have common bins.</p>
</section>
<section id="referenceworkspace">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">ReferenceWorkspace</a><a class="headerlink" href="#referenceworkspace" title="Permalink to this heading">¶</a></h3>
<p>The name of the workspace that will not be scaled. This means that other workspaces will be scaled to match up the scale of the reference one.
The reference is optional; if it is not specified, the workspace with the lowest x-axis interval will be taken as reference, which means that the stitching will iterate left-to-right.</p>
</section>
<section id="combinationbehaviour">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">CombinationBehaviour</a><a class="headerlink" href="#combinationbehaviour" title="Permalink to this heading">¶</a></h3>
<p>At the moment the only option is interleave, which means that all the points from all the inputs will be preserved and the output will be sorted by the x-axis values.</p>
</section>
<section id="scalefactorcalculation">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">ScaleFactorCalculation</a><a class="headerlink" href="#scalefactorcalculation" title="Permalink to this heading">¶</a></h3>
<p>By default it will calculate the median of the point-wise ratios. This is robust in the sense that it is not sensitive to outliers.
This can be set to manual, in which case the scale factors can be specified by the user.</p>
</section>
<section id="manualscalefactors">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">ManualScaleFactors</a><a class="headerlink" href="#manualscalefactors" title="Permalink to this heading">¶</a></h3>
<p>Those must be in the same order as the workspaces in the original input list. By setting those to 1. one could enforce no-scale stitching.</p>
</section>
<section id="tiescalefactors">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">TieScaleFactors</a><a class="headerlink" href="#tiescalefactors" title="Permalink to this heading">¶</a></h3>
<p>If this is checked, one will enforce that the scale factor calculated between two workspaces is the global median of point-wise ratios in the overlapping region and is hence constant for all the spectra.
Otherwise, for each spectra, it will find the median for that spectrum and scale each spectrum with its own factor.
Manual factors can only be considered as tied, i.e. they will be applied to all the spectra.</p>
</section>
<section id="outputworkspace">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">OutputWorkspace</a><a class="headerlink" href="#outputworkspace" title="Permalink to this heading">¶</a></h3>
<p>The workspace containing the stitched outputs.</p>
</section>
<section id="outputscalefactorsworkspace">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">OutputScaleFactorsWorkspace</a><a class="headerlink" href="#outputscalefactorsworkspace" title="Permalink to this heading">¶</a></h3>
<p>An optional output workspace to store the scale factors.
If manual or tied scale factors are used, this will be a single spectrum workspace containing those factors in the original order.
Without ties this will contain as many spectra as the inputs, each of which will contain the scale factors for that spectrum.</p>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example - Stitch</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">179864</span><span class="p">)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="n">ws1</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span><span class="n">DataY</span><span class="o">=</span><span class="n">y1</span><span class="p">,</span><span class="n">NSpec</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="n">ws2</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="n">x2</span><span class="p">,</span><span class="n">DataY</span><span class="o">=</span><span class="n">y2</span><span class="p">,</span><span class="n">NSpec</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">Stitch</span><span class="p">([</span><span class="n">ws1</span><span class="p">,</span><span class="n">ws2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Stitched curve has </span><span class="si">{</span><span class="n">st</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()</span><span class="si">}</span><span class="s1"> points&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Stitched curve has 22 points
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Transforms/Merging.html">Transforms\Merging</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/54a39e0a58206de8c1730bb3d0bdf337c05a00a9/Framework/Algorithms/inc/MantidAlgorithms/Stitch.h">Stitch.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/54a39e0a58206de8c1730bb3d0bdf337c05a00a9/Framework/Algorithms/src/Stitch.cpp">Stitch.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="StepScan-v1.html" title="Previous Chapter: StepScan v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; StepScan v1</span>
    </a>
  </li>
  <li>
    <a href="Stitch1D-v3.html" title="Next Chapter: Stitch1D v3"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Stitch1D v3 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>