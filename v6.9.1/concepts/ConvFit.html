<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Conv Fit</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=ff701123"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Create an IDF" href="CreateanIDF.html" />
    <link rel="prev" title="ComponentInfo" href="ComponentInfo.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.9</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Concepts</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">Conv Fit</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="conv-fit">
<span id="convfitconcept"></span><h1>Conv Fit<a class="headerlink" href="#conv-fit" title="Link to this heading">Â¶</a></h1>
<p>The measured data <span class="math notranslate nohighlight">\(I(Q, \omega)\)</span> is proportional to the convolution of the
scattering law <span class="math notranslate nohighlight">\(S(Q, \omega)\)</span> with the resolution function <span class="math notranslate nohighlight">\(R(Q,
\omega)\)</span> of the spectrometer via <span class="math notranslate nohighlight">\(I(Q, \omega) = S(Q, \omega) \circledast R(Q,
\omega)\)</span>. The traditional method of analysis has been to fit the measured
<span class="math notranslate nohighlight">\(I(Q, \omega)\)</span> with an appropriate set of functions related to the form of
<span class="math notranslate nohighlight">\(S(Q, \omega)\)</span> predicted by theory.</p>
<ul class="simple">
<li><p>In quasielastic scattering the simplest form is when both the <span class="math notranslate nohighlight">\(S(Q,
\omega)\)</span> and the <span class="math notranslate nohighlight">\(R(Q, \omega)\)</span> have the form of a Lorentzian - a
situation which is almost correct for reactor based backscattering
spectrometers such as IN10 &amp; IN16 at ILL. The convolution of two Lorentzians
is itself a Lorentzian so that the spectrum of the measured and resolution
data can both just be fitted with Lorentzians. The broadening of the sample
spectrum is then just the  difference of the two widths.</p></li>
<li><p>The next easiest case is when both <span class="math notranslate nohighlight">\(S(Q, \omega)\)</span> and <span class="math notranslate nohighlight">\(R(Q,
\omega)\)</span> have a simple functional form and the convolution is also a function
containing the parameters of the <span class="math notranslate nohighlight">\(S(Q, \omega)\)</span> and R(Q,  omega) functions.
The convoluted function may then be fitted to the data to provide the
parameters. An example would be the case where the <span class="math notranslate nohighlight">\(S(Q, \omega)\)</span> is a
Lorentzian and the <span class="math notranslate nohighlight">\(R(Q, \omega)\)</span> is a Gaussian.</p></li>
<li><p>For diffraction, the shape of the peak in time is a convolution of a Gaussian
with a decaying exponential and this function can be used to fit the Bragg
peaks.</p></li>
<li><p>The final case is where <span class="math notranslate nohighlight">\(R(Q, \omega)\)</span> does not have a simple function
form so that the measured data has to be convoluted numerically with the
<span class="math notranslate nohighlight">\(S(Q, \omega)\)</span> function to provide an estimate of the sample scattering.
The result is least-squares fitted to the measured data to provide values for
the parameters in the <span class="math notranslate nohighlight">\(S(Q, \omega)\)</span> function.</p></li>
</ul>
<p>This latter form of peak fitting is provided by SWIFT. It employs a
least-squares algorithm which requires the derivatives of the fitting function
with respect to its parameters in order to be faster and more efficient than
those algorithms which calculate the derivatives numerically. To do this the
assumption is made that the derivative of a convolution is equal to the
convolution of the derivative-as the derivative and the convolution are
performed over different variables (function parameters and energy transfer
respectively) this should be correct. A flat background is subtracted from the
resolution data before the convolution is performed.</p>
<p>Four types of sample function are available for <span class="math notranslate nohighlight">\(S(Q, \omega)\)</span>:</p>
<dl class="simple">
<dt>Quasielastic</dt><dd><p>This is the most common case and applies to both translational (diffusion) and
rotational modes, both of which have the form of a Lorentzian. The fitted
function is a set of Lorentzians centred at the origin in energy transfer.</p>
</dd>
<dt>Elastic</dt><dd><p>Comprising a central elastic peak together with a set of quasi-elastic
Lorentzians also centred at the origin. The elastic peak is taken to be the
un-broadened resolution function.</p>
</dd>
<dt>Shift</dt><dd><p>A central Lorentzian with pairs of energy shifted Lorentzians. This was
originally used for crystal field splitting data but more recently has been
applied to quantum tunnelling peaks. The fitting function assumes that the
peaks are symmetric about the origin in energy transfer both in position and
width. The widths of the central and side peaks may be different.</p>
</dd>
<dt>Polymer</dt><dd><p>A single quasi-elastic peak with 3 different forms of shape. The theory behind
this is described elsewhere [1,2]. Briefly, polymer theory predicts 3 forms
of the <span class="math notranslate nohighlight">\(I(Q,t)\)</span> in the form of <span class="math notranslate nohighlight">\(exp(-at2/b)\)</span> where <span class="math notranslate nohighlight">\(b\)</span> can
be 2, 3 or 4. The Full Width Half-Maximum (FWHM) then has a Q-dependence
(power law) of the form <span class="math notranslate nohighlight">\(Qb\)</span>. The <span class="math notranslate nohighlight">\(I(Q,t)\)</span> has been numerically
Fourier transformed into <span class="math notranslate nohighlight">\(I(Q, \omega)\)</span> and the <span class="math notranslate nohighlight">\(I(Q, \omega)\)</span>
have been fitted with functions of the form of a modified Lorentzian. These
latter functions are used in the energy fitting procedures.</p>
</dd>
</dl>
<p>References:</p>
<ol class="arabic simple">
<li><p>J S Higgins, R E Ghosh, W S Howells &amp; G Allen, <a class="reference external" href="http://dx.doi.org/10.1039/F29777300040">JCS Faraday II 73 40 (1977)</a></p></li>
<li><p>J S Higgins, G Allen, R E Ghosh, W S Howells &amp; B Farnoux, <a class="reference external" href="http://dx.doi.org/10.1016/0009-2614(77)80569-1">Chem Phys Lett 49 197 (1977)</a></p></li>
</ol>
<p><strong>Category</strong>: <a class="reference external" href="../api/python/mantid/api/categories/Concepts.html">Concepts</a></p>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ComponentInfo.html" title="Previous Chapter: ComponentInfo"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; ComponentInfo</span>
    </a>
  </li>
  <li>
    <a href="CreateanIDF.html" title="Next Chapter: Create an IDF"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Create an IDF &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>