<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>FitPeak v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=ff701123"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FitPeaks v1" href="FitPeaks-v1.html" />
    <link rel="prev" title="FitIncidentSpectrum v1" href="FitIncidentSpectrum-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.9</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">FitPeak v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="fitpeak-v1">
<span id="algm-fitpeak"></span><span id="algm-fitpeak-v1"></span><h1>FitPeak v1<a class="headerlink" href="#fitpeak-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id2">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id3">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#peak-profile" id="id4">Peak profile</a></p></li>
<li><p><a class="reference internal" href="#background" id="id5">Background</a></p></li>
<li><p><a class="reference internal" href="#input-and-output" id="id6">Input and Output</a></p>
<ul>
<li><p><a class="reference internal" href="#default-function-parameters-names" id="id7">Default function parameters’ names</a></p></li>
<li><p><a class="reference internal" href="#output-of-function-parameters" id="id8">Output of function parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#fitting-algorithm" id="id9">Fitting algorithm</a></p>
<ul>
<li><p><a class="reference internal" href="#simple-fit" id="id10">Simple fit</a></p></li>
<li><p><a class="reference internal" href="#high-background-fit" id="id11">High background fit</a></p></li>
<li><p><a class="reference internal" href="#starting-values-of-the-peak-function" id="id12">Starting values of the peak function</a></p></li>
<li><p><a class="reference internal" href="#criteria-to-validate-peaks-found" id="id13">Criteria To Validate Peaks Found</a></p></li>
<li><p><a class="reference internal" href="#fit-window-and-peak-range" id="id14">Fit Window and Peak Range</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#subalgorithms-used" id="id15">Subalgorithms used</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id16">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id17">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Fit a single peak with checking mechanism.</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of the input workspace for peak fitting.</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of the output workspace containing fitted peak.</p></td>
</tr>
<tr class="row-even"><td><p>ParameterTableWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></p></td>
<td></td>
<td><p>Name of the table workspace containing the fitted parameters.</p></td>
</tr>
<tr class="row-odd"><td><p>WorkspaceIndex</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Workspace index</p></td>
</tr>
<tr class="row-even"><td><p>PeakFunctionType</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Peak function type.  Allowed values: [‘AsymmetricPearsonVII’, ‘AsymmetricPearsonVII (PeakHeight, PeakCentre, Width, LeftShape, RightShape)’, ‘BackToBackExponential’, ‘BackToBackExponential (I, A, B, X0, S)’, ‘Bk2BkExpConvPV’, ‘Bk2BkExpConvPV (X0, Intensity, Alpha, Beta, Sigma2, Gamma)’, ‘DeltaFunction’, ‘DeltaFunction (Height, Centre)’, ‘ElasticDiffRotDiscreteCircle’, ‘ElasticDiffRotDiscreteCircle (Height, Centre, Radius)’, ‘ElasticDiffSphere’, ‘ElasticDiffSphere (Height, Centre, Radius)’, ‘ElasticIsoRotDiff’, ‘ElasticIsoRotDiff (Height, Centre, Radius)’, ‘ExamplePeakFunction’, ‘ExamplePeakFunction (Height, PeakCentre, Sigma)’, ‘Gaussian’, ‘Gaussian (Height, PeakCentre, Sigma)’, ‘IkedaCarpenterPV’, ‘IkedaCarpenterPV (I, Alpha0, Alpha1, Beta0, Kappa, SigmaSquared, Gamma, X0)’, ‘Lorentzian’, ‘Lorentzian (Amplitude, PeakCentre, FWHM)’, ‘PseudoVoigt’, ‘PseudoVoigt (Mixing, Intensity, PeakCentre, FWHM)’, ‘Voigt’, ‘Voigt (LorentzAmp, LorentzPos, LorentzFWHM, GaussianFWHM)’]</p></td>
</tr>
<tr class="row-odd"><td><p>PeakParameterNames</p></td>
<td><p>Input</p></td>
<td><p>str list</p></td>
<td></td>
<td><p>List of peak parameter names.</p></td>
</tr>
<tr class="row-even"><td><p>PeakParameterValues</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>List of peak parameter values.  They must have a 1-to-1 mapping to PeakParameterNames list.</p></td>
</tr>
<tr class="row-odd"><td><p>FittedPeakParameterValues</p></td>
<td><p>Output</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>Fitted peak parameter values.</p></td>
</tr>
<tr class="row-even"><td><p>BackgroundType</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Linear</p></td>
<td><p>Type of Background. Allowed values: [‘Flat’, ‘Flat (A0)’, ‘Linear’, ‘Linear (A0, A1)’, ‘Quadratic’, ‘Quadratic (A0, A1, A2)’]</p></td>
</tr>
<tr class="row-odd"><td><p>BackgroundParameterNames</p></td>
<td><p>Input</p></td>
<td><p>str list</p></td>
<td></td>
<td><p>List of background parameter names.</p></td>
</tr>
<tr class="row-even"><td><p>BackgroundParameterValues</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>List of background parameter values.  They must have a 1-to-1 mapping to BackgroundParameterNames list.</p></td>
</tr>
<tr class="row-odd"><td><p>FittedBackgroundParameterValues</p></td>
<td><p>Output</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>Fitted background parameter values.</p></td>
</tr>
<tr class="row-even"><td><p>FitWindow</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>Enter a comma-separated list of the expected X-position of windows to fit. The number of values must be 2.</p></td>
</tr>
<tr class="row-odd"><td><p>PeakRange</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>Enter a comma-separated list of expected x-position as peak range. The number of values must be 2.</p></td>
</tr>
<tr class="row-even"><td><p>FitBackgroundFirst</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>If true, then the algorithm will fit background first. And then the peak.</p></td>
</tr>
<tr class="row-odd"><td><p>RawParams</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>If true, then the output table workspace contains the raw profile parameter. Otherwise, the effective parameters will be written.</p></td>
</tr>
<tr class="row-even"><td><p>MinGuessedPeakWidth</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>2</p></td>
<td><p>Minimum guessed peak width for fit. It is in unit of number of pixels.</p></td>
</tr>
<tr class="row-odd"><td><p>MaxGuessedPeakWidth</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>10</p></td>
<td><p>Maximum guessed peak width for fit. It is in unit of number of pixels.</p></td>
</tr>
<tr class="row-even"><td><p>GuessedPeakWidthStep</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Step of guessed peak width. It is in unit of number of pixels.</p></td>
</tr>
<tr class="row-odd"><td><p>PeakPositionTolerance</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Peak position tolerance.  If fitted peak’s position differs from proposed value more than the given value, fit is treated as failure.</p></td>
</tr>
<tr class="row-even"><td><p>CostFunction</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Chi-Square</p></td>
<td><p>Cost functions. Allowed values: [‘Chi-Square’, ‘Rwp’]</p></td>
</tr>
<tr class="row-odd"><td><p>Minimizer</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Levenberg-Marquardt</p></td>
<td><p>Minimizer to use for fitting. Minimizers available are “Levenberg-Marquardt”, “Simplex”,”Conjugate gradient (Fletcher-Reeves imp.)”, “Conjugate gradient (Polak-Ribiere imp.)”, “BFGS”, and “Levenberg-MarquardtMD”. Allowed values: [‘BFGS’, ‘Conjugate gradient (Fletcher-Reeves imp.)’, ‘Conjugate gradient (Polak-Ribiere imp.)’, ‘Damped GaussNewton’, ‘FABADA’, ‘Levenberg-Marquardt’, ‘Levenberg-MarquardtMD’, ‘Simplex’, ‘SteepestDescent’, ‘Trust Region’]</p></td>
</tr>
<tr class="row-even"><td><p>CostFunctionValue</p></td>
<td><p>Output</p></td>
<td><p>number</p></td>
<td></td>
<td><p>Value of cost function of the fitted peak.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>This algorithm is used to fit a single peak with some checking mechanism
to ensure its fitting result is physical.</p>
<p>The output <a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a> contains the following
columns…</p>
<section id="peak-profile">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Peak profile</a><a class="headerlink" href="#peak-profile" title="Link to this heading">¶</a></h3>
<p>All peak profiles supported by Mantid are supported by FitPeak.</p>
<p>Starting parameter values specified by user should be close to the real values,
unless the automatic starting values determination algorithm works well with that
profile type.</p>
<p>But only [[Gaussian]] has been well tested with this functionalities.</p>
</section>
<section id="background">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Background</a><a class="headerlink" href="#background" title="Link to this heading">¶</a></h3>
<p>There are only three types of backgrounds that are supported, including
FlatBackground, LinearBackground and Quadratic.</p>
</section>
<section id="input-and-output">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Input and Output</a><a class="headerlink" href="#input-and-output" title="Link to this heading">¶</a></h3>
<p>FitPeak is designed to fit the parameters of a peak function with background function in a given region.
In order to provide convenient UI to both user interactively and algorithms calling this algorithm automatically,
a various formats for the input of the starting values of functions and output of the fitted values of the functions are
implemented.</p>
<section id="default-function-parameters-names">
<h4><a class="toc-backref" href="#id7" role="doc-backlink">Default function parameters’ names</a><a class="headerlink" href="#default-function-parameters-names" title="Link to this heading">¶</a></h4>
<p>Input function parameters’ names should be exactly the same as those defined in Mantid.
Thus user can input function parameters values in the default order,
which is instructed in the list of functions.
For example, one background function type is defined as ‘Linear (A0, A1)’.
As user chooses this function, he does not need to input background function parameter names,
but writes values of A0 and A1, respectively.</p>
</section>
<section id="output-of-function-parameters">
<h4><a class="toc-backref" href="#id8" role="doc-backlink">Output of function parameters</a><a class="headerlink" href="#output-of-function-parameters" title="Link to this heading">¶</a></h4>
<p>The output [[TableWorkspace]] contains the following columns…
* parameter name
* fitted parameter value
* error</p>
</section>
</section>
<section id="fitting-algorithm">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Fitting algorithm</a><a class="headerlink" href="#fitting-algorithm" title="Link to this heading">¶</a></h3>
<p>FindPeaks uses a more complicated approach to fit peaks if ‘’’HighBackground’’’ is flagged. In this case, FindPeak will fit the background first, and then do a Gaussian fit the peak with the fitted background removed.  This procedure will be repeated for a couple of times with different guessed peak widths.  And the parameters of the best result is selected.  The last step is to fit the peak with a combo function including background and Gaussian by using the previously recorded best background and peak parameters as the starting values.</p>
<section id="simple-fit">
<h4><a class="toc-backref" href="#id10" role="doc-backlink">Simple fit</a><a class="headerlink" href="#simple-fit" title="Link to this heading">¶</a></h4>
<p>In the ‘simple fit’ mode, the algorithm will make a composite function including
peak and background function and fit it against the observed data.</p>
<p>It works well with good starting values of the peak and background function,
especially when the peak is significant with low background.</p>
</section>
<section id="high-background-fit">
<h4><a class="toc-backref" href="#id11" role="doc-backlink">High background fit</a><a class="headerlink" href="#high-background-fit" title="Link to this heading">¶</a></h4>
<p>In the ‘high background fit’ mode, the background will be removed first;
then the fitting is focussed on the ‘pure’ peak function;
and a composite function is fit against the original data as the last step.</p>
<p>This approach is developed due to the failure of ‘simple fit’ mode on the cases
that background level is much higher than the peak height.
Without the background being removed, the optimizer intends to favor the background
rather than the peak function.</p>
</section>
<section id="starting-values-of-the-peak-function">
<h4><a class="toc-backref" href="#id12" role="doc-backlink">Starting values of the peak function</a><a class="headerlink" href="#starting-values-of-the-peak-function" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>Peak height is estimated by the maximum value, with background removed, inside the peak range;</p></li>
<li><p>Peak position can be set up either to the X value of the maximum Y value in the peak range, or to the value specified by user accordin to user’s selection.  For example, in the case of calibrating the offsets of detectors of powder diffractometers, the peak positions are unknown.  Then it is better to use the X value with the maximum Y value as the starting peak centre.  While in the case of striping vanadium peaks, all peaks’ centres should be exactly same as the theortical values.</p></li>
</ul>
</section>
<section id="criteria-to-validate-peaks-found">
<h4><a class="toc-backref" href="#id13" role="doc-backlink">Criteria To Validate Peaks Found</a><a class="headerlink" href="#criteria-to-validate-peaks-found" title="Link to this heading">¶</a></h4>
<p>FindPeaks finds peaks by fitting a Gaussian with background to a certain
range in the input histogram. <a class="reference internal" href="Fit-v1.html#algm-fit"><span class="std std-ref">Fit v1</span></a> may not give a correct
result even if chi^2 is used as criteria alone. Thus some other criteria
are provided as options to validate the result</p>
<p>1. Peak position. If peak positions are given, and trustful, then the
fitted peak position must be within a short distance to the give one.</p>
<p>2. Peak height. In the certain number of trial, peak height can be used
to select the best fit among various starting sigma values.</p>
<ol class="arabic simple" start="3">
<li><p>Peak width: Peak width cannot be equal or wider than the given fit window.</p></li>
</ol>
</section>
<section id="fit-window-and-peak-range">
<h4><a class="toc-backref" href="#id14" role="doc-backlink">Fit Window and Peak Range</a><a class="headerlink" href="#fit-window-and-peak-range" title="Link to this heading">¶</a></h4>
<p>If FitWindows is defined, then a peak’s range to fit (i.e., x-min and
x-max) is confined by this window.</p>
<p>If PeakRange is defined and starting peak centre given by user is not
within this range, then the situation is considered illegal. In future,
FitPeak might be able to estimate the peak centre in this situation by
locating the X-value whose corresponding Y-value is largest within
user-defined peak range.</p>
</section>
</section>
<section id="subalgorithms-used">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Subalgorithms used</a><a class="headerlink" href="#subalgorithms-used" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fit</p></li>
</ul>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Example - Fit a single peak with rough estimation on staring parameter values:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Load</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;focussed.nxs&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;focussed&#39;</span><span class="p">)</span>
<span class="n">FitPeak</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;focussed&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;peak4&#39;</span><span class="p">,</span> <span class="n">ParameterTableWorkspace</span><span class="o">=</span><span class="s1">&#39;peak4result&#39;</span><span class="p">,</span>
        <span class="n">WorkspaceIndex</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="n">PeakFunctionType</span><span class="o">=</span><span class="s1">&#39;Gaussian (Height, PeakCentre, Sigma)&#39;</span><span class="p">,</span>
        <span class="n">PeakParameterValues</span><span class="o">=</span><span class="s1">&#39;2000,2.14,0.01&#39;</span><span class="p">,</span><span class="n">BackgroundType</span><span class="o">=</span><span class="s1">&#39;Linear (A0, A1)&#39;</span><span class="p">,</span>
        <span class="n">BackgroundParameterValues</span><span class="o">=</span><span class="s1">&#39;2500,2000&#39;</span><span class="p">,</span><span class="n">FitWindow</span><span class="o">=</span><span class="s1">&#39;2,2.3&#39;</span><span class="p">,</span><span class="n">PeakRange</span><span class="o">=</span><span class="s1">&#39;2.1,2.25&#39;</span><span class="p">)</span>


<span class="n">tbws</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s2">&quot;peak4result&quot;</span><span class="p">]</span>
<span class="n">chi2</span> <span class="o">=</span> <span class="n">tbws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">peakheight</span> <span class="o">=</span> <span class="n">tbws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">peakcentre</span> <span class="o">=</span> <span class="n">tbws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">tbws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Chi-square = </span><span class="si">{:.5f}</span><span class="s2">: Peak centre = </span><span class="si">{:.5f}</span><span class="s2">, Height = </span><span class="si">{:.2f}</span><span class="s2">, Sigma = </span><span class="si">{:.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2</span><span class="p">,</span> <span class="n">peakcentre</span><span class="p">,</span> <span class="n">peakheight</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Chi-square = 1.74892: Peak centre = 2.14201, Height = 7490.67, Sigma = 0.00776
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Optimization.html">Optimization</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/171b44b29330a2303790637329340bb3b6de0d0a/Framework/Algorithms/inc/MantidAlgorithms/FitPeak.h">FitPeak.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/171b44b29330a2303790637329340bb3b6de0d0a/Framework/Algorithms/src/FitPeak.cpp">FitPeak.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="FitIncidentSpectrum-v1.html" title="Previous Chapter: FitIncidentSpectrum v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; FitIncidentSp...</span>
    </a>
  </li>
  <li>
    <a href="FitPeaks-v1.html" title="Next Chapter: FitPeaks v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">FitPeaks v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>