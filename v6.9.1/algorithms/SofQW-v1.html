<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SofQW v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=ff701123"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SofQWCentre v1" href="SofQWCentre-v1.html" />
    <link rel="prev" title="SmoothNeighbours v1" href="SmoothNeighbours-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.9</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">SofQW v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="sofqw-v1">
<span id="algm-sofqw"></span><span id="algm-sofqw-v1"></span><h1>SofQW v1<a class="headerlink" href="#sofqw-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#workflow" id="id6">Workflow</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id7">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id8">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Computes S(Q,w) using a either centre point or parallel-piped rebinning.
The output from each method is:
CentrePoint - centre-point rebin that takes no account of pixel curvature or area overlap</p>
<p>Polygon - parallel-piped rebin, outputting a weighted-sum of overlapping polygons</p>
<p>NormalisedPolygon - parallel-piped rebin, outputting a weighted-sum of overlapping polygons normalised by the fractional area of each overlap</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="SofQWCentre-v1.html#algm-sofqwcentre"><span class="std std-ref">SofQWCentre</span></a>, <a class="reference internal" href="SofQWPolygon-v1.html#algm-sofqwpolygon"><span class="std std-ref">SofQWPolygon</span></a>, <a class="reference internal" href="SofQWNormalisedPolygon-v1.html#algm-sofqwnormalisedpolygon"><span class="std std-ref">SofQWNormalisedPolygon</span></a>, <a class="reference internal" href="Rebin2D-v1.html#algm-rebin2d"><span class="std std-ref">Rebin2D</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Reduced data in units of energy transfer DeltaE. The workspace must contain histogram data and have common bins across all spectra.</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name to use for the q-omega workspace.</p></td>
</tr>
<tr class="row-even"><td><p>QAxisBinning</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The bin parameters to use for the q axis (in the format used by the <a class="reference internal" href="Rebin-v1.html#algm-rebin"><span class="std std-ref">Rebin v1</span></a> algorithm).</p></td>
</tr>
<tr class="row-odd"><td><p>EMode</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The energy transfer analysis mode (Direct/Indirect). Allowed values: [‘Direct’, ‘Indirect’]</p></td>
</tr>
<tr class="row-even"><td><p>EFixed</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The value of fixed energy: <span class="math notranslate nohighlight">\(E_i\)</span> (EMode=Direct) or <span class="math notranslate nohighlight">\(E_f\)</span> (EMode=Indirect) (meV). Must be set here if not available in the instrument definition.</p></td>
</tr>
<tr class="row-odd"><td><p>ReplaceNaNs</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>If true, all NaN values in the output workspace are replaced using the ReplaceSpecialValues algorithm.</p></td>
</tr>
<tr class="row-even"><td><p>EAxisBinning</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>The bin parameters to use for the E axis (optional, in the format used by the <a class="reference internal" href="Rebin-v1.html#algm-rebin"><span class="std std-ref">Rebin v1</span></a> algorithm).</p></td>
</tr>
<tr class="row-odd"><td><p>DetectorTwoThetaRanges</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></p></td>
<td></td>
<td><p>A table workspace use by SofQWNormalisedPolygon containing a ‘Detector ID’ column as well as ‘Min two theta’ and ‘Max two theta’ columns listing the detector’s min and max scattering angles in radians.</p></td>
</tr>
<tr class="row-even"><td><p>Method</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Centre</p></td>
<td><p>Defines the method used to compute the output. Allowed values: [‘Centre’, ‘Polygon’, ‘NormalisedPolygon’]</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>This algorithm is for use by inelastic instruments and takes as its
input a workspace where the data’s been reduced to be in <a class="reference internal" href="../concepts/UnitFactory.html#unit-factory"><span class="std std-ref">units</span></a>
of <strong>energy transfer</strong> against spectrum number (which can be seen as equivalent to
angle, with the angle being taken from the detector(s) to which the
spectrum pertains).</p>
<p>This algorithm can operate in one of three modes. Each mode simply runs a different algorithm to perform the computation:</p>
<ul class="simple">
<li><p><em>Centre</em>: performs a basic centre-point rebinning, see <a class="reference internal" href="SofQWCentre-v1.html#algm-sofqwcentre"><span class="std std-ref">SofQWCentre v1</span></a></p></li>
<li><p><em>Polygon</em>: performs a parallel-piped rebin, taking into account the curvature of the output bins, see <a class="reference internal" href="SofQWPolygon-v1.html#algm-sofqwpolygon"><span class="std std-ref">SofQWPolygon v1</span></a></p></li>
<li><p><em>NormalisedPolygon</em>: performs the same rebin as <em>Polygon</em> but the output bins normalised by the contributing overlap area, see <a class="reference internal" href="SofQWNormalisedPolygon-v1.html#algm-sofqwnormalisedpolygon"><span class="std std-ref">SofQWNormalisedPolygon v1</span></a></p></li>
</ul>
<p>The energy binning will not be changed by this algorithm, so the input
workspace should already have the desired bins (though this axis can be
rebinned afterwards if desired). The EMode and EFixed parameters are
used for the calculation of <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>If the input workspace is a distribution (i.e. <strong>counts/meV</strong> ) then the
output workspace will similarly be divided by the bin width in both
directions (i.e. will contain <strong>counts/meV/(1/Angstrom)</strong> ).</p>
<section id="workflow">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Workflow</a><a class="headerlink" href="#workflow" title="Link to this heading">¶</a></h3>
<figure class="align-default" id="id1">
<img alt="../_images/ImageNotFound.png" src="../_images/ImageNotFound.png" />
<figcaption>
<p><span class="caption-text">diagram generation was disabled</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Example - simple transformation of inelastic workspace:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create sample inelastic workspace for MARI instrument containing 1 at all spectra values</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSimulationWorkspace</span><span class="p">(</span><span class="n">Instrument</span><span class="o">=</span><span class="s1">&#39;MAR&#39;</span><span class="p">,</span><span class="n">BinParams</span><span class="o">=</span><span class="s1">&#39;-10,1,10&#39;</span><span class="p">)</span>
<span class="c1"># convert workspace into MD workspace</span>
<span class="n">ws</span><span class="o">=</span><span class="n">SofQW</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span><span class="n">QAxisBinning</span><span class="o">=</span><span class="s1">&#39;-3,0.1,3&#39;</span><span class="p">,</span><span class="n">Emode</span><span class="o">=</span><span class="s1">&#39;Direct&#39;</span><span class="p">,</span><span class="n">EFixed</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The converted X values are:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">59</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">59</span><span class="p">)[</span><span class="mi">10</span><span class="p">:</span><span class="mi">21</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The converted Y values are:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">59</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">59</span><span class="p">)[</span><span class="mi">10</span><span class="p">:</span><span class="mi">21</span><span class="p">])</span>
</pre></div>
</div>
<p><strong>Output:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The converted X values are:
[-10.  -9.  -8.  -7.  -6.  -5.  -4.  -3.  -2.  -1.]
[  0.   1.   2.   3.   4.   5.   6.   7.   8.   9.  10.]
The converted Y values are:
[ 12.  18.  18.  18.  18.  21.  18.  18.  21.  12.]
[ 18.  21.  24.  24.  24.  21.  24.  33.  39.  45.]
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Inelastic/SofQW.html">Inelastic\SofQW</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/171b44b29330a2303790637329340bb3b6de0d0a/Framework/Algorithms/inc/MantidAlgorithms/SofQW.h">SofQW.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/171b44b29330a2303790637329340bb3b6de0d0a/Framework/Algorithms/src/SofQW.cpp">SofQW.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="SmoothNeighbours-v1.html" title="Previous Chapter: SmoothNeighbours v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SmoothNeighbours v1</span>
    </a>
  </li>
  <li>
    <a href="SofQWCentre-v1.html" title="Next Chapter: SofQWCentre v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SofQWCentre v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>