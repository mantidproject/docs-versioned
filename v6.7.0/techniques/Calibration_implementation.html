<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Calibration Implementation Details</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Create Back To Back Parameters" href="CreateBackToBackParameters.html" />
    <link rel="prev" title="Calibration" href="Calibration.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.7</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" >Techniques</a> &#187;</li>
          
            <li class="nav-item nav-item-2"><a href="Calibration.html" accesskey="U">Calibration</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">Calibration Implementation Details</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="module-tube_calib">
<span id="calibration-implementation-details"></span><h1>Calibration Implementation Details<a class="headerlink" href="#module-tube_calib" title="Permalink to this heading">¶</a></h1>
<p>This file is concerned with calibrating a specified set of tubes</p>
<p>The main function is <a class="reference internal" href="#tube_calib.getCalibration" title="tube_calib.getCalibration"><code class="xref py py-func docutils literal notranslate"><span class="pre">getCalibration()</span></code></a> which is at the end of this file.
It populates an empty Calibration Table Workspace with the new positions of the pixel detectors after calibration.
This Calibration Table Workspace can be used later to move the pixel detectors to the calibrated positions.</p>
<p>Users should not need to directly call any other function other than <a class="reference internal" href="#tube_calib.getCalibration" title="tube_calib.getCalibration"><code class="xref py py-func docutils literal notranslate"><span class="pre">getCalibration()</span></code></a> from this file.</p>
<dl class="py function">
<dt class="sig sig-object py" id="tube_calib.constructIdealTubeFromRealTube">
<span class="sig-prename descclassname"><span class="pre">tube_calib.</span></span><span class="sig-name descname"><span class="pre">constructIdealTubeFromRealTube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ws</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tube</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitPar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">funcForm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_calib.constructIdealTubeFromRealTube" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an ideal tube from an actual tube (assumed ideal)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ws</strong> – integrated workspace</p></li>
<li><p><strong>tube</strong> – specification of one tube (if several tubes, only first tube is used)</p></li>
<li><p><strong>fitPar</strong> – initial fit parameters for peak of the tube</p></li>
<li><p><strong>funcForm</strong> – listing the type of known positions 1=Gaussian; 2=edge</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#ideal_tube.IdealTube" title="ideal_tube.IdealTube">IdealTube</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tube_calib.correct_tube">
<span class="sig-prename descclassname"><span class="pre">tube_calib.</span></span><span class="sig-name descname"><span class="pre">correct_tube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">AP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nDets</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_calib.correct_tube" title="Permalink to this definition">¶</a></dt>
<dd><p>Corrects position errors in a tube in the same manner as is done for MERLIN
according to an algorithm used by Rob Bewley in his MATLAB code.</p>
<p>&#64;param AP: Fit position of left (in pixels)
&#64;param BP: Fit position of right (in pixels)
&#64;param CP: Fit position of centre (in pixels)
&#64;param nDets: Number of pixel detectors in tube</p>
<p>Return Value: Array of corrected Xs  (in pixels)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tube_calib.correct_tube_to_ideal_tube">
<span class="sig-prename descclassname"><span class="pre">tube_calib.</span></span><span class="sig-name descname"><span class="pre">correct_tube_to_ideal_tube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tube_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ideal_tube_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_detectors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polin_fit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a></span></span><a class="headerlink" href="#tube_calib.correct_tube_to_ideal_tube" title="Permalink to this definition">¶</a></dt>
<dd><p>Corrects position errors in a tube given an array of points and their ideal positions.</p>
<p>Note that any element of tubePoints not between 0.0 and nDets is considered a rogue point and so is ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tube_points</strong> – Array of Slit Points along tube to be fitted (in pixels)</p></li>
<li><p><strong>ideal_tube_points</strong> – The corresponding points in an ideal tube (Y-coords advised)</p></li>
<li><p><strong>n_detectors</strong> – Number of pixel detectors in tube</p></li>
<li><p><strong>test_mode</strong> – If true, detectors at the position of a slit will be moved out of the way
to show the reckoned slit positions when the instrument is displayed.</p></li>
<li><p><strong>polin_fit</strong> – Order of the polynomial to fit for the ideal positions</p></li>
<li><p><strong>parameters_table</strong> – name of output TableWorkspace containing values and errors for optimized polynomial
coefficients, as well as goodness-of-fit chi-square value. If <cite>None</cite>, no table is returned</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of corrected Xs  (in same units as ideal tube points)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tube_calib.create_tube_calibration_ws_by_ws_index_list">
<span class="sig-prename descclassname"><span class="pre">tube_calib.</span></span><span class="sig-name descname"><span class="pre">create_tube_calibration_ws_by_ws_index_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrated_workspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_workspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workspace_index_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_calib.create_tube_calibration_ws_by_ws_index_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates workspace with integrated data for one tube against distance along tube
The tube is specified by a list of workspace indices of its spectra</p>
<p>&#64;param integrated_workspace: Workspace of integrated data
&#64;param workspace_index_list:  list of workspace indices for the tube
&#64;param x_unit: unit of distance ( Pixel)
&#64;param show_plot: True = show plot of workspace created, False = just make the workspace.</p>
<p>Return Value: Workspace created</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tube_calib.getCalibratedPixelPositions">
<span class="sig-prename descclassname"><span class="pre">tube_calib.</span></span><span class="sig-name descname"><span class="pre">getCalibratedPixelPositions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_workspace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">EventWorkspace</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Workspace2D</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tube_positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ideal_tube_positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which_tube</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_test_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polin_fit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tube_calib.getCalibratedPixelPositions" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the calibrated detector positions for one tube.</p>
<p>The tube is specified by a list of workspace indices of its spectra. The calibration is assumed
to be done parallel to the Y-axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_workspace</strong> – Workspace with tubes to be calibrated - may be integrated or raw</p></li>
<li><p><strong>tube_positions</strong> – Array of calibration positions (in pixels)</p></li>
<li><p><strong>ideal_tube_positions</strong> – Where these calibration positions should be (in Y coords)</p></li>
<li><p><strong>which_tube</strong> – a list of workspace indices for the tube</p></li>
<li><p><strong>peak_test_mode</strong> – true if shoving detectors that are reckoned to be at peak away (for test purposes)</p></li>
<li><p><strong>polin_fit</strong> – Order of the polynomial to fit for the ideal positions</p></li>
<li><p><strong>parameters_table</strong> – name of output TableWorkspace containing values and errors for optimized polynomial
coefficients, as well as goodness-of-fit chi-square value. If <cite>None</cite>, no table is returned</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of pixel detector IDs, and list of their calibrated positions</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tube_calib.getCalibration">
<span class="sig-prename descclassname"><span class="pre">tube_calib.</span></span><span class="sig-name descname"><span class="pre">getCalibration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_workspace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Workspace2D</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tubeSet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tube_spec.TubeSpec" title="tube_spec.TubeSpec"><span class="pre">TubeSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibTable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TableWorkspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitPar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tube_calib_fit_params.TubeCalibFitParams" title="tube_calib_fit_params.TubeCalibFitParams"><span class="pre">TubeCalibFitParams</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">iTube</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ideal_tube.IdealTube" title="ideal_tube.IdealTube"><span class="pre">IdealTube</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaksTable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TableWorkspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overridePeaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excludeShortTubes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotTube</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polinFit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaksTestMode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters_table_group</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../api/python/mantid/kernel/Direction.html#mantid.kernel.Direction.None" title="mantid.kernel.Direction.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#tube_calib.getCalibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the results the calibration and put them in the calibration table provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_workspace</strong> – Integrated Workspace with tubes to be calibrated</p></li>
<li><p><strong>tubeSet</strong> – Specification of Set of tubes to be calibrated ( <a class="reference internal" href="#tube_spec.TubeSpec" title="tube_spec.TubeSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">TubeSpec</span></code></a> object)</p></li>
<li><p><strong>calibTable</strong> – Empty calibration table into which the calibration results are placed. It is composed
by ‘Detector ID’ and a V3D column ‘Detector Position’. It will be filled with the IDs and calibrated
positions of the detectors.</p></li>
<li><p><strong>fitPar</strong> – A <a class="reference internal" href="#tube_calib_fit_params.TubeCalibFitParams" title="tube_calib_fit_params.TubeCalibFitParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">TubeCalibFitParams</span></code></a> object for fitting the peaks</p></li>
<li><p><strong>iTube</strong> – The <a class="reference internal" href="#ideal_tube.IdealTube" title="ideal_tube.IdealTube"><code class="xref py py-class docutils literal notranslate"><span class="pre">IdealTube</span></code></a> which contains the positions in metres of the shadows
of the slits, bars or edges used for calibration.</p></li>
<li><p><strong>peaksTable</strong> – Peaks table into which the peaks positions will be put</p></li>
<li><p><strong>overridePeaks</strong> – dictionary with tube indexes keys and an array of peaks in pixels to override those
that would be fitted for one tube</p></li>
<li><p><strong>excludeShortTubes</strong> – Exlude tubes shorter than specified length from calibration</p></li>
<li><p><strong>plotTube</strong> – List of tube indexes that will be ploted</p></li>
<li><p><strong>range_list</strong> – list of the tube indexes that will be calibrated. Default None, means all the tubes in tubeSet</p></li>
<li><p><strong>polinFit</strong> – Order of the polynomial to fit against the known positions. Acceptable: 2, 3</p></li>
<li><p><strong>peaksTestMode</strong> – true if shoving detectors that are reckoned to be at peak away (for test purposes)</p></li>
<li><p><strong>parameters_table_group</strong> – name of the WorkspaceGroup containing individual TableWorkspace tables. Each
table holds values and errors for the optimized coefficients of the polynomial that fits the peak positions (in
pixel coordinates) to the known slit positions (along the Y-coordinate). The last entry in the table
holds the goodness-of-fit, chi-square value. The name of each individual TableWorkspace is the string
<cite>parameters_table_group</cite> plus the suffix <cite>_I</cite>, where <cite>I</cite> is the tube index as given by list <cite>range_list</cite>.
If <cite>None</cite>, no group workspace is generated.</p></li>
</ul>
</dd>
</dl>
<p>This is the main method called from <a class="reference internal" href="Calibration.html#tube.calibrate" title="tube.calibrate"><code class="xref py py-func docutils literal notranslate"><span class="pre">calibrate()</span></code></a> to perform the calibration.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tube_calib.getCalibrationFromPeakFile">
<span class="sig-prename descclassname"><span class="pre">tube_calib.</span></span><span class="sig-name descname"><span class="pre">getCalibrationFromPeakFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ws</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibTable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iTube</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PeakFile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_calib.getCalibrationFromPeakFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the results the calibration and put them in the calibration table provided.</p>
<p>&#64;param ws: Integrated Workspace with tubes to be calibrated
&#64;param calibTable: Calibration table into which the calibration results are placed
&#64;param  iTube: The ideal tube
&#64;param PeakFile: File of peaks for calibration</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tube_calib.getPoints">
<span class="sig-prename descclassname"><span class="pre">tube_calib.</span></span><span class="sig-name descname"><span class="pre">getPoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrated_ws</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_forms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which_tube</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_calib.getPoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the centres of N slits or edges for calibration</p>
<p>It does look for the peak position in pixels by fitting the peaks and
edges. It is the method responsible for estimating the peak position in each tube.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This N slit method is suited for WISH or the five sharp peaks of MERLIN .</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>integrated_ws</strong> – Workspace of integrated data</p></li>
<li><p><strong>func_forms</strong> – array of function form 1=slit/bar, 2=edge</p></li>
<li><p><strong>fit_params</strong> – a TubeCalibFitParams object contain the fit parameters</p></li>
<li><p><strong>which_tube</strong> – a list of workspace indices for one tube (define a single tube)</p></li>
<li><p><strong>show_plot</strong> – show plot for this tube</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>array of the slit/edge positions (-1.0 indicates failed to find position)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tube_calib.get_ideal_tube_from_n_slits">
<span class="sig-prename descclassname"><span class="pre">tube_calib.</span></span><span class="sig-name descname"><span class="pre">get_ideal_tube_from_n_slits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrated_workspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slits</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_calib.get_ideal_tube_from_n_slits" title="Permalink to this definition">¶</a></dt>
<dd><p>Given N slits for calibration on an ideal tube
convert to Y values to form a ideal tube for correctTubeToIdealTube()</p>
<p>&#64;param integrated_workspace: Workspace of integrated data
&#64;param slits: positions of slits for ideal tube (in pixels)</p>
<p>Return Value: Ideal tube in Y-coords for use by correctTubeToIdealTube()</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tube_calib.read_peak_file">
<span class="sig-prename descclassname"><span class="pre">tube_calib.</span></span><span class="sig-name descname"><span class="pre">read_peak_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_calib.read_peak_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the file calibration</p>
<p>It returns a list of tuples, where the first value is the detector identification
and the second value is its calibration values.</p>
<dl class="simple">
<dt>Example of usage:</dt><dd><dl class="simple">
<dt>for (det_code, cal_values) in readPeakFile(‘pathname/TubeDemo’):</dt><dd><p>print(det_code)
print(cal_values)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<section id="tubespec">
<h2>TubeSpec<a class="headerlink" href="#tubespec" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tube_spec.TubeSpec">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tube_spec.</span></span><span class="sig-name descname"><span class="pre">TubeSpec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_workspace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../api/python/mantid/api/Workspace.html#mantid.api.Workspace" title="_api.Workspace"><span class="pre">Workspace</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_spec.TubeSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>The python class <a class="reference internal" href="#tube_spec.TubeSpec" title="tube_spec.TubeSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">TubeSpec</span></code></a> provides a way of specifying a set of tubes for
calibration, so that the necessary information about detectors etc. is forthcoming.
The function <a class="reference internal" href="#tube_calib.getCalibration" title="tube_calib.getCalibration"><code class="xref py py-func docutils literal notranslate"><span class="pre">getCalibration()</span></code></a> of <a class="reference internal" href="#module-tube_calib" title="tube_calib"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tube_calib</span></code></a> needs such an object.</p>
<p>Configuration methods:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#tube_spec.TubeSpec.setTubeSpecByString" title="tube_spec.TubeSpec.setTubeSpecByString"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setTubeSpecByString()</span></code></a></p></li>
<li><p><a class="reference internal" href="#tube_spec.TubeSpec.setTubeSpecByStringArray" title="tube_spec.TubeSpec.setTubeSpecByStringArray"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setTubeSpecByStringArray()</span></code></a></p></li>
</ul>
</div></blockquote>
<p>There are some functions useful for getting information about a tube specification.
It is not necessary to call them in a calibration script, but they may be useful for checking
the specification. These methods are:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#tube_spec.TubeSpec.getNumTubes" title="tube_spec.TubeSpec.getNumTubes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getNumTubes()</span></code></a></p></li>
<li><p><a class="reference internal" href="#tube_spec.TubeSpec.getDetectorInfoFromTube" title="tube_spec.TubeSpec.getDetectorInfoFromTube"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getDetectorInfoFromTube()</span></code></a></p></li>
<li><p><a class="reference internal" href="#tube_spec.TubeSpec.getTubeLength" title="tube_spec.TubeSpec.getTubeLength"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getTubeLength()</span></code></a></p></li>
<li><p><a class="reference internal" href="#tube_spec.TubeSpec.getTubeName" title="tube_spec.TubeSpec.getTubeName"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getTubeName()</span></code></a></p></li>
<li><p><a class="reference internal" href="#tube_spec.TubeSpec.getTubeByString" title="tube_spec.TubeSpec.getTubeByString"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getTubeByString()</span></code></a></p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Tubes are currently ordered in the specification in the same order as they appear in the IDF.
This may differ from the order they appear in the workspace indices.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tube_spec.TubeSpec.getComponent">
<span class="sig-name descname"><span class="pre">getComponent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tube_spec.TubeSpec.getComponent" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns instrument component corresponding to specification</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>instrument component</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tube_spec.TubeSpec.getComponents">
<span class="sig-name descname"><span class="pre">getComponents</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tube_spec.TubeSpec.getComponents" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns instrument components corresponding to specification</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of instrument components</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tube_spec.TubeSpec.getDetectorInfoFromTube">
<span class="sig-name descname"><span class="pre">getDetectorInfoFromTube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tubeIx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_spec.TubeSpec.getDetectorInfoFromTube" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns detector info for one tube.</p>
<p>Returns information about detectors in the ( <strong>tubeIx</strong> +1)st tube in the specification,
where <strong>tubeIx</strong> is the argument. Three integers are returned:</p>
<blockquote>
<div><p>the ID for the first detector,
the number of detectors in the tube and
the increment step of detector IDs in the tube (usually 1, but may be -1).</p>
</div></blockquote>
<p>It assumes that all the pixels along the tube have consecutive detector IDs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tubeIx</strong> – index of Tube in specified set</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ID of first detector, number of detectors and step between detectors +1 or -1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tube_spec.TubeSpec.getNumTubes">
<span class="sig-name descname"><span class="pre">getNumTubes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tube_spec.TubeSpec.getNumTubes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns number of tubes specified. May also save info about these tubes</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Value, number of tubes (-1 for erroneous specification)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tube_spec.TubeSpec.getTube">
<span class="sig-name descname"><span class="pre">getTube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tubeIx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_spec.TubeSpec.getTube" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of workspace indices of a tube</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tubeIx</strong> – index of Tube in specified set</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list of indices</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tube_spec.TubeSpec.getTubeByString">
<span class="sig-name descname"><span class="pre">getTubeByString</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tubeIx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_spec.TubeSpec.getTubeByString" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of workspace indices of a tube set that has been specified by string
It assumes that all the pixels along the tube have consecutive detector IDs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tubeIx</strong> – index of Tube in specified set</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list of indices</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tube_spec.TubeSpec.getTubeLength">
<span class="sig-name descname"><span class="pre">getTubeLength</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tubeIx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_spec.TubeSpec.getTubeLength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns length of the ( <strong>tubeIx</strong> +1)st tube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tubeIx</strong> – index of Tube in specified set</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Length of tube (first pixel to last pixel) in metres. 0.0 if tube not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tube_spec.TubeSpec.getTubeName">
<span class="sig-name descname"><span class="pre">getTubeName</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tubeIx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_spec.TubeSpec.getTubeName" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns name of tube.</p>
<p>This function is not used in tube calibration, but may be useful as a diagnostic.
It is used in creating the peakfile, which lists the peaks found for each tube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tubeIx</strong> – index of Tube in specified set</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Name of tube as in IDF or ‘unknown’ if not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tube_spec.TubeSpec.isTube">
<span class="sig-name descname"><span class="pre">isTube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_spec.TubeSpec.isTube" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines whether the component is a tube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>comp</strong> – the component</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Value, true if component passes test as being a tube</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tube_spec.TubeSpec.searchForTubes">
<span class="sig-name descname"><span class="pre">searchForTubes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_spec.TubeSpec.searchForTubes" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches the component for tubes and saves them in array, appending if array is not empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>comp</strong> – the component</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tube_spec.TubeSpec.setTubeSpecByString">
<span class="sig-name descname"><span class="pre">setTubeSpecByString</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tubeSpecString</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_spec.TubeSpec.setTubeSpecByString" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the sets of tube from the workspace.</p>
<p>Sets tube specification by string. The string specifies a component of the instrument
as in the instrument tree of its IDF file. This component may contain one or more tubes
and possibly all the tunes in the instrument.
If the tube specification is not empty this component is added to those already
in the specification. No checking is done for repeated or overlapping components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tubeSpecString</strong> – string specifying tubes of a component of the instrument</p>
</dd>
</dl>
<p>The <strong>tubeSpecString</strong> may be the full path name for the component or
steps may be missed out provided it remains unique.
For example panel03 of WISH can be specified by just <strong>panel03</strong>,
because panel03 is unique within the instrument. Also tube012 of this panel,
which is unique within the panel but not within the instrument
can be specified by <strong>panel03/tube012</strong> but not <strong>tube012</strong>.
If the specification is not unique, the first found will be used and there will
be no error message. So if in doubt don’t skip a step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tube_spec.TubeSpec.setTubeSpecByStringArray">
<span class="sig-name descname"><span class="pre">setTubeSpecByStringArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tubeSpecArray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_spec.TubeSpec.setTubeSpecByStringArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the sets of tube from the workspace with an array of strings.</p>
<p>Set tube specification like setTubeSpecByString, but with an array of string
to enable multiple components to be calibrated.</p>
<p>This function allows you to calibrate a set of tubes that is not defined by a single component.
For example a set of windows. It takes an array of strings as its argument.
Each string specifies a component such as a window or a single tube in the same manner as for
<a class="reference internal" href="#tube_spec.TubeSpec.setTubeSpecByString" title="tube_spec.TubeSpec.setTubeSpecByString"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setTubeSpecByString()</span></code></a>. The components must be disjoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tubeSpecArray</strong> – array of strings (ex. [‘door1’, ‘door2’])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="tubecalibfitparams">
<h2>TubeCalibFitParams<a class="headerlink" href="#tubecalibfitparams" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tube_calib_fit_params.TubeCalibFitParams">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tube_calib_fit_params.</span></span><span class="sig-name descname"><span class="pre">TubeCalibFitParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threePointMethod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outEdge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inEdge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgeGrad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tube_calib_fit_params.TubeCalibFitParams" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="idealtube">
<h2>IdealTube<a class="headerlink" href="#idealtube" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ideal_tube.IdealTube">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ideal_tube.</span></span><span class="sig-name descname"><span class="pre">IdealTube</span></span><a class="headerlink" href="#ideal_tube.IdealTube" title="Permalink to this definition">¶</a></dt>
<dd><p>The IdealTube specifies where the peaks formed by slits or edges should occur.</p>
<p>They can be considered as the known positions as well.
It does also keep informatin about the shape of the known_positions, if they are
peaks or edges.</p>
<p>First you create an ideal tube by calling the empty constructor idealTube().
Then call another function to populate it.</p>
<p>You may fill it up with the following methods:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#ideal_tube.IdealTube.setArray" title="ideal_tube.IdealTube.setArray"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setArray()</span></code></a></p></li>
<li><p><a class="reference internal" href="#ideal_tube.IdealTube.setPositionsAndForm" title="ideal_tube.IdealTube.setPositionsAndForm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setPositionsAndForm()</span></code></a></p></li>
</ul>
</div></blockquote>
<p>You may than query the known positions and functional forms through :</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#ideal_tube.IdealTube.getArray" title="ideal_tube.IdealTube.getArray"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getArray()</span></code></a></p></li>
<li><p><a class="reference internal" href="#ideal_tube.IdealTube.getFunctionalForms" title="ideal_tube.IdealTube.getFunctionalForms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getFunctionalForms()</span></code></a></p></li>
</ul>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="ideal_tube.IdealTube.constructTubeFor3PointsMethod">
<span class="sig-name descname"><span class="pre">constructTubeFor3PointsMethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idealAP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idealBP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idealCP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activeTubeLen</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ideal_tube.IdealTube.constructTubeFor3PointsMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct and ideal tube for Merlin 3-point calibration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idealAP</strong> – Ideal left (AP) in pixels</p></li>
<li><p><strong>idealBP</strong> – ideal right (BP) in pixels</p></li>
<li><p><strong>idealCP</strong> – ideal centre (CP) in pixels</p></li>
<li><p><strong>activeTubeLen</strong> – Active tube length in metres</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ideal_tube.IdealTube.getArray">
<span class="sig-name descname"><span class="pre">getArray</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ideal_tube.IdealTube.getArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the array of of points where the peaks should be in Metres</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ideal_tube.IdealTube.getFunctionalForms">
<span class="sig-name descname"><span class="pre">getFunctionalForms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ideal_tube.IdealTube.getFunctionalForms" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the array of of points where the peaks should be in Metres</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ideal_tube.IdealTube.setArray">
<span class="sig-name descname"><span class="pre">setArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ideal_tube.IdealTube.setArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an ideal tube directly from an array of positions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>array</strong> – Array of points where the peaks should be in Metres</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ideal_tube.IdealTube.setForm">
<span class="sig-name descname"><span class="pre">setForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">form</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ideal_tube.IdealTube.setForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the functional form for the peaks</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ideal_tube.IdealTube.setPositionsAndForm">
<span class="sig-name descname"><span class="pre">setPositionsAndForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">form</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ideal_tube.IdealTube.setPositionsAndForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct and ideal tube directly from an array of positions and functional forms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> – Array of points where the peaks or edges should be in Metres</p></li>
<li><p><strong>form</strong> – Array of functional forms of the points 1=peak, 2=edge</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p><strong>Category</strong>: <a class="reference external" href="categories/Techniques.html">Techniques</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="Calibration.html" title="Previous Chapter: Calibration"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Calibration</span>
    </a>
  </li>
  <li>
    <a href="CreateBackToBackParameters.html" title="Next Chapter: Create Back To Back Parameters"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Create Back T... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>