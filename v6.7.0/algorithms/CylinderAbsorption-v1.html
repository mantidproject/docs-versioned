<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>CylinderAbsorption v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CylinderPaalmanPingsCorrection v2" href="CylinderPaalmanPingsCorrection-v2.html" />
    <link rel="prev" title="CutMD v1" href="CutMD-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.7</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">CylinderAbsorption v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="cylinderabsorption-v1">
<span id="algm-cylinderabsorption"></span><span id="algm-cylinderabsorption-v1"></span><h1>CylinderAbsorption v1<a class="headerlink" href="#cylinderabsorption-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/ImageNotFound.png"><img alt="../_images/ImageNotFound.png" class="screenshot" src="../_images/ImageNotFound.png" style="width: 200px;" /></a>
<figcaption>
<p><span class="caption-text">Enable screenshots using DOCS_SCREENSHOTS in CMake</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#assumptions" id="id6">Assumptions</a></p></li>
<li><p><a class="reference internal" href="#restrictions-on-the-input-workspace" id="id7">Restrictions on the input workspace</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#references" id="id8">References</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id9">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id10">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Calculates bin-by-bin correction factors for attenuation due to absorption and single scattering in a ‘cylindrical’ sample.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="AbsorptionCorrection-v1.html#algm-absorptioncorrection"><span class="std std-ref">AbsorptionCorrection</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The X values for the input workspace must be in units of wavelength</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Output workspace name</p></td>
</tr>
<tr class="row-even"><td><p>ScatterFrom</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Sample</p></td>
<td><p>The component to calculate the absorption for (default: Sample). Allowed values: [‘Sample’, ‘Container’, ‘Environment’]</p></td>
</tr>
<tr class="row-odd"><td><p>AttenuationXSection</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The ABSORPTION cross-section, at 1.8 Angstroms, for the sample material in barns. Column 8 of a table generated from <a class="reference external" href="http://www.ncnr.nist.gov/resources/n-lengths/">http://www.ncnr.nist.gov/resources/n-lengths/</a>.</p></td>
</tr>
<tr class="row-even"><td><p>ScatteringXSection</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The (coherent + incoherent) scattering cross-section for the sample material in barns. Column 7 of a table generated from <a class="reference external" href="http://www.ncnr.nist.gov/resources/n-lengths/">http://www.ncnr.nist.gov/resources/n-lengths/</a>.</p></td>
</tr>
<tr class="row-odd"><td><p>SampleNumberDensity</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The number density of the sample in number of atoms per cubic angstrom if not set with SetSampleMaterial</p></td>
</tr>
<tr class="row-even"><td><p>NumberOfWavelengthPoints</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The number of wavelength points for which the numerical integral is calculated (default: all points)</p></td>
</tr>
<tr class="row-odd"><td><p>ExpMethod</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Normal</p></td>
<td><p>Select the method to use to calculate exponentials, normal or a fast approximation (default: Normal). Allowed values: [‘Normal’, ‘FastApprox’]</p></td>
</tr>
<tr class="row-even"><td><p>EMode</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Elastic</p></td>
<td><p>The energy mode (default: elastic). Allowed values: [‘Elastic’, ‘Direct’, ‘Indirect’]</p></td>
</tr>
<tr class="row-odd"><td><p>EFixed</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The value of the initial or final energy, as appropriate, in meV. Will be taken from the instrument definition file, if available.</p></td>
</tr>
<tr class="row-even"><td><p>CylinderSampleHeight</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The height of the cylindrical sample in centimetres</p></td>
</tr>
<tr class="row-odd"><td><p>CylinderSampleRadius</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The radius of the cylindrical sample in centimetres</p></td>
</tr>
<tr class="row-even"><td><p>CylinderAxis</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p>0,1,0</p></td>
<td><p>A 3D vector specifying the cylindrical sample’s orientation</p></td>
</tr>
<tr class="row-odd"><td><p>NumberOfSlices</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1</p></td>
<td><p>The number of slices into which the cylinder is divided for the calculation</p></td>
</tr>
<tr class="row-even"><td><p>NumberOfAnnuli</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1</p></td>
<td><p>The number of annuli into which each slice is divided for the calculation</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This algorithm uses a numerical integration method to calculate
attenuation factors resulting from absorption and single scattering in a
cylindrical sample with the dimensions and material properties given.
Factors are calculated for each spectrum (i.e. detector position) and
wavelength point, as defined by the input workspace. The sample is
divided up into a stack of slices, which are then divided into annuli
(rings). These annuli are further divided (see Ref. [2], Appendix A) to
give the full set of elements for which a calculation will be carried
out. Thus the calculation speed depends linearly on the total number of
bins in the workspace and on the number of slices. The dependence on the
number of annuli is stronger, going as <span class="math notranslate nohighlight">\(3n ( n+1 )\)</span>.</p>
<p>Path lengths through the sample are then calculated for the centre-point
of each element and a numerical integration is carried out using these
path lengths over the volume elements.</p>
<section id="assumptions">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Assumptions</a><a class="headerlink" href="#assumptions" title="Permalink to this heading">¶</a></h3>
<p>Although no assumptions are made about the beam direction or the
sample position, the cylinder will be constructed with its centre at
the sample position and it’s axis along the y axis (which in the case
of most instruments is the vertical). The sample geometry can also be
set using <a class="reference internal" href="SetSample-v1.html#algm-setsample"><span class="std std-ref">SetSample</span></a>.</p>
</section>
<section id="restrictions-on-the-input-workspace">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Restrictions on the input workspace</a><a class="headerlink" href="#restrictions-on-the-input-workspace" title="Permalink to this heading">¶</a></h3>
<p>The input workspace must have units of wavelength. The
<a class="reference internal" href="../concepts/Instrument.html#instrument"><span class="std std-ref">instrument</span></a> associated with the workspace must be fully
defined because detector, source &amp; sample position are needed.</p>
</section>
</section>
<section id="references">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">References</a><a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h2>
<p>The method used here is based upon work presented in the following two
papers, although it does not yet fully implement all aspects discussed
there (e.g. there’s no multiple scattering and no concentric cylinders).</p>
<ol class="arabic simple">
<li><p>I.A. Blech &amp; B.L. Averbach, <em>Multiple Scattering of Neutrons in
Vanadium and Copper</em>, Phys. Rev. <strong>137 4A</strong> (1965) A1113
<a class="reference external" href="http://dx.doi.org/10.1103/PhysRev.137.A1113">doi: 10.1103/PhysRev.137.A1113</a></p></li>
<li><p>A.K. Soper &amp; P.A. Egelstaff, <em>Multiple Scattering and Attenuation of
Neutrons in Concentric Cylinders</em>, NIM <strong>178</strong> (1980) 415
<a class="reference external" href="http://dx.doi.org/10.1016/0029-554X(80)90820-4">doi: 10.1016/0029-554X(80)90820-4</a></p></li>
</ol>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example - Using a X Section Values</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">ConvertUnits</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="s2">&quot;Wavelength&quot;</span><span class="p">)</span>

<span class="n">wsOut</span> <span class="o">=</span> <span class="n">CylinderAbsorption</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">AttenuationXSection</span><span class="o">=</span><span class="mf">5.08</span><span class="p">,</span>
    <span class="n">ScatteringXSection</span><span class="o">=</span><span class="mf">5.1</span><span class="p">,</span><span class="n">SampleNumberDensity</span><span class="o">=</span><span class="mf">0.07192</span><span class="p">,</span>
    <span class="n">NumberOfWavelengthPoints</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">CylinderSampleHeight</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">CylinderSampleRadius</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">NumberOfSlices</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">NumberOfAnnuli</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;The Absorption correction is calculated to match the input workspace&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;  over </span><span class="si">%i</span><span class="s2"> bins, ranging from  </span><span class="si">%.2f</span><span class="s2"> to </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span>
    <span class="p">(</span><span class="n">wsOut</span><span class="o">.</span><span class="n">blocksize</span><span class="p">(),</span>
    <span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">wsOut</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The Absorption correction is calculated to match the input workspace
  over 100 bins, ranging from  0.77 to 0.37
</pre></div>
</div>
<p><strong>Example - Using a SetSampleMaterial</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">ConvertUnits</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="s2">&quot;Wavelength&quot;</span><span class="p">)</span>
<span class="n">SetSampleMaterial</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">ChemicalFormula</span><span class="o">=</span><span class="s1">&#39;Cd&#39;</span><span class="p">)</span>

<span class="n">wsOut</span> <span class="o">=</span> <span class="n">CylinderAbsorption</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span>
    <span class="n">NumberOfWavelengthPoints</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">CylinderSampleHeight</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">CylinderSampleRadius</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">NumberOfSlices</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">NumberOfAnnuli</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;The Absorption correction is calculated to match the input workspace&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;  over </span><span class="si">%i</span><span class="s2"> bins, ranging from  </span><span class="si">%.2f</span><span class="s2"> to </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span>
    <span class="p">(</span><span class="n">wsOut</span><span class="o">.</span><span class="n">blocksize</span><span class="p">(),</span>
    <span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">wsOut</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The Absorption correction is calculated to match the input workspace
  over 100 bins, ranging from  0.25 to 0.00
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/CorrectionFunctions/AbsorptionCorrections.html">CorrectionFunctions\AbsorptionCorrections</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/291276d1b3f92d519f399310a3ef5f5d4a7c3d7f/Framework/Algorithms/inc/MantidAlgorithms/CylinderAbsorption.h">CylinderAbsorption.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/291276d1b3f92d519f399310a3ef5f5d4a7c3d7f/Framework/Algorithms/src/CylinderAbsorption.cpp">CylinderAbsorption.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="CutMD-v1.html" title="Previous Chapter: CutMD v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; CutMD v1</span>
    </a>
  </li>
  <li>
    <a href="CylinderPaalmanPingsCorrection-v2.html" title="Next Chapter: CylinderPaalmanPingsCorrection v2"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">CylinderPaalm... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>