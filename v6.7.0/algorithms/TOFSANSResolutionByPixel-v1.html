<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>TOFSANSResolutionByPixel v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TOFTOFCropWorkspace v1" href="TOFTOFCropWorkspace-v1.html" />
    <link rel="prev" title="TOFSANSResolution v1" href="TOFSANSResolution-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.7</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">TOFSANSResolutionByPixel v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="tofsansresolutionbypixel-v1">
<span id="algm-tofsansresolutionbypixel"></span><span id="algm-tofsansresolutionbypixel-v1"></span><h1>TOFSANSResolutionByPixel v1<a class="headerlink" href="#tofsansresolutionbypixel-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/ImageNotFound.png"><img alt="../_images/ImageNotFound.png" class="screenshot" src="../_images/ImageNotFound.png" style="width: 200px;" /></a>
<figcaption>
<p><span class="caption-text">Enable screenshots using DOCS_SCREENSHOTS in CMake</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p></li>
<li><p><a class="reference internal" href="#source" id="id6">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Calculate the Q resolution for TOF SANS data for each pixel.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="TOFSANSResolution-v1.html#algm-tofsansresolution"><span class="std std-ref">TOFSANSResolution</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name the workspace to calculate the resolution for, for each pixel and wavelength</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of the newly created workspace which contains the Q resolution.</p></td>
</tr>
<tr class="row-even"><td><p>DeltaR</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Virtual ring width on the detector (mm).</p></td>
</tr>
<tr class="row-odd"><td><p>SampleApertureRadius</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Sample aperture radius, R2 (mm).</p></td>
</tr>
<tr class="row-even"><td><p>SourceApertureRadius</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Source aperture radius, R1 (mm).</p></td>
</tr>
<tr class="row-odd"><td><p>SigmaModerator</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Moderator time spread (microseconds) as afunction of wavelength (Angstroms).</p></td>
</tr>
<tr class="row-even"><td><p>CollimationLength</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Collimation length (m)</p></td>
</tr>
<tr class="row-odd"><td><p>AccountForGravity</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Whether to correct for the effects of gravity</p></td>
</tr>
<tr class="row-even"><td><p>ExtraLength</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Additional length for gravity correction.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>Calculates the Q-resolution per pixel according to Mildner and Carpenter equation</p>
<div class="math notranslate nohighlight">
\[(\sigma_Q )^2 = \frac{4\pi^2}{12\lambda^2} [ 3(\frac{R_1}{L_1})^2 + 3(\frac{R_2}{L_3})^2 + (\frac{\Delta R}{L_2})^2 ] + Q^2(\frac{\sigma_{\lambda}}{\lambda})^2\]</div>
<p>where <span class="math notranslate nohighlight">\(L1\)</span> and <span class="math notranslate nohighlight">\(L2\)</span>  are the collimation length and sample-to-detector distance respectively and</p>
<div class="math notranslate nohighlight">
\[\frac{1}{L_3} = \frac{1}{L_1} + \frac{1}{L_2}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[(\sigma_{\lambda})^2 = (\Delta \lambda )^2 / 12 + (\sigma_{moderator})^2\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_{\lambda}\)</span> is the overall effective standard deviation in wavelength.
<span class="math notranslate nohighlight">\(\Delta \lambda\)</span> values are found from the wavelength binning of the InputWorkspace,
<span class="math notranslate nohighlight">\(\sigma_{moderator}\)</span> is the moderator time spread (the variation in time for the moderator
to emit neutrons of a given wavelength). Note that <span class="math notranslate nohighlight">\(\Delta \lambda\)</span> may be imposed
by wavelength steps set elsewhere in Mantid which should be at least as large as the
equivalent time bins used in the original histogram data collection. For event mode data
<span class="math notranslate nohighlight">\(\Delta \lambda\)</span> is in theory very small, but in practice a histogram in
time has to be generated (perhaps using monitor time bins or specifically set
event-time-bins), before a rebinning into user provided wavelength steps in InputWorkspace.
Again the latter steps should be the largest.</p>
<p>Q values needed here are calculated in the same way as for Q1D, including correction
for gravity for which detector coordinates are assumed centred at zero wavelength.</p>
<p><span class="math notranslate nohighlight">\(\sigma_Q\)</span> is returned as the y-values of the InputWorkspace, and the
remaining variables in the main equation above are related to parameters of this
algorithm as follows:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_1\)</span> equals SourceApertureRadius</p></li>
<li><p><span class="math notranslate nohighlight">\(R_2\)</span> equals SampleApertureRadius</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta R\)</span> equals DeltaR</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma_{moderator}\)</span> equals SigmaModerator</p></li>
<li><p><span class="math notranslate nohighlight">\(\L_1\)</span> equals CollimationLength</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\lambda\)</span> in the equation is the midpoint of wavelength
histogram bin values of InputWorkspace.</p>
<p>Collimation length <span class="math notranslate nohighlight">\(L_1\)</span> in metres in the equation here is the distance between the
first beam defining pinhole (Radius <span class="math notranslate nohighlight">\(R_1\)</span>) and the sample aperture (radius <span class="math notranslate nohighlight">\(R_2\)</span>).
(Beware that <span class="math notranslate nohighlight">\(L_1\)</span> is more often the moderator to sample distance.)</p>
<p>For rectangular collimation apertures, size H x W, Mildner &amp; Carpenter say to
use <span class="math notranslate nohighlight">\(R = \sqrt{( H^2 +W^2)/6 }\)</span>. Note that we are assuming isotropically averaged,
scalar <span class="math notranslate nohighlight">\(Q\)</span>, and making some small angle approximations. Results on higher angle detectors
may not be accurate. For data reduction sliced in different directions on the detector
(e.g. GISANS) adjust the calling parameters to suit the collimation in that direction.</p>
<p>Note that <span class="math notranslate nohighlight">\(\Delta\)</span> is the full width of a rectangular distribution in radius or wavelength,
for which the standard deviation is <span class="math notranslate nohighlight">\(\sigma=\Delta/\sqrt{12}\)</span>. For a Gaussian distribution
the FWHM (full width at half maximum) is <span class="math notranslate nohighlight">\(\sqrt{8\ln{2}}\sigma=2.35482\sigma\)</span>. For an exponential decay
<span class="math notranslate nohighlight">\(e^{-t/\tau}\)</span>, the standard deviation (and the mean) is <span class="math notranslate nohighlight">\(\tau\)</span>. For non-rectangular
distributions these equations allow the equivalent <span class="math notranslate nohighlight">\(\Delta\)</span> to be entered as <span class="math notranslate nohighlight">\(\Delta=\sqrt{12}\sigma\)</span>.</p>
<p>This version of the algorithm neglects wavelength-dependent detector detection depth effects.</p>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/SANS.html">SANS</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/291276d1b3f92d519f399310a3ef5f5d4a7c3d7f/Framework/Algorithms/inc/MantidAlgorithms/TOFSANSResolutionByPixel.h">TOFSANSResolutionByPixel.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/291276d1b3f92d519f399310a3ef5f5d4a7c3d7f/Framework/Algorithms/src/TOFSANSResolutionByPixel.cpp">TOFSANSResolutionByPixel.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="TOFSANSResolution-v1.html" title="Previous Chapter: TOFSANSResolution v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; TOFSANSResolution v1</span>
    </a>
  </li>
  <li>
    <a href="TOFTOFCropWorkspace-v1.html" title="Next Chapter: TOFTOFCropWorkspace v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">TOFTOFCropWor... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>