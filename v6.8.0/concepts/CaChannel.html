<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>CaChannel</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Calibration" href="Calibration.html" />
    <link rel="prev" title="Analysis Data Service" href="AnalysisDataService.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.8</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Concepts</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">CaChannel</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="cachannel">
<span id="id1"></span><h1>CaChannel<a class="headerlink" href="#cachannel" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p></li>
<li><p><a class="reference internal" href="#installation" id="id3">Installation</a></p>
<ul>
<li><p><a class="reference internal" href="#full-installation" id="id4">Full Installation</a></p></li>
<li><p><a class="reference internal" href="#conda-package" id="id5">Conda Package</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id6">Usage</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Describes how to use the <a class="reference external" href="https://pypi.org/project/CaChannel/">CaChannel</a> package to connect
to an instrument that uses the <a class="reference external" href="http://www.aps.anl.gov/epics/">EPICS</a> software control suite.</p>
</section>
<section id="installation">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Installation</a><a class="headerlink" href="#installation" title="Permalink to this heading">¶</a></h2>
<p>The installation of the <code class="docutils literal notranslate"><span class="pre">CaChannel</span></code> depends on how you have installed mantid.
See <a class="reference external" href="https://www.mantidproject.org/installation">https://www.mantidproject.org/installation</a> the available methods.
Developers should use the <cite>Conda Package</cite> method</p>
<section id="full-installation">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Full Installation</a><a class="headerlink" href="#full-installation" title="Permalink to this heading">¶</a></h3>
<p>If you installed mantid via an installer package then simplest way to install
CaChannel is to run the following script in the Workbench Script Window</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Install CaChannel with pip&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">subprocess</span> <span class="k">as</span> <span class="nn">subp</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Run pip using the same executable as the running Python</span>
<span class="n">py_exe</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">executable</span>
<span class="n">pip_cmd</span> <span class="o">=</span> <span class="p">(</span>
  <span class="n">py_exe</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;pip&quot;</span><span class="p">,</span> <span class="s2">&quot;install&quot;</span><span class="p">,</span> <span class="s2">&quot;--upgrade-strategy&quot;</span><span class="p">,</span> <span class="s2">&quot;only-if-needed&quot;</span><span class="p">,</span> <span class="s2">&quot;cachannel&quot;</span>
<span class="p">)</span>
<span class="n">process</span> <span class="o">=</span> <span class="n">subp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">pip_cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subp</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subp</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">process</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<span class="n">process</span><span class="o">.</span><span class="n">check_returncode</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="conda-package">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Conda Package</a><a class="headerlink" href="#conda-package" title="Permalink to this heading">¶</a></h3>
<p>If you installed mantid via Conda then you can add CaChannel to your existing
environment:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>&gt;conda activate your-environment-name
&gt;const install --channel paulscherrerinstitute cachannel
</pre></div>
</div>
</section>
<section id="usage">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h3>
<p>Assuming the instrument can be contacted by a prefix <code class="docutils literal notranslate"><span class="pre">PREFIX1:PREFIX2</span></code> then to retrieve a process variable you would type the following Python code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">CaChannel</span> <span class="kn">import</span> <span class="n">CaChannel</span><span class="p">,</span> <span class="n">CaChannelException</span><span class="p">,</span> <span class="n">ca</span>
<span class="n">chan</span> <span class="o">=</span> <span class="n">CaChannel</span><span class="p">(</span><span class="s1">&#39;PREFIX1:PREFIX2:PVNAME:VALUENAME&#39;</span><span class="p">)</span>
<span class="n">chan</span><span class="o">.</span><span class="n">setTimeout</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">chan</span><span class="o">.</span><span class="n">searchw</span><span class="p">()</span>
<span class="n">as_string</span><span class="o">=</span><span class="kc">True</span> <span class="c1"># set to False if you want a numeric value</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chan</span><span class="o">.</span><span class="n">getw</span><span class="p">(</span><span class="n">ca</span><span class="o">.</span><span class="n">DBR_STRING</span> <span class="k">if</span> <span class="n">as_string</span> <span class="k">else</span> <span class="kc">None</span><span class="p">))</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">PVNAME:VALUENAME</span></code> is the name of the PV variable and associated value.
The print statement should print the text value of the PV.
If no output is returned then the connection could not be made.
Check the IP address of the server is in the environment variable above and that the full name of the PV is correct.</p>
<p>Example PV names for <code class="docutils literal notranslate"><span class="pre">INTER</span></code>:</p>
<ul class="simple">
<li><p>IN:INTER:DAE:TITLE</p></li>
<li><p>IN:INTER:DAE:RUNNUMBER</p></li>
<li><p>IN:INTER:CS:SB:Theta</p></li>
<li><p>IN:INTER:CS:SB:S1VG</p></li>
</ul>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="AnalysisDataService.html" title="Previous Chapter: Analysis Data Service"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Analysis Data Service</span>
    </a>
  </li>
  <li>
    <a href="Calibration.html" title="Next Chapter: Calibration"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Calibration &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>