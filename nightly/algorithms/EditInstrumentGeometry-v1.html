<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>EditInstrumentGeometry v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ElasticWindow v1" href="ElasticWindow-v1.html" />
    <link rel="prev" title="EQSANSTofStructure v1" href="EQSANSTofStructure-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">EditInstrumentGeometry v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="editinstrumentgeometry-v1">
<span id="algm-editinstrumentgeometry"></span><span id="algm-editinstrumentgeometry-v1"></span><h1>EditInstrumentGeometry v1<a class="headerlink" href="#editinstrumentgeometry-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/EditInstrumentGeometry-v1_dlg.png"><img alt="../_images/EditInstrumentGeometry-v1_dlg.png" class="screenshot" src="../_images/EditInstrumentGeometry-v1_dlg.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>EditInstrumentGeometry</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#requirements-on-input-properties" id="id5">Requirements on input properties</a></p></li>
<li><p><a class="reference internal" href="#limitations" id="id6">Limitations</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id7">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id8">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Adds a new instrument or edits an existing one; currently works in an overwrite mode only.</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Workspace</p></td>
<td><p>InOut</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Workspace to edit the detector information</p></td>
</tr>
<tr class="row-odd"><td><p>PrimaryFlightPath</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Primary flight path L1 of the powder diffractometer.</p></td>
</tr>
<tr class="row-even"><td><p>SpectrumIDs</p></td>
<td><p>Input</p></td>
<td><p>int list</p></td>
<td></td>
<td><p>Spectrum Numbers (note that it is not detector ID or workspace indices). The list must be either empty or have a size equal to input workspace’s histogram number.</p></td>
</tr>
<tr class="row-odd"><td><p>L2</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Secondary flight (L2) paths for each detector.  Number of L2 given must be same as number of histogram.</p></td>
</tr>
<tr class="row-even"><td><p>Polar</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Polar angles (two thetas) for detectors. Number of 2theta given must be same as number of histogram.</p></td>
</tr>
<tr class="row-odd"><td><p>Azimuthal</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>Azimuthal angles (out-of-plane) for detectors. Number of azimuthal angles given must be same as number of histogram.</p></td>
</tr>
<tr class="row-even"><td><p>DetectorIDs</p></td>
<td><p>Input</p></td>
<td><p>int list</p></td>
<td></td>
<td><p>User specified detector IDs of the spectra. Number of specified detector IDs must be either zero or number of histogram</p></td>
</tr>
<tr class="row-odd"><td><p>InstrumentName</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Name of the newly built instrument.  If left empty, the original instrument will be used.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This algorithm can:</p>
<p>#. Add an Instrument to a Workspace without any real instrument associated with, or
#. Replace a Workspace’s Instrument with a new Instrument, or
#. Edit all detectors’ parameters of the instrument associated with a Workspace (partial instrument editing is not supported).</p>
</section>
<section id="requirements-on-input-properties">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Requirements on input properties</a><a class="headerlink" href="#requirements-on-input-properties" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>PrimaryFightPath (L1): If it is not given, L1 will be the distance
between source and sample in the original instrument. Otherwise, L1 is
read from input. The source position of the modified instrument is (0,
0, -L1);</p></li>
<li><p>SpectrumIDs: If not specified (empty list), then Spectrum Numbers will be
set up to any array such that SpectrumNos[wsindex] is the spectrum Number of
workspace index ‘wsindex’;</p></li>
<li><p>L2 and Polar cannot be empty list;</p></li>
<li><p>SpectrumIDs[i], L2[i], Polar[i], Azimuthal[i] and optional
DetectorIDs[i] correspond to the detector of a same spectrum.</p></li>
<li><p>Angles are specified in degrees.</p></li>
</ol>
</section>
<section id="limitations">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Limitations</a><a class="headerlink" href="#limitations" title="Permalink to this heading">¶</a></h2>
<p>There are some limitations of this algorithm.</p>
<ol class="arabic simple">
<li><p>The key to locate the detector is via spectrum Number;</p></li>
<li><p>For each spectrum, there is only one and only one new detector. Thus, if one spectrum is associated with a group of detectors previously, the replacement (new) detector is the one which is (diffraction) focused on after this algorithm is called.</p></li>
</ol>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example - Adding a new instrument to a workspace</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span>
    <span class="n">DataX</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
    <span class="n">DataY</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
    <span class="n">NSpec</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">EditInstrumentGeometry</span><span class="p">(</span>
    <span class="n">ws</span><span class="p">,</span>
    <span class="n">PrimaryFlightPath</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span>
    <span class="n">SpectrumIDs</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="n">L2</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">],</span>
    <span class="n">Polar</span><span class="o">=</span><span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">23.0</span><span class="p">],</span>
    <span class="n">Azimuthal</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="n">DetectorIDs</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">],</span>
    <span class="n">InstrumentName</span><span class="o">=</span><span class="s1">&#39;Bizarrio&#39;</span><span class="p">)</span>
<span class="n">spectrumInfo</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">spectrumInfo</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Histogram </span><span class="si">{}</span><span class="s1"> scattering angle: </span><span class="si">{:.3}</span><span class="s1"> degrees&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">spectrumInfo</span><span class="o">.</span><span class="n">twoTheta</span><span class="p">(</span><span class="n">i</span><span class="p">))))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Histogram 1 scattering angle: 10.0 degrees
Histogram 2 scattering angle: 15.0 degrees
Histogram 3 scattering angle: 23.0 degrees
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Diffraction/DataHandling.html">Diffraction\DataHandling</a> | <a class="reference external" href="categories/DataHandling/Instrument.html">DataHandling\Instrument</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/ec725a8349ae13c48d48de8c8ab3312d4a4eef5e/Framework/Algorithms/inc/MantidAlgorithms/EditInstrumentGeometry.h">EditInstrumentGeometry.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/ec725a8349ae13c48d48de8c8ab3312d4a4eef5e/Framework/Algorithms/src/EditInstrumentGeometry.cpp">EditInstrumentGeometry.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="EQSANSTofStructure-v1.html" title="Previous Chapter: EQSANSTofStructure v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; EQSANSTofStructure v1</span>
    </a>
  </li>
  <li>
    <a href="ElasticWindow-v1.html" title="Next Chapter: ElasticWindow v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">ElasticWindow v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>