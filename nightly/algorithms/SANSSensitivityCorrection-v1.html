<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>SANSSensitivityCorrection v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SANSSolidAngleCorrection v1" href="SANSSolidAngleCorrection-v1.html" />
    <link rel="prev" title="SANSSave v1" href="SANSSave-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">SANSSensitivityCorrection v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="sanssensitivitycorrection-v1">
<span id="algm-sanssensitivitycorrection"></span><span id="algm-sanssensitivitycorrection-v1"></span><h1>SANSSensitivityCorrection v1<a class="headerlink" href="#sanssensitivitycorrection-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/SANSSensitivityCorrection-v1_dlg.png"><img alt="../_images/SANSSensitivityCorrection-v1_dlg.png" class="screenshot" src="../_images/SANSSensitivityCorrection-v1_dlg.png" style="width: 349px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>SANSSensitivityCorrection</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#source" id="id5">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Perform SANS sensitivity correction.</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Filename</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Flood field or sensitivity file. Allowed extensions: [‘_event.nxs’, ‘.xml’]</p></td>
</tr>
<tr class="row-even"><td><p>UseSampleDC</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>If true, the dark current subtracted from the sample data will also be subtracted from the flood field.</p></td>
</tr>
<tr class="row-odd"><td><p>DarkCurrentFile</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The name of the input file to load as dark current. Allowed extensions: [‘_event.nxs’, ‘.xml’]</p></td>
</tr>
<tr class="row-even"><td><p>MinEfficiency</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Minimum efficiency for a pixel to be considered (default: no minimum).</p></td>
</tr>
<tr class="row-odd"><td><p>MaxEfficiency</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Maximum efficiency for a pixel to be considered (default: no maximum).</p></td>
</tr>
<tr class="row-even"><td><p>FloodTransmissionValue</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Transmission value for the flood field material (default: no transmission).</p></td>
</tr>
<tr class="row-odd"><td><p>FloodTransmissionError</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Transmission error for the flood field material (default: no transmission).</p></td>
</tr>
<tr class="row-even"><td><p>BeamCenterX</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Beam position in X pixel coordinates (optional: otherwise sample beam center is used)</p></td>
</tr>
<tr class="row-odd"><td><p>BeamCenterY</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Beam position in Y pixel coordinates (optional: otherwise sample beam center is used)</p></td>
</tr>
<tr class="row-even"><td><p>MaskedFullComponent</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Component Name to fully mask according to the IDF file.</p></td>
</tr>
<tr class="row-odd"><td><p>MaskedEdges</p></td>
<td><p>Input</p></td>
<td><p>int list</p></td>
<td></td>
<td><p>Number of pixels to mask on the edges: X-low, X-high, Y-low, Y-high</p></td>
</tr>
<tr class="row-even"><td><p>MaskedComponent</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Component Name to mask the edges according to the IDF file.</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ReductionProperties</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>__sans_reduction_properties</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>OutputSensitivityWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>OutputMessage</p></td>
<td><p>Output</p></td>
<td><p>string</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This SANS workflow algorithm will compute the sensitivity correction
from a given flood field data set. It will apply the proper corrections
to the data according the the input property manager object. Those
corrections may include dark current subtraction, moving the beam
center, the solid angle correction, and applying a patch.</p>
<p>If an input workspace is given, the computed correction will be applied
to that workspace.</p>
<p>A Nexus file containing a pre-calculated sensitivity correction can also
be supplied for the case where we simply want to apply the correction to
an input workspace.</p>
<p>The relative detector efficiency is computed using the
<a class="reference internal" href="CalculateEfficiency-v2.html#algm-calculateefficiency"><span class="std std-ref">CalculateEfficiency</span></a>
algorithm the following way:</p>
<p><span class="math notranslate nohighlight">\(S(x,y)=\frac{I_{flood}(x,y)}{1/N_{pixels}\sum_{i,j}I_{flood}(i,j)}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(I_{flood}(x,y)\)</span> is the pixel count of the flood data in pixel (x,y).
If a minimum and/or maximum sensitivity is given, the pixels having an efficiency
outside the given limits are masked and the efficiency is recomputed without using
those pixels.
The sample data is then corrected by dividing the intensity in each pixels by
the efficiency S:</p>
<p><span class="math notranslate nohighlight">\(I'_{sample}(x,y) = \frac{I_{sample}(x,y)}{S(x,y)}\)</span></p>
<p>The pixels found to have an efficiency outside the given limits are also masked
in the sample data so that they don’t enter any subsequent calculations.
If the user chose to use a dark current data set when starting the reduction
process, that dark current data will be subtracted from the flood data. The
subtraction is done before the sensitivity is calculated.
If the user chose to use the solid angle correction for the reduction process,
that correction will be applied to the flood data before the sensitivity is calculated.</p>
<p>This algorithm is usually called by
<a class="reference internal" href="SANSReduction-v1.html#algm-sansreduction"><span class="std std-ref">SANSReduction</span></a> or <a class="reference internal" href="HFIRSANSReduction-v1.html#algm-hfirsansreduction"><span class="std std-ref">HFIRSANSReduction</span></a>.</p>
<p><strong>Note 1</strong>: The solid angle correction is either not applied at all, or applied to both
the flood data to calculate the sensitivity correction and applied to the sample data as part of the reduction process.</p>
<p><strong>Note 2</strong>: EQSANS has the option to patch masked areas of the detector using the
efficiency calculated for the unmasked portion of each tube. This creates a sensitivity
file that covers the entire detector. This option can be enabled by using the
<a class="reference internal" href="ComputeSensitivity-v1.html#algm-computesensitivity"><span class="std std-ref">ComputeSensitivity</span></a>
workflow algorithm to create a sensitivity workspace, which can then be saved and used
for EQSANS reduction as a pre-calculated sensitivity file.</p>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Workflow/SANS/UsesPropertyManager.html">Workflow\SANS\UsesPropertyManager</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/ae5920090788fe85703dcb99039251b0d956c4b7/Framework/WorkflowAlgorithms/inc/MantidWorkflowAlgorithms/SANSSensitivityCorrection.h">SANSSensitivityCorrection.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/ae5920090788fe85703dcb99039251b0d956c4b7/Framework/WorkflowAlgorithms/src/SANSSensitivityCorrection.cpp">SANSSensitivityCorrection.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="SANSSave-v1.html" title="Previous Chapter: SANSSave v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SANSSave v1</span>
    </a>
  </li>
  <li>
    <a href="SANSSolidAngleCorrection-v1.html" title="Next Chapter: SANSSolidAngleCorrection v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SANSSolidAngl... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>