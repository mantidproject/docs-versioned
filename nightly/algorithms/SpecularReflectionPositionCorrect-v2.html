<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>SpecularReflectionPositionCorrect v2</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SphericalAbsorption v1" href="SphericalAbsorption-v1.html" />
    <link rel="prev" title="SpecularReflectionPositionCorrect v1" href="SpecularReflectionPositionCorrect-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">SpecularReflectionPositionCorrect v2</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="specularreflectionpositioncorrect-v2">
<span id="algm-specularreflectionpositioncorrect"></span><span id="algm-specularreflectionpositioncorrect-v2"></span><h1>SpecularReflectionPositionCorrect v2<a class="headerlink" href="#specularreflectionpositioncorrect-v2" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/SpecularReflectionPositionCorrect-v2_dlg.png"><img alt="../_images/SpecularReflectionPositionCorrect-v2_dlg.png" class="screenshot" src="../_images/SpecularReflectionPositionCorrect-v2_dlg.png" style="width: 349px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>SpecularReflectionPositionCorrect</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p></li>
<li><p><a class="reference internal" href="#previous-versions" id="id6">Previous Versions</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id7">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id8">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Corrects a reflectometer’s detector component’s position.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="SpecularReflectionCalculateTheta-v2.html#algm-specularreflectioncalculatetheta"><span class="std std-ref">SpecularReflectionCalculateTheta</span></a>, <a class="reference internal" href="FindReflectometryLines-v2.html#algm-findreflectometrylines"><span class="std std-ref">FindReflectometryLines</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>An input workspace to correct.</p></td>
</tr>
<tr class="row-odd"><td><p>TwoTheta</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Angle used to correct the detector component [degrees].</p></td>
</tr>
<tr class="row-even"><td><p>DetectorCorrectionType</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>VerticalShift</p></td>
<td><p>Whether detectors should be shifted vertically or rotated around the sample position. Allowed values: [‘VerticalShift’, ‘RotateAroundSample’]</p></td>
</tr>
<tr class="row-odd"><td><p>DetectorComponentName</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Name of the detector component to correct, for example point-detector</p></td>
</tr>
<tr class="row-even"><td><p>DetectorID</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The ID of the detector to correct; if both the component name and the detector ID are set the latter will be used.</p></td>
</tr>
<tr class="row-odd"><td><p>SampleComponentName</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>some-surface-holder</p></td>
<td><p>Name of the sample component; if the given name is not found in the instrument, the default sample is used.</p></td>
</tr>
<tr class="row-even"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>A workspace with corrected detector position.</p></td>
</tr>
<tr class="row-odd"><td><p>DetectorFacesSample</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>If true, a normal vector at the centre of the detector always points towards the sample.</p></td>
</tr>
<tr class="row-even"><td><p>LinePosition</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>A fractional workspace index for the specular line centre.</p></td>
</tr>
<tr class="row-odd"><td><p>PixelSize</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Size of a detector pixel, in metres.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>Moves the specified detector component to a given angle between the beam and
the sample-to-detector vector. The detector component is moved as a
block. The rest of the instrument components remain in original positions. The component
can be shifted vertically (default), or rotated around the sample position. When rotating
around the sample, an optional rotation can be applied so that the detector always faces
the sample.</p>
<p>In the most basic operation, the detector is moved to the angle specified by <code class="docutils literal notranslate"><span class="pre">TwoTheta</span></code>.
This case is schematically shown below for rotation around the sample position and
<code class="docutils literal notranslate"><span class="pre">DetectorFacesSample</span></code> set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/SpecularReflectionCorrection_figure1.png"><img alt="Schematic representation of angle correction when only TwoTheta is given." src="../_images/SpecularReflectionCorrection_figure1.png" style="width: 449.0px; height: 184.0px;" /></a>
</figure>
<p>If <code class="docutils literal notranslate"><span class="pre">LinePosition</span></code> and <code class="docutils literal notranslate"><span class="pre">PixelSize</span></code> are also given, the detector will be moved such
that the angle will be <code class="docutils literal notranslate"><span class="pre">TwoTheta</span></code> for the pixel at workspace index <code class="docutils literal notranslate"><span class="pre">LinePosition</span></code>.
Note that <code class="docutils literal notranslate"><span class="pre">LinePosition</span></code> can be a fractional index making it possible to adjust the
detector angle to a fitted line position. The figure below illustrates this option.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/SpecularReflectionCorrection_figure2.png"><img alt="Schematic representation of angle correction when TwoTheta and LinePosition are given." src="../_images/SpecularReflectionCorrection_figure2.png" style="width: 449.0px; height: 184.0px;" /></a>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The line positions can be acquired by using, for instance,
<a class="reference internal" href="FindReflectometryLines-v2.html#algm-findreflectometrylines"><span class="std std-ref">FindReflectometryLines</span></a>.</p>
</div>
</section>
<section id="previous-versions">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Previous Versions</a><a class="headerlink" href="#previous-versions" title="Permalink to this heading">¶</a></h2>
<p>For version 1 of the algorithm, please see <a class="reference internal" href="SpecularReflectionPositionCorrect-v1.html#algm-specularreflectionpositioncorrect-v1"><span class="std std-ref">SpecularReflectionPositionCorrect-v1.</span></a></p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path.
In Mantid this is done using <a class="reference internal" href="../interfaces/framework/ManageUserDirectories.html#manageuserdirectories"><span class="std std-ref">Manage User Directories</span></a>.</p>
</div>
<p><strong>Example - Correct ‘point-detector’</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;point-detector&#39;</span><span class="p">)</span>
<span class="n">polref</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;POLREF00004699.raw&#39;</span><span class="p">,</span> <span class="n">PeriodList</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">polref</span> <span class="o">=</span> <span class="n">polref</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">instr</span> <span class="o">=</span> <span class="n">polref</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original position: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">getComponentByName</span><span class="p">(</span><span class="s1">&#39;point-detector&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()))</span>

<span class="n">polref_vert</span> <span class="o">=</span> <span class="n">SpecularReflectionPositionCorrect</span><span class="p">(</span><span class="n">polref</span><span class="p">,</span> <span class="n">TwoTheta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">DetectorComponentName</span><span class="o">=</span><span class="s1">&#39;point-detector&#39;</span><span class="p">,</span> <span class="n">DetectorCorrectionType</span><span class="o">=</span><span class="s1">&#39;VerticalShift&#39;</span><span class="p">)</span>
<span class="n">instr</span> <span class="o">=</span> <span class="n">polref_vert</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Vertical shift:    &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">getComponentByName</span><span class="p">(</span><span class="s1">&#39;point-detector&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()))</span>

<span class="n">polref_rot</span> <span class="o">=</span> <span class="n">SpecularReflectionPositionCorrect</span><span class="p">(</span><span class="n">polref</span><span class="p">,</span> <span class="n">TwoTheta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">DetectorComponentName</span><span class="o">=</span><span class="s1">&#39;point-detector&#39;</span><span class="p">,</span> <span class="n">DetectorCorrectionType</span><span class="o">=</span><span class="s1">&#39;RotateAroundSample&#39;</span><span class="p">)</span>
<span class="n">instr</span> <span class="o">=</span> <span class="n">polref_rot</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rotated:           &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">getComponentByName</span><span class="p">(</span><span class="s1">&#39;point-detector&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<p>Note that in this case the difference between shifting the detectors vertically or rotating them is negligible.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>point-detector
Original position: [25.6,0,0.0444961]
Vertical shift:    [25.6,0,0.0444753]
Rotated:           [25.6,0,0.0444753]
</pre></div>
</div>
<p><strong>Example - Correct ‘lineardetector’</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lineardetector&#39;</span><span class="p">)</span>
<span class="n">polref</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;POLREF00004699.raw&#39;</span><span class="p">,</span> <span class="n">PeriodList</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">polref</span> <span class="o">=</span> <span class="n">polref</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">instr</span> <span class="o">=</span> <span class="n">polref</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original position: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">getComponentByName</span><span class="p">(</span><span class="s1">&#39;lineardetector&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()))</span>

<span class="n">polref_vert</span> <span class="o">=</span> <span class="n">SpecularReflectionPositionCorrect</span><span class="p">(</span><span class="n">polref</span><span class="p">,</span> <span class="n">TwoTheta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">DetectorComponentName</span><span class="o">=</span><span class="s1">&#39;lineardetector&#39;</span><span class="p">)</span>
<span class="n">instr</span> <span class="o">=</span> <span class="n">polref_vert</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Vertical shift:    &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">getComponentByName</span><span class="p">(</span><span class="s1">&#39;lineardetector&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()))</span>

<span class="n">polref_rot</span> <span class="o">=</span> <span class="n">SpecularReflectionPositionCorrect</span><span class="p">(</span><span class="n">polref</span><span class="p">,</span> <span class="n">TwoTheta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">DetectorComponentName</span><span class="o">=</span><span class="s1">&#39;lineardetector&#39;</span><span class="p">,</span> <span class="n">DetectorCorrectionType</span><span class="o">=</span><span class="s1">&#39;RotateAroundSample&#39;</span><span class="p">)</span>
<span class="n">instr</span> <span class="o">=</span> <span class="n">polref_rot</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rotated:           &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">getComponentByName</span><span class="p">(</span><span class="s1">&#39;lineardetector&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>lineardetector
Original position: [26,0,0]
Vertical shift:    [26,0,0.0513177]
Rotated:           [25.9996,0,0.0513102]
</pre></div>
</div>
<p><strong>Example - Correct ‘OSMOND’</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;OSMOND&#39;</span><span class="p">)</span>
<span class="n">polref</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;POLREF00004699.raw&#39;</span><span class="p">,</span> <span class="n">PeriodList</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">polref</span> <span class="o">=</span> <span class="n">polref</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">instr</span> <span class="o">=</span> <span class="n">polref</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original position: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">getComponentByName</span><span class="p">(</span><span class="s1">&#39;OSMOND&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()))</span>

<span class="n">polref_vert</span> <span class="o">=</span> <span class="n">SpecularReflectionPositionCorrect</span><span class="p">(</span><span class="n">polref</span><span class="p">,</span> <span class="n">TwoTheta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">DetectorComponentName</span><span class="o">=</span><span class="s1">&#39;OSMOND&#39;</span><span class="p">)</span>
<span class="n">instr</span> <span class="o">=</span> <span class="n">polref_vert</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Vertical shift:    &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">getComponentByName</span><span class="p">(</span><span class="s1">&#39;OSMOND&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()))</span>

<span class="n">polref_rot</span> <span class="o">=</span> <span class="n">SpecularReflectionPositionCorrect</span><span class="p">(</span><span class="n">polref</span><span class="p">,</span> <span class="n">TwoTheta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">DetectorComponentName</span><span class="o">=</span><span class="s1">&#39;OSMOND&#39;</span><span class="p">,</span> <span class="n">DetectorCorrectionType</span><span class="o">=</span><span class="s1">&#39;RotateAroundSample&#39;</span><span class="p">)</span>
<span class="n">instr</span> <span class="o">=</span> <span class="n">polref_rot</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rotated:           &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">getComponentByName</span><span class="p">(</span><span class="s1">&#39;OSMOND&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OSMOND
Original position: [26,0,0]
Vertical shift:    [26,0,0.0513177]
Rotated:           [25.9996,0,0.0513102]
</pre></div>
</div>
<p><strong>Example - Rotate given pixel</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="c1"># We&#39;ll just use an empty workspace here.</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">LoadEmptyInstrument</span><span class="p">(</span><span class="n">InstrumentName</span><span class="o">=</span><span class="s1">&#39;D17&#39;</span><span class="p">)</span>
<span class="c1"># Get rid of monitors</span>
<span class="n">ExtractMonitors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">DetectorWorkspace</span><span class="o">=</span><span class="s1">&#39;ws&#39;</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;ws&#39;</span><span class="p">]</span>
<span class="n">line_position</span> <span class="o">=</span> <span class="mf">22.</span>
<span class="n">spectrum_info</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">spectrumInfo</span><span class="p">()</span>
<span class="n">two_theta</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">spectrum_info</span><span class="o">.</span><span class="n">twoTheta</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">line_position</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pixel </span><span class="si">{}</span><span class="s1"> 2theta&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">line_position</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;before angle correction: </span><span class="si">{:.3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">two_theta</span><span class="p">))</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">SpecularReflectionPositionCorrect</span><span class="p">(</span>
    <span class="n">ws</span><span class="p">,</span>
    <span class="n">TwoTheta</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">DetectorCorrectionType</span><span class="o">=</span><span class="s1">&#39;RotateAroundSample&#39;</span><span class="p">,</span>
    <span class="n">DetectorComponentName</span><span class="o">=</span><span class="s1">&#39;detector&#39;</span><span class="p">,</span>
    <span class="n">DetectorFacesSample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">LinePosition</span><span class="o">=</span><span class="n">line_position</span><span class="p">,</span>
    <span class="n">PixelSize</span><span class="o">=</span><span class="mf">0.001195</span><span class="p">)</span>
<span class="n">spectrum_info</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">spectrumInfo</span><span class="p">()</span>
<span class="n">two_theta</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">spectrum_info</span><span class="o">.</span><span class="n">twoTheta</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">line_position</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;after angle correction: </span><span class="si">{:.3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">two_theta</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Pixel 22 2theta
before angle correction: 2.33
after angle correction: 1.5
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Reflectometry.html">Reflectometry</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/Reflectometry/inc/MantidReflectometry/SpecularReflectionPositionCorrect2.h">SpecularReflectionPositionCorrect2.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/Reflectometry/src/SpecularReflectionPositionCorrect2.cpp">SpecularReflectionPositionCorrect2.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="SpecularReflectionPositionCorrect-v1.html" title="Previous Chapter: SpecularReflectionPositionCorrect v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SpecularRefle...</span>
    </a>
  </li>
  <li>
    <a href="SphericalAbsorption-v1.html" title="Next Chapter: SphericalAbsorption v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SphericalAbso... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>