<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>LoadILLReflectometry v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LoadILLSANS v1" href="LoadILLSANS-v1.html" />
    <link rel="prev" title="LoadILLPolarizedDiffraction v1" href="LoadILLPolarizedDiffraction-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">LoadILLReflectometry v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="loadillreflectometry-v1">
<span id="algm-loadillreflectometry"></span><span id="algm-loadillreflectometry-v1"></span><h1>LoadILLReflectometry v1<a class="headerlink" href="#loadillreflectometry-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/LoadILLReflectometry-v1_dlg.png"><img alt="../_images/LoadILLReflectometry-v1_dlg.png" class="screenshot" src="../_images/LoadILLReflectometry-v1_dlg.png" style="width: 349px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>LoadILLReflectometry</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p></li>
<li><p><a class="reference internal" href="#time-of-flight-axis" id="id6">Time of flight axis</a></p></li>
<li><p><a class="reference internal" href="#measurement" id="id7">Measurement</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id8">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id9">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Loads an ILL reflectometry Nexus file (instrument D17 or FIGARO).</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="LoadNexus-v1.html#algm-loadnexus"><span class="std std-ref">LoadNexus</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Filename</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of the Nexus file to load. Allowed extensions: [‘.nxs’]</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of the output workspace</p></td>
</tr>
<tr class="row-even"><td><p>ForegroundPeakCentre</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Foreground peak position in fractional workspace index (if not given the peak is searched for and fitted).</p></td>
</tr>
<tr class="row-odd"><td><p>DetectorCentreFractionalIndex</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>127.5</p></td>
<td><p>The fractional workspace index of the geometric centre of the detector at incident beam axis (127.5 for D17 and Figaro).</p></td>
</tr>
<tr class="row-even"><td><p>Measurement</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>DirectBeam</p></td>
<td><p>Load as direct or reflected beam. Allowed values: [‘DirectBeam’, ‘ReflectedBeam’]</p></td>
</tr>
<tr class="row-odd"><td><p>BraggAngle</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The bragg angle necessary for reflected beam.</p></td>
</tr>
<tr class="row-even"><td><p>FitStartWorkspaceIndex</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Start workspace index used for peak fitting.</p></td>
</tr>
<tr class="row-odd"><td><p>FitEndWorkspaceIndex</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>255</p></td>
<td><p>End workspace index used for peak fitting.</p></td>
</tr>
<tr class="row-even"><td><p>FitRangeLower</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>-1</p></td>
<td><p>Minimum wavelength used for peak fitting.</p></td>
</tr>
<tr class="row-odd"><td><p>FitRangeUpper</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>-1</p></td>
<td><p>Maximum wavelength used for peak fitting.</p></td>
</tr>
<tr class="row-even"><td><p>XUnit</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Wavelength</p></td>
<td><p>X unit of the OutputWorkspace. Allowed values: [‘Wavelength’, ‘TimeOfFlight’]</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>Loads data of a Nexus file obtained from an ILL reflectometry instrument
<a class="reference external" href="https://www.ill.eu/instruments-support/instruments-groups/instruments/d17/description/instrument-layout/">D17</a>
or <a class="reference external" href="https://www.ill.eu/instruments-support/instruments-groups/instruments/figaro/description/instrument-layout/">FIGARO</a>
into a <a class="reference internal" href="../concepts/Workspace2D.html#workspace2d"><span class="std std-ref">Workspace2D</span></a>.
Both time-of-flight and monochromatic instrument configurations are supported.
In general, this loader reads detector and monitor counts and adds x-axis and error values.
The output workspace contains histogram data.
The x-axis can have units in time-of-flight or wavelength with non-varying and varying bins, respectively.
The conversion to wavelength uses the algorithm <a class="reference internal" href="ConvertUnits-v1.html#algm-convertunits"><span class="std std-ref">ConvertUnits v1</span></a>.
Detector indices and spectrum numbers start with zero like workspace indices.</p>
</section>
<section id="time-of-flight-axis">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Time of flight axis</a><a class="headerlink" href="#time-of-flight-axis" title="Permalink to this heading">¶</a></h2>
<p>The chopper values are used for computing the time-of-flight values for the bin edges <span class="math notranslate nohighlight">\(x_i\)</span> by the following equation:</p>
<div class="math notranslate nohighlight">
\[x_{i} = \left( i + 0.5 \right) w_{\mathrm{channel}} + \Delta_{t, \mathrm{tof}} -  60^{\circ} \cdot \frac{ p_{\mathrm{off}} - 45^{\circ} + \Omega_{c2} - \Omega_{c1} + \Delta_{\mathrm{open}} }{ 2 \cdot 360^{\circ} \cdot v_{c1} } \cdot 10^{6},\]</div>
<p>with the following variables: channel width <span class="math notranslate nohighlight">\(w_{\mathrm{channel}}\)</span>, time-of-flight delay <span class="math notranslate nohighlight">\(\Delta_{t, \mathrm{tof}}\)</span>, offset <span class="math notranslate nohighlight">\(p_{\mathrm{off}}\)</span>, phase of second chopper <span class="math notranslate nohighlight">\(\Omega_{c2}\)</span>, phase of first chopper <span class="math notranslate nohighlight">\(\Omega_{c1}\)</span>, open offset <span class="math notranslate nohighlight">\(\Delta_{\mathrm{open}}\)</span> and velocity of first chopper <span class="math notranslate nohighlight">\(v_{c1}\)</span>.</p>
</section>
<section id="measurement">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Measurement</a><a class="headerlink" href="#measurement" title="Permalink to this heading">¶</a></h2>
<p>The loader can load both types of data: direct and reflected beam.
In both cases the foreground centre will be fitted.
In case of direct beam, the detector will be rotated around the sample such that the fractional workspace index of the foreground centre will appear at 0 scattering angle.
In case of reflected beam, <strong>BraggAngle</strong> is mandatory, and the detector will be driven such that the foreground centre will appear at <strong>2*BraggAngle</strong>.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path.
In Mantid this is done using <a class="reference internal" href="../interfaces/framework/ManageUserDirectories.html#manageuserdirectories"><span class="std std-ref">Manage User Directories</span></a>.</p>
</div>
<p><strong>Example - ReflectedBeam:</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="c1"># Load ILL d17 data file (TOF mode) into a workspace 2D using a user-defined angle of 5.5 degrees:</span>
<span class="n">ws2</span> <span class="o">=</span> <span class="n">LoadILLReflectometry</span><span class="p">(</span><span class="s1">&#39;ILL/D17/317370.nxs&#39;</span><span class="p">,</span> <span class="n">Measurement</span><span class="o">=</span><span class="s1">&#39;ReflectedBeam&#39;</span><span class="p">,</span> <span class="n">BraggAngle</span><span class="o">=</span><span class="mf">5.5</span><span class="p">)</span>
<span class="n">detId</span> <span class="o">=</span> <span class="mi">202</span> <span class="c1"># the foreground centre is around 202</span>
<span class="n">det</span> <span class="o">=</span> <span class="n">ws2</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="n">detId</span><span class="p">)</span>
<span class="n">angleDet</span> <span class="o">=</span> <span class="n">ws2</span><span class="o">.</span><span class="n">detectorTwoTheta</span><span class="p">(</span><span class="n">det</span><span class="p">)</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">180</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pixel at detector ID </span><span class="si">{}</span><span class="s2"> was rotated to </span><span class="si">{:.1f}</span><span class="s2"> degrees.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">detId</span><span class="p">,</span> <span class="n">angleDet</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Pixel at detector ID 202 was rotated to 11.0 degrees.
</pre></div>
</div>
<p><strong>Example - Direct Beam</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">directBeamWS</span> <span class="o">=</span> <span class="n">LoadILLReflectometry</span><span class="p">(</span><span class="s1">&#39;ILL/D17/317369.nxs&#39;</span><span class="p">)</span>
<span class="n">detId</span> <span class="o">=</span> <span class="mi">202</span> <span class="c1"># the foreground centre is around 202</span>
<span class="n">det</span> <span class="o">=</span> <span class="n">directBeamWS</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="n">detId</span><span class="p">)</span>
<span class="n">angleDet</span> <span class="o">=</span> <span class="n">directBeamWS</span><span class="o">.</span><span class="n">detectorTwoTheta</span><span class="p">(</span><span class="n">det</span><span class="p">)</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">180</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pixel at detector ID </span><span class="si">{}</span><span class="s2"> was rotated to </span><span class="si">{:.1f}</span><span class="s2"> degrees.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">detId</span><span class="p">,</span> <span class="n">angleDet</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Pixel at detector ID 202 was rotated to 0.0 degrees.
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/DataHandling/Nexus.html">DataHandling\Nexus</a> | <a class="reference external" href="categories/ILL/Reflectometry.html">ILL\Reflectometry</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/DataHandling/inc/MantidDataHandling/LoadILLReflectometry.h">LoadILLReflectometry.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/DataHandling/src/LoadILLReflectometry.cpp">LoadILLReflectometry.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="LoadILLPolarizedDiffraction-v1.html" title="Previous Chapter: LoadILLPolarizedDiffraction v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; LoadILLPolari...</span>
    </a>
  </li>
  <li>
    <a href="LoadILLSANS-v1.html" title="Next Chapter: LoadILLSANS v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">LoadILLSANS v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>