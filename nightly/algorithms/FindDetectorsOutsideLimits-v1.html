<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>FindDetectorsOutsideLimits v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FindDetectorsPar v1" href="FindDetectorsPar-v1.html" />
    <link rel="prev" title="FindDetectorsInShape v1" href="FindDetectorsInShape-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">FindDetectorsOutsideLimits v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="finddetectorsoutsidelimits-v1">
<span id="algm-finddetectorsoutsidelimits"></span><span id="algm-finddetectorsoutsidelimits-v1"></span><h1>FindDetectorsOutsideLimits v1<a class="headerlink" href="#finddetectorsoutsidelimits-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/FindDetectorsOutsideLimits-v1_dlg.png"><img alt="../_images/FindDetectorsOutsideLimits-v1_dlg.png" class="screenshot" src="../_images/FindDetectorsOutsideLimits-v1_dlg.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>FindDetectorsOutsideLimits</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#childalgorithms-used" id="id6">ChildAlgorithms used</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id7">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id8">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Identifies histograms and their detectors that have total numbers of counts over a user defined maximum or less than the user define minimum.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="FindDeadDetectors-v1.html#algm-finddeaddetectors"><span class="std std-ref">FindDeadDetectors</span></a>, <a class="reference internal" href="DetectorDiagnostic-v1.html#algm-detectordiagnostic"><span class="std std-ref">DetectorDiagnostic</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of the input workspace2D</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Each histogram from the input workspace maps to a histogram in this workspace with one value that indicates if there was a dead detector</p></td>
</tr>
<tr class="row-even"><td><p>HighThreshold</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Spectra whose total number of counts are equal to or above this value will be marked bad (default off)</p></td>
</tr>
<tr class="row-odd"><td><p>LowThreshold</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Spectra whose total number of counts are equal to or below this value will be marked bad (default 0)</p></td>
</tr>
<tr class="row-even"><td><p>StartWorkspaceIndex</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The index number of the first spectrum to include in the calculation (default 0)</p></td>
</tr>
<tr class="row-odd"><td><p>EndWorkspaceIndex</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The index number of the last spectrum to include in the calculation (default the last histogram)</p></td>
</tr>
<tr class="row-even"><td><p>RangeLower</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>No bin with a boundary at an x value less than this will be used in the summation that decides if a detector is ‘bad’ (default: the start of each histogram)</p></td>
</tr>
<tr class="row-odd"><td><p>RangeUpper</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>No bin with a boundary at an x value higher than this value will be used in the summation that decides if a detector is ‘bad’ (default: the end of each histogram)</p></td>
</tr>
<tr class="row-even"><td><p>NumberOfFailures</p></td>
<td><p>Output</p></td>
<td><p>number</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This is intended to identify detectors that are grossly over or under
counting. It reads the input workspace and identifies all histograms
with numbers of counts outside the user defined upper and lower limits.
Each spectra that fails has its spectra masked on the output workspace.
Spectra that pass the test have their data set to a positive value, 1.0.
The output workspace can be fed to <a class="reference internal" href="MaskDetectors-v1.html#algm-maskdetectors"><span class="std std-ref">MaskDetectors v1</span></a> to
mask the same spectra on another workspace.</p>
<section id="childalgorithms-used">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">ChildAlgorithms used</a><a class="headerlink" href="#childalgorithms-used" title="Permalink to this heading">¶</a></h3>
<p>Uses the <a class="reference internal" href="Integration-v1.html#algm-integration"><span class="std std-ref">Integration v1</span></a> algorithm to sum the spectra.</p>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example:</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="n">BankPixelWidth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">NumBanks</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#create dome dead and noisy detectors</span>
<span class="n">deadDetArray</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">ws</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()</span>
<span class="n">noisyDetArray</span><span class="o">=</span> <span class="p">[</span><span class="mf">100.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">ws</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">(),</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">ws</span><span class="o">.</span><span class="n">setY</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">deadDetArray</span><span class="p">))</span>
    <span class="n">ws</span><span class="o">.</span><span class="n">setY</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">noisyDetArray</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;With just the default LowThreshold of 0&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">wsOut</span><span class="p">,</span><span class="n">NumberOfFailures</span><span class="p">)</span><span class="o">=</span><span class="n">FindDetectorsOutsideLimits</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> spectra were outside the limits.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">NumberOfFailures</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;With a High and LowThreshold, as well as restricting the range to consider&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">wsOut2</span><span class="p">,</span><span class="n">NumberOfFailures</span><span class="p">)</span><span class="o">=</span><span class="n">FindDetectorsOutsideLimits</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">HighThreshold</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">LowThreshold</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">RangeLower</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">RangeUpper</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> spectra were outside the limits.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">NumberOfFailures</span><span class="p">))</span>

<span class="n">mtd</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>With just the default LowThreshold of 0
20 spectra were outside the limits.

With a High and LowThreshold, as well as restricting the range to consider
40 spectra were outside the limits.
</pre></div>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSimulationWorkspace</span><span class="p">(</span><span class="s1">&#39;MARI&#39;</span><span class="p">,</span><span class="s1">&#39;0,1,10&#39;</span><span class="p">)</span>
<span class="n">nh</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nh</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ind</span><span class="o">&gt;=</span><span class="mi">100</span> <span class="ow">and</span> <span class="n">ind</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="p">:</span>
        <span class="n">y</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">mws1</span><span class="p">,</span><span class="n">nMasked1</span> <span class="o">=</span> <span class="n">FindDetectorsOutsideLimits</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">mws2</span><span class="p">,</span><span class="n">nMasked2</span> <span class="o">=</span> <span class="n">FindDetectorsOutsideLimits</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="n">startWorkspaceIndex</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;****************************************&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;full mask ws has </span><span class="si">{0}</span><span class="s2"> masked detectors&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nMasked1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;part mask ws  has </span><span class="si">{0}</span><span class="s2"> masked detectors&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nMasked2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;****************************************&quot;</span><span class="p">)</span>
<span class="n">selected_spec</span> <span class="o">=</span> <span class="p">[</span><span class="mi">99</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">199</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">299</span><span class="p">,</span><span class="mi">300</span><span class="p">]</span>
<span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">selected_spec</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;full mask ws Spec N</span><span class="si">{0}</span><span class="s2"> is masked: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span><span class="n">mws1</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="n">spec</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;part mask ws Spec N</span><span class="si">{0}</span><span class="s2"> is masked: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span><span class="n">mws2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="n">spec</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;****************************************&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>****************************************
full mask ws has 200 masked detectors
part mask ws  has 100 masked detectors
****************************************
full mask ws Spec N99 is masked: False
part mask ws Spec N99 is masked: False
full mask ws Spec N100 is masked: True
part mask ws Spec N100 is masked: False
full mask ws Spec N199 is masked: True
part mask ws Spec N199 is masked: False
full mask ws Spec N200 is masked: True
part mask ws Spec N200 is masked: True
full mask ws Spec N299 is masked: True
part mask ws Spec N299 is masked: True
full mask ws Spec N300 is masked: False
part mask ws Spec N300 is masked: False
****************************************
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Diagnostics.html">Diagnostics</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/Algorithms/inc/MantidAlgorithms/FindDetectorsOutsideLimits.h">FindDetectorsOutsideLimits.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/Algorithms/src/FindDetectorsOutsideLimits.cpp">FindDetectorsOutsideLimits.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="FindDetectorsInShape-v1.html" title="Previous Chapter: FindDetectorsInShape v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; FindDetectors...</span>
    </a>
  </li>
  <li>
    <a href="FindDetectorsPar-v1.html" title="Next Chapter: FindDetectorsPar v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">FindDetectorsPar v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>