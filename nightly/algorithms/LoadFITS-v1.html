<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>LoadFITS v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LoadFlexiNexus v1" href="LoadFlexiNexus-v1.html" />
    <link rel="prev" title="LoadEventPreNexus v2" href="LoadEventPreNexus-v2.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">LoadFITS v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="loadfits-v1">
<span id="algm-loadfits"></span><span id="algm-loadfits-v1"></span><h1>LoadFITS v1<a class="headerlink" href="#loadfits-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/LoadFITS-v1_dlg.png"><img alt="../_images/LoadFITS-v1_dlg.png" class="screenshot" src="../_images/LoadFITS-v1_dlg.png" style="width: 329px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>LoadFITS</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#fits-header-entries" id="id6">FITS header entries</a></p></li>
<li><p><a class="reference internal" href="#child-algorithms-used" id="id7">Child algorithms used</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id8">Usage</a></p>
<ul>
<li><p><a class="reference internal" href="#example-1-loading-one-spectrum-per-image-row" id="id9">Example 1: loading one spectrum per image row</a></p></li>
<li><p><a class="reference internal" href="#example-2-loading-one-spectrum-per-pixel" id="id10">Example 2: loading one spectrum per pixel</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#source" id="id11">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Load FITS files into workspaces of type Workspace2D.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="Load-v1.html#algm-load"><span class="std std-ref">Load</span></a>, <a class="reference internal" href="SaveFITS-v1.html#algm-savefits"><span class="std std-ref">SaveFITS</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Filename</p></td>
<td><p>Input</p></td>
<td><p>list of str lists</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the input file (note that you can give multiple file names separated by commas). Allowed extensions: [‘.fits’, ‘.fit’]</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>LoadAsRectImg</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>If enabled (not by default), the output Workspace2D will have one histogram per row and one bin per pixel, such that a 2D color plot (color fill plot) will display an image.</p></td>
</tr>
<tr class="row-odd"><td><p>FilterNoiseLevel</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Threshold to remove noisy pixels. Try 50 for example.</p></td>
</tr>
<tr class="row-even"><td><p>BinSize</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1</p></td>
<td><p>Rebunch n*n on both axes, generating pixels with sums of blocks of n by n original pixels.</p></td>
</tr>
<tr class="row-odd"><td><p>Scale</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>80</p></td>
<td><p>Pixels per cm.</p></td>
</tr>
<tr class="row-even"><td><p>HeaderMapFile</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>A file mapping header key names to non-standard names [line separated values in the format KEY=VALUE, e.g. BitDepthName=BITPIX] - do not use this if you want to keep compatibility with standard FITS files.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>Load FITS files, which typically contain images, into a
<a class="reference internal" href="../concepts/WorkspaceGroup.html#workspacegroup"><span class="std std-ref">WorkspaceGroup</span></a>. FITS stands for Flexible Image
Transport System, see <a class="reference external" href="http://en.wikipedia.org/wiki/FITS">http://en.wikipedia.org/wiki/FITS</a>. A new
workspace (of type <a class="reference internal" href="../concepts/Workspace2D.html#workspace2d"><span class="std std-ref">Workspace2D</span></a>) is created for
every FITS file loaded with this algorithm, and these workspaces are
added into a <a class="reference internal" href="../concepts/WorkspaceGroup.html#workspacegroup"><span class="std std-ref">WorkspaceGroup</span></a>. The group
workspace is named as indicated in the OutputWorkspace input
property. The workspaces included in the group are named with the same
name and an appendix _1, _2, etc., incremented sequentially as new
files are loaded with the same OutputWorkspace property.</p>
<p>The way image pixels are loaded into the resulting workspaces depends
on the property LoadAsRectImg. If it is set as false, one spectrum
will be created for every image pixel. Otherwise, one spectrum will be
created for every image row.</p>
<p>When LoadAsRectImg is true, the workspaces created by this algorithm
contain one spectrum per row (and one bin per column). The first
spectrum corresponds to the first (topmost) row and the last spectrum
corresponds to the last (bottom) column. With this type of workspace
you can display the image with a “color fill plot” or plot2D.</p>
<p>When LoadAsRectImg is false, the workspaces created by this algorithm
contain one spectrum per pixel. The first spectrum corresponds to the
top-left corner and the last spectrum to the bottom-right corner. The
image pixels are assigned to spectra row by row, i.e., the first
spectra correspond to the first or topmost row, the next spectra
correspond to the next rows, going from top down, until finally the
last spectra correspond to the last or bottom row.</p>
<p>The current implementation of this algorithm only supports 2D files
(FITS images with two axes). With this condition, in principle this
algorithm should be able to load any standard FITS file, and also
those who do not deviate too much from the standard. See below an
explanation of the minimum set of basic standard header entries that
this algorithm requires (those should be present in any FITS file), So
far, the algorithm has been tested with files produced by the cameras
used for the IMAT instrument at ISIS, and Starlight Xpress CCD cameras
used for calibration of other instruments at ISIS.</p>
<section id="fits-header-entries">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">FITS header entries</a><a class="headerlink" href="#fits-header-entries" title="Permalink to this heading">¶</a></h3>
<p>At a very minimum, the standard header entries SIMPLE, BITPIX, NAXIS,
NAXIS1, and NAXIS2 must be present in the file.</p>
<p>This algorithm interprets extension headers defined for the IMAT
instrument (ISIS facility). The set of extension headers for the IMAT
instrument is being defined as of this writing and specific support
and/or functionality related to additional headers might be added in
this algorithm.</p>
</section>
<section id="child-algorithms-used">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Child algorithms used</a><a class="headerlink" href="#child-algorithms-used" title="Permalink to this heading">¶</a></h3>
<p>This algorithm uses one child algorithm:</p>
<ul class="simple">
<li><p><a class="reference internal" href="LoadInstrument-v1.html#algm-loadinstrument"><span class="std std-ref">LoadInstrument v1</span></a>, which looks for a description of the
instrument in the facilities definition file and if found reads it.
This algorithm is used only once when loading a set of FITS file
corresponding to the same instrument.</p></li>
</ul>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<section id="example-1-loading-one-spectrum-per-image-row">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Example 1: loading one spectrum per image row</a><a class="headerlink" href="#example-1-loading-one-spectrum-per-image-row" title="Permalink to this heading">¶</a></h3>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws_name</span> <span class="o">=</span> <span class="s1">&#39;FITSimgs&#39;</span>
<span class="n">wsg</span> <span class="o">=</span> <span class="n">LoadFITS</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;FITS_small_01.fits&#39;</span><span class="p">,</span> <span class="n">LoadAsRectImg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="n">ws_name</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wsg</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># A couple of standard FITS header entries</span>
<span class="n">bpp_log</span> <span class="o">=</span> <span class="s1">&#39;BITPIX&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">log</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getRun</span><span class="p">()</span><span class="o">.</span><span class="n">getLogData</span><span class="p">(</span><span class="n">bpp_log</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bits per pixel: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">log</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not find the keyword &#39;</span><span class="si">{}</span><span class="s2">&#39; in this FITS file&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bpp_log</span><span class="p">))</span>

<span class="n">axis1_log</span> <span class="o">=</span> <span class="s1">&#39;NAXIS1&#39;</span>
<span class="n">axis2_log</span> <span class="o">=</span> <span class="s1">&#39;NAXIS2&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">log1</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getRun</span><span class="p">()</span><span class="o">.</span><span class="n">getLogData</span><span class="p">(</span><span class="n">axis1_log</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
    <span class="n">log2</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getRun</span><span class="p">()</span><span class="o">.</span><span class="n">getLogData</span><span class="p">(</span><span class="n">axis2_log</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FITS image size: </span><span class="si">{}</span><span class="s2"> x </span><span class="si">{}</span><span class="s2"> pixels&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">log1</span><span class="p">,</span> <span class="n">log2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of spectra in the output workspace: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not find the keywords &#39;</span><span class="si">{}</span><span class="s2">&#39; and &#39;</span><span class="si">{}</span><span class="s2">&#39; in this FITS file&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">axis1_log</span><span class="p">,</span> <span class="n">axis2_log</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Bits per pixel: 16
FITS image size: 512 x 512 pixels
Number of spectra in the output workspace: 512
</pre></div>
</div>
</section>
<section id="example-2-loading-one-spectrum-per-pixel">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Example 2: loading one spectrum per pixel</a><a class="headerlink" href="#example-2-loading-one-spectrum-per-pixel" title="Permalink to this heading">¶</a></h3>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws_name</span> <span class="o">=</span> <span class="s1">&#39;FITSws&#39;</span>
<span class="n">wsg</span> <span class="o">=</span> <span class="n">LoadFITS</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;FITS_small_01.fits&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="n">ws_name</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wsg</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># A couple of standard FITS header entries</span>
<span class="n">bpp_log</span> <span class="o">=</span> <span class="s1">&#39;BITPIX&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">log</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getRun</span><span class="p">()</span><span class="o">.</span><span class="n">getLogData</span><span class="p">(</span><span class="n">bpp_log</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bits per pixel: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">log</span><span class="p">)))</span>
<span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not find the keyword &#39;</span><span class="si">{}</span><span class="s2">&#39; in this FITS file&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bpp_log</span><span class="p">))</span>

<span class="n">axis1_log</span> <span class="o">=</span> <span class="s1">&#39;NAXIS1&#39;</span>
<span class="n">axis2_log</span> <span class="o">=</span> <span class="s1">&#39;NAXIS2&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">log1</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getRun</span><span class="p">()</span><span class="o">.</span><span class="n">getLogData</span><span class="p">(</span><span class="n">axis1_log</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
    <span class="n">log2</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getRun</span><span class="p">()</span><span class="o">.</span><span class="n">getLogData</span><span class="p">(</span><span class="n">axis2_log</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FITS image size: </span><span class="si">{}</span><span class="s2"> x </span><span class="si">{}</span><span class="s2"> pixels&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">log1</span><span class="p">,</span> <span class="n">log2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of spectra in the output workspace: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not find the keywords &#39;</span><span class="si">{}</span><span class="s2">&#39; and &#39;</span><span class="si">{}</span><span class="s2">&#39; in this FITS file&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">axis1_log</span><span class="p">,</span> <span class="n">axis2_log</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Bits per pixel: 16
FITS image size: 512 x 512 pixels
Number of spectra in the output workspace: 262144
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/DataHandling/Imaging.html">DataHandling\Imaging</a></p>
</section>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/DataHandling/inc/MantidDataHandling/LoadFITS.h">LoadFITS.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/DataHandling/src/LoadFITS.cpp">LoadFITS.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="LoadEventPreNexus-v2.html" title="Previous Chapter: LoadEventPreNexus v2"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; LoadEventPreNexus v2</span>
    </a>
  </li>
  <li>
    <a href="LoadFlexiNexus-v1.html" title="Next Chapter: LoadFlexiNexus v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">LoadFlexiNexus v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>