<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>DetectorEfficiencyVariation v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="DetectorFloodWeighting v1" href="DetectorFloodWeighting-v1.html" />
    <link rel="prev" title="DetectorEfficiencyCorUser v1" href="DetectorEfficiencyCorUser-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">DetectorEfficiencyVariation v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="detectorefficiencyvariation-v1">
<span id="algm-detectorefficiencyvariation"></span><span id="algm-detectorefficiencyvariation-v1"></span><h1>DetectorEfficiencyVariation v1<a class="headerlink" href="#detectorefficiencyvariation-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/DetectorEfficiencyVariation-v1_dlg.png"><img alt="../_images/DetectorEfficiencyVariation-v1_dlg.png" class="screenshot" src="../_images/DetectorEfficiencyVariation-v1_dlg.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>DetectorEfficiencyVariation</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#child-algorithms-used" id="id6">Child algorithms used</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id7">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id8">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Compares two white beam vanadium workspaces from the same instrument to find detectors whose efficiencies have changed beyond a threshold.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="DetectorDiagnostic-v1.html#algm-detectordiagnostic"><span class="std std-ref">DetectorDiagnostic</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>WhiteBeamBase</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of a white beam vanadium workspace</p></td>
</tr>
<tr class="row-odd"><td><p>WhiteBeamCompare</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of a matching second white beam vanadium run from the same instrument</p></td>
</tr>
<tr class="row-even"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>A MaskWorkpace where each spectra that failed the test is masked. Each histogram from the input workspace maps to a histogram in this workspace with one value that indicates if there was a dead detector.</p></td>
</tr>
<tr class="row-odd"><td><p>Variation</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1.1</p></td>
<td><p>Identify histograms whose total number of counts has changed by more than this factor of the median change between the two input workspaces.</p></td>
</tr>
<tr class="row-even"><td><p>StartWorkspaceIndex</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The index number of the first spectrum to include in the calculation (default: 0)</p></td>
</tr>
<tr class="row-odd"><td><p>EndWorkspaceIndex</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The index number of the last spectrum to include in the calculation (default: the last spectrum in the workspace)</p></td>
</tr>
<tr class="row-even"><td><p>RangeLower</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>No bin with a boundary at an x value less than this will be included in the summation used to decide if a detector is ‘bad’ (default: the start of each histogram)</p></td>
</tr>
<tr class="row-odd"><td><p>RangeUpper</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>No bin with a boundary at an x value higher than this value will be included in the summation used to decide if a detector is ‘bad’ (default: the end of each histogram)</p></td>
</tr>
<tr class="row-even"><td><p>NumberOfFailures</p></td>
<td><p>Output</p></td>
<td><p>number</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>It is intended that the input white beam vanadium workspaces are from
the same instrument and were collected before and after an experimental
run of interest. First the ratios of the total number of counts in
corresponding histograms from each input workspace are calculated and
then the median ratio is calculated. Each ratio is compared to the
median and a histogram will fail when any of the following conditions
are true:</p>
<ul class="simple">
<li><p>(sum1/sum2)/median(sum1/sum2) &gt; Variation</p></li>
<li><p>(sum1/sum2)/median(sum1/sum2) &lt; 1/Variation</p></li>
</ul>
<p>where sum1 is the sum of the counts in a histogram in the workspace
WhiteBeamBase and sum2 is the sum of the counts in the equivalent
histogram in WhiteBeamCompare. The above equations only make sense for
identifying bad detectors if Variation &gt; 1. If a value of less than one
is given for Variation then Variation will be set to the reciprocal.</p>
<p>The output workspace contains a MaskWorkspace where those spectra that
fail the tests are masked and those that pass them are assigned a single
positive value.</p>
<section id="child-algorithms-used">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Child algorithms used</a><a class="headerlink" href="#child-algorithms-used" title="Permalink to this heading">¶</a></h3>
<p>Uses the <a class="reference internal" href="Integration-v1.html#algm-integration"><span class="std std-ref">Integration v1</span></a> algorithm to sum the spectra.</p>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example:</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">wsBase</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">noisyY</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">noisyY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mf">1e20</span>
<span class="n">ws</span><span class="o">.</span><span class="n">setY</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="n">noisyY</span><span class="p">)</span>

<span class="p">(</span><span class="n">wsOut</span><span class="p">,</span> <span class="n">numFailures</span><span class="p">)</span> <span class="o">=</span> <span class="n">DetectorEfficiencyVariation</span><span class="p">(</span><span class="n">WhiteBeamBase</span><span class="o">=</span><span class="s1">&#39;wsBase&#39;</span><span class="p">,</span> <span class="n">WhiteBeamCompare</span><span class="o">=</span><span class="s1">&#39;ws&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> spectra has been masked in wsOut&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numFailures</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1 spectra has been masked in wsOut
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Diagnostics.html">Diagnostics</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/ae5920090788fe85703dcb99039251b0d956c4b7/Framework/Algorithms/inc/MantidAlgorithms/DetectorEfficiencyVariation.h">DetectorEfficiencyVariation.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/ae5920090788fe85703dcb99039251b0d956c4b7/Framework/Algorithms/src/DetectorEfficiencyVariation.cpp">DetectorEfficiencyVariation.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="DetectorEfficiencyCorUser-v1.html" title="Previous Chapter: DetectorEfficiencyCorUser v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; DetectorEffic...</span>
    </a>
  </li>
  <li>
    <a href="DetectorFloodWeighting-v1.html" title="Next Chapter: DetectorFloodWeighting v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">DetectorFlood... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>