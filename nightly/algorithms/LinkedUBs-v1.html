<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>LinkedUBs v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LiquidsReflectometryReduction v1" href="LiquidsReflectometryReduction-v1.html" />
    <link rel="prev" title="LineProfile v1" href="LineProfile-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">LinkedUBs v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="linkedubs-v1">
<span id="algm-linkedubs"></span><span id="algm-linkedubs-v1"></span><h1>LinkedUBs v1<a class="headerlink" href="#linkedubs-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/LinkedUBs-v1_dlg.png"><img alt="../_images/LinkedUBs-v1_dlg.png" class="screenshot" src="../_images/LinkedUBs-v1_dlg.png" style="width: 349px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>LinkedUBs</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p></li>
<li><p><a class="reference internal" href="#useage" id="id6">Useage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id7">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Links the indexing of a given run to the UB of a reference         run. PredictedPeaks should be calculated via goniometer rotation of          the reference UB. Use of this algorithm will result in a seperate           (linked) UB for each goniometer setting considered.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="SetGoniometer-v1.html#algm-setgoniometer"><span class="std std-ref">SetGoniometer</span></a>, <a class="reference internal" href="CalculateUMatrix-v1.html#algm-calculateumatrix"><span class="std std-ref">CalculateUMatrix</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>QTolerance</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.5</p></td>
<td><p>Radius of isotropic q envelope to search within.</p></td>
</tr>
<tr class="row-odd"><td><p>QDecrement</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.95</p></td>
<td><p>Multiplicative factor by which to decrement q envelope             on each iteration.</p></td>
</tr>
<tr class="row-even"><td><p>DTolerance</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.01</p></td>
<td><p>Observed peak is linked if             abs(dSpacing) &lt; dPredicted + dTolerance.</p></td>
</tr>
<tr class="row-odd"><td><p>NumPeaks</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>15</p></td>
<td><p>Number of peaks, ordered from highest to lowest             dSpacing to consider.</p></td>
</tr>
<tr class="row-even"><td><p>PeakIncrement</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>10</p></td>
<td><p>Number of peaks to add to numPeaks on each iteration.</p></td>
</tr>
<tr class="row-odd"><td><p>Iterations</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>10</p></td>
<td><p>Number of cycles of refinement.</p></td>
</tr>
<tr class="row-even"><td><p>a</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1</p></td>
<td><p>Lattice parameter a.</p></td>
</tr>
<tr class="row-odd"><td><p>b</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1</p></td>
<td><p>Lattice parameter b.</p></td>
</tr>
<tr class="row-even"><td><p>c</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1</p></td>
<td><p>Lattice parameter c.</p></td>
</tr>
<tr class="row-odd"><td><p>alpha</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>90</p></td>
<td><p>Lattice parameter alpha.</p></td>
</tr>
<tr class="row-even"><td><p>beta</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>90</p></td>
<td><p>Lattice parameter beta.</p></td>
</tr>
<tr class="row-odd"><td><p>gamma</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>90</p></td>
<td><p>Lattice parameter gamma.</p></td>
</tr>
<tr class="row-even"><td><p>MinWavelength</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.8</p></td>
<td><p>Minimum wavelength for LinkedPredictedPeaks.</p></td>
</tr>
<tr class="row-odd"><td><p>MaxWavelength</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>9.3</p></td>
<td><p>Maximum wavelength for LinkedPredictedPeaks.</p></td>
</tr>
<tr class="row-even"><td><p>MinDSpacing</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.6</p></td>
<td><p>Minimum dSpacing for LinkedPredictedPeaks.</p></td>
</tr>
<tr class="row-odd"><td><p>MaxDSpacing</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>20</p></td>
<td><p>Maximum dSpacing for LinkedPredictedPeaks.</p></td>
</tr>
<tr class="row-even"><td><p>ReflectionCondition</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Primitive</p></td>
<td><p>Reflection condition                                     for LinkedPredictedPeaks. Allowed values: [‘Primitive’, ‘C-face centred’, ‘A-face centred’, ‘B-face centred’, ‘Body centred’, ‘All-face centred’, ‘Rhombohedrally centred, obverse’, ‘Rhombohedrally centred, reverse’, ‘Hexagonally centred, reverse’]</p></td>
</tr>
<tr class="row-odd"><td><p>Workspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Instrument workspace on which observed peaks are defined.</p></td>
</tr>
<tr class="row-even"><td><p>ObservedPeaks</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>FindPeaks table to which PredictedPeaks are compared.</p></td>
</tr>
<tr class="row-odd"><td><p>PredictedPeaks</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>PredictedPeaks table to which ObservedPeaks are compared.</p></td>
</tr>
<tr class="row-even"><td><p>LinkedPeaks</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Linked peaks: UB matrix consistent with that of             PredictedPeaks.</p></td>
</tr>
<tr class="row-odd"><td><p>LinkedPredictedPeaks</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>LinkedPredictedPeaks: UB matrix consistent with             PredictedPeaks.</p></td>
</tr>
<tr class="row-even"><td><p>DeleteWorkspace</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Delete workspace after execution for memory management.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>Given an initial UB at some goniometer configuration, this algorithm facilitates
the ‘linking’ of the UBs across orientations - in other words, ensuring the
continuity of the indexing of reflections throughout reciprocal space allowing
for grouping of reflections and refinement.</p>
<p>On chopper instruments, when the sample is lowered into the
blockhouse there is often no possibility to adjust its position. When rotating the
crystal via the goniometer, since the crystal is likely not centred exactly, the
predicted peaks from the initial UB often do not capture the data. As well as
consistently indexing the peaks, the algorithm also effectively carries out a U
matrix correction that accounts for sample miscentering. Use of this algorithm
will result in a seperate UB matrix for each orientation which can then be used
for integration.</p>
<p>The algorithm requires a set of predicted peaks that have been generated from
the initial UB via goniometer rotation, a set of observed (found) peaks, and
the lattice parameters in order to calculate the B matrix. A search within a
Q-envelope is carried out in which all peaks within the envelope are screened
as potential ‘matches’ to the observed peaks by comparing dspacing values.</p>
<p>This approach works well in simple cases, but for large unit cells and
modulated structures where lots of peaks with small and similar dspacings
appear, it is useful to make use of the NumPeaks parameter. This sorts the
predicted peaks from largest to smallest dspacing and defines which peaks are
used for the first cycle. As the refinement of the UB is carried out, more
peaks at shorter d are added, encoded by the PeakIncrement parameter. This adds
a defined number of peaks after each cycle.</p>
<p>The main limitation of this approach is that the lattice parameters of the sample should be known accurately. It is recommended that at least 10 iterations are carried out, but in cases where the crystal is well centred and the goniometer angles are known accurately fewer iterations are necessary.</p>
</section>
<section id="useage">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Useage</a><a class="headerlink" href="#useage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># WISH single crystal</span>
<span class="c1"># demonstration of linkedUBs algorithm on D10 Ruby (cyle 18/1)</span>

<span class="kn">from</span> <span class="nn">mantid.simpleapi</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># lattice parameters</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">4.764407</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">4.76440</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">13.037904</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mi">120</span>

<span class="c1"># parameters for PredictPeaks</span>
<span class="n">MinDSpacing</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">MaxDSpacing</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">MinWavelength</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">MaxWavelength</span> <span class="o">=</span> <span class="mf">9.3</span>
<span class="n">ReflectionCondition</span><span class="o">=</span><span class="s1">&#39;Primitive&#39;</span>

<span class="c1"># parameters for LinkedUBs</span>
<span class="n">QTolerance</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">QDecrement</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">DTolerance</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">NumPeaks</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">PeakIncrement</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">Iterations</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">DeleteWorkspace</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># phi axis at omega = 270</span>
<span class="n">u_phi_x</span><span class="p">,</span> <span class="n">u_phi_y</span><span class="p">,</span> <span class="n">u_phi_z</span> <span class="o">=</span> <span class="mf">0.58779</span><span class="p">,</span> <span class="mf">0.80902</span><span class="p">,</span> <span class="mf">0.0</span>

<span class="c1"># load and process 41598</span>
<span class="n">LoadRaw</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;WISH00041598.raw&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598&#39;</span><span class="p">)</span>
<span class="n">CropWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598&#39;</span><span class="p">,</span> <span class="n">XMin</span><span class="o">=</span><span class="mi">6000</span><span class="p">,</span> <span class="n">XMax</span><span class="o">=</span><span class="mi">99000</span><span class="p">)</span>
<span class="n">ConvertUnits</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598&#39;</span><span class="p">,</span> <span class="n">Target</span><span class="o">=</span><span class="s1">&#39;dSpacing&#39;</span><span class="p">,</span> <span class="n">ConvertFromPointData</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># load and process 41599</span>
<span class="n">LoadRaw</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;WISH00041599.raw&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041599&#39;</span><span class="p">)</span>
<span class="n">CropWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041599&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041599&#39;</span><span class="p">,</span> <span class="n">XMin</span><span class="o">=</span><span class="mi">6000</span><span class="p">,</span> <span class="n">XMax</span><span class="o">=</span><span class="mi">99000</span><span class="p">)</span>
<span class="n">ConvertUnits</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041599&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041599&#39;</span><span class="p">,</span> <span class="n">Target</span><span class="o">=</span><span class="s1">&#39;dSpacing&#39;</span><span class="p">,</span> <span class="n">ConvertFromPointData</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># find peaks on 41598 and 41599</span>
<span class="n">FindSXPeaks</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598&#39;</span><span class="p">,</span> <span class="n">PeakFindingStrategy</span><span class="o">=</span><span class="s1">&#39;AllPeaks&#39;</span><span class="p">,</span> <span class="n">ResolutionStrategy</span><span class="o">=</span><span class="s1">&#39;AbsoluteResolution&#39;</span><span class="p">,</span> <span class="n">XResolution</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">PhiResolution</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">TwoThetaResolution</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598_find_peaks&#39;</span><span class="p">)</span>

<span class="n">FindSXPeaks</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041599&#39;</span><span class="p">,</span> <span class="n">PeakFindingStrategy</span><span class="o">=</span><span class="s1">&#39;AllPeaks&#39;</span><span class="p">,</span> <span class="n">ResolutionStrategy</span><span class="o">=</span><span class="s1">&#39;AbsoluteResolution&#39;</span><span class="p">,</span> <span class="n">XResolution</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">PhiResolution</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">TwoThetaResolution</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041599_find_peaks&#39;</span><span class="p">)</span>

<span class="c1"># find and optimise UB on 41598 using lattice parameters</span>
<span class="n">FindUBUsingLatticeParameters</span><span class="p">(</span><span class="n">PeaksWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598_find_peaks&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span> <span class="n">NumInitial</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">Tolerance</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">Iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">PredictPeaks</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598_find_peaks&#39;</span><span class="p">,</span> <span class="n">WavelengthMin</span><span class="o">=</span><span class="n">MinWavelength</span><span class="p">,</span> <span class="n">WavelengthMax</span><span class="o">=</span><span class="n">MaxWavelength</span><span class="p">,</span> <span class="n">MinDSpacing</span><span class="o">=</span><span class="n">MinDSpacing</span><span class="p">,</span> <span class="n">ReflectionCondition</span><span class="o">=</span><span class="n">ReflectionCondition</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598_predict_peaks&#39;</span><span class="p">)</span>

<span class="n">OptimizeLatticeForCellType</span><span class="p">(</span><span class="n">PeaksWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598_predict_peaks&#39;</span><span class="p">,</span> <span class="n">CellType</span><span class="o">=</span><span class="s1">&#39;Hexagonal&#39;</span><span class="p">,</span> <span class="n">Apply</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">CopySample</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598_predict_peaks&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598&#39;</span><span class="p">,</span> <span class="n">CopyName</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">CopyMaterial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">CopyEnvironment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">CopyShape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># set gonio on 41598 and predict the peaks of 41599</span>
<span class="n">SetGoniometer</span><span class="p">(</span><span class="n">Workspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598&#39;</span><span class="p">,</span> <span class="n">Axis0</span><span class="o">=</span><span class="s1">&#39;0,0,1,0,1&#39;</span><span class="p">,</span> <span class="n">Axis1</span><span class="o">=</span><span class="s1">&#39;25,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,-1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u_phi_x</span><span class="p">,</span> <span class="n">u_phi_y</span><span class="p">,</span> <span class="n">u_phi_z</span><span class="p">))</span>
<span class="n">PredictPeaks</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041598&#39;</span><span class="p">,</span> <span class="n">WavelengthMin</span><span class="o">=</span><span class="n">MinWavelength</span><span class="p">,</span> <span class="n">WavelengthMax</span><span class="o">=</span><span class="n">MaxWavelength</span><span class="p">,</span> <span class="n">MinDSpacing</span><span class="o">=</span><span class="n">MinDSpacing</span><span class="p">,</span> <span class="n">ReflectionCondition</span><span class="o">=</span><span class="n">ReflectionCondition</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;WISH00041599_predict_peaks&#39;</span><span class="p">)</span>

<span class="c1"># linkedUBs</span>
<span class="n">LinkedUBs</span><span class="p">(</span><span class="n">QTolerance</span><span class="o">=</span><span class="n">QTolerance</span><span class="p">,</span>
          <span class="n">QDecrement</span><span class="o">=</span><span class="n">QDecrement</span><span class="p">,</span>
          <span class="n">DTolerance</span><span class="o">=</span><span class="n">DTolerance</span><span class="p">,</span>
          <span class="n">NumPeaks</span><span class="o">=</span><span class="n">NumPeaks</span><span class="p">,</span>
          <span class="n">PeakIncrement</span><span class="o">=</span><span class="n">PeakIncrement</span><span class="p">,</span>
          <span class="n">Iterations</span><span class="o">=</span><span class="n">Iterations</span><span class="p">,</span>
          <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
          <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span>
          <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
          <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
          <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span>
          <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span>
          <span class="n">MinWavelength</span><span class="o">=</span><span class="n">MinWavelength</span><span class="p">,</span>
          <span class="n">MaxWavelength</span><span class="o">=</span><span class="n">MaxWavelength</span><span class="p">,</span>
          <span class="n">MinDSpacing</span><span class="o">=</span><span class="n">MinDSpacing</span><span class="p">,</span>
          <span class="n">MaxDSpacing</span><span class="o">=</span><span class="n">MaxDSpacing</span><span class="p">,</span>
          <span class="n">ReflectionCondition</span><span class="o">=</span><span class="n">ReflectionCondition</span><span class="p">,</span>
          <span class="n">Workspace</span><span class="o">=</span><span class="s1">&#39;WISH00041599&#39;</span><span class="p">,</span>
          <span class="n">ObservedPeaks</span><span class="o">=</span><span class="s1">&#39;WISH00041599_find_peaks&#39;</span><span class="p">,</span>
          <span class="n">PredictedPeaks</span><span class="o">=</span><span class="s1">&#39;WISH00041599_predict_peaks&#39;</span><span class="p">,</span>
          <span class="n">LinkedPeaks</span><span class="o">=</span><span class="s1">&#39;WISH00041599_linked_peaks&#39;</span><span class="p">,</span>
          <span class="n">LinkedPredictedPeaks</span><span class="o">=</span><span class="s1">&#39;WISH00041599_linked_peaks_predicted&#39;</span><span class="p">,</span>
          <span class="n">DeleteWorkspace</span><span class="o">=</span><span class="n">DeleteWorkspace</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Diffraction/Reduction.html">Diffraction\Reduction</a> | <a class="reference external" href="categories/Crystal/UBMatrix.html">Crystal\UBMatrix</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/PythonInterface/plugins/algorithms/LinkedUBs.py">LinkedUBs.py</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="LineProfile-v1.html" title="Previous Chapter: LineProfile v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; LineProfile v1</span>
    </a>
  </li>
  <li>
    <a href="LiquidsReflectometryReduction-v1.html" title="Next Chapter: LiquidsReflectometryReduction v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">LiquidsReflec... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>