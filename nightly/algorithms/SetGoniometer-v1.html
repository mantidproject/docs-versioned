<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>SetGoniometer v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SetInstrumentParameter v1" href="SetInstrumentParameter-v1.html" />
    <link rel="prev" title="SetDetScale v1" href="SetDetScale-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">SetGoniometer v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="setgoniometer-v1">
<span id="algm-setgoniometer"></span><span id="algm-setgoniometer-v1"></span><h1>SetGoniometer v1<a class="headerlink" href="#setgoniometer-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/SetGoniometer-v1_dlg.png"><img alt="../_images/SetGoniometer-v1_dlg.png" class="screenshot" src="../_images/SetGoniometer-v1_dlg.png" style="width: 349px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>SetGoniometer</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id6">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id7">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Define the goniometer motors used in an experiment by giving the axes and directions of rotations.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="GoniometerAnglesFromPhiRotation-v1.html#algm-goniometeranglesfromphirotation"><span class="std std-ref">GoniometerAnglesFromPhiRotation</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Workspace</p></td>
<td><p>InOut</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>An workspace that will be modified with the new goniometer created.</p></td>
</tr>
<tr class="row-odd"><td><p>Goniometers</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>None, Specify Individually</p></td>
<td><p>Set the axes and motor names according to goniometers that we define in the code (Universal defined for SNS). Allowed values: [‘None, Specify Individually’, ‘Universal’]</p></td>
</tr>
<tr class="row-even"><td><p>Axis0</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Axis0: name, x,y,z, 1/-1 (1 for ccw, -1 for cw rotation). A number of degrees can be used instead of name. Leave blank for no axis</p></td>
</tr>
<tr class="row-odd"><td><p>Axis1</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Axis1: name, x,y,z, 1/-1 (1 for ccw, -1 for cw rotation). A number of degrees can be used instead of name. Leave blank for no axis</p></td>
</tr>
<tr class="row-even"><td><p>Axis2</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Axis2: name, x,y,z, 1/-1 (1 for ccw, -1 for cw rotation). A number of degrees can be used instead of name. Leave blank for no axis</p></td>
</tr>
<tr class="row-odd"><td><p>Axis3</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Axis3: name, x,y,z, 1/-1 (1 for ccw, -1 for cw rotation). A number of degrees can be used instead of name. Leave blank for no axis</p></td>
</tr>
<tr class="row-even"><td><p>Axis4</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Axis4: name, x,y,z, 1/-1 (1 for ccw, -1 for cw rotation). A number of degrees can be used instead of name. Leave blank for no axis</p></td>
</tr>
<tr class="row-odd"><td><p>Axis5</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Axis5: name, x,y,z, 1/-1 (1 for ccw, -1 for cw rotation). A number of degrees can be used instead of name. Leave blank for no axis</p></td>
</tr>
<tr class="row-even"><td><p>Average</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>Use the average value of the log, if false a separate goniometer will be created for each value in the logs</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>Use this algorithm to define your goniometer. Enter each axis in the
order of rotation, starting with the one farthest from the sample.</p>
<p>You may enter up to 6 axes, for which you must define (separated by
commas):</p>
<ul class="simple">
<li><p>The name of the axis, which MUST match the name in your sample logs.
You can specify a number, and a log value will be created
(GoniometerAxis?_FixedValue, where ? is the axis number)</p></li>
<li><p>The X, Y, Z components of the vector of the axis of rotation.
Right-handed coordinates with +Z=beam direction; +Y=Vertically up
(against gravity); +X to the left.</p></li>
<li><p>The sense of rotation as 1 or -1: 1 for counter-clockwise, -1 for
clockwise rotation.</p></li>
</ul>
<p>The run’s sample logs will be used in order to determine the actual
angles of rotation: for example, if you have an axis called ‘phi’,
then the time-average value of the log called ‘phi’ will be used as
the rotation angle. Units are assumed to be degrees.</p>
<p>When the Average property is set to False then a separate goniometer
will be created for each value in the log. When multiple log axes are
defined they must have the same length and are assumed to be all the
same time series.</p>
<p>The “Universal” goniometer at SNS is equivalent to Axis0 tied to the
“omega” log pointing vertically upward, Axis1 tied to “chi” log,
pointing along the beam, and Axis2 tied to “phi”, pointing vertically
upward.</p>
<p>SetGoniometer(w,”Universal”) is the same as
SetGoniometer(w,Axis0=”omega,0,1,0,1”,Axis1=”chi,0,0,1,1”,Axis2=”phi,0,1,0,1”)</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">wg</span> <span class="o">=</span> <span class="n">CreateSingleValuedWorkspace</span><span class="p">()</span>
<span class="n">AddSampleLog</span><span class="p">(</span><span class="n">wg</span><span class="p">,</span> <span class="s2">&quot;Motor1&quot;</span><span class="p">,</span> <span class="s2">&quot;45.&quot;</span><span class="p">,</span> <span class="s2">&quot;Number&quot;</span><span class="p">)</span>
<span class="n">SetGoniometer</span><span class="p">(</span><span class="n">wg</span><span class="p">,</span> <span class="n">Axis0</span><span class="o">=</span><span class="s2">&quot;Motor1,0,1,0,1&quot;</span><span class="p">,</span> <span class="n">Axis1</span><span class="o">=</span><span class="s2">&quot;5,0,1,0,1&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Log values: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">getRun</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Goniometer angles:  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">getRun</span><span class="p">()</span><span class="o">.</span><span class="n">getGoniometer</span><span class="p">()</span><span class="o">.</span><span class="n">getEulerAngles</span><span class="p">(</span><span class="s1">&#39;YZY&#39;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Clearing goniometer up&quot;</span><span class="p">)</span>
<span class="n">SetGoniometer</span><span class="p">(</span><span class="n">wg</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Goniometer angles:  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">getRun</span><span class="p">()</span><span class="o">.</span><span class="n">getGoniometer</span><span class="p">()</span><span class="o">.</span><span class="n">getEulerAngles</span><span class="p">(</span><span class="s1">&#39;YZY&#39;</span><span class="p">)</span>    <span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Log values: [&#39;Motor1&#39;, &#39;GoniometerAxis1_FixedValue&#39;]
Goniometer angles:  [50,0,0]
Clearing goniometer up
Goniometer angles:  [0,0,0]
</pre></div>
</div>
<p><strong>Example - multiple goniometers - omega scan</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">LoadILLDiffraction</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;ILL/D20/000017.nxs&#39;</span><span class="p">)</span>
<span class="n">SetGoniometer</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Axis0</span><span class="o">=</span><span class="s1">&#39;omega.position,0,1,0,1&#39;</span><span class="p">,</span> <span class="n">Average</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of goniometers =&#39;</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">run</span><span class="p">()</span><span class="o">.</span><span class="n">getNumGoniometers</span><span class="p">())</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">run</span><span class="p">()</span><span class="o">.</span><span class="n">getNumGoniometers</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> omega = </span><span class="si">{</span><span class="n">ws</span><span class="o">.</span><span class="n">run</span><span class="p">()</span><span class="o">.</span><span class="n">getGoniometer</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">getEulerAngles</span><span class="p">(</span><span class="s2">&quot;YZY&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Number of goniometers = 21
0 omega = 1.0
1 omega = 1.2
2 omega = 1.4
3 omega = 1.6
4 omega = 1.8
5 omega = 2.0
6 omega = 2.2
7 omega = 2.4
8 omega = 2.6
9 omega = 2.8
10 omega = 3.0
11 omega = 3.2
12 omega = 3.4
13 omega = 3.6
14 omega = 3.8
15 omega = 4.0
16 omega = 4.2
17 omega = 4.4
18 omega = 4.6
19 omega = 4.8
20 omega = 5.0
</pre></div>
</div>
<p><strong>Example: WISH goniometer</strong></p>
<p>The WISH instrument at ISIS has a goniometer arm at 45 degrees to vertical (phi axis) that is closest to the sample, and
a vertical rotation axis furthest from the sample (omega axis). The rotation angles about these axes are stored in the
<code class="docutils literal notranslate"><span class="pre">ewald_pos</span></code> and <code class="docutils literal notranslate"><span class="pre">ccr_pos</span></code> logs of the workspace. The initial orientation of the phi-axis (at omega=0) is typically
in the plane normal to the incident beam (i.e. the XY-plane). In this case the goniometer can be set as so</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">LoadEmptyInstrument</span><span class="p">(</span><span class="n">InstrumentName</span><span class="o">=</span><span class="s1">&#39;WISH&#39;</span><span class="p">)</span>
<span class="n">SetGoniometer</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Axis0</span><span class="o">=</span><span class="s2">&quot;ccr_pos,0,1,0,1&quot;</span><span class="p">,</span><span class="n">Axis1</span><span class="o">=</span><span class="s2">&quot;ewald_pos,1,1,0,1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Crystal/Goniometer.html">Crystal\Goniometer</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c02ae4cb378648e7336cc15b6678a80eb5d20757/Framework/Crystal/inc/MantidCrystal/SetGoniometer.h">SetGoniometer.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c02ae4cb378648e7336cc15b6678a80eb5d20757/Framework/Crystal/src/SetGoniometer.cpp">SetGoniometer.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="SetDetScale-v1.html" title="Previous Chapter: SetDetScale v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SetDetScale v1</span>
    </a>
  </li>
  <li>
    <a href="SetInstrumentParameter-v1.html" title="Next Chapter: SetInstrumentParameter v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SetInstrument... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>