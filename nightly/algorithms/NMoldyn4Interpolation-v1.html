<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>NMoldyn4Interpolation v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NOMADMedianDetectorTest v1" href="NOMADMedianDetectorTest-v1.html" />
    <link rel="prev" title="MuonProcess v1" href="MuonProcess-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">NMoldyn4Interpolation v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="nmoldyn4interpolation-v1">
<span id="algm-nmoldyn4interpolation"></span><span id="algm-nmoldyn4interpolation-v1"></span><h1>NMoldyn4Interpolation v1<a class="headerlink" href="#nmoldyn4interpolation-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/NMoldyn4Interpolation-v1_dlg.png"><img alt="../_images/NMoldyn4Interpolation-v1_dlg.png" class="screenshot" src="../_images/NMoldyn4Interpolation-v1_dlg.png" style="width: 424px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>NMoldyn4Interpolation</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id5">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id6">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Maps NMoldyn simulated s(q,e) data onto OSIRIS’ Q and E values</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Simulated workspace</p></td>
</tr>
<tr class="row-odd"><td><p>ReferenceWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Reference OSIRIS workspace to provide values</p></td>
</tr>
<tr class="row-even"><td><p>EFixed</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1.845</p></td>
<td><p>EFixed value of OSIRIS data (should be default in almost all circumstances)</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Output Workspace of remapped simulation data</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>Given simulated s(q,e) data workspace and a reference OSIRIS s(q,e) workspace,
interpolates the simulated data onto the same (q, e) grid as the reference workspace.
This allows direct comparison between simulated and experimental data upon the
same axes. Currently only supports OSIRIS experimental data.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example 1 - Interpolate a simulated data set onto the axes of an experimental
set</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#create a simulated S(Q,E) workspace of a sin function</span>
<span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">q_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">y_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">val</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x_data</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">q_data</span><span class="p">])</span>
<span class="n">y_data</span> <span class="o">=</span> <span class="n">y_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_data</span><span class="p">))</span>
<span class="n">sim_ws</span><span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="n">x_data</span><span class="p">,</span> <span class="n">DataY</span><span class="o">=</span><span class="n">y_data</span><span class="p">,</span> <span class="n">NSpec</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_data</span><span class="p">),</span>
                        <span class="n">VerticalAxisUnit</span><span class="o">=</span><span class="s1">&#39;MomentumTransfer&#39;</span><span class="p">,</span>
                        <span class="n">VerticalAxisValues</span><span class="o">=</span><span class="n">q_data</span><span class="p">)</span>
<span class="c1">#create an empty OSIRIS workspace (this would be your experimental OSIRIS resolution function)</span>
<span class="n">idf_dir</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;instrumentDefinition.directory&#39;</span><span class="p">]</span>
<span class="n">osiris</span> <span class="o">=</span> <span class="n">LoadEmptyInstrument</span><span class="p">(</span><span class="n">idf_dir</span> <span class="o">+</span> <span class="s1">&#39;OSIRIS_Definition.xml&#39;</span><span class="p">)</span>
<span class="n">osiris</span> <span class="o">=</span> <span class="n">CropWorkspace</span><span class="p">(</span><span class="n">osiris</span><span class="p">,</span>  <span class="n">StartWorkspaceIndex</span><span class="o">=</span><span class="mi">970</span><span class="p">,</span> <span class="n">EndWorkspaceIndex</span><span class="o">=</span><span class="mi">980</span><span class="p">)</span>
<span class="n">osiris</span> <span class="o">=</span> <span class="n">Rebin</span><span class="p">(</span><span class="n">osiris</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">])</span>
<span class="c1">#interpolate the two workspaces</span>
<span class="n">interpolated_ws</span> <span class="o">=</span> <span class="n">NMoldyn4Interpolation</span><span class="p">(</span><span class="n">sim_ws</span><span class="p">,</span> <span class="n">osiris</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No. of Q-values in simulation = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim_ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No. of Q-values in reference = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">osiris</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No. of Q-values in interpolated set = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">interpolated_ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="o">.</span> <span class="n">of</span> <span class="n">Q</span><span class="o">-</span><span class="n">values</span> <span class="ow">in</span> <span class="n">simulation</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">No</span><span class="o">.</span> <span class="n">of</span> <span class="n">Q</span><span class="o">-</span><span class="n">values</span> <span class="ow">in</span> <span class="n">reference</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">No</span><span class="o">.</span> <span class="n">of</span> <span class="n">Q</span><span class="o">-</span><span class="n">values</span> <span class="ow">in</span> <span class="n">interpolated</span> <span class="nb">set</span> <span class="o">=</span> <span class="mi">11</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Simulation.html">Simulation</a> | <a class="reference external" href="categories/Inelastic/DataHandling.html">Inelastic\DataHandling</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/PythonInterface/plugins/algorithms/NMoldyn4Interpolation.py">NMoldyn4Interpolation.py</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="MuonProcess-v1.html" title="Previous Chapter: MuonProcess v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; MuonProcess v1</span>
    </a>
  </li>
  <li>
    <a href="NOMADMedianDetectorTest-v1.html" title="Next Chapter: NOMADMedianDetectorTest v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">NOMADMedianDe... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>