<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>UnwrapMonitor v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="UnwrapMonitorsInTOF v1" href="UnwrapMonitorsInTOF-v1.html" />
    <link rel="prev" title="UnGroupWorkspace v1" href="UnGroupWorkspace-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">UnwrapMonitor v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="unwrapmonitor-v1">
<span id="algm-unwrapmonitor"></span><span id="algm-unwrapmonitor-v1"></span><h1>UnwrapMonitor v1<a class="headerlink" href="#unwrapmonitor-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/UnwrapMonitor-v1_dlg.png"><img alt="../_images/UnwrapMonitor-v1_dlg.png" class="screenshot" src="../_images/UnwrapMonitor-v1_dlg.png" style="width: 426px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>UnwrapMonitor</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#restrictions-on-the-input-workspace" id="id6">Restrictions on the Input Workspace</a></p></li>
<li><p><a class="reference internal" href="#child-algorithms-used" id="id7">Child Algorithms Used</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id8">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id9">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Takes an input workspace that contains ‘raw’ data, unwraps the data according to the reference flightpath provided and converts the units to wavelength.The output workspace will have common bins in the maximum theoretical wavelength range.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="UnwrapMonitorsInTOF-v1.html#algm-unwrapmonitorsintof"><span class="std std-ref">UnwrapMonitorsInTOF</span></a>, <a class="reference internal" href="UnwrapSNS-v1.html#algm-unwrapsns"><span class="std std-ref">UnwrapSNS</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>A workspace with x values in units of TOF and y values in counts</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the workspace to be created as the output of the algorithm</p></td>
</tr>
<tr class="row-even"><td><p>LRef</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The length of the reference flight path (in metres)</p></td>
</tr>
<tr class="row-odd"><td><p>JoinWavelength</p></td>
<td><p>Output</p></td>
<td><p>number</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This algorithm is for use with white-beam instruments with choppers. The
chopper cuts the range of wavelengths, so all detectors (including
monitors) should be reduced to the same wavelength range. This is done
using a “reference” flightpath, <span class="math notranslate nohighlight">\(L_{ref}\)</span>, which is (usually, see
below) the flightpath of the farthest detectors.</p>
<p>If <span class="math notranslate nohighlight">\(T_{min}\)</span> and <span class="math notranslate nohighlight">\(T_{max}\)</span> are the beginning and end of the
frame, for each detector <span class="math notranslate nohighlight">\(D\)</span> at total flightpath <span class="math notranslate nohighlight">\(L_d\)</span> the
following times are defined:</p>
<div class="math notranslate nohighlight">
\[T_1 = T_{max} - \left ( T_{min} \times \left ( 1 - \frac{L_d}{L_{ref}} \right ) \right )\]</div>
<div class="math notranslate nohighlight">
\[T_2 = T_{max} \times \left ( \frac{L_d}{L_{ref}} \right )\]</div>
<p>Thus if <span class="math notranslate nohighlight">\(L_d &lt; L_{ref}\)</span> then <span class="math notranslate nohighlight">\(T_1 &gt; T_2\)</span></p>
<p>Neutron velocities (and hence wavelengths) for the detector <span class="math notranslate nohighlight">\(D\)</span>
are calculated in the following way:</p>
<ul class="simple">
<li><p>For <span class="math notranslate nohighlight">\(T_{min} &lt; T &lt; T_2\)</span>, velocities are calculated in the usual
way, i.e. <span class="math notranslate nohighlight">\(v = \frac{L_d}{T}\)</span></p></li>
<li><p>Data in the range <span class="math notranslate nohighlight">\(T_2 &lt; T &lt; T_1\)</span> are ignored (i.e. they are
not used in the wavelength-converted histograms)</p></li>
<li><p>For <span class="math notranslate nohighlight">\(T_1 &lt; T &lt; T_{max}\)</span>, velocities are calculated using the
formula <span class="math notranslate nohighlight">\(v = \frac{L_d}{T - T_{max} + T_{min}}\)</span></p></li>
</ul>
<p>Note that the minimum and maximum velocities for the points that are
actually <em>used</em> are:</p>
<div class="math notranslate nohighlight">
\[v_{max} = \frac{L_d}{T - T_{max} + T_{min}} = \frac{L_{ref}}{T_{min}}\]</div>
<p>and <span class="math notranslate nohighlight">\(v_{min} = \frac{L_d}{T_2} = \frac{L_{ref}}{T_{max}}\)</span></p>
<p>In other words, these velocities are the same for all detectors, so the
wavelength range in the transformed histogram will correspondingly be
the same and this algorithm rebins the data into common bins in this
range.</p>
<p>Occasionally, it may be that some detectors (typically downstream
monitors) may be at a *longer* flightpath than <span class="math notranslate nohighlight">\(L_{ref}\)</span>. This
depends entirely on the chopper aperture/setting. These detectors are
“frame-overlapped” - in other words, there is an ambiguity in the
definition of the wavelength for certain points, which should therefore
be excluded. These points are at the very beginning and at the very end
of the frame for a range <span class="math notranslate nohighlight">\(Dt\)</span> (equal on both sides) given by</p>
<div class="math notranslate nohighlight">
\[D_t = (T_{max} - T_{min}) \times \left (1 - \frac{L_{ref}}{L_d} \right)\]</div>
<p>In other words, points between <span class="math notranslate nohighlight">\(T_{min}\)</span> and <span class="math notranslate nohighlight">\(T_{min} + D_t\)</span>
and between <span class="math notranslate nohighlight">\(T_{max} - D_t\)</span> and <span class="math notranslate nohighlight">\(T_{max}\)</span> should be
excluded. For all other points, velocities and wavelengths are
calculated in the normal way.</p>
<p>Note that since we are dealing with histogrammed data, the cut-off
values above will almost certainly not fall exactly on a bin boundary.
The approach taken by this algorithm is that if any part of a bin has a
value that should be excluded, then the entire bin is excluded. What
this means in practice is that the edge bins will possibly have a
reduced number of counts.</p>
<section id="restrictions-on-the-input-workspace">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Restrictions on the Input Workspace</a><a class="headerlink" href="#restrictions-on-the-input-workspace" title="Permalink to this heading">¶</a></h3>
<p>The input workspace must contain histogram data where the X unit is
time-of-flight and the Y data is raw counts. The instrument associated with the
workspace must be fully defined because detector, source &amp; sample position are needed.</p>
</section>
<section id="child-algorithms-used">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Child Algorithms Used</a><a class="headerlink" href="#child-algorithms-used" title="Permalink to this heading">¶</a></h3>
<p>If the input workspace contains more than a single spectrum, Unwrap
makes use of the <a class="reference internal" href="Rebin-v1.html#algm-rebin"><span class="std std-ref">rebin</span></a> algorithm to set the bins on the
output workspace to common values which cover the maximum theoretically
accessible wavelength range.</p>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example - unwrapping a raw workspace.</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a raw data workspace.</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>

<span class="c1"># The result variable will contain a tuple: (OutputWorkspace, JoinWaveLength)</span>
<span class="c1"># To access individual outputs use result[i] where i is the index of the required output.</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">UnwrapMonitor</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span><span class="n">LRef</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;JoinWaveLength is: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>JoinWaveLength is: 1.4241722...
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/CorrectionFunctions/InstrumentCorrections.html">CorrectionFunctions\InstrumentCorrections</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/Algorithms/inc/MantidAlgorithms/UnwrapMonitor.h">UnwrapMonitor.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/Algorithms/src/UnwrapMonitor.cpp">UnwrapMonitor.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="UnGroupWorkspace-v1.html" title="Previous Chapter: UnGroupWorkspace v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; UnGroupWorkspace v1</span>
    </a>
  </li>
  <li>
    <a href="UnwrapMonitorsInTOF-v1.html" title="Next Chapter: UnwrapMonitorsInTOF v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">UnwrapMonitor... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>