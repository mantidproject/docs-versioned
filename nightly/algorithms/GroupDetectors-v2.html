<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>GroupDetectors v2</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GroupToXResolution v1" href="GroupToXResolution-v1.html" />
    <link rel="prev" title="GroupDetectors v1" href="GroupDetectors-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">GroupDetectors v2</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="groupdetectors-v2">
<span id="algm-groupdetectors"></span><span id="algm-groupdetectors-v2"></span><h1>GroupDetectors v2<a class="headerlink" href="#groupdetectors-v2" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id5">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/GroupDetectors-v2_dlg.png"><img alt="../_images/GroupDetectors-v2_dlg.png" class="screenshot" src="../_images/GroupDetectors-v2_dlg.png" style="width: 349px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>GroupDetectors</strong> dialog.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id6">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id7">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id8">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id9">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#mapfile" id="id10">MapFile</a></p></li>
<li><p><a class="reference internal" href="#groupingpattern" id="id11">GroupingPattern</a></p></li>
<li><p><a class="reference internal" href="#vertical-axis-on-output" id="id12">Vertical Axis on Output</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#previous-versions" id="id13">Previous Versions</a></p>
<ul>
<li><p><a class="reference internal" href="#version-1" id="id14">Version 1</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id15">Usage</a></p>
<ul>
<li><p><a class="reference internal" href="#output" id="id16">Output</a></p></li>
<li><p><a class="reference internal" href="#id1" id="id17">Output</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id18">Output</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id19">Output</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id20">Output</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#source" id="id21">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Sums spectra bin-by-bin, equivalent to grouping the data from a set of detectors.  Individual groups can be specified by passing the algorithm a list of spectrum numbers, detector IDs or workspace indices. Many spectra groups can be created in one execution via an input file.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="SpatialGrouping-v1.html#algm-spatialgrouping"><span class="std std-ref">SpatialGrouping</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the input 2D workspace</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the output workspace</p></td>
</tr>
<tr class="row-even"><td><p>MapFile</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>A file that consists of lists of spectra numbers to group. See the help for the file format. Allowed extensions: [‘.map’, ‘.xml’]</p></td>
</tr>
<tr class="row-odd"><td><p>ExcludeGroupNumbers</p></td>
<td><p>Input</p></td>
<td><p>int list</p></td>
<td></td>
<td><p>An array of group IDs to exclude when reading from an XML file.</p></td>
</tr>
<tr class="row-even"><td><p>IgnoreGroupNumber</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>If true, use sequential spectrum numbers, otherwise use the group number from MapFile as spectrum numbers.</p></td>
</tr>
<tr class="row-odd"><td><p>GroupingPattern</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Describes how this algorithm should group the detectors. See the help for full instructions.</p></td>
</tr>
<tr class="row-even"><td><p>SpectraList</p></td>
<td><p>Input</p></td>
<td><p>int list</p></td>
<td></td>
<td><p>An array containing a list of the spectrum numbers to combine (DetectorList and WorkspaceIndexList are ignored if this is set)</p></td>
</tr>
<tr class="row-odd"><td><p>DetectorList</p></td>
<td><p>Input</p></td>
<td><p>int list</p></td>
<td></td>
<td><p>An array of detector IDs to combine (WorkspaceIndexList is ignored if this is set)</p></td>
</tr>
<tr class="row-even"><td><p>WorkspaceIndexList</p></td>
<td><p>Input</p></td>
<td><p>unsigned int list</p></td>
<td></td>
<td><p>An array of workspace indices to combine</p></td>
</tr>
<tr class="row-odd"><td><p>KeepUngroupedSpectra</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>If true ungrouped spectra will be copied to the output workspace and placed after the groups</p></td>
</tr>
<tr class="row-even"><td><p>Behaviour</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Sum</p></td>
<td><p>Whether to sum or average the values when grouping detectors. Allowed values: [‘Sum’, ‘Average’]</p></td>
</tr>
<tr class="row-odd"><td><p>PreserveEvents</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>Keep the output workspace as an EventWorkspace, if the input has events.</p></td>
</tr>
<tr class="row-even"><td><p>CopyGroupingFromWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td><p>The name of a workspace to copy the grouping from. This can be either a normal workspace or a grouping workspace, but they must be from the same instrument. Detector ids are used to match up the spectra to be grouped. If this option is selected all file and list options will be ignored.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This algorithm sums, bin-by-bin, multiple spectra into a single spectra.
The errors are summed in quadrature and the algorithm checks that the
bin boundaries in X are the same. The new summed spectra are created at
the start of the output workspace and have spectra numbers that
start at zero and increase in the order the groups are specified. All
detectors from the grouped spectra will be moved to belong to the new
spectrum.</p>
<p>Not all spectra in the input workspace have to be copied to a group. If
KeepUngroupedSpectra is set to true any spectra not listed will be
copied to the output workspace after the groups in order. If
KeepUngroupedSpectra is set to false only the spectra selected to be in
a group will be used.</p>
<p>To create a single group the list of spectra can be identified using a
list of either spectrum numbers, detector IDs or workspace indices. The
list should be set against the appropriate property.</p>
<section id="mapfile">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">MapFile</a><a class="headerlink" href="#mapfile" title="Permalink to this heading">¶</a></h3>
<p>An input file allows the specification of many groups. The file has the
following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">number</span> <span class="n">of</span> <span class="n">groups</span> <span class="ow">in</span> <span class="n">file</span><span class="p">]</span>

<span class="p">[</span><span class="n">first</span> <span class="n">group</span><span class="s1">&#39;s number]</span>
<span class="p">[</span><span class="n">number</span> <span class="n">of</span> <span class="n">spectra</span> <span class="ow">in</span> <span class="n">first</span> <span class="n">group</span><span class="p">]</span>
<span class="p">[</span><span class="n">spectrum</span> <span class="mi">1</span><span class="p">]</span> <span class="p">[</span><span class="n">spectrum</span> <span class="mi">2</span><span class="p">]</span> <span class="p">[</span><span class="n">spectrum</span> <span class="mi">3</span><span class="p">]</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="p">[</span><span class="n">spectrum</span> <span class="n">n</span><span class="p">]</span>

<span class="p">[</span><span class="n">second</span> <span class="n">group</span><span class="s1">&#39;s number]</span>
<span class="p">[</span><span class="n">number</span> <span class="n">of</span> <span class="n">spectra</span> <span class="ow">in</span> <span class="n">second</span> <span class="n">group</span><span class="p">]</span>
<span class="p">[</span><span class="n">spectrum</span> <span class="mi">1</span><span class="p">]</span> <span class="p">[</span><span class="n">spectrum</span> <span class="mi">2</span><span class="p">]</span> <span class="p">[</span><span class="n">spectrum</span> <span class="mi">3</span><span class="p">]</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="p">[</span><span class="n">spectrum</span> <span class="n">n</span><span class="p">]</span>

<span class="p">[</span><span class="n">repeat</span> <span class="k">as</span> <span class="n">necessary</span><span class="p">]</span>
</pre></div>
</div>
<p>Mantid will still work if the number of groups specified at the start is
incorrect, but other software may not. Mantid will warn you if the value
given is incorrect.</p>
<p>Each group’s spectrum number is determined by the group’s number. This
behaviour can be overridden by enabling the IgnoreGroupNumber property, in
which case the first group will be numbered 1, and the second 2, and so on.</p>
<p>Blank lines and whitespace in the map file are ignored. Comments may be
entered using a #, like in a Python script.</p>
<p>An example of an input file follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
<span class="mi">1</span>
<span class="mi">64</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">10</span>
<span class="mi">11</span> <span class="mi">12</span> <span class="mi">13</span> <span class="mi">14</span> <span class="mi">15</span> <span class="mi">16</span> <span class="mi">17</span> <span class="mi">18</span> <span class="mi">19</span> <span class="mi">20</span>
<span class="mi">21</span> <span class="mi">22</span> <span class="mi">23</span> <span class="mi">24</span> <span class="mi">25</span> <span class="mi">26</span> <span class="mi">27</span> <span class="mi">28</span> <span class="mi">29</span> <span class="mi">30</span>
<span class="mi">31</span> <span class="mi">32</span> <span class="mi">33</span> <span class="mi">34</span> <span class="mi">35</span> <span class="mi">36</span> <span class="mi">37</span> <span class="mi">38</span> <span class="mi">39</span> <span class="mi">40</span>
<span class="mi">41</span> <span class="mi">42</span> <span class="mi">43</span> <span class="mi">44</span> <span class="mi">45</span> <span class="mi">46</span> <span class="mi">47</span> <span class="mi">48</span> <span class="mi">49</span> <span class="mi">50</span>
<span class="mi">51</span> <span class="mi">52</span> <span class="mi">53</span> <span class="mi">54</span> <span class="mi">55</span> <span class="mi">56</span> <span class="mi">57</span> <span class="mi">58</span> <span class="mi">59</span> <span class="mi">60</span>
<span class="mi">61</span> <span class="mi">62</span> <span class="mi">63</span> <span class="mi">64</span>
<span class="mi">2</span>
<span class="mi">60</span>
<span class="mi">65</span> <span class="mi">66</span> <span class="mi">67</span> <span class="mi">68</span> <span class="mi">69</span> <span class="mi">70</span> <span class="mi">71</span> <span class="mi">72</span> <span class="mi">73</span> <span class="mi">74</span>
<span class="mi">75</span> <span class="mi">76</span> <span class="mi">77</span> <span class="mi">78</span> <span class="mi">79</span> <span class="mi">80</span> <span class="mi">81</span> <span class="mi">82</span> <span class="mi">83</span> <span class="mi">84</span>
<span class="mi">85</span> <span class="mi">86</span> <span class="mi">87</span> <span class="mi">88</span> <span class="mi">89</span> <span class="mi">90</span> <span class="mi">91</span> <span class="mi">92</span> <span class="mi">93</span> <span class="mi">94</span>
<span class="mi">95</span> <span class="mi">96</span> <span class="mi">97</span> <span class="mi">98</span> <span class="mi">99</span> <span class="mi">100</span> <span class="mi">101</span> <span class="mi">102</span> <span class="mi">103</span> <span class="mi">104</span>
<span class="mi">105</span> <span class="mi">106</span> <span class="mi">107</span> <span class="mi">108</span> <span class="mi">109</span> <span class="mi">110</span> <span class="mi">111</span> <span class="mi">112</span> <span class="mi">113</span> <span class="mi">114</span>
<span class="mi">115</span> <span class="mi">116</span> <span class="mi">117</span> <span class="mi">118</span> <span class="mi">119</span> <span class="mi">120</span> <span class="mi">121</span> <span class="mi">122</span> <span class="mi">123</span> <span class="mi">124</span>
</pre></div>
</div>
<p>In addition the following XML grouping format is also supported</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;detector-grouping&gt;</span>
  <span class="nt">&lt;group</span> <span class="na">name=</span><span class="s">&quot;fwd1&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;ids</span> <span class="na">val=</span><span class="s">&quot;1-32&quot;</span><span class="nt">/&gt;</span> <span class="nt">&lt;/group&gt;</span>
  <span class="nt">&lt;group</span> <span class="na">name=</span><span class="s">&quot;bwd1&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;ids</span> <span class="na">val=</span><span class="s">&quot;33,36,38,60-64&quot;</span><span class="nt">/&gt;</span> <span class="nt">&lt;/group&gt;</span>

  <span class="nt">&lt;group</span> <span class="na">name=</span><span class="s">&quot;fwd2&quot;</span><span class="nt">&gt;&lt;detids</span> <span class="na">val=</span><span class="s">&quot;1,2,17,32&quot;</span><span class="nt">/&gt;&lt;/group&gt;</span>
  <span class="nt">&lt;group</span> <span class="na">name=</span><span class="s">&quot;bwd2&quot;</span><span class="nt">&gt;&lt;detids</span> <span class="na">val=</span><span class="s">&quot;33,36,38,60,64&quot;</span><span class="nt">/&gt;</span> <span class="nt">&lt;/group&gt;</span>
<span class="nt">&lt;/detector-grouping&gt;</span>
</pre></div>
</div>
<p>where is used to specify spectra IDs and detector IDs.</p>
</section>
<section id="groupingpattern">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">GroupingPattern</a><a class="headerlink" href="#groupingpattern" title="Permalink to this heading">¶</a></h3>
<p>Grouping can also be specified using the GroupingPattern property. Its syntax
is as follows:</p>
<p>The pattern consists of a list of numbers that refer to workspace indices and
various operators: <code class="docutils literal notranslate"><span class="pre">,:+-</span></code>.</p>
<p>The spectra you wish to keep can be specified by selecting the appropriate
workspace indices. This can be achieved with the following operators:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">,</span></code> allows you to specify additional indices. <code class="docutils literal notranslate"><span class="pre">1,2,4</span></code> will
keep indices 1, 2 and 4 only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:</span></code> indicates a continuous range of indices. For example,
<code class="docutils literal notranslate"><span class="pre">1:5</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">1,2,3,4,5</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">+</span></code> sums two spectra together. <code class="docutils literal notranslate"><span class="pre">7+9</span></code> will produce a single
spectra listing the sum of 7 and 9, ignoring any others.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-</span></code> sums a range of spectra together. For example, <code class="docutils literal notranslate"><span class="pre">3-8</span></code> is
the same as <code class="docutils literal notranslate"><span class="pre">3+4+5+6+7+8</span></code>.</p></li>
</ul>
<p>One could combine these operations, for example <code class="docutils literal notranslate"><span class="pre">10+12,13:89</span></code> would
list the sum of 10 and 12 followed by 13 to 89.</p>
</section>
<section id="vertical-axis-on-output">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Vertical Axis on Output</a><a class="headerlink" href="#vertical-axis-on-output" title="Permalink to this heading">¶</a></h3>
<p>The OutputWorkspace of this algorithm will always have spectrum numbers as the
vertical axis, independent of the vertical axis units in InputWorkspace. This
is because after grouping, the vertical axis can have meaningless values and
generally, there is not enough information available to rebuild the axis. The
vertical axis can be manually restored afterwards by e.g.
<a class="reference internal" href="ConvertSpectrumAxis-v2.html#algm-convertspectrumaxis"><span class="std std-ref">ConvertSpectrumAxis</span></a>.</p>
</section>
</section>
<section id="previous-versions">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Previous Versions</a><a class="headerlink" href="#previous-versions" title="Permalink to this heading">¶</a></h2>
<section id="version-1">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Version 1</a><a class="headerlink" href="#version-1" title="Permalink to this heading">¶</a></h3>
<p>The set of spectra to be grouped can be given as a list of either
spectrum numbers, detector IDs or workspace indices. The new, summed
spectrum will appear in the workspace at the first workspace index of
the pre-grouped spectra (which will be given by the ResultIndex property
after execution). The detectors for all the grouped spectra will be
moved to belong to the first spectrum. <em>A technical note: the workspace
indices previously occupied by summed spectra will have their data
zeroed and their spectrum number set to a value of -1.</em> <a class="reference external" href="GroupDetectors-v1.html">See page
for version 1 here.</a></p>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example 1: specifying a map file</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Create a grouping file from the example above.</span>
<span class="c1"># It makes 2 groups of 64 and 60 detectors respectively.</span>
<span class="n">groupingFileContent</span> <span class="o">=</span> \
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">2</span>
<span class="sd">1</span>
<span class="sd">64</span>
<span class="sd">1 2 3 4 5 6 7 8 9 10</span>
<span class="sd">11 12 13 14 15 16 17 18 19 20</span>
<span class="sd">21 22 23 24 25 26 27 28 29 30</span>
<span class="sd">31 32 33 34 35 36 37 38 39 40</span>
<span class="sd">41 42 43 44 45 46 47 48 49 50</span>
<span class="sd">51 52 53 54 55 56 57 58 59 60</span>
<span class="sd">61 62 63 64</span>
<span class="sd">2</span>
<span class="sd">60</span>
<span class="sd">65 66 67 68 69 70 71 72 73 74</span>
<span class="sd">75 76 77 78 79 80 81 82 83 84</span>
<span class="sd">85 86 87 88 89 90 91 92 93 94</span>
<span class="sd">95 96 97 98 99 100 101 102 103 104</span>
<span class="sd">105 106 107 108 109 110 111 112 113 114</span>
<span class="sd">115 116 117 118 119 120 121 122 123 124</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># Save the data to a file</span>
<span class="n">groupingFilePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/MantidUsageExample_GroupDetectorsGrouping.txt&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">groupingFilePath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="n">groupingFileContent</span> <span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Create a workspace filled with a constant value = 0.3</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c1"># Group detectors according to the created file.</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="n">MapFile</span> <span class="o">=</span> <span class="n">groupingFilePath</span> <span class="p">)</span>

<span class="c1"># Check the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of groups is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First grouped spectrum is a sum 64 input spectra:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.1f}</span><span class="s1"> == 64 * 0.3 == </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">64</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Second grouped spectrum is a sum 60 input spectra:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.1f}</span><span class="s1"> == 60 * 0.3 == </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">60</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">))</span>
<span class="c1"># Get detector IDs of the first group</span>
<span class="n">grp0_ids</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of grouped detectors is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grp0_ids</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;5 first detectors in group: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([</span> <span class="n">grp0_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;5 last  detectors in group: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([</span> <span class="n">grp0_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">59</span><span class="p">,</span><span class="mi">64</span><span class="p">)]))</span>
<span class="c1"># Get detector IDs of the second group</span>
<span class="n">grp1_ids</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of grouped detectors is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grp1_ids</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;5 first detectors in group: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([</span> <span class="n">grp1_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;5 last  detectors in group: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([</span> <span class="n">grp1_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span><span class="mi">60</span><span class="p">)]))</span>
</pre></div>
</div>
<section id="output">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Output</a><a class="headerlink" href="#output" title="Permalink to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Number of groups is 2
First grouped spectrum is a sum 64 input spectra:
19.2 == 64 * 0.3 == 19.2
Second grouped spectrum is a sum 60 input spectra:
18.0 == 60 * 0.3 == 18.0
Number of grouped detectors is 64
5 first detectors in group: [100, 101, 102, 103, 104]
5 last  detectors in group: [159, 160, 161, 162, 163]
Number of grouped detectors is 60
5 first detectors in group: [164, 165, 166, 167, 168]
5 last  detectors in group: [219, 220, 221, 222, 223]
</pre></div>
</div>
<p><strong>Example 2: specifying spectrum numbers</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a workspace filled with a constant value = 0.3</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c1"># Group detectots using a list of spectrum numbers</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">SpectraList</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

<span class="c1"># Check the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of groups is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The grouped spectrum is a sum 3 input spectra:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.1f}</span><span class="s1"> == 3 * 0.3 == </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">))</span>

<span class="c1"># Get detector IDs in the group</span>
<span class="n">grp_ids</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Number of grouped detectors is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grp_ids</span><span class="p">)))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Detector IDs: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grp_ids</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="id1">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Output</a><a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Number of groups is 1
The grouped spectrum is a sum 3 input spectra:
0.9 == 3 * 0.3 == 0.9
Number of grouped detectors is 3
Detector IDs: set(100,102,104)
</pre></div>
</div>
<p><strong>Example 3: specifying detctor IDs</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a workspace filled with a constant value = 0.3</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c1"># Group detectots using a list of detctor IDs</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">DetectorList</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">102</span><span class="p">,</span><span class="mi">104</span><span class="p">])</span>

<span class="c1"># Check the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of groups is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The grouped spectrum is a sum 3 input spectra:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.1f}</span><span class="s1"> == 3 * 0.3 == </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">))</span>

<span class="c1"># Get detector IDs in the group</span>
<span class="n">grp_ids</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Number of grouped detectors is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grp_ids</span><span class="p">)))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Detector IDs: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grp_ids</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="id2">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Output</a><a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Number of groups is 1
The grouped spectrum is a sum 3 input spectra:
0.9 == 3 * 0.3 == 0.9
Number of grouped detectors is 3
Detector IDs: set(100,102,104)
</pre></div>
</div>
<p><strong>Example 4: specifying workspace indices</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a workspace filled with a constant value = 0.3</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c1"># Group detectots using a list of workspace indices</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">WorkspaceIndexList</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>

<span class="c1"># Check the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of groups is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The grouped spectrum is a sum 3 input spectra:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.1f}</span><span class="s1"> == 3 * 0.3 == </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">))</span>

<span class="c1"># Get detector IDs in the group</span>
<span class="n">grp_ids</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Number of grouped detectors is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grp_ids</span><span class="p">)))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Detector IDs: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grp_ids</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Output</a><a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Number of groups is 1
The grouped spectrum is a sum 3 input spectra:
0.9 == 3 * 0.3 == 0.9
Number of grouped detectors is 3
Detector IDs: set(100,102,104)
</pre></div>
</div>
<p><strong>Example 5: keeping ungrouped spectra</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Create a grouping file from the example above.</span>
<span class="c1"># It makes 2 groups of 64 and 60 detectors respectively.</span>
<span class="n">groupingFileContent</span> <span class="o">=</span> \
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">2</span>
<span class="sd">1</span>
<span class="sd">64</span>
<span class="sd">1 2 3 4 5 6 7 8 9 10</span>
<span class="sd">11 12 13 14 15 16 17 18 19 20</span>
<span class="sd">21 22 23 24 25 26 27 28 29 30</span>
<span class="sd">31 32 33 34 35 36 37 38 39 40</span>
<span class="sd">41 42 43 44 45 46 47 48 49 50</span>
<span class="sd">51 52 53 54 55 56 57 58 59 60</span>
<span class="sd">61 62 63 64</span>
<span class="sd">2</span>
<span class="sd">60</span>
<span class="sd">65 66 67 68 69 70 71 72 73 74</span>
<span class="sd">75 76 77 78 79 80 81 82 83 84</span>
<span class="sd">85 86 87 88 89 90 91 92 93 94</span>
<span class="sd">95 96 97 98 99 100 101 102 103 104</span>
<span class="sd">105 106 107 108 109 110 111 112 113 114</span>
<span class="sd">115 116 117 118 119 120 121 122 123 124</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># Save the data to a file</span>
<span class="n">groupingFilePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/MantidUsageExample_GroupDetectorsGrouping.txt&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">groupingFilePath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="n">groupingFileContent</span> <span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Create a workspace filled with a constant value = 0.3</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c1"># Group detectors according to the created file.</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="n">MapFile</span><span class="o">=</span><span class="n">groupingFilePath</span><span class="p">,</span> <span class="n">KeepUngroupedSpectra</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>

<span class="c1"># Check the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of spectra in grouped workspace is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;It includes 2 groups + </span><span class="si">{}</span><span class="s1"> remaining ungrouped spectra&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="mi">64</span> <span class="o">+</span> <span class="mi">60</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First  spectrum is grouped, it has </span><span class="si">{}</span><span class="s1"> detectors&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">())))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Second spectrum is grouped, it has </span><span class="si">{}</span><span class="s1"> detectors&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">())))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Spectrum   2  is ungrouped, it has  </span><span class="si">{}</span><span class="s1"> detector&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">())))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Spectrum   3  is ungrouped, it has  </span><span class="si">{}</span><span class="s1"> detector&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">())))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Spectrum  77  is ungrouped, it has  </span><span class="si">{}</span><span class="s1"> detector&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">77</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">())))</span>
</pre></div>
</div>
</section>
<section id="id4">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Output</a><a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Number of spectra in grouped workspace is 78
It includes 2 groups + 76 remaining ungrouped spectra
First  spectrum is grouped, it has 64 detectors
Second spectrum is grouped, it has 60 detectors
Spectrum   2  is ungrouped, it has  1 detector
Spectrum   3  is ungrouped, it has  1 detector
...
Spectrum  77  is ungrouped, it has  1 detector
</pre></div>
</div>
<p><strong>Example 6: Group detectors using spectra list</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create test input</span>
<span class="n">xx</span><span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="c1"># create spectra with signal equal to spectra number</span>
<span class="n">yy</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
    <span class="n">yy</span><span class="o">=</span><span class="n">yy</span><span class="o">+</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

<span class="n">ws</span><span class="o">=</span><span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="n">DataY</span><span class="o">=</span><span class="n">yy</span><span class="p">,</span><span class="n">NSpec</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
<span class="c1"># Group detectors</span>
<span class="n">wsg0</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">SpectraList</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">KeepUngroupedSpectra</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Behaviour</span><span class="o">=</span><span class="s1">&#39;Sum&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Grouped first 3 spectra results in workspace with </span><span class="si">{0}</span><span class="s2"> spectra and the grouped spectra is spectrum 0:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg0</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wsg0</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First unaffected spectrum is now spectrum 1, former spectrum 4:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wsg0</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*********************************************************&quot;</span><span class="p">)</span>

<span class="c1"># Group detectors differently</span>
<span class="n">wsg1</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">SpectraList</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="n">KeepUngroupedSpectra</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Behaviour</span><span class="o">=</span><span class="s1">&#39;Sum&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Grouped 3 spectra starting with second results in workspace with </span><span class="si">{0}</span><span class="s2"> spectra and the grouped spectra is spectrum 0:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg1</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wsg1</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First unaffected spectrum is now spectrum 1, former spectrum 0:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wsg1</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*********************************************************&quot;</span><span class="p">)</span>

<span class="c1"># Group detectors in a chain:</span>
<span class="n">wsg2</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">wsg0</span><span class="p">,</span><span class="n">SpectraList</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">KeepUngroupedSpectra</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Behaviour</span><span class="o">=</span><span class="s1">&#39;Sum&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Grouped 6 spectra 3x3 twice results in workspace with </span><span class="si">{0}</span><span class="s2"> spectra and the grouped spectra is spectrum 0 and 1:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg2</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wsg2</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wsg2</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First unaffected spectrum is now spectrum 3, former spectrum 7:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wsg2</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*********************************************************&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Grouped first 3 spectra results in workspace with 8 spectra and the grouped spectra is spectrum 0:
[ 6.  6.  6.  6.  6.  6.  6.  6.  6.  6.]
First unaffected spectrum is now spectrum 1, former spectrum 4:
[ 4.  4.  4.  4.  4.  4.  4.  4.  4.  4.]
*********************************************************
Grouped 3 spectra starting with second results in workspace with 8 spectra and the grouped spectra is spectrum 0:
[ 9.  9.  9.  9.  9.  9.  9.  9.  9.  9.]
First unaffected spectrum is now spectrum 1, former spectrum 0:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
*********************************************************
Grouped 6 spectra 3x3 twice results in workspace with 6 spectra and the grouped spectra is spectrum 0 and 1:
[ 15.  15.  15.  15.  15.  15.  15.  15.  15.  15.]
[ 6.  6.  6.  6.  6.  6.  6.  6.  6.  6.]
First unaffected spectrum is now spectrum 3, former spectrum 7:
[ 7.  7.  7.  7.  7.  7.  7.  7.  7.  7.]
*********************************************************
</pre></div>
</div>
<p><strong>Example 7: Group detectors using map file:</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># Create test input</span>
<span class="n">xx</span><span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="c1"># create spectra with signal equal to spectra number</span>
<span class="n">yy</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
    <span class="n">yy</span><span class="o">=</span><span class="n">yy</span><span class="o">+</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

<span class="n">ws</span><span class="o">=</span><span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="n">DataY</span><span class="o">=</span><span class="n">yy</span><span class="p">,</span><span class="n">NSpec</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>

<span class="c1"># Create map file</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;defaultsave.directory&quot;</span><span class="p">],</span> <span class="s2">&quot;TestMapFile.map&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">);</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;4</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="c1"># header, four groups</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;1</span><span class="se">\n</span><span class="s1">3</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="c1"># header group 1</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;1 2 3</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="c1">#  group 1</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;2</span><span class="se">\n</span><span class="s1">3</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="c1"># header group 2</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;4 5 6</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="c1">#  group 2</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;3</span><span class="se">\n</span><span class="s1">2</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="c1"># header group 3</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;7 8</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="c1">#  group 3</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;4</span><span class="se">\n</span><span class="s1">2</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="c1"># header group 4</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;9 10</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="c1">#  group 4</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Group detectors</span>
<span class="n">wsg</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">MapFile</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span><span class="n">KeepUngroupedSpectra</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Behaviour</span><span class="o">=</span><span class="s1">&#39;Sum&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Grouped workspace has </span><span class="si">{0}</span><span class="s2"> spectra&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;spectrum 1 (sum of spectra 1-3): </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;spectrum 2 (sum of spectra 4-6): </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;spectrum 3 (sum of spectra 7-8): </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;spectrum 4 (sum of spectra 9-10): </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Grouped workspace has 4 spectra
spectrum 1 (sum of spectra 1-3): [ 6.  6.  6.  6.  6.  6.  6.  6.  6.  6.]
spectrum 2 (sum of spectra 4-6): [ 15.  15.  15.  15.  15.  15.  15.  15.  15.  15.]
spectrum 3 (sum of spectra 7-8): [ 15.  15.  15.  15.  15.  15.  15.  15.  15.  15.]
spectrum 4 (sum of spectra 9-10): [ 19.  19.  19.  19.  19.  19.  19.  19.  19.  19.]
</pre></div>
</div>
<p><strong>Example 8: Group detectors using grouping pattern:</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Workspace of 10 spectra each with one bin.</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">DataY</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="n">NSpec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Run algorithm adding first two spectra and then keep the fourth, add the fifth to seventh, and then keep the last three spectra</span>
<span class="n">ws2</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">GroupingPattern</span><span class="o">=</span><span class="s2">&quot;0+1,3,4-6,7:9&quot;</span><span class="p">)</span>

<span class="c1">#print result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[ 3.]
[ 4.]
[ 18.]
[ 8.]
[ 9.]
[ 10.]
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Transforms/Grouping.html">Transforms\Grouping</a></p>
</section>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id21" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/DataHandling/inc/MantidDataHandling/GroupDetectors2.h">GroupDetectors2.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/DataHandling/src/GroupDetectors2.cpp">GroupDetectors2.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="GroupDetectors-v1.html" title="Previous Chapter: GroupDetectors v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; GroupDetectors v1</span>
    </a>
  </li>
  <li>
    <a href="GroupToXResolution-v1.html" title="Next Chapter: GroupToXResolution v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">GroupToXResolution v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>