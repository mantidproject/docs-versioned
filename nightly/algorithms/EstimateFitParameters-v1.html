<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>EstimateFitParameters v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="EstimateMuonAsymmetryFromCounts v1" href="EstimateMuonAsymmetryFromCounts-v1.html" />
    <link rel="prev" title="EstimateDivergence v1" href="EstimateDivergence-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">EstimateFitParameters v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="estimatefitparameters-v1">
<span id="algm-estimatefitparameters"></span><span id="algm-estimatefitparameters-v1"></span><h1>EstimateFitParameters v1<a class="headerlink" href="#estimatefitparameters-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/EstimateFitParameters-v1_dlg.png"><img alt="../_images/EstimateFitParameters-v1_dlg.png" class="screenshot" src="../_images/EstimateFitParameters-v1_dlg.png" style="width: 349px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>EstimateFitParameters</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#monte-carlo" id="id6">Monte Carlo</a></p></li>
<li><p><a class="reference internal" href="#cross-entropy" id="id7">Cross Entropy</a></p></li>
<li><p><a class="reference internal" href="#finding-bad-parameters" id="id8">Finding Bad Parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id9">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id10">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Estimate parameters of a fitting function using a Monte Carlo algorithm.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="Fit-v1.html#algm-fit"><span class="std std-ref">Fit</span></a>, <a class="reference internal" href="EstimatePeakErrors-v1.html#algm-estimatepeakerrors"><span class="std std-ref">EstimatePeakErrors</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Function</p></td>
<td><p>InOut</p></td>
<td><p>Function</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Parameters defining the fitting function and its initial values</p></td>
</tr>
<tr class="row-odd"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of the input Workspace</p></td>
</tr>
<tr class="row-even"><td><p>IgnoreInvalidData</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Flag to ignore infinities, NaNs and data with zero errors.</p></td>
</tr>
<tr class="row-odd"><td><p>DomainType</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Simple</p></td>
<td><p>The type of function domain to use: Simple, Sequential, or Parallel. Allowed values: [‘Simple’, ‘Sequential’, ‘Parallel’]</p></td>
</tr>
<tr class="row-even"><td><p>EvaluationType</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>CentrePoint</p></td>
<td><p>The way the function is evaluated on histogram data sets. If value is “CentrePoint” then function is evaluated at centre of each bin. If it is “Histogram” then function is integrated within the bin and the integrals returned. Allowed values: [‘CentrePoint’, ‘Histogram’]</p></td>
</tr>
<tr class="row-odd"><td><p>StepSizeMethod</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Default</p></td>
<td><p>The way the step size is calculated for numerical derivatives. See the section about step sizes in the Fit algorithm documentation to understand the difference between “Default” and “Sqrt epsilon”. Allowed values: [‘Default’, ‘Sqrt epsilon’]</p></td>
</tr>
<tr class="row-even"><td><p>PeakRadius</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>A value of the peak radius the peak functions should use. A peak radius defines an interval on the x axis around the centre of the peak where its values are calculated. Values outside the interval are not calculated and assumed zeros.Numerically the radius is a whole number of peak widths (FWHM) that fit into the interval on each side from the centre. The default value of 0 means the whole x axis.</p></td>
</tr>
<tr class="row-odd"><td><p>CostFunction</p></td>
<td><p>InOut</p></td>
<td><p>string</p></td>
<td><p>Least squares</p></td>
<td><p>The cost function to be used for the fit, default is Least squares. Allowed values: [‘Least squares’, ‘Poisson’, ‘Rwp’, ‘Unweighted least squares’]</p></td>
</tr>
<tr class="row-even"><td><p>NSamples</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>100</p></td>
<td><p>Number of samples.</p></td>
</tr>
<tr class="row-odd"><td><p>Constraints</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Additional constraints on tied parameters.</p></td>
</tr>
<tr class="row-even"><td><p>Type</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Monte Carlo</p></td>
<td><p>Type of the algorithm: “Monte Carlo” or “Cross Entropy”</p></td>
</tr>
<tr class="row-odd"><td><p>NOutputs</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>10</p></td>
<td><p>Number of parameter sets to output to OutputWorkspace. Unused if OutputWorkspace isn’t set. (Monte Carlo only)</p></td>
</tr>
<tr class="row-even"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></p></td>
<td></td>
<td><p>Optional: A table workspace with parameter sets producing the smallest values of cost function. (Monte Carlo only)</p></td>
</tr>
<tr class="row-odd"><td><p>NIterations</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>10</p></td>
<td><p>Number of iterations of the Cross Entropy algorithm.</p></td>
</tr>
<tr class="row-even"><td><p>Selection</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>10</p></td>
<td><p>Size of the selection in the Cross Entropy algorithm from which to estimate new distribution parameters for the next iteration.</p></td>
</tr>
<tr class="row-odd"><td><p>FixBadParameters</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>If true try to estimate which parameters may cause problems for fitting and fix them.</p></td>
</tr>
<tr class="row-even"><td><p>Seed</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>A seed value for the random number generator. The default value (0) makes the generator use a random seed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This algorithm uses a Monte Carlo - type approach to estimate initial values of function parameters
before passing the function to <a class="reference internal" href="Fit-v1.html#algm-fit"><span class="std std-ref">Fit v1</span></a> algorithm.
The user needs to provide the search intervals for each parameters that requires estimation.
These intervals are set by defining boundary constraints in the fitting function. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="o">=</span><span class="n">UserFunction</span><span class="p">,</span><span class="n">Formula</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">constraints</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">a</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">b</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>Here the algorithm will search intervals [1, 4] and [0, 4] for values of parameters <cite>a</cite> and <cite>b</cite>
respectively such that the cost function is the smallest.</p>
<p>If a parameter will be fixed or tied in a fit don’t include it in the <cite>constraints</cite>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="o">=</span><span class="n">UserFunction</span><span class="p">,</span><span class="n">Formula</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ties</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mf">1.9</span><span class="p">),</span><span class="n">constraints</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">a</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">)</span>
<span class="n">name</span><span class="o">=</span><span class="n">UserFunction</span><span class="p">,</span><span class="n">Formula</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ties</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">constraints</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">a</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>The algorithm uses one of the two strategies (set via <cite>Type</cite> property): “Monte Carlo” and “Cross Entropy”.</p>
<section id="monte-carlo">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Monte Carlo</a><a class="headerlink" href="#monte-carlo" title="Permalink to this heading">¶</a></h3>
<p>In this strategy a number (defined by <cite>NSamples</cite> property) of parameter sets are generated and the one that
gives the smallest cost function is considered the winner. These best parameters are set to <cite>Function</cite>
property (it has the <cite>InOut</cite> direction).</p>
<p>If <cite>OutputWorkspace</cite> property is set then more than 1 parameter set can be output. The output workspace is
a table workspace in which the first column contains the names of the parameters and the subsequent columns
have the parameter sets with the smallest cost fnction values. Below is an example of such a workspace.</p>
<figure class="align-default">
<img alt="../_images/EstimateFitParameters_output.png" src="../_images/EstimateFitParameters_output.png" />
</figure>
</section>
<section id="cross-entropy">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Cross Entropy</a><a class="headerlink" href="#cross-entropy" title="Permalink to this heading">¶</a></h3>
<p>This strategy iteratively tries to narrow down the search space using statistics from a previous iteration.</p>
<p>The steps of the algorithm:</p>
<ol class="arabic simple">
<li><p>Generate a number (<cite>NSamples</cite>) of sets of function parameters normally distributed with given means and sigmas. Initially the distribution parameters are taken from the intervals passed in <cite>constraints</cite> of the fitting function: the means are the centres of the intervals and the sigmas are halves of their widths.</p></li>
<li><p>Calculate the cost function for each set of parameters and select a number of the smallest values. This number is defined  by the <cite>Selection</cite> property.</p></li>
<li><p>Find the sample means and sigmas of the parameters from the subset selected in step 2.</p></li>
<li><p>Repeat steps 1 - 3 a few times (<cite>NIterations</cite>).</p></li>
<li><p>Return parameters for the smallest cost function value found in the last iteration.</p></li>
</ol>
</section>
<section id="finding-bad-parameters">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Finding Bad Parameters</a><a class="headerlink" href="#finding-bad-parameters" title="Permalink to this heading">¶</a></h3>
<p>It may happen that some of the parameters cannot be determined from the data set in the <cite>InputWorkspace</cite>. If this is the case <a class="reference internal" href="Fit-v1.html#algm-fit"><span class="std std-ref">Fit v1</span></a> may diverge
or fail with an error. To try and find such parameters set <cite>FixBadParameters</cite> to <cite>true</cite>.
If the algorithm decides that some of the parameters may cause problems it will fix them.</p>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example 1.</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a data set. It is a BackToBackExponential.</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">8.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="mf">1.6</span><span class="p">,</span>  <span class="mf">2.6</span><span class="p">,</span>  <span class="mf">3.6</span><span class="p">,</span>  <span class="mf">4.6</span><span class="p">,</span>  <span class="mf">5.6</span><span class="p">,</span>  <span class="mf">6.6</span><span class="p">,</span>  <span class="mf">7.6</span><span class="p">,</span>  <span class="mf">8.5</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.899424685451e-06</span><span class="p">,</span> <span class="mf">0.0007065291085075</span><span class="p">,</span> <span class="mf">0.03312893859911</span><span class="p">,</span>
        <span class="mf">0.6260554060356</span><span class="p">,</span>    <span class="mf">4.961949842664</span><span class="p">,</span>     <span class="mf">17.4766663495</span><span class="p">,</span>
        <span class="mf">30.00494980772</span><span class="p">,</span>     <span class="mf">29.34773951093</span><span class="p">,</span>     <span class="mf">20.53693564978</span><span class="p">,</span>
        <span class="mf">12.73990150587</span><span class="p">,</span>     <span class="mf">7.739398423952</span><span class="p">,</span>     <span class="mf">4.694362241084</span><span class="p">,</span>
        <span class="mf">2.847186128946</span><span class="p">,</span>     <span class="mf">1.726807862958</span><span class="p">,</span>     <span class="mf">1.047276595461</span><span class="p">,</span>
        <span class="mf">0.6351380161499</span><span class="p">,</span>    <span class="mf">0.3851804649058</span><span class="p">,</span>    <span class="mf">0.1957211887562</span><span class="p">]</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Define a function, constraints set the search intervals.</span>
<span class="n">fun</span> <span class="o">=</span> <span class="s1">&#39;name=BackToBackExponential,S=1.1,constraints=(50&lt;I&lt;200,0.1&lt;A&lt;300,0.01&lt;B&lt;10,-5&lt;X0&lt;0,0.001&lt;S&lt;4)&#39;</span>

<span class="c1"># Set up the algorithm.</span>
<span class="kn">from</span> <span class="nn">mantid.api</span> <span class="kn">import</span> <span class="n">AlgorithmManager</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">AlgorithmManager</span><span class="o">.</span><span class="n">createUnmanaged</span><span class="p">(</span><span class="s1">&#39;EstimateFitParameters&#39;</span><span class="p">)</span>
<span class="n">alg</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="n">alg</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;Function&#39;</span><span class="p">,</span> <span class="n">fun</span><span class="p">)</span>
<span class="n">alg</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;InputWorkspace&#39;</span><span class="p">,</span> <span class="n">ws</span><span class="p">)</span>
<span class="c1"># Non-default cost function can be used.</span>
<span class="n">alg</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;CostFunction&#39;</span><span class="p">,</span> <span class="s1">&#39;Unweighted least squares&#39;</span><span class="p">)</span>
<span class="c1"># How many points to try.</span>
<span class="n">alg</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;NSamples&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="c1"># A seed for the random number generator. Only to make this test reproducible.</span>
<span class="n">alg</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;Seed&#39;</span><span class="p">,</span> <span class="mi">1234</span><span class="p">)</span>
<span class="c1"># Execute the algorithm.</span>
<span class="n">alg</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
<span class="c1"># Function now contains the estimated parameters.</span>
<span class="n">function</span> <span class="o">=</span> <span class="n">alg</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s1">&#39;Function&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
<span class="nb">print</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
<span class="c1"># Evaluate the function with the returned parameters to see the quality of estimation.</span>
<span class="n">EvaluateFunction</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">function</span><span class="p">),</span><span class="n">ws</span><span class="p">,</span><span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;estimation&#39;</span><span class="p">)</span>
<span class="c1"># Run Fit starting with the new parameters.</span>
<span class="n">Fit</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">function</span><span class="p">),</span><span class="n">ws</span><span class="p">,</span><span class="n">Output</span><span class="o">=</span><span class="s1">&#39;fit&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/EstimateFitParameters_mcest.png" src="../_images/EstimateFitParameters_mcest.png" />
</figure>
<figure class="align-default">
<img alt="../_images/EstimateFitParameters_mcfit.png" src="../_images/EstimateFitParameters_mcfit.png" />
</figure>
<p>Output:</p>
<p>(You may see different numbers for the parameters when you run this example on your machine.)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> name=BackToBackExponential,I=...,A=...,B=...,X0=...,S=...,constraints=(50&lt;I&lt;200,0.1&lt;A&lt;300,0.01&lt;B&lt;10,-5&lt;X0&lt;0,0.001&lt;S&lt;4)
</pre></div>
</div>
<p><strong>Example 2.</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a data set. It is a Gaussian.</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">8.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="mf">1.6</span><span class="p">,</span>  <span class="mf">2.6</span><span class="p">,</span>  <span class="mf">3.6</span><span class="p">,</span>  <span class="mf">4.6</span><span class="p">,</span>  <span class="mf">5.6</span><span class="p">,</span>  <span class="mf">6.6</span><span class="p">,</span>  <span class="mf">7.6</span><span class="p">,</span>  <span class="mf">8.5</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.18295779512548e-08</span><span class="p">,</span> <span class="mf">1.13372713874796e-06</span><span class="p">,</span> <span class="mf">3.57128496416351e-05</span><span class="p">,</span>
    <span class="mf">0.000682328052756376</span><span class="p">,</span> <span class="mf">0.00790705405159343</span><span class="p">,</span> <span class="mf">0.0555762126114831</span><span class="p">,</span>
    <span class="mf">0.236927758682122</span><span class="p">,</span> <span class="mf">0.612626394184416</span><span class="p">,</span> <span class="mf">0.960789439152323</span><span class="p">,</span>
    <span class="mf">0.913931185271228</span><span class="p">,</span> <span class="mf">0.527292424043049</span><span class="p">,</span> <span class="mf">0.184519523992989</span><span class="p">,</span>
    <span class="mf">0.0391638950989871</span><span class="p">,</span> <span class="mf">0.00504176025969098</span><span class="p">,</span> <span class="mf">0.000393669040655079</span><span class="p">,</span>
    <span class="mf">1.86437423315169e-05</span><span class="p">,</span> <span class="mf">5.35534780279311e-07</span><span class="p">,</span> <span class="mf">1.43072419185677e-08</span><span class="p">]</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Define a function, constraints set the search intervals.</span>
<span class="n">fun</span> <span class="o">=</span> <span class="s1">&#39;name=BackToBackExponential,S=1.1,constraints=(0.01&lt;I&lt;200,0.001&lt;A&lt;300,0.001&lt;B&lt;300,-5&lt;X0&lt;5,0.001&lt;S&lt;4)&#39;</span>

<span class="c1"># Set up the algorithm.</span>
<span class="kn">from</span> <span class="nn">mantid.api</span> <span class="kn">import</span> <span class="n">AlgorithmManager</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">AlgorithmManager</span><span class="o">.</span><span class="n">createUnmanaged</span><span class="p">(</span><span class="s1">&#39;EstimateFitParameters&#39;</span><span class="p">)</span>
<span class="n">alg</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="n">alg</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;Function&#39;</span><span class="p">,</span> <span class="n">fun</span><span class="p">)</span>
<span class="n">alg</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;InputWorkspace&#39;</span><span class="p">,</span> <span class="n">ws</span><span class="p">)</span>
<span class="c1"># Cross Entropy type.</span>
<span class="n">alg</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Cross Entropy&#39;</span><span class="p">)</span>
<span class="c1"># How many samples in each iteration.</span>
<span class="n">alg</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;NSamples&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="c1"># How many samples to use to refine distributions.</span>
<span class="n">alg</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;Selection&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="c1"># How many iterations to make.</span>
<span class="n">alg</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;NIterations&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="c1"># Try to find bad parameters. A and B are expected to be bad.</span>
<span class="n">alg</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;FixBadParameters&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># A seed for the random number generator. Only to make this test reproducible.</span>
<span class="n">alg</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;Seed&#39;</span><span class="p">,</span> <span class="mi">1234</span><span class="p">)</span>
<span class="c1"># Execute the algorithm.</span>
<span class="n">alg</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
<span class="c1"># Function now contains the estimated parameters.</span>
<span class="n">function</span> <span class="o">=</span> <span class="n">alg</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s1">&#39;Function&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
<span class="nb">print</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
<span class="c1"># Evaluate the function with the returned parameters to see the quality of estimation.</span>
<span class="n">EvaluateFunction</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">function</span><span class="p">),</span><span class="n">ws</span><span class="p">,</span><span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;estimation&#39;</span><span class="p">)</span>
<span class="c1"># Run Fit starting with the new parameters.</span>
<span class="n">Fit</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">function</span><span class="p">),</span><span class="n">ws</span><span class="p">,</span><span class="n">Output</span><span class="o">=</span><span class="s1">&#39;fit&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/EstimateFitParameters_ceest.png" src="../_images/EstimateFitParameters_ceest.png" />
</figure>
<figure class="align-default">
<img alt="../_images/EstimateFitParameters_cefit.png" src="../_images/EstimateFitParameters_cefit.png" />
</figure>
<p>Output:</p>
<p>(You may see different numbers for the parameters when you run this example on your machine.)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>name=BackToBackExponential,I=...,X0=...,S=...,constraints=(0.01&lt;I&lt;200,0.001&lt;A&lt;300,0.001&lt;B&lt;300,-5&lt;X0&lt;5,0.001&lt;S&lt;4),ties=(A=...,B=...)
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Optimization.html">Optimization</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/b49a51182ff0fbada20a1481592ea370353fb756/Framework/CurveFitting/inc/MantidCurveFitting/Algorithms/EstimateFitParameters.h">EstimateFitParameters.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/b49a51182ff0fbada20a1481592ea370353fb756/Framework/CurveFitting/src/Algorithms/EstimateFitParameters.cpp">EstimateFitParameters.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="EstimateDivergence-v1.html" title="Previous Chapter: EstimateDivergence v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; EstimateDivergence v1</span>
    </a>
  </li>
  <li>
    <a href="EstimateMuonAsymmetryFromCounts-v1.html" title="Next Chapter: EstimateMuonAsymmetryFromCounts v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">EstimateMuonA... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>