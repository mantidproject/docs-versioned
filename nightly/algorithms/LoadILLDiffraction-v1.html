<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>LoadILLDiffraction v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LoadILLIndirect v2" href="LoadILLIndirect-v2.html" />
    <link rel="prev" title="LoadIDFFromNexus v1" href="LoadIDFFromNexus-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">LoadILLDiffraction v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="loadilldiffraction-v1">
<span id="algm-loadilldiffraction"></span><span id="algm-loadilldiffraction-v1"></span><h1>LoadILLDiffraction v1<a class="headerlink" href="#loadilldiffraction-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/LoadILLDiffraction-v1_dlg.png"><img alt="../_images/LoadILLDiffraction-v1_dlg.png" class="screenshot" src="../_images/LoadILLDiffraction-v1_dlg.png" style="width: 406px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>LoadILLDiffraction</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#loading-d20" id="id6">Loading D20</a></p></li>
<li><p><a class="reference internal" href="#scans" id="id7">Scans</a></p></li>
<li><p><a class="reference internal" href="#logs" id="id8">Logs</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#d2b-alignment" id="id9">D2B alignment</a></p></li>
<li><p><a class="reference internal" href="#d2b-pixel-numbering-in-tubes" id="id10">D2B pixel numbering in tubes</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id11">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id12">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Loads ILL diffraction nexus files.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="LoadNexus-v1.html#algm-loadnexus"><span class="std std-ref">LoadNexus</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Filename</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>File path of the data file to load. Allowed extensions: [‘.nxs’]</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The output workspace.</p></td>
</tr>
<tr class="row-even"><td><p>TwoThetaOffset</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>2 theta offset for D1B data, in degrees.</p></td>
</tr>
<tr class="row-odd"><td><p>AlignTubes</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Apply vertical and horizontal alignment of tubes as defined in IPF</p></td>
</tr>
<tr class="row-even"><td><p>ConvertAxisAndTranspose</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Whether to convert the spectrum axis to 2theta and transpose (for 1D detector and no-scan configuration)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This is the loader for the raw <cite>.nxs</cite> files produced by the powder and liquid diffractometers at ILL.
Currently it supports the instruments D20, D1B, D2B, and D4.</p>
<p>The <em>TwoThetaOffset</em> parameter corresponding to the rotation of the detector is optional and only used for D1B. It is to be provided in degrees.</p>
<section id="loading-d20">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Loading D20</a><a class="headerlink" href="#loading-d20" title="Permalink to this heading">¶</a></h3>
<p>For D20 1-dimensional detector, it supports 3 resolution modes:</p>
<ul class="simple">
<li><p><strong>low</strong> is the physical configuration, i.e. 1536 pixels. This corresponds to the IDF <em>D20_lr</em>.</p></li>
<li><p><strong>nominal</strong> is the default configuration, i.e. pixels split by 2 by DAQ, so in total 3072 pixels. This corresponds to IDF <em>D20</em>.</p></li>
<li><p><strong>high</strong> is when each pixel is split by 3, resulting in 4608 pixels. This corresponds to IDF <em>D20_hr</em>.</p></li>
</ul>
<p>Note, that all the IDFs contain only active pixels, and do not count the last 2 banks which are permanently inactive.</p>
<p>The <em>2theta</em> value of the first pixel is read from the file, and the whole detector is rotated correspondingly.</p>
</section>
<section id="scans">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Scans</a><a class="headerlink" href="#scans" title="Permalink to this heading">¶</a></h3>
<p>The loader is able to load the following scan configurations:</p>
<ul class="simple">
<li><p><strong>no scan</strong>, used for D20, when a single file contains a single dataset, e.g. data acquired with static detector at a single temperature point. In this case x-axis is just a single point.</p></li>
<li><p><strong>detector scan</strong>, used always for D2B, and for D20 calibration runs, when the detector moves during the run. In this configuration the output is a <em>scanning workspace</em> containing one spectrum for each pixel at each time index. The x-axis is again a single point.</p></li>
<li><p><strong>other scan</strong>, e.g. omega scan for D20, which is another type of motor scan, but it is not the detector that moves, but the sample. In this case, the data in the raw file is organised just as for <em>detector scan</em>, but the output workspace is not a <em>scanning workspace</em>. It is a regular workspace with x-axis corresponding to the scanned variable, e.g. omega angle.</p></li>
</ul>
</section>
<section id="logs">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Logs</a><a class="headerlink" href="#logs" title="Permalink to this heading">¶</a></h3>
<p>The loader creates time series logs for each of the scanned variable in the <cite>.nxs</cite> file. The scanned variable name is added under <cite>ScanVar</cite> log.</p>
</section>
</section>
<section id="d2b-alignment">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">D2B alignment</a><a class="headerlink" href="#d2b-alignment" title="Permalink to this heading">¶</a></h2>
<p>For D2B, the loader applies tube alignment; first rotating them horizontally around the sample, then translating them vertically.
This is done based on <em>tube_centers</em> and <em>tube_angles</em> parameters defined in the Instrument Parameter File.</p>
</section>
<section id="d2b-pixel-numbering-in-tubes">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">D2B pixel numbering in tubes</a><a class="headerlink" href="#d2b-pixel-numbering-in-tubes" title="Permalink to this heading">¶</a></h2>
<p>For D2B it assumes that the counts written in the nexus file follow “U-shape” convention; that is, the first tube counts are written from bottom to top, the second one: from top to bottom, and so on.
Note that in the IDF of D2B detector IDs grow ascending from bottom to top for all the tubes.
The loader takes care that the correct counts are attributed to correct pixels.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path.
In Mantid this is done using <a class="reference internal" href="../interfaces/framework/ManageUserDirectories.html#manageuserdirectories"><span class="std std-ref">Manage User Directories</span></a>.</p>
</div>
<p><strong>Example - LoadILLDiffraction - D20 no scan</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">LoadILLDiffraction</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;ILL/D20/967100.nxs&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The output has </span><span class="si">{0}</span><span class="s1"> bins (no scan) and </span><span class="si">{1}</span><span class="s1"> spectra&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">blocksize</span><span class="p">(),</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The output has 1 bins (no scan) and 3073 spectra
</pre></div>
</div>
<p><strong>Example - LoadILLDiffraction - D20 omega scan</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">LoadILLDiffraction</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;ILL/D20/000017.nxs&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The output has </span><span class="si">{0}</span><span class="s1"> bins (scan) and </span><span class="si">{1}</span><span class="s1"> spectra&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">blocksize</span><span class="p">(),</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The output has 21 bins (scan) and 3073 spectra
</pre></div>
</div>
<p><strong>Example - LoadILLDiffraction - D2B detector scan</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">LoadILLDiffraction</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;ILL/D2B/508093.nxs&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The output has </span><span class="si">{0}</span><span class="s1"> bins (detector scan) and </span><span class="si">{1}</span><span class="s1"> spectra&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">blocksize</span><span class="p">(),</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The output has 1 bins (detector scan) and 409625 spectra
</pre></div>
</div>
<p><strong>Example - LoadILLDiffraction - D1B</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">LoadILLDiffraction</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;ILL/D1B/473432.nxs&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The output has </span><span class="si">{0}</span><span class="s1"> bin (detector scan) and </span><span class="si">{1}</span><span class="s1"> spectra&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">blocksize</span><span class="p">(),</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The output has 1 bin (detector scan) and 1281 spectra
</pre></div>
</div>
<p><strong>Example - LoadILLDiffraction - D4</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">LoadILLDiffraction</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;ILL/D4/387230.nxs&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The output has </span><span class="si">{0}</span><span class="s1"> bin and </span><span class="si">{1}</span><span class="s1"> spectra&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">blocksize</span><span class="p">(),</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The output has 1 bin and 577 spectra
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/DataHandling/Nexus.html">DataHandling\Nexus</a> | <a class="reference external" href="categories/ILL/Diffraction.html">ILL\Diffraction</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/DataHandling/inc/MantidDataHandling/LoadILLDiffraction.h">LoadILLDiffraction.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/DataHandling/src/LoadILLDiffraction.cpp">LoadILLDiffraction.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="LoadIDFFromNexus-v1.html" title="Previous Chapter: LoadIDFFromNexus v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; LoadIDFFromNexus v1</span>
    </a>
  </li>
  <li>
    <a href="LoadILLIndirect-v2.html" title="Next Chapter: LoadILLIndirect v2"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">LoadILLIndirect v2 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>