<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>SolidAngle v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SortByQVectors v1" href="SortByQVectors-v1.html" />
    <link rel="prev" title="SofTwoThetaTOF v1" href="SofTwoThetaTOF-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">SolidAngle v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="solidangle-v1">
<span id="algm-solidangle"></span><span id="algm-solidangle-v1"></span><h1>SolidAngle v1<a class="headerlink" href="#solidangle-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/SolidAngle-v1_dlg.png"><img alt="../_images/SolidAngle-v1_dlg.png" class="screenshot" src="../_images/SolidAngle-v1_dlg.png" style="width: 349px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>SolidAngle</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p></li>
<li><p><a class="reference internal" href="#method-property" id="id6"><code class="docutils literal notranslate"><span class="pre">Method</span></code> Property</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id7">Usage</a></p></li>
<li><p><a class="reference internal" href="#references" id="id8">References</a></p></li>
<li><p><a class="reference internal" href="#source" id="id9">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>The SolidAngle algorithm calculates the solid angle in steradians for each of the detectors in an instrument and outputs the data in a workspace.  This can then be used to normalize a data workspace using the divide algorithm should you wish.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="Divide-v1.html#algm-divide"><span class="std std-ref">Divide</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>This workspace is used to identify the instrument to use and also which spectra to create a solid angle for. If the Max and Min spectra values are not provided one solid angle will be created for each spectra in the input workspace</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the workspace to be created as the output of the algorithm.  A workspace of this name will be created and stored in the Analysis Data Service.</p></td>
</tr>
<tr class="row-even"><td><p>StartWorkspaceIndex</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The index number of the first spectrum for which to find the solid angle (default: 0)</p></td>
</tr>
<tr class="row-odd"><td><p>EndWorkspaceIndex</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The index of the last spectrum whose solid angle is to be found (default: the last spectrum in the workspace)</p></td>
</tr>
<tr class="row-even"><td><p>Method</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>GenericShape</p></td>
<td><p>Select the method to calculate the Solid Angle. Allowed values: [‘GenericShape’, ‘Rectangle’, ‘VerticalTube’, ‘HorizontalTube’, ‘VerticalWing’, ‘HorizontalWing’]</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>The algorithm calculates solid angles from the sample position of the
input workspace for all of the spectra selected. If several detectors
have been mapped to the same spectrum then the solid angles of this
detectors will be summed to provide the solid angle for the spectrum.
The solid angle of a detector that has been masked or marked as dead is
considered to be 0 steradians. For grouped detectors, the solid angles will be summed.</p>
<p>This algorithms can happily accept <a class="reference internal" href="../concepts/Ragged_Workspace.html#ragged-workspace"><span class="std std-ref">ragged workspace</span></a>
as an input workspace. The result would
be a ragged output workspace whose X axis values match the lowest and
highest of each the input spectra.</p>
<p>Note: The Solid angle calculation assumes that the path between the
sample and detector is unobstructed by another other instrument
components.</p>
</section>
<section id="method-property">
<h2><a class="toc-backref" href="#id6" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">Method</span></code> Property</a><a class="headerlink" href="#method-property" title="Permalink to this heading">¶</a></h2>
<p>The method property changes how the solid angle calculation is
perfomed.
<code class="docutils literal notranslate"><span class="pre">GenericShape</span></code> uses the ray-tracing methods of <a class="reference internal" href="../concepts/Instrument.html#instrument"><span class="std std-ref">Instrument</span></a>.</p>
<p>All of the others have special analytical forms taken from small angle scattering literature.
Those are fast analytical approximations that are valid in large detector distance and small pixel area limit.
For those equations <span class="math notranslate nohighlight">\(2\theta\)</span> is the scattering angle (from direct beam rather than in-plane), <span class="math notranslate nohighlight">\(\alpha\)</span> is the scattering angle constrained in either the x (horizontal) or y (vertical) plane.
The methods below also assume that the instrument has properties <code class="docutils literal notranslate"><span class="pre">x-pixel-size</span></code> and <code class="docutils literal notranslate"><span class="pre">y-pixel-size</span></code> which define the size of the pixels in millimetres.
A difference between this implementation and what is in literature, is that rather than using the detector elements distance as <span class="math notranslate nohighlight">\(L_{2i} = \frac{D}{\cos(2\theta_i)}\)</span>, this uses the actual <span class="math notranslate nohighlight">\(L_{2i}\)</span> and in the equation after proper substitution.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Rectangular</span></code>: <span class="math notranslate nohighlight">\(d\Omega_i = p_x p_y cos(2\theta_i) / L_{2i}^2\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VerticalTube</span></code> and <code class="docutils literal notranslate"><span class="pre">HorizontalTube</span></code>: <span class="math notranslate nohighlight">\(d\Omega_i = p_x p_y \cos(\alpha_i) / L_2^2\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VerticalWing</span></code> and <code class="docutils literal notranslate"><span class="pre">HorizontalWing</span></code>: <span class="math notranslate nohighlight">\(d\Omega_i = p_x p_y \cos^3(\alpha_i) / (L_2 \cos(2\theta_i))^2\)</span></p></li>
</ul>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example:</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">wsOut</span> <span class="o">=</span> <span class="n">SolidAngle</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solid angle of Spectra 1 in Bank 1: </span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solid angle of Spectra 101 in Bank 2: </span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">100</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Solid angle of Spectra 1 in Bank 1: 6.40e-08
Solid angle of Spectra 101 in Bank 2: 1.60e-08
</pre></div>
</div>
<p><strong>Example: BIOSANS</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">LoadEmptyInstrument</span><span class="p">(</span><span class="n">InstrumentName</span><span class="o">=</span><span class="s1">&#39;BIOSANS&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;BIOSANS&#39;</span><span class="p">)</span>
<span class="n">mainDet</span> <span class="o">=</span> <span class="n">SolidAngle</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;BIOSANS&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;main_detector&#39;</span><span class="p">,</span>
                     <span class="n">Method</span><span class="o">=</span><span class="s1">&#39;VerticalTube&#39;</span><span class="p">,</span> <span class="n">StartWorkspaceIndex</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">EndWorkspaceIndex</span><span class="o">=</span><span class="mi">49153</span><span class="p">)</span>
<span class="n">wingDet</span> <span class="o">=</span> <span class="n">SolidAngle</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;BIOSANS&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;wing_detector&#39;</span><span class="p">,</span>
                     <span class="n">Method</span><span class="o">=</span><span class="s1">&#39;VerticalWing&#39;</span><span class="p">,</span> <span class="n">StartWorkspaceIndex</span><span class="o">=</span><span class="mi">49154</span><span class="p">,</span> <span class="n">EndWorkspaceIndex</span><span class="o">=</span><span class="mi">90113</span><span class="p">)</span>
<span class="c1"># both are zero where nothing was calculated</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solid angle where main was not calculated: </span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mainDet</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solid angle where wing was not calculated: </span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">wingDet</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># both have values where they were calculated</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solid angle where main was calculated: </span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mainDet</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solid angle where wing was calculated: </span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">wingDet</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">49155</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Solid angle where main was not calculated: 0.00e+00
Solid angle where wing was not calculated: 0.00e+00
Solid angle where main was calculated: 2.82e-05
Solid angle where wing was calculated: 1.30e-05
</pre></div>
</div>
</section>
<section id="references">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">References</a><a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h2>
<p>The specialzed <code class="docutils literal notranslate"><span class="pre">Method</span></code> calculations are based on work summarized in:</p>
<ol class="arabic simple">
<li><ol class="upperroman simple">
<li><p>Grillo, <em>Small-angle neutron scattering and applications in soft condensed matter.</em> Soft matter characterization (2008): 723-782.</p></li>
</ol>
</li>
<li><p>Annie Brûlet, <em>Improvement of data treatment in small-angle neutron scattering.</em> J. of Appl. Cryst. 40.1 (2007): 165-177 <a class="reference external" href="https://doi.org/10.1107/S0021889806051442">doi: 10.1107/S0021889806051442</a></p></li>
</ol>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/CorrectionFunctions/InstrumentCorrections.html">CorrectionFunctions\InstrumentCorrections</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/Algorithms/inc/MantidAlgorithms/SolidAngle.h">SolidAngle.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/Algorithms/src/SolidAngle.cpp">SolidAngle.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="SofTwoThetaTOF-v1.html" title="Previous Chapter: SofTwoThetaTOF v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SofTwoThetaTOF v1</span>
    </a>
  </li>
  <li>
    <a href="SortByQVectors-v1.html" title="Next Chapter: SortByQVectors v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SortByQVectors v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>