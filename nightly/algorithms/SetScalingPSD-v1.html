<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>SetScalingPSD v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SetSpecialCoordinates v1" href="SetSpecialCoordinates-v1.html" />
    <link rel="prev" title="SetSampleMaterial v1" href="SetSampleMaterial-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">SetScalingPSD v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="setscalingpsd-v1">
<span id="algm-setscalingpsd"></span><span id="algm-setscalingpsd-v1"></span><h1>SetScalingPSD v1<a class="headerlink" href="#setscalingpsd-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/SetScalingPSD-v1_dlg.png"><img alt="../_images/SetScalingPSD-v1_dlg.png" class="screenshot" src="../_images/SetScalingPSD-v1_dlg.png" style="width: 426px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>SetScalingPSD</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#optional-properties" id="id5">Optional properties</a></p></li>
<li><p><a class="reference internal" href="#childalgorithms-used" id="id6">ChildAlgorithms used</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#source" id="id7">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>For an instrument with Position Sensitive Detectors (PSDs) the ‘engineering’ positions of individual detectors may not match the true areas where neutrons are detected. This algorithm reads data on the calibrated location of the detectors and adjusts the parametrized instrument geometry accordingly.</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ScalingFilename</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the scaling calibrations file to read, including its full or relative path. The file extension must be either .sca or .raw (filenames are case sensitive on linux). Allowed extensions: [‘.sca’, ‘.raw’]</p></td>
</tr>
<tr class="row-odd"><td><p>Workspace</p></td>
<td><p>InOut</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the workspace to apply the scaling to. This must be associated with an instrument appropriate for the scaling file</p></td>
</tr>
<tr class="row-even"><td><p>ScalingOption</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Control scaling calculation - 0 =&gt; use average of left and right scaling (default). 1 =&gt; use maximum scaling. 2 =&gt; maximum + 5%</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This algorithm was developed for the Merlin instrument but may be used
with other instruments if appropriate scaling data is available. The
scaling data should give the true centre point location of each pixel
detector in the instrument. This may be obtained by a calibration run
and post-processing of the results. Since the calibration data may vary
with time, it is not convenient to store it in the instrument XML
definition file. Instead it can be stored as an ACSII file with the
extension “.sca” or within the “.raw” file associated with the data, as
data on the position of each detector (r,theta,phi).</p>
<p>A scaling file (extension .sca) is expected to be an ASCII file with
three header lines. Of these, only the second line is actual read and
the first item on this line should give the number of detectors
described by the file as an integer value. Each subsequent line after
the first three will give the information for one detector with at least
the five ordered values detector_ID, detector_offset, l2, code, theta
and phi. Of these values only the detector_ID and the new position (l2,
theta, phi) are used. The latter three values are taken as defining the
true position of the detector in spherical polar coordinates relative to
the origin (sample position). If a raw file is given the true positions
are taken from this instead.</p>
<p>This algorithm creates a parameter map for the instrument that applies a
shift to each detector so that is at the correct position. Monitors are
not moved. Because the shift of detector locations can alter the
effective width of the pixel it is necessary to apply a scaling factor.
While each shift can have components in all three primary axes (X,Y,Z),
it is assumed that a single PSD will maintain the co-linear nature of
pixel centres. The width scaling factor for a pixel i is approximated as
average of the left and right side scalings cased by the change in
relative spacings with respect to neighbour pixels. End of detector
pixels only have one scaling value to use. It is assumed that the
scaling is both small and smooth so that the approximate scaling is
reasonable.</p>
<p>Scaling and position correction will be reflected in properties of the
detector objects including values such as the solid angle, bounding box,
etc. The detector numbering in Merlin uses sequential numbers for pixels
within a PSD and non-sequential jumps between PSDs. This algorithm uses
these jumps to identify individual PSDs.</p>
<p>To apply this algorithm to instruments other than Merlin it may be
necessary to modify the code depending on the type of detectors present
and how they are numbered.</p>
<p>If the tube detector performance enhancement is used the results of the
algorithm will not be visible in the instrument viewer, however
all subsequent calclations on the workspace will be performed correctly.</p>
<section id="optional-properties">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Optional properties</a><a class="headerlink" href="#optional-properties" title="Permalink to this heading">¶</a></h3>
<p>ScalingOpt - this integer value controls the way in which the scaling is
calculated for pixels that have both left and right values for the
scaling. The default is to just average the two together. Setting this
to 1 causes the maximum scaling to be used and setting it to 2 uses the
maximum scaling plus 5% to be used.</p>
</section>
<section id="childalgorithms-used">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">ChildAlgorithms used</a><a class="headerlink" href="#childalgorithms-used" title="Permalink to this heading">¶</a></h3>
<p>None</p>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/CorrectionFunctions/InstrumentCorrections.html">CorrectionFunctions\InstrumentCorrections</a></p>
</section>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/DataHandling/inc/MantidDataHandling/SetScalingPSD.h">SetScalingPSD.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/DataHandling/src/SetScalingPSD.cpp">SetScalingPSD.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="SetSampleMaterial-v1.html" title="Previous Chapter: SetSampleMaterial v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SetSampleMaterial v1</span>
    </a>
  </li>
  <li>
    <a href="SetSpecialCoordinates-v1.html" title="Next Chapter: SetSpecialCoordinates v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SetSpecialCoo... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>