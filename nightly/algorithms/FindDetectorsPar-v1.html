<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>FindDetectorsPar v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FindEPP v2" href="FindEPP-v2.html" />
    <link rel="prev" title="FindDetectorsOutsideLimits v1" href="FindDetectorsOutsideLimits-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">FindDetectorsPar v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="finddetectorspar-v1">
<span id="algm-finddetectorspar"></span><span id="algm-finddetectorspar-v1"></span><h1>FindDetectorsPar v1<a class="headerlink" href="#finddetectorspar-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/FindDetectorsPar-v1_dlg.png"><img alt="../_images/FindDetectorsPar-v1_dlg.png" class="screenshot" src="../_images/FindDetectorsPar-v1_dlg.png" style="width: 404px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>FindDetectorsPar</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#par-and-phx-files" id="id5"><a class="reference internal" href="SavePAR-v1.html#algm-savepar"><span class="std std-ref">par</span></a> and <a class="reference internal" href="SavePHX-v1.html#algm-savephx"><span class="std std-ref">phx</span></a> files</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id6">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id7">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>The algorithm returns the angular parameters and second flight path for a workspace detectors (data, usually availble in par or phx file)</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the workspace that will be used as input for the algorithm</p></td>
</tr>
<tr class="row-odd"><td><p>ReturnLinearRanges</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>if set to true, the algorithm would return linear detector’s ranges (dx,dy) rather then angular ranges (dAzimuthal,dPolar)</p></td>
</tr>
<tr class="row-even"><td><p>ParFile</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>not_used.par</p></td>
<td><p>An optional file that contains of the list of angular parameters for the detectors and detectors groups; If specified, will use data from file instead of the data, calculated from the instument description. Allowed extensions: [‘.par’, ‘.phx’]</p></td>
</tr>
<tr class="row-odd"><td><p>OutputParTable</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>If not empty, a name of a table workspace which  will contain the calculated par or phx values for the detectors</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>Identifies geometrical parameters of detectors and groups of detectors
after the workspaces were grouped using ASCII or XML map file. Located
in DataHandling\Instrument\Detectors group and intended to be used as
Child Algorithm of <a class="reference internal" href="SaveNXSPE-v1.html#algm-savenxspe"><span class="std std-ref">SaveNXSPE</span></a>
algorithm, though can be deployed independently. Dynamic casting from iAlgorithm
and accessors functions
return calculated parameters to <a class="reference internal" href="SaveNXSPE-v1.html#algm-savenxspe"><span class="std std-ref">SaveNXSPE</span></a>
when FindDetectorsPar used as
the Child Algorithm of <a class="reference internal" href="SaveNXSPE-v1.html#algm-savenxspe"><span class="std std-ref">SaveNXSPE</span></a>
procedure;</p>
<p>Internal Child Algorithm identifies the group topology, namely if a
group of detectors is arranged into a rectangular shape or in a ring.
The algorithm calculates the geometrical centre of the detectors group
and 6 points, located within +-1/4 width of the first detector of the
group. If the centre or any of these points belong to the group of the
detectors itself, the group assumed to have a rectangular topology, and
if not – the cylindrical one (ring).</p>
<p>Single detector defined to have the rectangular shape.</p>
<p>After identifying the topology, the parameters are calculated using
formulas for angles in Cartesian or Cylindrical coordinate systems
accordingly</p>
</section>
<section id="par-and-phx-files">
<h2><a class="toc-backref" href="#id5" role="doc-backlink"><a class="reference internal" href="SavePAR-v1.html#algm-savepar"><span class="std std-ref">par</span></a> and <a class="reference internal" href="SavePHX-v1.html#algm-savephx"><span class="std std-ref">phx</span></a> files</a><a class="headerlink" href="#par-and-phx-files" title="Permalink to this heading">¶</a></h2>
<p>These files are ascii files which are used to describe the combined
detectors geometry defined by map files. There are no reasons for you to
use it unless this Mantid algorithm is working unsatisfactory for you.
In this case you can quickly modify and use par file until this
algorithm is modified. It is your responsibility then to assure the
correspondence between mapped detectors and parameters in the par file.</p>
<p>The par files are simple ASCII files with the following columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="n">st</span> <span class="n">column</span>      <span class="n">sample</span><span class="o">-</span><span class="n">detector</span> <span class="n">distance</span> <span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="mi">2</span><span class="n">nd</span>  <span class="s2">&quot;          scattering angle (deg)</span>
<span class="mi">3</span><span class="n">rd</span>  <span class="s2">&quot;          azimuthal angle (deg)   (west bank = 0 deg, north bank = -90 deg etc.)   (Note the reversed sign convention cf .phx files)</span>
<span class="mi">4</span><span class="n">th</span>  <span class="s2">&quot;          width  (m)</span>
<span class="mi">5</span><span class="n">th</span>  <span class="s2">&quot;          height (m)</span>
</pre></div>
</div>
<p>When processed by this algorithm, 4th and 5th column are transformed
into angular values.</p>
<p><a class="reference internal" href="SavePHX-v1.html#algm-savephx"><span class="std std-ref">Phx</span></a>
files are Mslice phx files, which do not contain
secondary flight path. This path is calculated by the algorithm from the
data in the instrument description and the angular values are calculated
as in nxspe file. There are no reason to use phx files to build nxspe
files at the moment unless you already have one and need to repeat your
previous results with Mantid.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>This algorithm is meant to be run as a child algorithm to one of the previously
mentioned algorithms. However, it can be used alone.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path.
In Mantid this is done using <a class="reference internal" href="../interfaces/framework/ManageUserDirectories.html#manageuserdirectories"><span class="std std-ref">Manage User Directories</span></a>.</p>
</div>
<p><strong>Example - Pars with (dPolar, dAzimuthal)</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s2">&quot;MAR11001.raw&quot;</span><span class="p">)</span>
<span class="c1"># Output workspace is None if OutputParTable is not used)</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">FindDetectorsPar</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">OutputParTable</span><span class="o">=</span><span class="s2">&quot;pars&quot;</span><span class="p">)</span>
<span class="c1"># pars is a TableWorkspace</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Workspace type = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">id</span><span class="p">()))</span>
<span class="c1"># Show width column headers</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Width headers = ( </span><span class="si">{}</span><span class="s2"> , </span><span class="si">{}</span><span class="s2"> )&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">getColumnNames</span><span class="p">()[</span><span class="mi">3</span><span class="p">],</span> <span class="n">pars</span><span class="o">.</span><span class="n">getColumnNames</span><span class="p">()[</span><span class="mi">4</span><span class="p">]))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Workspace type = TableWorkspace
Width headers = ( polar_width , azimuthal_width )
</pre></div>
</div>
<p><strong>Example - Pars with (dX (width), dY (height))</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s2">&quot;MAR11001.raw&quot;</span><span class="p">)</span>
<span class="c1"># Output workspace is None if OutputParTable is not used)</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">FindDetectorsPar</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">ReturnLinearRanges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">OutputParTable</span><span class="o">=</span><span class="s2">&quot;pars&quot;</span><span class="p">)</span>
<span class="c1"># pars is a TableWorkspace</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Workspace type = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">id</span><span class="p">()))</span>
<span class="c1"># Show width column headers</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Width headers = ( </span><span class="si">{}</span><span class="s2"> , </span><span class="si">{}</span><span class="s2"> )&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">getColumnNames</span><span class="p">()[</span><span class="mi">3</span><span class="p">],</span> <span class="n">pars</span><span class="o">.</span><span class="n">getColumnNames</span><span class="p">()[</span><span class="mi">4</span><span class="p">]))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Workspace type = TableWorkspace
Width headers = ( det_width , det_height )
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/DataHandling/Instrument.html">DataHandling\Instrument</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/DataHandling/inc/MantidDataHandling/FindDetectorsPar.h">FindDetectorsPar.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/DataHandling/src/FindDetectorsPar.cpp">FindDetectorsPar.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="FindDetectorsOutsideLimits-v1.html" title="Previous Chapter: FindDetectorsOutsideLimits v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; FindDetectors...</span>
    </a>
  </li>
  <li>
    <a href="FindEPP-v2.html" title="Next Chapter: FindEPP v2"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">FindEPP v2 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>