<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>IndexPeaks v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="IndexSXPeaks v1" href="IndexSXPeaks-v1.html" />
    <link rel="prev" title="ImportMDHistoWorkspace v1" href="ImportMDHistoWorkspace-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">IndexPeaks v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="indexpeaks-v1">
<span id="algm-indexpeaks"></span><span id="algm-indexpeaks-v1"></span><h1>IndexPeaks v1<a class="headerlink" href="#indexpeaks-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/IndexPeaks-v1_dlg.png"><img alt="../_images/IndexPeaks-v1_dlg.png" class="screenshot" src="../_images/IndexPeaks-v1_dlg.png" style="width: 349px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>IndexPeaks</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id6">Usage</a></p></li>
<li><p><a class="reference internal" href="#related-algorithms" id="id7">Related Algorithms</a></p></li>
<li><p><a class="reference internal" href="#source" id="id8">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Index the peaks using the UB from the sample. Leave MaxOrder at default value 0 to get this value, and ModVectors (unless overridden) from the sample.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="IndexSXPeaks-v1.html#algm-indexsxpeaks"><span class="std std-ref">IndexSXPeaks</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PeaksWorkspace</p></td>
<td><p>InOut</p></td>
<td><p>IPeaksWorkspace</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Input Peaks Workspace</p></td>
</tr>
<tr class="row-odd"><td><p>Tolerance</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.15</p></td>
<td><p>Main peak indexing tolerance</p></td>
</tr>
<tr class="row-even"><td><p>ToleranceForSatellite</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.15</p></td>
<td><p>Satellite peak indexing tolerance</p></td>
</tr>
<tr class="row-odd"><td><p>RoundHKLs</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>Round H, K and L values to integers</p></td>
</tr>
<tr class="row-even"><td><p>CommonUBForAll</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Index all orientations with a common UB</p></td>
</tr>
<tr class="row-odd"><td><p>ModVector1</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p>0,0,0</p></td>
<td><p>Modulation Vector 1: dh, dk, dl</p></td>
</tr>
<tr class="row-even"><td><p>ModVector2</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p>0,0,0</p></td>
<td><p>Modulation Vector 2: dh, dk, dl</p></td>
</tr>
<tr class="row-odd"><td><p>ModVector3</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td><p>0,0,0</p></td>
<td><p>Modulation Vector 3: dh, dk, dl</p></td>
</tr>
<tr class="row-even"><td><p>MaxOrder</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Maximum order to apply Modulation Vectors. Default = 0</p></td>
</tr>
<tr class="row-odd"><td><p>CrossTerms</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Include combinations of modulation vectors in satellite search</p></td>
</tr>
<tr class="row-even"><td><p>SaveModulationInfo</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>If true, update the OrientedLattice with the maxOrder, modulation vectors &amp; cross terms values input to the algorithm</p></td>
</tr>
<tr class="row-odd"><td><p>NumIndexed</p></td>
<td><p>Output</p></td>
<td><p>number</p></td>
<td></td>
<td><p>Gets set with the number of indexed peaks.</p></td>
</tr>
<tr class="row-even"><td><p>AverageError</p></td>
<td><p>Output</p></td>
<td><p>number</p></td>
<td></td>
<td><p>Gets set with the average HKL indexing error.</p></td>
</tr>
<tr class="row-odd"><td><p>MainNumIndexed</p></td>
<td><p>Output</p></td>
<td><p>number</p></td>
<td></td>
<td><p>Gets set with the number of indexed main peaks.</p></td>
</tr>
<tr class="row-even"><td><p>SateNumIndexed</p></td>
<td><p>Output</p></td>
<td><p>number</p></td>
<td></td>
<td><p>Gets set with the number of indexed main peaks.</p></td>
</tr>
<tr class="row-odd"><td><p>MainError</p></td>
<td><p>Output</p></td>
<td><p>number</p></td>
<td></td>
<td><p>Gets set with the average HKL indexing error of Main Peaks.</p></td>
</tr>
<tr class="row-even"><td><p>SatelliteError</p></td>
<td><p>Output</p></td>
<td><p>number</p></td>
<td></td>
<td><p>Gets set with the average HKL indexing error of Satellite Peaks.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>Given a PeaksWorkspace with a <a class="reference internal" href="../concepts/Lattice.html#lattice"><span class="std std-ref">UB matrix</span></a> stored with
the sample, this algorithm will use UB inverse to index the peaks. If
there are peaks from multiple runs in the workspace, the stored
<a class="reference internal" href="../concepts/Lattice.html#lattice"><span class="std std-ref">UB matrix</span></a> will be used to get an initial indexing for
the peaks from each individual run. Subsequently, a temporary
<a class="reference internal" href="../concepts/Lattice.html#lattice"><span class="std std-ref">UB matrix</span></a> will be optimzed for the peaks from each
individual run, and used to index the peaks from that run. In this way,
a consistent indexing of the peaks from multiple runs will be obtained,
which indexes the largest number of peaks, although one
<a class="reference internal" href="../concepts/Lattice.html#lattice"><span class="std std-ref">UB matrix</span></a> may not produce exactly that indexing for all
peaks, within the specified tolerance.</p>
<p>To not optimize the UB for each run, use the option, CommonUBForAll.  In
this case, the same UB stored in the workspace will be used to index
all the peaks with no optimization.</p>
<p>Any peak with any Miller index more than the specified tolerance away
from an integer will have its (h,k,l) set to (0,0,0). The calculated
Miller indices can either be rounded to the nearest integer value, or
can be left as decimal fractions.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example - a simple example of IndexPeaks</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path. In Mantid this is done using <a class="reference external" href="http://www.mantidproject.org/ManageUserDirectories">Manage User Directories</a>.</p>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load Peaks found in SXD23767.raw</span>
<span class="n">Load</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;SXD23767.peaks&#39;</span><span class="p">,</span><span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;peaks_qLab&#39;</span><span class="p">)</span>

<span class="c1">#Set orientated lattice</span>
<span class="n">ubMatrix</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.06452276</span><span class="p">,</span>  <span class="mf">0.2478114</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.23742194</span><span class="p">,</span> <span class="mf">0.29161678</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00914316</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12523779</span><span class="p">,</span> <span class="mf">0.06958942</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1802702</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.14649001</span><span class="p">]</span>
<span class="n">SetUB</span><span class="p">(</span><span class="s1">&#39;peaks_qLab&#39;</span><span class="p">,</span><span class="n">UB</span><span class="o">=</span><span class="n">ubMatrix</span><span class="p">)</span>

<span class="c1"># Run Algorithm</span>
<span class="n">indexed</span> <span class="o">=</span><span class="n">IndexPeaks</span><span class="p">(</span><span class="n">PeaksWorkspace</span><span class="o">=</span><span class="s1">&#39;peaks_qLab&#39;</span><span class="p">,</span><span class="n">Tolerance</span><span class="o">=</span><span class="mf">0.12</span><span class="p">,</span><span class="n">RoundHKLs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of Indexed Peaks: </span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">indexed</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Number of Indexed Peaks: 147
</pre></div>
</div>
</section>
<section id="related-algorithms">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Related Algorithms</a><a class="headerlink" href="#related-algorithms" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="IndexSXPeaks-v1.html#algm-indexsxpeaks"><span class="std std-ref">IndexSXPeaks</span></a>
will index peaks given a PeaksWorkspace and lattice parameters</p>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Crystal/Peaks.html">Crystal\Peaks</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/8b6be077efd75a1eee39b81bc5971c6c51c44283/Framework/Crystal/inc/MantidCrystal/IndexPeaks.h">IndexPeaks.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/8b6be077efd75a1eee39b81bc5971c6c51c44283/Framework/Crystal/src/IndexPeaks.cpp">IndexPeaks.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ImportMDHistoWorkspace-v1.html" title="Previous Chapter: ImportMDHistoWorkspace v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; ImportMDHisto...</span>
    </a>
  </li>
  <li>
    <a href="IndexSXPeaks-v1.html" title="Next Chapter: IndexSXPeaks v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">IndexSXPeaks v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>