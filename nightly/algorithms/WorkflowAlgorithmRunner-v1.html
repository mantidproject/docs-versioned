<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>WorkflowAlgorithmRunner v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="XorMD v1" href="XorMD-v1.html" />
    <link rel="prev" title="WienerSmooth v1" href="WienerSmooth-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">WorkflowAlgorithmRunner v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="workflowalgorithmrunner-v1">
<span id="algm-workflowalgorithmrunner"></span><span id="algm-workflowalgorithmrunner-v1"></span><h1>WorkflowAlgorithmRunner v1<a class="headerlink" href="#workflowalgorithmrunner-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/WorkflowAlgorithmRunner-v1_dlg.png"><img alt="../_images/WorkflowAlgorithmRunner-v1_dlg.png" class="screenshot" src="../_images/WorkflowAlgorithmRunner-v1_dlg.png" style="width: 447px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>WorkflowAlgorithmRunner</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id5">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id6">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Manages dependency resolution, input/output mapping and running of algorithms.</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Algorithm</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of the algorithm to run</p></td>
</tr>
<tr class="row-odd"><td><p>SetupTable</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Table workspace containing the setup of the runs.</p></td>
</tr>
<tr class="row-even"><td><p>InputOutputMap</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Table workspace mapping algorithm outputs to inputs.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This utility algorithm is used to control consecutive executions of another algorithm. After defining a table of desired input and output properties, <code class="docutils literal notranslate"><span class="pre">WorkflowAlgorithmRunner</span></code> connects the outputs to input properties, declares the order of execution, and runs the algorithm. It is mainly meant for managing the execution of workflow algorithms for data reduction purposes although it can run all types of algorithms.</p>
<p>The runs are specified in a <cite>TableWorkspace</cite> and given as the <em>SetupTable</em> input property to the algorithm. The first column has to contain unique string identifiers for each row. The rest of the columns have to be named same as the input/output properties of the managed algorithm.</p>
<p>Each row in the <em>SetupTable</em> corresponds to a single run of the managed algorithm. Its properties are set without modifications from the corresponding columns of the row except for special input/output columns declare in the <em>InputOutputMap</em>. For example, two independent runs of the <a class="reference internal" href="Scale-v1.html#algm-scale"><span class="std std-ref">Scale v1</span></a> would be specified as</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Id</p></th>
<th class="head"><p>InputWorkspace</p></th>
<th class="head"><p>OutputWorkspace</p></th>
<th class="head"><p>Factor</p></th>
<th class="head"><p>Operation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1st run</p></td>
<td><p>ws1</p></td>
<td><p>ws1</p></td>
<td><p>0.42</p></td>
<td><p>Multiply</p></td>
</tr>
<tr class="row-odd"><td><p>2nd run</p></td>
<td><p>ws2</p></td>
<td><p>scaled_ws2</p></td>
<td><p>100</p></td>
<td><p>Multiply</p></td>
</tr>
</tbody>
</table>
<p>The <em>Operation</em> column could have been omitted in the above to use the default value of the <em>Operation</em> property of <cite>Scale</cite>.</p>
<p><em>InputOutputMap</em> connects the outputs of a run to the inputs of another run. It is a <cite>TableWorkspace</cite> where the column names correspond to some or all of the managed algorithm’s input properties. The table has only a single row which lists the names of the output properties whose final values will be forwarded to the corresponding input property. To continue the <a class="reference internal" href="Scale-v1.html#algm-scale"><span class="std std-ref">Scale v1</span></a> example above, the <em>InputWorkspace</em> and <em>OutputWorkspace</em> properties would be connected by the following single column table:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>InputWorkspace</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>OutputWorkspace</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only workspace properties can be specified in the <em>InputOutputMap</em>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A single output property can be wired to several input properties. However, an input property cannot have multiple output properties.</p>
</div>
<p>If the one wanted to give the workspace scaled by ‘2nd run’ as an input for ‘1st run’, the <em>InputOutputMap</em> would look like the following:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Id</p></th>
<th class="head"><p>InputWorkspace</p></th>
<th class="head"><p>OutputWorkspace</p></th>
<th class="head"><p>Factor</p></th>
<th class="head"><p>Operation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1st run</p></td>
<td><p>2nd run</p></td>
<td><p>‘ws1’</p></td>
<td><p>0.42</p></td>
<td><p>Multiply</p></td>
</tr>
<tr class="row-odd"><td><p>2nd run</p></td>
<td><p>‘ws2’</p></td>
<td><p>scaled_ws2</p></td>
<td><p>100</p></td>
<td><p>Multiply</p></td>
</tr>
</tbody>
</table>
<p>This would result in ‘2nd run’ to be executed first to produce the ‘scaled_ws2’ workspace which in turn would be fed to ‘1st run’ as the <em>InputWorkspace</em> property. Behind the scenes, <code class="docutils literal notranslate"><span class="pre">WorkflowAlgorithmRunner</span></code> will replace the ‘2nd run’ in the InputWorkspace column of ‘1st run’ by scaled_ws2.</p>
<p>In the above, note the quotation marks around the ‘ws2’ and ‘ws1’ property names. These are <strong>hard coded input</strong> and <strong>forced output</strong> values, respectively. This tells <cite>WorkspaceAlgorithmRunner</cite> to omit input/output mapping and to keep these values as they are.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A non-forced output property which is not needed by the other runs will be cleared by <code class="docutils literal notranslate"><span class="pre">WorkflowAlgorithmRunner</span></code>.</p>
</div>
<p>An equivalent python commands to running <code class="docutils literal notranslate"><span class="pre">WorkflowAlgorithmRunner</span></code> with the above <em>InputOutputMap</em> and <em>SetupTable</em> would be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Scale</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;ws2&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;scaled_ws2&#39;</span><span class="p">,</span> <span class="n">Factor</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">Operation</span><span class="o">=</span><span class="s1">&#39;Multiply&#39;</span><span class="p">)</span>
<span class="n">Scale</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;scaled_ws2&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;ws1&#39;</span><span class="p">,</span> <span class="n">Factor</span><span class="o">=</span><span class="mf">0.42</span><span class="p">,</span> <span class="n">Operation</span><span class="o">=</span><span class="s1">&#39;Multiply&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example: Let’s recreate the example in the Description section</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is our initial workspace. We want to scale it first by 100</span>
<span class="c1"># and then by 0.42</span>
<span class="n">CreateSingleValuedWorkspace</span><span class="p">(</span><span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;ws2&#39;</span><span class="p">,</span> <span class="n">DataValue</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># Setup the runs for the Scale algorithm</span>
<span class="n">setupTable</span> <span class="o">=</span> <span class="n">WorkspaceFactoryImpl</span><span class="o">.</span><span class="n">Instance</span><span class="p">()</span><span class="o">.</span><span class="n">createTable</span><span class="p">()</span>
<span class="n">setupTable</span><span class="o">.</span><span class="n">addColumn</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;Run name&#39;</span><span class="p">)</span> <span class="c1"># First column can have arbitrary name.</span>
<span class="c1"># The rest of the columns can be in arbitrary order</span>
<span class="n">setupTable</span><span class="o">.</span><span class="n">addColumn</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;InputWorkspace&#39;</span><span class="p">)</span>
<span class="n">setupTable</span><span class="o">.</span><span class="n">addColumn</span><span class="p">(</span><span class="s1">&#39;double&#39;</span><span class="p">,</span> <span class="s1">&#39;Factor&#39;</span><span class="p">)</span> <span class="c1"># Scale expects to get a number here.</span>
<span class="n">setupTable</span><span class="o">.</span><span class="n">addColumn</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;OutputWorkspace&#39;</span><span class="p">)</span>
<span class="n">row</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Run name&#39;</span><span class="p">:</span> <span class="s1">&#39;1st run&#39;</span><span class="p">,</span>
    <span class="s1">&#39;InputWorkspace&#39;</span><span class="p">:</span> <span class="s1">&#39;2nd run&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Factor&#39;</span><span class="p">:</span> <span class="mf">0.42</span><span class="p">,</span>
    <span class="s1">&#39;OutputWorkspace&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;ws1&quot;&#39;</span> <span class="c1"># Forced output either by &#39;&#39; or &quot;&quot;.</span>
<span class="p">}</span>
<span class="n">setupTable</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="n">row</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Run name&#39;</span><span class="p">:</span> <span class="s1">&#39;2nd run&#39;</span><span class="p">,</span>
    <span class="s1">&#39;InputWorkspace&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;ws2&#39;&quot;</span><span class="p">,</span>
    <span class="s1">&#39;Factor&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s1">&#39;OutputWorkspace&#39;</span><span class="p">:</span> <span class="s1">&#39;scaled_ws2&#39;</span>
<span class="p">}</span>
<span class="n">setupTable</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="n">AnalysisDataServiceImpl</span><span class="o">.</span><span class="n">Instance</span><span class="p">()</span><span class="o">.</span><span class="n">addOrReplace</span><span class="p">(</span><span class="s1">&#39;setupTable&#39;</span><span class="p">,</span> <span class="n">setupTable</span><span class="p">)</span>

<span class="c1"># Map OutputWorkspace to InputWorkspace</span>
<span class="n">ioMap</span> <span class="o">=</span> <span class="n">WorkspaceFactoryImpl</span><span class="o">.</span><span class="n">Instance</span><span class="p">()</span><span class="o">.</span><span class="n">createTable</span><span class="p">()</span>
<span class="n">ioMap</span><span class="o">.</span><span class="n">addColumn</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;InputWorkspace&#39;</span><span class="p">)</span>
<span class="n">ioMap</span><span class="o">.</span><span class="n">addRow</span><span class="p">({</span><span class="s1">&#39;InputWorkspace&#39;</span><span class="p">:</span> <span class="s1">&#39;OutputWorkspace&#39;</span><span class="p">})</span>
<span class="n">AnalysisDataServiceImpl</span><span class="o">.</span><span class="n">Instance</span><span class="p">()</span><span class="o">.</span><span class="n">addOrReplace</span><span class="p">(</span><span class="s1">&#39;ioMapTable&#39;</span><span class="p">,</span> <span class="n">ioMap</span><span class="p">)</span>

<span class="c1"># Execute the algorithm</span>
<span class="n">WorkflowAlgorithmRunner</span><span class="p">(</span><span class="s1">&#39;Scale&#39;</span><span class="p">,</span> <span class="n">SetupTable</span><span class="o">=</span><span class="n">setupTable</span><span class="p">,</span> <span class="n">InputOutputMap</span><span class="o">=</span><span class="n">ioMap</span><span class="p">)</span>

<span class="c1"># Print some results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original input value: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;ws2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;After scaling by 100: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;scaled_ws2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;After further scaling by 0.42: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;ws1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original input value: 1.0
After scaling by 100: 100.0
After further scaling by 0.42: 42.0
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Utility.html">Utility</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/Algorithms/inc/MantidAlgorithms/WorkflowAlgorithmRunner.h">WorkflowAlgorithmRunner.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/Algorithms/src/WorkflowAlgorithmRunner.cpp">WorkflowAlgorithmRunner.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="WienerSmooth-v1.html" title="Previous Chapter: WienerSmooth v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; WienerSmooth v1</span>
    </a>
  </li>
  <li>
    <a href="XorMD-v1.html" title="Next Chapter: XorMD v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">XorMD v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>