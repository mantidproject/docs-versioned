<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>ConvertMultipleRunsToSingleCrystalMD v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ConvertPeaksWorkspace v1" href="ConvertPeaksWorkspace-v1.html" />
    <link rel="prev" title="ConvertMDHistoToMatrixWorkspace v1" href="ConvertMDHistoToMatrixWorkspace-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">ConvertMultipleRunsToSingleCrystalMD v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="convertmultiplerunstosinglecrystalmd-v1">
<span id="algm-convertmultiplerunstosinglecrystalmd"></span><span id="algm-convertmultiplerunstosinglecrystalmd-v1"></span><h1>ConvertMultipleRunsToSingleCrystalMD v1<a class="headerlink" href="#convertmultiplerunstosinglecrystalmd-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/ConvertMultipleRunsToSingleCrystalMD-v1_dlg.png"><img alt="../_images/ConvertMultipleRunsToSingleCrystalMD-v1_dlg.png" class="screenshot" src="../_images/ConvertMultipleRunsToSingleCrystalMD-v1_dlg.png" style="width: 349px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>ConvertMultipleRunsToSingleCrystalMD</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#masking" id="id6">Masking</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id7">Usage</a></p></li>
<li><p><a class="reference internal" href="#related-algorithms" id="id8">Related Algorithms</a></p></li>
<li><p><a class="reference internal" href="#source" id="id9">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Convert multiple runs to one Single Crystal MDEventWorkspace</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="ConvertToDiffractionMDWorkspace-v3.html#algm-converttodiffractionmdworkspace"><span class="std std-ref">ConvertToDiffractionMDWorkspace</span></a>, <a class="reference internal" href="ConvertToMD-v1.html#algm-converttomd"><span class="std std-ref">ConvertToMD</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Filename</p></td>
<td><p>Input</p></td>
<td><p>list of str lists</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Files to combine in reduction. Allowed extensions: [‘_event.nxs’, ‘.nxs.h5’, ‘.nxs’]</p></td>
</tr>
<tr class="row-odd"><td><p>FilterByTofMin</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Optional: To exclude events that do not fall within a range of times-of-flight. This is the minimum accepted value in microseconds. Keep blank to load all events.</p></td>
</tr>
<tr class="row-even"><td><p>FilterByTofMax</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Optional: To exclude events that do not fall within a range of times-of-flight. This is the maximum accepted value in microseconds. Keep blank to load all events.</p></td>
</tr>
<tr class="row-odd"><td><p>FilterByTimeStop</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Optional: To only include events before the provided stop time, in seconds (relative to the start of the run).</p></td>
</tr>
<tr class="row-even"><td><p>MomentumMin</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Minimum value in momentum. This should match the Flux momentum if the output is to be used with <a class="reference internal" href="MDNorm-v1.html#algm-mdnorm"><span class="std std-ref">MDNorm</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>MomentumMax</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Maximum value in momentum. This should match the Fluxmomentum if the output is to be used with <a class="reference internal" href="MDNorm-v1.html#algm-mdnorm"><span class="std std-ref">MDNorm</span></a></p></td>
</tr>
<tr class="row-even"><td><p>UBMatrix</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Path to an ISAW-style UB matrix text file. See <a class="reference internal" href="LoadIsawUB-v1.html#algm-loadisawub"><span class="std std-ref">LoadIsawUB</span></a>. Allowed extensions: [‘.mat’, ‘.ub’, ‘.txt’]</p></td>
</tr>
<tr class="row-odd"><td><p>SetGoniometer</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Set which Goniometer to use. See <a class="reference internal" href="SetGoniometer-v1.html#algm-setgoniometer"><span class="std std-ref">SetGoniometer</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Goniometers</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>None, Specify Individually</p></td>
<td><p>Set the axes and motor names according to goniometers that we define in the code (Universal defined for SNS). Allowed values: [‘None, Specify Individually’, ‘Universal’]</p></td>
</tr>
<tr class="row-odd"><td><p>Axis0</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Axis0: name, x,y,z, 1/-1 (1 for ccw, -1 for cw rotation). A number of degrees can be used instead of name. Leave blank for no axis</p></td>
</tr>
<tr class="row-even"><td><p>Axis1</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Axis1: name, x,y,z, 1/-1 (1 for ccw, -1 for cw rotation). A number of degrees can be used instead of name. Leave blank for no axis</p></td>
</tr>
<tr class="row-odd"><td><p>Axis2</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Axis2: name, x,y,z, 1/-1 (1 for ccw, -1 for cw rotation). A number of degrees can be used instead of name. Leave blank for no axis</p></td>
</tr>
<tr class="row-even"><td><p>LoadInstrument</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Load a different instrument IDF onto the data from a file. See <a class="reference internal" href="LoadInstrument-v1.html#algm-loadinstrument"><span class="std std-ref">LoadInstrument</span></a>. Allowed extensions: [‘.xml’]</p></td>
</tr>
<tr class="row-odd"><td><p>ApplyCalibration</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></p></td>
<td></td>
<td><p>Calibration will be applied using this TableWorkspace using <a class="reference internal" href="ApplyCalibration-v1.html#algm-applycalibration"><span class="std std-ref">ApplyCalibration</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>DetCal</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Load an ISAW DetCal calibration onto the data from a file. See <a class="reference internal" href="LoadIsawDetCal-v1.html#algm-loadisawdetcal"><span class="std std-ref">LoadIsawDetCal</span></a>. Allowed extensions: [‘.detcal’]</p></td>
</tr>
<tr class="row-odd"><td><p>CopyInstrumentParameters</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td><p>The input workpsace from which <a class="reference internal" href="CopyInstrumentParameters-v1.html#algm-copyinstrumentparameters"><span class="std std-ref">CopyInstrumentParameters</span></a> will copy parameters to data</p></td>
</tr>
<tr class="row-even"><td><p>MaskFile</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Masking file for masking. Supported file format is XML and ISIS ASCII. See <a class="reference internal" href="LoadMask-v1.html#algm-loadmask"><span class="std std-ref">LoadMask</span></a>. Allowed extensions: [‘.xml’, ‘.msk’]</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Output Workspace</p></td>
</tr>
<tr class="row-even"><td><p>QFrame</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Q_sample</p></td>
<td><p>Selects Q-dimensions of the output workspace. Q (sample frame): Wave-vector converted into the frame of the sample (taking out the goniometer rotation). HKL: Use the sample’s UB matrix to convert Wave-vector to crystal’s HKL indices. Allowed values: [‘Q_sample’, ‘HKL’]</p></td>
</tr>
<tr class="row-odd"><td><p>Uproj</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>Defines the first projection vector of the target Q coordinate system in <strong>Q3D</strong> mode - Default (1,0,0)</p></td>
</tr>
<tr class="row-even"><td><p>Vproj</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>Defines the second projection vector of the target Q coordinate system in <strong>Q3D</strong> mode - Default (0,1,0).</p></td>
</tr>
<tr class="row-odd"><td><p>Wproj</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>Defines the third projection vector of the target Q coordinate system in <strong>Q3D</strong> mode. - Default (0,0,1)</p></td>
</tr>
<tr class="row-even"><td><p>MinValues</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>It has to be N comma separated values, where N is the number of dimensions of the target workspace. Values smaller then specified here will not be added to workspace.  Number N is defined by properties 4,6 and 7 and described on <em>MD Transformation factory</em> page. See also <a class="reference internal" href="ConvertToMDMinMaxLocal-v1.html#algm-converttomdminmaxlocal"><span class="std std-ref">ConvertToMDMinMaxLocal v1</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>MaxValues</p></td>
<td><p>Input</p></td>
<td><p>dbl list</p></td>
<td></td>
<td><p>A list of the same size and the same units as MinValues list. Values higher or equal to the specified by this list will be ignored</p></td>
</tr>
<tr class="row-even"><td><p>SplitInto</p></td>
<td><p>Input</p></td>
<td><p>int list</p></td>
<td><p>5</p></td>
<td><p>A comma separated list of into how many sub-grid elements each dimension should split; or just one to split into the same number for all dimensions. Default 5.</p></td>
</tr>
<tr class="row-odd"><td><p>SplitThreshold</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1000</p></td>
<td><p>How many events in a box before it should be split. Default 1000.</p></td>
</tr>
<tr class="row-even"><td><p>MaxRecursionDepth</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>20</p></td>
<td><p>How many levels of box splitting recursion are allowed. The smallest box will have each side length <span class="math notranslate nohighlight">\(l = (extents) / (SplitInto^{MaxRecursionDepth}).\)</span> Default 20.</p></td>
</tr>
<tr class="row-odd"><td><p>OverwriteExisting</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>By default  (“1”), existing Output Workspace will be replaced. Select false (“0”) if you want to add new events to the workspace, which already exist.  Choosing “0” can be very inefficient for file-based workspaces</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This workflow algorithm loads, converts to MDWorkspace and combines a
series of runs. The resulting workspace is a <a class="reference internal" href="../concepts/MDWorkspace.html#mdworkspace"><span class="std std-ref">MDWorkspace</span></a> containing a volume of scattering events. If a <a class="reference internal" href="../concepts/Lattice.html#lattice"><span class="std std-ref">UB
matrix</span></a> is provided and <cite>QFrame=’HKL’</cite>, then the MD workspace
will be in HKL otherwise it will be in Q_sample.</p>
<p>This is <strong>not</strong> a correctly normalized workspace, for that look at
<a class="reference internal" href="SingleCrystalDiffuseReduction-v1.html#algm-singlecrystaldiffusereduction"><span class="std std-ref">SingleCrystalDiffuseReduction</span></a>. The output workspace can be
used with <a class="reference internal" href="FindPeaksMD-v1.html#algm-findpeaksmd"><span class="std std-ref">FindPeaksMD</span></a> and from that
determine the <a class="reference internal" href="../concepts/Lattice.html#lattice"><span class="std std-ref">UB matrix</span></a>. The output workspace (if in
Q sample) can then be used with <a class="reference internal" href="MDNorm-v1.html#algm-mdnorm"><span class="std std-ref">MDNorm</span></a> to
correctly bin and normalise the data.</p>
<p>The input filename follows the syntax from
<a class="reference internal" href="../api/python/mantid/api/MultipleFileProperty.html#mantid.api.MultipleFileProperty" title="mantid.api.MultipleFileProperty"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultipleFileProperty</span></code></a></p>
<p>You should refer to <a class="reference internal" href="ConvertToMD-v1.html#algm-converttomd"><span class="std std-ref">ConvertToMD</span></a> for all its
options. If MinValues and MaxValues are not provided then limits will
be calculated with <a class="reference internal" href="ConvertToMDMinMaxGlobal-v1.html#algm-converttomdminmaxglobal"><span class="std std-ref">ConvertToMDMinMaxGlobal</span></a></p>
<p>The resulting workspaces can be saved and loaded with <a class="reference internal" href="SaveMD-v2.html#algm-savemd"><span class="std std-ref">SaveMD</span></a> and <a class="reference internal" href="LoadMD-v1.html#algm-loadmd"><span class="std std-ref">LoadMD</span></a> respectively.</p>
<section id="masking">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Masking</a><a class="headerlink" href="#masking" title="Permalink to this heading">¶</a></h3>
<p>The workspace will be masked by the provided masking file. A masking
file can be created my masking a data file then saving it using
<a class="reference internal" href="SaveMask-v1.html#algm-savemask"><span class="std std-ref">SaveMask</span></a>.</p>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Single file Q-sample</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ConvertMultipleRunsToSingleCrystalMD</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;CNCS_7860&#39;</span><span class="p">,</span>
                                     <span class="n">MinValues</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span>
                                     <span class="n">MaxValues</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                                     <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;output&#39;</span><span class="p">,</span>
                                     <span class="n">SetGoniometer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">Axis0</span><span class="o">=</span><span class="s2">&quot;huber,0,1,0,1&quot;</span><span class="p">)</span>
<span class="n">ws</span><span class="o">=</span><span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The workspace is in </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getSpecialCoordinateSystem</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> experiment runs in the workspace&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumExperimentInfo</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of Events = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNEvents</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> dimensions with names: </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumDims</span><span class="p">(),</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The workspace is in QSample
There are 1 experiment runs in the workspace
Number of Events = 100210
There are 3 dimensions with names: Q_sample_x Q_sample_y Q_sample_z
</pre></div>
</div>
<p><strong>Multiple files Q-sample</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ConvertMultipleRunsToSingleCrystalMD</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;CORELLI_29782:29817:10&#39;</span><span class="p">,</span>
                                     <span class="n">FilterByTofMin</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                                     <span class="n">FilterByTofMax</span><span class="o">=</span><span class="mi">16666</span><span class="p">,</span>
                                     <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;output&#39;</span><span class="p">,</span>
                                     <span class="n">SetGoniometer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">Axis0</span><span class="o">=</span><span class="s2">&quot;BL9:Mot:Sample:Axis1,0,1,0,1&quot;</span><span class="p">)</span>
<span class="n">ws</span><span class="o">=</span><span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The workspace is in </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getSpecialCoordinateSystem</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> experiment runs in the workspace&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumExperimentInfo</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of Events = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNEvents</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> dimensions with names: </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumDims</span><span class="p">(),</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The workspace is in QSample
There are 4 experiment runs in the workspace
Number of Events = 47223197
There are 3 dimensions with names: Q_sample_x Q_sample_y Q_sample_z
</pre></div>
</div>
<p><strong>Single file HKL</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a ISAW UB file for the test</span>
<span class="kn">import</span> <span class="nn">mantid</span>
<span class="n">UBfilename</span><span class="o">=</span><span class="n">mantid</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="s2">&quot;defaultsave.directory&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;ConvertMultipleRunsToSingleCrystalMDTest.mat&quot;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">UBfilename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;0.0  0.5  0.0  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;0.0  0.0  0.25  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;0.2  0.0  0.0  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;2.0  4.0  5.0  90  90  90  40  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;0.0  0.0  0.0   0   0   0   0  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">some text about IPNS convention&quot;</span><span class="p">)</span>

<span class="n">ConvertMultipleRunsToSingleCrystalMD</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;CNCS_7860&#39;</span><span class="p">,</span>
                                     <span class="n">MinValues</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span>
                                     <span class="n">MaxValues</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                                     <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;output&#39;</span><span class="p">,</span>
                                     <span class="n">SetGoniometer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">Axis0</span><span class="o">=</span><span class="s2">&quot;huber,0,1,0,1&quot;</span><span class="p">,</span>
                                     <span class="n">UBMatrix</span><span class="o">=</span><span class="n">UBfilename</span><span class="p">,</span>
                                     <span class="n">QFrame</span><span class="o">=</span><span class="s1">&#39;HKL&#39;</span><span class="p">)</span>
<span class="n">ws</span><span class="o">=</span><span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The workspace is in </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getSpecialCoordinateSystem</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> experiment runs in the workspace&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumExperimentInfo</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of Events = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNEvents</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> dimensions with names: </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumDims</span><span class="p">(),</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The workspace is in HKL
There are 1 experiment runs in the workspace
Number of Events = 112266
There are 3 dimensions with names: [H,0,0] [0,K,0] [0,0,L]
</pre></div>
</div>
<p><strong>Multiple files HKL</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ConvertMultipleRunsToSingleCrystalMD</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;CORELLI_29782:29817:10&#39;</span><span class="p">,</span>
                                     <span class="n">FilterByTofMin</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                                     <span class="n">FilterByTofMax</span><span class="o">=</span><span class="mi">16666</span><span class="p">,</span>
                                     <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;output&#39;</span><span class="p">,</span>
                                     <span class="n">SetGoniometer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">Axis0</span><span class="o">=</span><span class="s2">&quot;BL9:Mot:Sample:Axis1,0,1,0,1&quot;</span><span class="p">,</span>
                                     <span class="n">UBMatrix</span><span class="o">=</span><span class="s2">&quot;/SNS/CORELLI/IPTS-15526/shared/benzil_Hexagonal.mat&quot;</span><span class="p">,</span>
                                     <span class="n">QFrame</span><span class="o">=</span><span class="s1">&#39;HKL&#39;</span><span class="p">)</span>
<span class="n">ws</span><span class="o">=</span><span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The workspace is in </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getSpecialCoordinateSystem</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> experiment runs in the workspace&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumExperimentInfo</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of Events = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNEvents</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> dimensions with names: </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumDims</span><span class="p">(),</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The workspace is in HKL
There are 4 experiment runs in the workspace
Number of Events = 47223200
There are 3 dimensions with names: [H,0,0] [0,K,0] [0,0,L]
</pre></div>
</div>
</section>
<section id="related-algorithms">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Related Algorithms</a><a class="headerlink" href="#related-algorithms" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="ConvertToMD-v1.html#algm-converttomd"><span class="std std-ref">ConvertToMD</span></a> is used to Convert to MD</p>
<p><a class="reference internal" href="SingleCrystalDiffuseReduction-v1.html#algm-singlecrystaldiffusereduction"><span class="std std-ref">SingleCrystalDiffuseReduction</span></a> does the correct normalisation for multiple runs</p>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/MDAlgorithms/Creation.html">MDAlgorithms\Creation</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/PythonInterface/plugins/algorithms/WorkflowAlgorithms/ConvertMultipleRunsToSingleCrystalMD.py">ConvertMultipleRunsToSingleCrystalMD.py</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ConvertMDHistoToMatrixWorkspace-v1.html" title="Previous Chapter: ConvertMDHistoToMatrixWorkspace v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; ConvertMDHist...</span>
    </a>
  </li>
  <li>
    <a href="ConvertPeaksWorkspace-v1.html" title="Next Chapter: ConvertPeaksWorkspace v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">ConvertPeaksW... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>