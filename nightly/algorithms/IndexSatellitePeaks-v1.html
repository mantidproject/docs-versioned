<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>IndexSatellitePeaks v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="IndirectAnnulusAbsorption v1" href="IndirectAnnulusAbsorption-v1.html" />
    <link rel="prev" title="IndexSXPeaks v1" href="IndexSXPeaks-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">IndexSatellitePeaks v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="indexsatellitepeaks-v1">
<span id="algm-indexsatellitepeaks"></span><span id="algm-indexsatellitepeaks-v1"></span><h1>IndexSatellitePeaks v1<a class="headerlink" href="#indexsatellitepeaks-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/IndexSatellitePeaks-v1_dlg.png"><img alt="../_images/IndexSatellitePeaks-v1_dlg.png" class="screenshot" src="../_images/IndexSatellitePeaks-v1_dlg.png" style="width: 360px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>IndexSatellitePeaks</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#related-algorithms" id="id5">Related Algorithms</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id6">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id7">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Algorithm for indexing satellite peaks in superspace</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NuclearPeaks</p></td>
<td><p>Input</p></td>
<td><p>IPeaksWorkspace</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Main integer HKL peaks. Q vectors will be calculated relative to these peaks.</p></td>
</tr>
<tr class="row-odd"><td><p>SatellitePeaks</p></td>
<td><p>Input</p></td>
<td><p>IPeaksWorkspace</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Positions of satellite peaks with fractional                              HKL coordinates</p></td>
</tr>
<tr class="row-even"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p>IPeaksWorkspace</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The indexed satellite peaks. This will be a                               table workspace with miller indicies h, k, l, m1,                              m2, …, mn.</p></td>
</tr>
<tr class="row-odd"><td><p>Tolerance</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0.3</p></td>
<td><p>Tolerance on the noise of the q vectors</p></td>
</tr>
<tr class="row-even"><td><p>NumOfQs</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1</p></td>
<td><p>Number of independant q vectors</p></td>
</tr>
<tr class="row-odd"><td><p>ClusterThreshold</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1.5</p></td>
<td><p>Threshold for automaticallty deciding on the number of q vectors to use. If NumOfQs found is set then this is property is ignored.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>IndexSatellitePeaks is used to find the higher dimensional miller indices that
index a collection of “satellite” fractional single crystal peaks. This
algorithm takes a PeaksWorkspace, output from the algorithm
FindSatellitePeaks, and returns a new table with integer indices for each
peak.</p>
<p>This algorithm works by first attempting to finding the minimum number of
distinct modulation (<cite>q</cite>) vectors that are required to fully index the
collection of peaks. The full list of q vectors is found using the same method
described in the <a class="reference internal" href="FindSatellitePeaks-v1.html#algm-findsatellitepeaks-v1"><span class="std std-ref">FindSatellitePeaks</span></a>
algorithm. The basis set is then chosen from this list. If there are multiple
choices of vectors the algorithm will always choose the smallest one. This
defines the number of additional dimensions required to index the crystal with
integer indices.</p>
<p>Once a basis of <cite>q</cite> vectors has been chosen for indexing the system all integer
multiples of the basis set are generated. Each <cite>q</cite> vector is then compared with
the set of all possible integer reflections and is assigned to the closest one
found within the radius of the <cite>Tolerance</cite> parameter (measured by Euclidean
distance in HKL space). Reflections which cannot be indexed within the
tolerance are set to (0,0,0).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The current version of the algorithm returns a
<a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a> and not a <a class="reference internal" href="../concepts/PeaksWorkspace.html#peaksworkspace"><span class="std std-ref">PeaksWorkspace</span></a>. This means that the workspace cannot be overlaid on the
slice viewer or the instrument view.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>As well as being able to export the data to the nexus file format,
saving the data to the Jana format is supported via the <a class="reference internal" href="SaveReflections-v1.html#algm-savereflections-v1"><span class="std std-ref">SaveReflections</span></a> algorithm.</p>
</div>
<p>For more information on superspace crystallography see:</p>
<ul class="simple">
<li><p>Van Smaalen, Sander. “An elementary introduction to superspace
crystallography.” Zeitschrift für Kristallographie-Crystalline Materials
219, no. 11 (2004): 681-691.</p></li>
<li><p>Van Smaalen, Sander. “Incommensurate crystal structures.” Crystallography
Reviews 4, no. 2 (1995): 79-202.</p></li>
</ul>
</section>
<section id="related-algorithms">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Related Algorithms</a><a class="headerlink" href="#related-algorithms" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="FindSatellitePeaks-v1.html#algm-findsatellitepeaks-v1"><span class="std std-ref">FindSatellitePeaks</span></a> can be used to
obtain a workspace of satellite peak positions in fractional HKL that is
required for input to this algorithm.</p></li>
<li><p><a class="reference internal" href="SaveReflections-v1.html#algm-savereflections-v1"><span class="std std-ref">SaveReflections</span></a> algorithm can be used to save
the table workspace output from this algorithm to the Jana text file format.</p></li>
</ul>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path. In Mantid this is done using <a class="reference external" href="http://www.mantidproject.org/ManageUserDirectories">Manage User Directories</a>.</p>
</div>
<p><strong>Example - calling IndexSatellitePeaks:</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">nuclear_peaks</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s1">&#39;WISH_peak_hkl_small.nxs&#39;</span><span class="p">)</span>
<span class="n">satellite_peaks</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s2">&quot;refine_satellites_fixed_q_test.nxs&quot;</span><span class="p">)</span>
<span class="n">indexed_peaks</span> <span class="o">=</span> <span class="n">IndexSatellitePeaks</span><span class="p">(</span><span class="n">nuclear_peaks</span><span class="p">,</span> <span class="n">satellite_peaks</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">NumOfQs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">indexed_peaks</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H: </span><span class="si">{:&gt;5}</span><span class="s2"> K: </span><span class="si">{:&gt;5}</span><span class="s2"> L: </span><span class="si">{:&gt;5}</span><span class="s2"> M1: </span><span class="si">{:&gt;5}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">peak</span><span class="o">.</span><span class="n">getH</span><span class="p">(),</span><span class="n">peak</span><span class="o">.</span><span class="n">getK</span><span class="p">(),</span><span class="n">peak</span><span class="o">.</span><span class="n">getL</span><span class="p">(),</span><span class="n">peak</span><span class="o">.</span><span class="n">getIntMNP</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>H:   2.0 K:  -1.0 L:  -3.0 M1:  -1.0
H:   2.0 K:  -1.0 L:   0.0 M1:  -1.0
H:   2.0 K:  -1.0 L:  -3.0 M1:   1.0
H:   2.0 K:  -1.0 L:   0.0 M1:   1.0
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Crystal/Peaks.html">Crystal\Peaks</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/8b6be077efd75a1eee39b81bc5971c6c51c44283/Framework/PythonInterface/plugins/algorithms/IndexSatellitePeaks.py">IndexSatellitePeaks.py</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="IndexSXPeaks-v1.html" title="Previous Chapter: IndexSXPeaks v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; IndexSXPeaks v1</span>
    </a>
  </li>
  <li>
    <a href="IndirectAnnulusAbsorption-v1.html" title="Next Chapter: IndirectAnnulusAbsorption v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">IndirectAnnul... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>