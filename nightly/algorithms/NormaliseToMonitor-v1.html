<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>NormaliseToMonitor v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NormaliseToUnity v1" href="NormaliseToUnity-v1.html" />
    <link rel="prev" title="NormaliseSpectra v1" href="NormaliseSpectra-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">NormaliseToMonitor v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="normalisetomonitor-v1">
<span id="algm-normalisetomonitor"></span><span id="algm-normalisetomonitor-v1"></span><h1>NormaliseToMonitor v1<a class="headerlink" href="#normalisetomonitor-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/NormaliseToMonitor-v1_dlg.png"><img alt="../_images/NormaliseToMonitor-v1_dlg.png" class="screenshot" src="../_images/NormaliseToMonitor-v1_dlg.png" style="width: 349px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>NormaliseToMonitor</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#bin-by-bin-mode" id="id6">Bin-by-bin mode</a></p></li>
<li><p><a class="reference internal" href="#normalisation-by-integrated-count-mode" id="id7">Normalisation by integrated count mode</a></p></li>
<li><p><a class="reference internal" href="#restrictions-on-the-input-workspace" id="id8">Restrictions on the input workspace</a></p></li>
<li><p><a class="reference internal" href="#detector-scan-workspaces" id="id9">Detector Scan Workspaces</a></p></li>
<li><p><a class="reference internal" href="#child-algorithms-used" id="id10">Child Algorithms used</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id11">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id12">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Normalizes a 2D workspace by a specified spectrum, spectrum, described by a monitor ID or spectrun provided in a separate worskspace.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="Divide-v1.html#algm-divide"><span class="std std-ref">Divide</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of the input workspace. Must be a non-distribution histogram.</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name to use for the output workspace</p></td>
</tr>
<tr class="row-even"><td><p>MonitorSpectrum</p></td>
<td><p>InOut</p></td>
<td><p>number</p></td>
<td><p>-1</p></td>
<td><p>The spectrum number within the InputWorkspace you want to normalize by (It can be a monitor spectrum or a spectrum responsible for a group of detectors or monitors)</p></td>
</tr>
<tr class="row-odd"><td><p>MonitorID</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>-1</p></td>
<td><p>The MonitorID (detector ID), which defines the monitor’s data within the InputWorkspace. Will be overridden by the values correspondent to MonitorSpectrum field if one is provided in the field above. If workspace do not have monitors, the MonitorID can refer to empty data and the field then can accepts any MonitorID within the InputWorkspace.</p></td>
</tr>
<tr class="row-even"><td><p>MonitorWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td><p>A workspace containing one or more spectra to normalize the InputWorkspace by.</p></td>
</tr>
<tr class="row-odd"><td><p>MonitorWorkspaceIndex</p></td>
<td><p>InOut</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The index of the spectrum within the MonitorWorkspace(2 (0&lt;=ind&lt;=nHistograms in MonitorWorkspace) you want to normalize by (usually related to the index, responsible for the monitor’s data but can be any). If no value is provided in this field, ‘’’InputWorkspace’’’ will be normalized by first spectra (with index 0)</p></td>
</tr>
<tr class="row-even"><td><p>IntegrationRangeMin</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>If set, normalization will be by integrated count from this minimum x value</p></td>
</tr>
<tr class="row-odd"><td><p>IntegrationRangeMax</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>If set, normalization will be by integrated count up to this maximum x value</p></td>
</tr>
<tr class="row-even"><td><p>IncludePartialBins</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>If true and an integration range is set then partial bins at either  end of the integration range are also included</p></td>
</tr>
<tr class="row-odd"><td><p>NormFactorWS</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td></td>
<td><p>Name of the workspace, containing the normalization factor. If this name is empty, normalization workspace is not returned. If the name coincides with the output workspace name, _normFactor suffix is added to this name</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<section id="bin-by-bin-mode">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Bin-by-bin mode</a><a class="headerlink" href="#bin-by-bin-mode" title="Permalink to this heading">¶</a></h3>
<p>In this, the default scenario, each spectrum in the workspace is
normalised on a bin-by-bin basis by the monitor spectrum given. The
error on the monitor spectrum is taken into account. The normalisation
scheme used is:</p>
<p><span class="math notranslate nohighlight">\((s_i)_{Norm}=(\frac{s_i}{m_i})*\Delta w_i*\frac{\sum_i{m_i}}{\sum_i(\Delta w_i)}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(s_i\)</span> is the signal in a bin, <span class="math notranslate nohighlight">\(m_i\)</span> the count in the
corresponding monitor bin, <span class="math notranslate nohighlight">\(\Delta w_i\)</span> the bin width,
<span class="math notranslate nohighlight">\(\sum_i{m_i}\)</span> the integrated monitor count and
<span class="math notranslate nohighlight">\(\sum_i{\Delta w_i}\)</span> the sum of the monitor bin widths. In words,
this means that after normalisation each bin is multiplied by the bin
width and the total monitor count integrated over the entire frame, and
then divided by the total frame width. This leads to a normalised
histogram which has unit of counts, as before.</p>
<p>If the workspace does not have common binning, then the monitor spectrum
is rebinned internally to match each data spectrum prior to doing the
normalisation.</p>
<p>If a bin in the monitor spectrum contains 0 counts there is no special
treatment, only a warning is logged. The following options are available to deal
with the issue:</p>
<ul class="simple">
<li><p>Smooth the monitor spectrum before normalisation (using for example <a class="reference internal" href="FFTSmooth-v2.html#algm-fftsmooth"><span class="std std-ref">FFTSmooth v2</span></a>, <a class="reference internal" href="SmoothData-v1.html#algm-smoothdata"><span class="std std-ref">SmoothData v1</span></a>, <a class="reference internal" href="SplineSmoothing-v1.html#algm-splinesmoothing"><span class="std std-ref">SplineSmoothing v1</span></a> algorithms).</p></li>
<li><p>Replace the infinite numbers and NaNs after normalisation (<a class="reference internal" href="ReplaceSpecialValues-v1.html#algm-replacespecialvalues"><span class="std std-ref">ReplaceSpecialValues v1</span></a> algorithm).</p></li>
</ul>
</section>
<section id="normalisation-by-integrated-count-mode">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Normalisation by integrated count mode</a><a class="headerlink" href="#normalisation-by-integrated-count-mode" title="Permalink to this heading">¶</a></h3>
<p>This mode is used if one or both of the relevant ‘IntegrationRange’
optional parameters are set. If either is set to a value outside the
workspace range, then it will be reset to the frame minimum or maximum,
as appropriate.</p>
<p>The error on the integrated monitor spectrum is taken into account in
the normalisation. No adjustment of the overall normalisation takes
place, meaning that the output values in the output workspace are
technically dimensionless.</p>
</section>
<section id="restrictions-on-the-input-workspace">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Restrictions on the input workspace</a><a class="headerlink" href="#restrictions-on-the-input-workspace" title="Permalink to this heading">¶</a></h3>
<p>The data must be histogram, non-distribution data. The exception to the histogram requirement is for workspaces that contain point data with
a single count per spectrum. In this case the normalisation is performed by dividing every spectrum by the monitor counts, taking into
account the error on the monitor counts.</p>
</section>
<section id="detector-scan-workspaces">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Detector Scan Workspaces</a><a class="headerlink" href="#detector-scan-workspaces" title="Permalink to this heading">¶</a></h3>
<p>Workspaces that have scanning detectors are supported by this algorithm, both for bin-by-bin mode and normlisation by integrated
count. The only option for specifying the monitor is by ‘MonitorID’, attempting to use ‘MonitorSpectrum’ or MonitorWorkspaceIndex’
will throw an error. In this case the ‘NormFactorWS’ output will contain a monitor spectrum for each time index.</p>
</section>
<section id="child-algorithms-used">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Child Algorithms used</a><a class="headerlink" href="#child-algorithms-used" title="Permalink to this heading">¶</a></h3>
<p>The <a class="reference internal" href="ExtractSpectra-v1.html#algm-extractspectra"><span class="std std-ref">ExtractSpectra v1</span></a> algorithm is used
to pull out the monitor spectrum if it’s part of the InputWorkspace or
MonitorWorkspace. For the ‘integrated range’ option, the
<a class="reference internal" href="Integration-v1.html#algm-integration"><span class="std std-ref">Integration v1</span></a> algorithm is used to integrate the monitor
spectrum.</p>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path.
In Mantid this is done using <a class="reference internal" href="../interfaces/framework/ManageUserDirectories.html#manageuserdirectories"><span class="std std-ref">Manage User Directories</span></a>.</p>
</div>
<p><strong>Example - Normalise to Monitor ID=1</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span><span class="n">Load</span><span class="p">(</span><span class="s1">&#39;IRS26173.raw&#39;</span><span class="p">)</span>

<span class="n">wsN</span> <span class="o">=</span> <span class="n">NormaliseToMonitor</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="n">MonitorID</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Without normalisation&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Monitor ID=1 </span><span class="si">{:.3f}</span><span class="s2">, </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Selected data </span><span class="si">{:.6f}</span><span class="s2">, </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;With Normalisation&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Monitor ID=1 </span><span class="si">{:.3f}</span><span class="s2">, </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsN</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wsN</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Selected data </span><span class="si">{:.6f}</span><span class="s2">, </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsN</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wsN</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Without normalisation
Monitor ID=1 626034.000, 626681.000
Selected data 2.000000, 1.000000
With Normalisation
Monitor ID=1 464872.441, 464872.441
Selected data 1.485135, 0.741801
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/CorrectionFunctions/NormalisationCorrections.html">CorrectionFunctions\NormalisationCorrections</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/Algorithms/inc/MantidAlgorithms/NormaliseToMonitor.h">NormaliseToMonitor.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/Algorithms/src/NormaliseToMonitor.cpp">NormaliseToMonitor.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="NormaliseSpectra-v1.html" title="Previous Chapter: NormaliseSpectra v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; NormaliseSpectra v1</span>
    </a>
  </li>
  <li>
    <a href="NormaliseToUnity-v1.html" title="Next Chapter: NormaliseToUnity v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">NormaliseToUnity v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>