<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>UnwrapMonitorsInTOF v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="UnwrapSNS v1" href="UnwrapSNS-v1.html" />
    <link rel="prev" title="UnwrapMonitor v1" href="UnwrapMonitor-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">UnwrapMonitorsInTOF v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="unwrapmonitorsintof-v1">
<span id="algm-unwrapmonitorsintof"></span><span id="algm-unwrapmonitorsintof-v1"></span><h1>UnwrapMonitorsInTOF v1<a class="headerlink" href="#unwrapmonitorsintof-v1" title="Permalink to this heading">¶</a></h1>
<figure class="align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/UnwrapMonitorsInTOF-v1_dlg.png"><img alt="../_images/UnwrapMonitorsInTOF-v1_dlg.png" class="screenshot" src="../_images/UnwrapMonitorsInTOF-v1_dlg.png" style="width: 349px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>UnwrapMonitorsInTOF</strong> dialog.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id2">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id3">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id4">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id5">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id6">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id7">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Takes a TOF input workspace that contains ‘raw’ data and unwraps monitor data according to a specified wavelength range. The monitor spectra are essentially doubled and then trimmed to the specified wavelength range. If no wavelength range is specified (-1), then the doubled data is not trimmed. The units of the output workspace is in TOF. Note that currently only workspaces with linearly binned monitor data can be handled correctly.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="UnwrapMonitor-v1.html#algm-unwrapmonitor"><span class="std std-ref">UnwrapMonitor</span></a>, <a class="reference internal" href="UnwrapSNS-v1.html#algm-unwrapsns"><span class="std std-ref">UnwrapSNS</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>An input workspace.</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>An output workspace.</p></td>
</tr>
<tr class="row-even"><td><p>WavelengthMin</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>-1</p></td>
<td><p>A lower bound of the wavelength range.</p></td>
</tr>
<tr class="row-odd"><td><p>WavelengthMax</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>-1</p></td>
<td><p>An upper bound of the wavelength range.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This algorithm is for use with white-beam instruments with choppers. When setting two different
time regimes for monitors and detectors it can occur that neutrons from the previous frame
are detected by monitors further down the beam line. Note that this algorithm currently only
operates well on linearly binned monitor data.</p>
<p>The schematic illustration below explains the situation. Two pulses are in the beam line
at the same time. All monitors are operating in the same time regime. This means that
while a monitor closer to the source starts detecting neutrons associated with the current frame,
a monitor further down the beam line might be detecting neutrons associated with the previous frame as
is depicted in illustration a) below.</p>
<p>This means that the measured signal for a monitor further down the beam line can be comprised of data from
two sequential frames. It will be chopped up as is depicted in illustration b) below.</p>
<figure class="align-default">
<img alt="../_images/UnwrapMonitorsInTOF_wrapped_monitors.png" src="../_images/UnwrapMonitorsInTOF_wrapped_monitors.png" />
</figure>
<p>This algorithm duplicates the data and appends it to itself. This means that the TOF is essentially doubled
(in the case of linear time binning). This is depicted in illustration a) below. This means that we now
have data in the monitors which is not physical, i.e. some monitors seem to have measured data for certain
time-of-flight values which are not accessible for the wavelength range of the apperatus and the locations of the monitors.
Therefore the user can specify the wavelength range of the apperatus. This is translated into the effective
time-of-flight range of each monitor and data outside of this range is set to zero. This is illustrated in image b) below.</p>
<figure class="align-default">
<img alt="../_images/UnwrapMonitorsInTOF_unwrapped_monitors.png" src="../_images/UnwrapMonitorsInTOF_unwrapped_monitors.png" />
</figure>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p><strong>Example - UnwrapMonitorsInTOF</strong></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Create a sample SANS2D workspace</span>
<span class="n">sans2D_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ConfigService</span><span class="o">.</span><span class="n">getInstrumentDirectory</span><span class="p">(),</span><span class="s2">&quot;SANS2D_Definition.xml&quot;</span><span class="p">)</span>
<span class="n">workspace</span> <span class="o">=</span> <span class="n">LoadEmptyInstrument</span><span class="p">(</span><span class="n">sans2D_path</span><span class="p">)</span>
<span class="n">workspace</span> <span class="o">=</span> <span class="n">Rebin</span><span class="p">(</span><span class="n">workspace</span><span class="p">,</span> <span class="s2">&quot;1,10000, 100000&quot;</span><span class="p">)</span>

<span class="c1"># Set monitor 4  (at workspace index 3) to  [3, 2, 1, 0, 0, 0, 0, 0, 5, 4]</span>
<span class="n">dataY</span> <span class="o">=</span> <span class="n">workspace</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">dataY</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_values</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c1"># Apply the UnwrapMonitorsInTOF algorithm</span>
<span class="n">output_workspace</span> <span class="o">=</span> <span class="n">UnwrapMonitorsInTOF</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">workspace</span><span class="p">,</span> <span class="n">WavelengthMin</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">WavelengthMax</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Inspect the unwrapped data</span>
<span class="n">dataY_doubled</span> <span class="o">=</span> <span class="n">output_workspace</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The number of bins is </span><span class="si">{0}</span><span class="s2"> and is expected to be 20.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataY_doubled</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The monitor 4 entries are: </span><span class="si">{0}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dataY_doubled</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The number of bins is 20 and is expected to be 20.
The monitor 4 entries are: [ 0.  0.  0.  0.  0.  0.  0.  0.  5.  4.  3.  2.  1.  0.  0.  0.  0.  0.
  0.  0.].
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/CorrectionFunctions/InstrumentCorrections.html">CorrectionFunctions\InstrumentCorrections</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/ec01dd0095c93d22fbc1c7a502ff628a4fee9a76/Framework/Algorithms/inc/MantidAlgorithms/UnwrapMonitorsInTOF.h">UnwrapMonitorsInTOF.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/ec01dd0095c93d22fbc1c7a502ff628a4fee9a76/Framework/Algorithms/src/UnwrapMonitorsInTOF.cpp">UnwrapMonitorsInTOF.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="UnwrapMonitor-v1.html" title="Previous Chapter: UnwrapMonitor v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; UnwrapMonitor v1</span>
    </a>
  </li>
  <li>
    <a href="UnwrapSNS-v1.html" title="Next Chapter: UnwrapSNS v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">UnwrapSNS v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>