<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>How To Define Geometric Shape</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to reset detectors calibration" href="Howtoresetdetectorscalibration.html" />
    <link rel="prev" title="Transition to the HistogramData module" href="HistogramData.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Concepts</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">How To Define Geometric Shape</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="how-to-define-geometric-shape">
<span id="howtodefinegeometricshape"></span><h1>How To Define Geometric Shape<a class="headerlink" href="#how-to-define-geometric-shape" title="Permalink to this heading">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<section id="primitive-shapes">
<h3>Primitive Shapes<a class="headerlink" href="#primitive-shapes" title="Permalink to this heading">¶</a></h3>
<p>There is direct support for defining any of the following geometric
shapes to add <a class="reference internal" href="InstrumentDefinitionFile.html#instrumentdefinitionfile"><span class="std std-ref">Instrument Definition File</span></a>.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sphere">Sphere</a></p></li>
<li><p><a class="reference internal" href="#cylinder">Cylinder (finite height)</a></p></li>
<li><p><a class="reference internal" href="#hollow-cylinder">Hollow Cylinder (finite height)</a></p></li>
<li><p><a class="reference internal" href="#infinite-cylinder">Infinite Cylinder</a></p></li>
<li><p><a class="reference internal" href="#slice-of-cylinder-ring">Slice of Cylinder Ring</a></p></li>
<li><p><a class="reference internal" href="#cone">Cone</a></p></li>
<li><p><a class="reference internal" href="#infinite-cone">Infinite Cone</a></p></li>
<li><p><a class="reference internal" href="#infinite-plane">Infinite Plane</a></p></li>
<li><p><a class="reference internal" href="#cuboid">Cuboid</a></p></li>
<li><p><a class="reference internal" href="#hexahedron">Hexahedron</a></p></li>
<li><p><a class="reference internal" href="#tapered-guide">Tapered Guide</a></p></li>
</ul>
</section>
<section id="combining-primitive-shapes">
<h3>Combining Primitive shapes<a class="headerlink" href="#combining-primitive-shapes" title="Permalink to this heading">¶</a></h3>
<p>In addition to the shapes listed above, other shapes may be defined by
combining already defined shapes into new ones. This is done using an
algebra that follows the following notation:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>:</p></td>
<td><p>Union (i.e two or more things making up one shape). See e.g. also <a class="reference external" href="http://en.wikipedia.org/wiki/Union_(set_theory)">1</a></p></td>
<td><p>a body = legs : torso : arms : head</p></td>
</tr>
<tr class="row-odd"><td><p>“ “</p></td>
<td><p>“space” shared between shapes, i,e. intersection (the common region of shapes). See e.g. also <a class="reference external" href="http://en.wikipedia.org/wiki/Intersection_(set_theory)">2</a></p></td>
<td><p>“small-circle = big-circle small-circle” (where the small circle placed within the big-circle)</p></td>
</tr>
<tr class="row-even"><td><p>#</p></td>
<td><p>Complement</p></td>
<td><p># sphere = shape defined by all points outside sphere</p></td>
</tr>
<tr class="row-odd"><td><p>( )</p></td>
<td><p>Brackets are used to emphasise which shapes an operation should be applied to.</p></td>
<td><p>box1 (# box2) is the intersection between box1 and the shape defined by all points not inside box2</p></td>
</tr>
</tbody>
</table>
</section>
<section id="axes-and-units-of-measure">
<h3>Axes and units of measure<a class="headerlink" href="#axes-and-units-of-measure" title="Permalink to this heading">¶</a></h3>
<p>All objects are defined with respect to cartesian axes (x,y,z), and the
<a class="reference internal" href="InstrumentDefinitionFile.html#using-defaults"><span class="std std-ref">default</span></a> unit of all supplied values are
metres(m). Objects may be defined so that the origin (0,0,0) is at the
centre, so that when rotations are applied they do not also apply an
unexpected translation.</p>
<p>Within instrument definitions we support the concept of defining a
rotation by specifying what point the object is <a class="reference internal" href="InstrumentDefinitionFile.html#using-facing"><span class="std std-ref">facing</span></a>.
To apply that correctly the side of the object we consider to be the front
is the xy plane. Hence, when planning to use <a class="reference internal" href="InstrumentDefinitionFile.html#using-facing"><span class="std std-ref">facing</span></a>
the shape should be defined such that the positive y-axis is considered
to be up, the x-axis the width, and the z-axis the depth of the shape.</p>
</section>
</section>
<section id="to-be-aware-of">
<h2>To be aware of<a class="headerlink" href="#to-be-aware-of" title="Permalink to this heading">¶</a></h2>
<p>When defining a shape you have complete freedom to define it with
respect to whatever coordinate system you like. However, we have a least
the following recommendation</p>
<ul class="simple">
<li><p>The origin of coordinate system of a shape is used for calculating
the L2 distances. Therefore, at least for any TOF instruments where
you care about L2 distances, the origin should be chosen to be at the
position on your detector shape that is best used for calculation the
L2 distance</p></li>
</ul>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<section id="defining-a-sphere">
<h3>Defining a sphere<a class="headerlink" href="#defining-a-sphere" title="Permalink to this heading">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;sphere</span> <span class="na">id=</span><span class="s">&quot;some-sphere&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;centre</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span>  <span class="na">y=</span><span class="s">&quot;0.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;radius</span> <span class="na">val=</span><span class="s">&quot;0.5&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/sphere&gt;</span>

<span class="nt">&lt;algebra</span> <span class="na">val=</span><span class="s">&quot;some-sphere&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Any shape must be given an ID name. Here the sphere has been given the
name “some-sphere”. The purpose of the ID name is to use it in the
description, here this is done with the line . The description is
optional. If it is left out the algebraic intersection is taken between
any shapes defined.</p>
</section>
<section id="defining-a-ball-with-a-hole-through-it-along-the-x-axis">
<h3>Defining a ball with a hole through it along the x-axis<a class="headerlink" href="#defining-a-ball-with-a-hole-through-it-along-the-x-axis" title="Permalink to this heading">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;cylinder</span> <span class="na">id=</span><span class="s">&quot;stick&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;centre-of-bottom-base</span> <span class="na">x=</span><span class="s">&quot;-0.5&quot;</span> <span class="na">y=</span><span class="s">&quot;0.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;axis</span> <span class="na">x=</span><span class="s">&quot;1.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;radius</span> <span class="na">val=</span><span class="s">&quot;0.05&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;height</span> <span class="na">val=</span><span class="s">&quot;1.0&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/cylinder&gt;</span>

<span class="nt">&lt;sphere</span> <span class="na">id=</span><span class="s">&quot;some-sphere&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;centre</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span>  <span class="na">y=</span><span class="s">&quot;0.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;radius</span> <span class="na">val=</span><span class="s">&quot;0.5&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/sphere&gt;</span>

<span class="nt">&lt;algebra</span> <span class="na">val=</span><span class="s">&quot;some-sphere (# stick)&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>This algebra string reads as follows: take the <em>intersection</em> between a
sphere and the shape defined by all points <em>not</em> inside a cylinder of
length 1.0 along the x-axis. Note the brackets around # stick in the
algebraic string are optional, but here included to emphasis that the
“space” between the “some-sphere” and “(# stick)” is the intersection
operator.</p>
</section>
</section>
<section id="notation-used-to-defined-any-of-the-predefined-geometric-shapes">
<h2>Notation used to defined any of the predefined geometric shapes<a class="headerlink" href="#notation-used-to-defined-any-of-the-predefined-geometric-shapes" title="Permalink to this heading">¶</a></h2>
<section id="sphere">
<h3>Sphere<a class="headerlink" href="#sphere" title="Permalink to this heading">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;sphere</span> <span class="na">id=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;centre</span> <span class="na">x=</span><span class="s">&quot;4.1&quot;</span>  <span class="na">y=</span><span class="s">&quot;2.1&quot;</span> <span class="na">z=</span><span class="s">&quot;8.1&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;radius</span> <span class="na">val=</span><span class="s">&quot;3.2&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/sphere&gt;</span>
</pre></div>
</div>
</section>
<section id="cylinder">
<h3>Cylinder<a class="headerlink" href="#cylinder" title="Permalink to this heading">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;cylinder</span> <span class="na">id=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;centre-of-bottom-base</span> <span class="na">r=</span><span class="s">&quot;0.0&quot;</span> <span class="na">t=</span><span class="s">&quot;0.0&quot;</span> <span class="na">p=</span><span class="s">&quot;0.0&quot;</span> <span class="nt">/&gt;</span>  <span class="cm">&lt;!-- here position specified using spherical coordinates --&gt;</span>
  <span class="nt">&lt;axis</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.2&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;radius</span> <span class="na">val=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;height</span> <span class="na">val=</span><span class="s">&quot;10.2&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/cylinder&gt;</span>
</pre></div>
</div>
<figure class="align-center" id="id2">
<img alt="XMLcylinderDescription.png‎" src="../_images/XMLcylinderDescription.png" />
<figcaption>
<p><span class="caption-text">Schematic of a cylinder</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="hollow-cylinder">
<h3>Hollow Cylinder<a class="headerlink" href="#hollow-cylinder" title="Permalink to this heading">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;hollow-cylinder</span> <span class="na">id=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;centre-of-bottom-base</span> <span class="na">r=</span><span class="s">&quot;0.0&quot;</span> <span class="na">t=</span><span class="s">&quot;0.0&quot;</span> <span class="na">p=</span><span class="s">&quot;0.0&quot;</span> <span class="nt">/&gt;</span>  <span class="cm">&lt;!-- here position specified using spherical coordinates --&gt;</span>
  <span class="nt">&lt;axis</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;1.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;inner-radius</span> <span class="na">val=</span><span class="s">&quot;0.007&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;outer-radius</span> <span class="na">val=</span><span class="s">&quot;0.01&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;height</span> <span class="na">val=</span><span class="s">&quot;0.05&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/hollow-cylinder&gt;</span>
</pre></div>
</div>
<figure class="align-center" id="id3">
<img alt="XMLHollowCylinderDescription.png" src="../_images/XMLHollowCylinderDescription.png" />
<figcaption>
<p><span class="caption-text">Schematic of a hollow cylinder</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="infinite-cylinder">
<h3>Infinite Cylinder<a class="headerlink" href="#infinite-cylinder" title="Permalink to this heading">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;infinite-cylinder</span> <span class="na">id=</span><span class="s">&quot;A&quot;</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;centre</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.2&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;axis</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.2&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;radius</span> <span class="na">val=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/infinite-cylinder&gt;</span>
</pre></div>
</div>
</section>
<section id="slice-of-cylinder-ring">
<h3>Slice of Cylinder Ring<a class="headerlink" href="#slice-of-cylinder-ring" title="Permalink to this heading">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;slice-of-cylinder-ring</span> <span class="na">id=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;inner-radius</span> <span class="na">val=</span><span class="s">&quot;0.0596&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;outer-radius</span> <span class="na">val=</span><span class="s">&quot;0.0646&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;depth</span> <span class="na">val=</span><span class="s">&quot;0.01&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;arc</span> <span class="na">val=</span><span class="s">&quot;45.0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/slice-of-cylinder-ring&gt;</span>
</pre></div>
</div>
<p>This XML element defines a slice of a cylinder ring. Most importantly
the part of this shape facing the sample is flat and looks like this:</p>
<figure class="align-default" id="id4">
<img alt="XMLsliceCylinderRingDescription.png" src="../_images/XMLsliceCylinderRingDescription.png" />
<figcaption>
<p><span class="caption-text">XMLsliceCylinderRingDescription.png</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="cone">
<h3>Cone<a class="headerlink" href="#cone" title="Permalink to this heading">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;cone</span> <span class="na">id=</span><span class="s">&quot;A&quot;</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;tip-point</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.2&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;axis</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.2&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;angle</span> <span class="na">val=</span><span class="s">&quot;30.1&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;height</span> <span class="na">val=</span><span class="s">&quot;10.2&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/cone&gt;</span>
</pre></div>
</div>
<figure class="align-default" id="id5">
<img alt="XMLconeDescription.png" src="../_images/XMLconeDescription.png" />
<figcaption>
<p><span class="caption-text">XMLconeDescription.png</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="infinite-cone">
<h3>Infinite Cone<a class="headerlink" href="#infinite-cone" title="Permalink to this heading">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;infinite-cone</span> <span class="na">id=</span><span class="s">&quot;A&quot;</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;tip-point</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.2&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;axis</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.2&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;angle</span> <span class="na">val=</span><span class="s">&quot;30.1&quot;</span>  <span class="nt">/&gt;</span>
<span class="nt">&lt;/infinite-cone&gt;</span>
</pre></div>
</div>
</section>
<section id="infinite-plane">
<h3>Infinite Plane<a class="headerlink" href="#infinite-plane" title="Permalink to this heading">¶</a></h3>
<p>Is the 3D shape of all points on the plane and all points on one side of
the infinite plane, the side which point away from the infinite plane in
the direction of the normal vector.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;infinite-plane</span> <span class="na">id=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;point-in-plane</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.2&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;normal-to-plane</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.2&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/infinite-plane&gt;</span>
</pre></div>
</div>
</section>
<section id="cuboid">
<h3>Cuboid<a class="headerlink" href="#cuboid" title="Permalink to this heading">¶</a></h3>
<p>Here the dimensions are used to define a 2m x 4m x 0.2m cuboid with its centre at (10,10,10).</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;cuboid</span> <span class="na">id=</span><span class="s">&quot;some-cuboid&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;width</span> <span class="na">val=</span><span class="s">&quot;2.0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;height</span> <span class="na">val=</span><span class="s">&quot;4.0&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;depth</span>  <span class="na">val=</span><span class="s">&quot;0.2&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;centre</span> <span class="na">x=</span><span class="s">&quot;10.0&quot;</span> <span class="na">y=</span><span class="s">&quot;10.0&quot;</span> <span class="na">z=</span><span class="s">&quot;10.0&quot;</span>  <span class="nt">/&gt;</span>
<span class="nt">&lt;/cuboid&gt;</span>
<span class="nt">&lt;algebra</span> <span class="na">val=</span><span class="s">&quot;some-cuboid&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../concepts/HowToDefineGeometricShape-1.py">Source code</a>, <a class="reference external" href="../concepts/HowToDefineGeometricShape-1.png">png</a>, <a class="reference external" href="../concepts/HowToDefineGeometricShape-1.hires.png">hires.png</a>, <a class="reference external" href="../concepts/HowToDefineGeometricShape-1.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="Cuboid Dimension XML Example image" class="plot-directive" src="../_images/HowToDefineGeometricShape-1.png" />
</figure>
<p>In the next example, four points are used to describe a 2m x 0.8m x 0.4m cuboid with the its centre at the origin.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;cuboid</span> <span class="na">id=</span><span class="s">&quot;shape&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;left-front-bottom-point</span> <span class="na">x=</span><span class="s">&quot;1&quot;</span> <span class="na">y=</span><span class="s">&quot;-0.4&quot;</span> <span class="na">z=</span><span class="s">&quot;-0.3&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;left-front-top-point</span>  <span class="na">x=</span><span class="s">&quot;1&quot;</span> <span class="na">y=</span><span class="s">&quot;-0.4&quot;</span> <span class="na">z=</span><span class="s">&quot;0.3&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;left-back-bottom-point</span>  <span class="na">x=</span><span class="s">&quot;-1&quot;</span> <span class="na">y=</span><span class="s">&quot;-0.4&quot;</span> <span class="na">z=</span><span class="s">&quot;-0.3&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;right-front-bottom-point</span>  <span class="na">x=</span><span class="s">&quot;1&quot;</span> <span class="na">y=</span><span class="s">&quot;0.4&quot;</span> <span class="na">z=</span><span class="s">&quot;-0.3&quot;</span>  <span class="nt">/&gt;</span>
<span class="nt">&lt;/cuboid&gt;</span>
<span class="nt">&lt;algebra</span> <span class="na">val=</span><span class="s">&quot;shape&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../concepts/HowToDefineGeometricShape-2.py">Source code</a>, <a class="reference external" href="../concepts/HowToDefineGeometricShape-2.png">png</a>, <a class="reference external" href="../concepts/HowToDefineGeometricShape-2.hires.png">hires.png</a>, <a class="reference external" href="../concepts/HowToDefineGeometricShape-2.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="Cuboid Point XML Example image" class="plot-directive" src="../_images/HowToDefineGeometricShape-2.png" />
</figure>
</section>
<section id="hexahedron">
<h3>Hexahedron<a class="headerlink" href="#hexahedron" title="Permalink to this heading">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;hexahedron</span> <span class="na">id=</span><span class="s">&quot;Bertie&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;left-back-bottom-point</span>  <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;left-front-bottom-point</span> <span class="na">x=</span><span class="s">&quot;1.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;right-front-bottom-point</span> <span class="na">x=</span><span class="s">&quot;1.0&quot;</span> <span class="na">y=</span><span class="s">&quot;1.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;right-back-bottom-point</span>  <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;1.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;left-back-top-point</span>  <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.0&quot;</span> <span class="na">z=</span><span class="s">&quot;2.0&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;left-front-top-point</span>  <span class="na">x=</span><span class="s">&quot;0.5&quot;</span> <span class="na">y=</span><span class="s">&quot;0.0&quot;</span> <span class="na">z=</span><span class="s">&quot;2.0&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;right-front-top-point</span>  <span class="na">x=</span><span class="s">&quot;0.5&quot;</span> <span class="na">y=</span><span class="s">&quot;0.5&quot;</span> <span class="na">z=</span><span class="s">&quot;2.0&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;right-back-top-point</span>  <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.5&quot;</span> <span class="na">z=</span><span class="s">&quot;2.0&quot;</span>  <span class="nt">/&gt;</span>
<span class="nt">&lt;/hexahedron&gt;</span>
</pre></div>
</div>
<figure class="align-default" id="id6">
<img alt="XMLhexahedronDescription.png" src="../_images/XMLhexahedronDescription.png" />
<figcaption>
<p><span class="caption-text">XMLhexahedronDescription.png</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="tapered-guide">
<h3>Tapered Guide<a class="headerlink" href="#tapered-guide" title="Permalink to this heading">¶</a></h3>
<p>Available from version 3.0 onwards.</p>
<p>A tapered guide is a special case of hexahedron; a “start” rectangular
aperture which in a continued fashion changes into an “end” rectangular
aperture.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;tapered-guide</span> <span class="na">id=</span><span class="s">&quot;A Guide&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;aperture-start</span> <span class="na">height=</span><span class="s">&quot;2.0&quot;</span> <span class="na">width=</span><span class="s">&quot;2.0&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;length</span> <span class="na">val=</span><span class="s">&quot;3.0&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;aperture-end</span> <span class="na">height=</span><span class="s">&quot;4.0&quot;</span> <span class="na">width=</span><span class="s">&quot;4.0&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;centre</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;5.0&quot;</span> <span class="na">z=</span><span class="s">&quot;10.0&quot;</span> <span class="nt">/&gt;</span> <span class="cm">&lt;!-- Optional.  Defaults to (0, 0 ,0) --&gt;</span>
    <span class="nt">&lt;axis</span> <span class="na">x=</span><span class="s">&quot;0.5&quot;</span> <span class="na">y=</span><span class="s">&quot;1.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0&quot;</span> <span class="nt">/&gt;</span> <span class="cm">&lt;!-- Optional.  Defaults to (0, 0 ,1) --&gt;</span>
<span class="nt">&lt;/tapered-guide&gt;</span>
</pre></div>
</div>
<p>The centre value denotes the centre of the start aperture. The specified
axis runs from the start aperture to the end aperture. “Height” is along
the y-axis and “width” runs along the x-axis, before the application of
the “axis” rotation.</p>
</section>
<section id="rotating-shapes">
<h3>Rotating Shapes<a class="headerlink" href="#rotating-shapes" title="Permalink to this heading">¶</a></h3>
<p><em>Note that some shapes (such as</em> <a class="reference internal" href="#cylinder">Cylinder (finite height)</a> <em>and</em> <a class="reference internal" href="#tapered-guide">Tapered Guide</a> <em>) can be oriented in a
certain direction, using the</em> <code class="docutils literal notranslate"><span class="pre">axis</span></code> <em>tag, but this representation isn’t general enough to support
all possible 3D rotations for all shapes.</em></p>
<p>Most shapes can be rotated individually or as part of an ensemble, by using the
<code class="docutils literal notranslate"><span class="pre">rotate</span></code> or <code class="docutils literal notranslate"><span class="pre">rotate-all</span></code> tags respectively.
The shapes that can be rotated are: <a class="reference internal" href="#sphere">Sphere</a>, <a class="reference internal" href="#cylinder">Cylinder (finite height)</a>,
<a class="reference internal" href="#hollow-cylinder">Hollow Cylinder (finite height)</a>, <a class="reference internal" href="#infinite-cylinder">Infinite Cylinder</a>,
<a class="reference internal" href="#slice-of-cylinder-ring">Slice of Cylinder Ring</a>, <a class="reference internal" href="#infinite-plane">Infinite Plane</a>, <a class="reference internal" href="#cuboid">Cuboid</a>, <a class="reference internal" href="#hexahedron">Hexahedron</a> and <a class="reference internal" href="#tapered-guide">Tapered Guide</a>.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">rotate</span></code> tag to rotate a shape <strong>individually around its centre</strong> (or centre-of-bottom-base).
The shape is rotated by an angle in degrees around the x,y and z axes in that order. To rotate a
cuboid 90° clockwise around x and 45° anti-clockwise around y:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;cuboid</span> <span class="na">id=</span><span class="s">&quot;stick&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;width</span> <span class="na">val=</span><span class="s">&quot;3.0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;height</span> <span class="na">val=</span><span class="s">&quot;0.5&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;depth</span>  <span class="na">val=</span><span class="s">&quot;0.5&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;centre</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;rotate</span> <span class="na">x=</span><span class="s">&quot;90&quot;</span> <span class="na">y=</span><span class="s">&quot;-45&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/cuboid&gt;</span>

<span class="nt">&lt;algebra</span> <span class="na">val=</span><span class="s">&quot;stick&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">rotate-all</span></code> tag to rotate a combined shape <strong>about the origin</strong>. To rotate the unison of a
sphere on the end of a cylinder (by 90° clockwise around x and 45° anti-clockwise around y):</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;cylinder</span> <span class="na">id=</span><span class="s">&quot;stick&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;centre-of-bottom-base</span> <span class="na">x=</span><span class="s">&quot;-1.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;axis</span> <span class="na">x=</span><span class="s">&quot;1.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;radius</span> <span class="na">val=</span><span class="s">&quot;0.2&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;height</span> <span class="na">val=</span><span class="s">&quot;2.0&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/cylinder&gt;</span>

<span class="nt">&lt;sphere</span> <span class="na">id=</span><span class="s">&quot;some-sphere&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;centre</span> <span class="na">x=</span><span class="s">&quot;2.0&quot;</span>  <span class="na">y=</span><span class="s">&quot;0.0&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;radius</span> <span class="na">val=</span><span class="s">&quot;0.5&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/sphere&gt;</span>

<span class="nt">&lt;algebra</span> <span class="na">val=</span><span class="s">&quot;some-sphere (: stick)&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;rotate-all</span> <span class="na">x=</span><span class="s">&quot;90&quot;</span> <span class="na">y=</span><span class="s">&quot;-45&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>All these rotatable shapes (expect for <a class="reference internal" href="#infinite-plane">Infinite Plane</a> and <a class="reference internal" href="#infinite-cylinder">Infinite Cylinder</a>) can be plotted to check
your shape definition is correct. For more details see <a class="reference internal" href="../plotting/MeshPlotHelp.html#mesh-plots"><span class="std std-ref">3D Mesh Plots for Sample Shapes</span></a>.</p>
<p>Shapes will be automatically rotated, if a rotation is set using <a class="reference internal" href="../algorithms/SetGoniometer-v1.html#algm-setgoniometer"><span class="std std-ref">SetGoniometer v1</span></a>.
This goniometer rotation is about the origin and can work alongside manual rotation tags.
Note the rotations are applied in the order <code class="docutils literal notranslate"><span class="pre">rotate</span></code>, <code class="docutils literal notranslate"><span class="pre">rotate-all</span></code>, <code class="docutils literal notranslate"><span class="pre">goniometer</span></code>.</p>
</section>
</section>
<section id="bounding-box">
<span id="id1"></span><h2>Bounding-Box<a class="headerlink" href="#bounding-box" title="Permalink to this heading">¶</a></h2>
<p>When a geometric shape is rendered in the <a class="reference internal" href="../workbench/instrumentviewer.html#instrumentviewer"><span class="std std-ref">instrument viewer</span></a>,
Mantid will attempt to automatically construct an axis-aligned bounding box for every
geometric shape that does not have one yet. Well-defined bounding boxes are
required by many features of Mantid, from correctly rendering the instrument
to performing calculations in various algorithms.</p>
<p>The automatically calculated bounding boxes can generally be relied upon and
are usually ideal. However, if the automatic calculation fails to produce a
reasonable bounding box, or if performance becomes an issue with particularly
complex shapes, you have the option of adding a manually pre-calculated
bounding box.</p>
<p>A typical symptom of the automatic calculation creating an incorrect bounding
box is your instrument appearing very small when viewed (forcing you to zoom
in for a long time to see it). In such cases, the axis visualizations also
tend to not display properly.</p>
<p>A custom bounding-box can be added to shapes using the following notation:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;hexahedron</span> <span class="na">id=</span><span class="s">&quot;shape&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;left-front-bottom-point</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;-0.037&quot;</span> <span class="na">z=</span><span class="s">&quot;-0.0031&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;right-front-bottom-point</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;-0.037&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0031&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;left-front-top-point</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.037&quot;</span> <span class="na">z=</span><span class="s">&quot;-0.0104&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;right-front-top-point</span> <span class="na">x=</span><span class="s">&quot;0.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.037&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0104&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;left-back-bottom-point</span> <span class="na">x=</span><span class="s">&quot;0.005&quot;</span> <span class="na">y=</span><span class="s">&quot;-0.037&quot;</span> <span class="na">z=</span><span class="s">&quot;-0.0031&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;right-back-bottom-point</span> <span class="na">x=</span><span class="s">&quot;0.005&quot;</span> <span class="na">y=</span><span class="s">&quot;-0.037&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0031&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;left-back-top-point</span> <span class="na">x=</span><span class="s">&quot;0.005&quot;</span> <span class="na">y=</span><span class="s">&quot;0.037&quot;</span> <span class="na">z=</span><span class="s">&quot;-0.0104&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;right-back-top-point</span> <span class="na">x=</span><span class="s">&quot;0.005&quot;</span> <span class="na">y=</span><span class="s">&quot;0.037&quot;</span> <span class="na">z=</span><span class="s">&quot;0.0104&quot;</span>  <span class="nt">/&gt;</span>
<span class="nt">&lt;/hexahedron&gt;</span>
<span class="nt">&lt;algebra</span> <span class="na">val=</span><span class="s">&quot;shape&quot;</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;bounding-box&gt;</span>
  <span class="nt">&lt;x-min</span> <span class="na">val=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;x-max</span> <span class="na">val=</span><span class="s">&quot;0.005&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;y-min</span> <span class="na">val=</span><span class="s">&quot;-0.037&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;y-max</span> <span class="na">val=</span><span class="s">&quot;0.037&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;z-min</span> <span class="na">val=</span><span class="s">&quot;-0.0104&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;z-max</span> <span class="na">val=</span><span class="s">&quot;0.0104&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bounding-box&gt;</span>
</pre></div>
</div>
<p>Note for the best effect this bounding box should be enclosing the shape
as tight as possible.</p>
<p><strong>Category</strong>: <a class="reference external" href="../api/python/mantid/api/categories/Concepts.html">Concepts</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="HistogramData.html" title="Previous Chapter: Transition to the HistogramData module"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Transition to...</span>
    </a>
  </li>
  <li>
    <a href="Howtoresetdetectorscalibration.html" title="Next Chapter: How to reset detectors calibration"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">How to reset ... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>