<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Diffraction Changes</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Direct Geometry Changes" href="direct_geometry.html" />
    <link rel="prev" title="Mantid 6.6.0 Release Notes" href="index.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="../index.html" >Release Notes</a> &#187;</li>
          
            <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Mantid 6.6.0 Release Notes</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">Diffraction Changes</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="diffraction-changes">
<h1>Diffraction Changes<a class="headerlink" href="#diffraction-changes" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#powder-diffraction" id="id5">Powder Diffraction</a></p>
<ul>
<li><p><a class="reference internal" href="#new-features" id="id6">New features</a></p></li>
<li><p><a class="reference internal" href="#bugfixes" id="id7">Bugfixes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#engineering-diffraction" id="id8">Engineering Diffraction</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id9">New features</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id10">Bugfixes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#single-crystal-diffraction" id="id11">Single Crystal Diffraction</a></p>
<ul>
<li><p><a class="reference internal" href="#id3" id="id12">New features</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id13">Bugfixes</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="powder-diffraction">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Powder Diffraction</a><a class="headerlink" href="#powder-diffraction" title="Permalink to this heading">¶</a></h2>
<section id="new-features">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">New features</a><a class="headerlink" href="#new-features" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Increase the speed of the fourier filter in the POLARIS total scattering reduction by reducing the Rmax parameter used in the pair of (forward and backward) PDFFourierTransform calls and optimising the integration code inside <a class="reference internal" href="../../algorithms/PDFFourierTransform-v2.html#algm-pdffouriertransform-v2"><span class="std std-ref">PDFFourierTransform v2</span></a></p></li>
<li><p>Added support for ILL D4C instrument, a liquid diffractometer. This adds a new algorithm responsible for the reduction stage: <a class="reference internal" href="../../algorithms/D4ILLReduction-v1.html#algm-d4illreduction"><span class="std std-ref">D4ILLReduction</span></a>, which handles calling the loader, correcting for dead time, bank position offsets, relative efficiency, and normalisation to monitor or time.</p></li>
<li><p>For ILL/D2B instrument, only calibrated data are loaded from the nexus file.</p></li>
<li><p>Introduce an input parameter in <a class="reference internal" href="../../algorithms/WANDPowderReduction-v1.html#algm-wandpowderreduction"><span class="std std-ref">WANDPowderReduction</span></a> to specify that the input workspaces are from event filtering. In such a situation, the overall reduction time could be reduced significantly.</p></li>
</ul>
</section>
<section id="bugfixes">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Bugfixes</a><a class="headerlink" href="#bugfixes" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Change to use time average mean value of logs in <a class="reference internal" href="../../algorithms/PDDetermineCharacterizations-v1.html#algm-pddeterminecharacterizations"><span class="std std-ref">PDDetermineCharacterizations</span></a></p></li>
<li><p>Fix problem when calling focus twice in a reduction using the ISIS Powder diffraction scripts. The second run of focus was using a partially processed input file from the first focus resulting in some of the reduction steps (normalisation, absorption correction) were being run twice</p></li>
<li><p>Fixed an issue with <a class="reference internal" href="../../algorithms/HB2AReduce-v1.html#algm-hb2areduce"><span class="std std-ref">HB2AReduce</span></a> when ‘colltrans’ column is not available in the data file. This corresponds to the situation when the ‘colltrans’ motor is not connected.</p></li>
</ul>
</section>
</section>
<section id="engineering-diffraction">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Engineering Diffraction</a><a class="headerlink" href="#engineering-diffraction" title="Permalink to this heading">¶</a></h2>
<section id="id1">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">New features</a><a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>On the GSASII tab, when a successful refinement is run, the output table workspace for the lattice parameters now includes the Microstrain value and the column title is marked when this parameter has been refined. A similar instrument parameter table workspace is now also generated which includes Sigma-1 and Gamma(Y), with a refined flag, and the fitting range. The Pawley reflections are output to a separate table workspace if they are available.</p></li>
<li><p>An indeterminate progress bar has been added below the FitPropertyBrowser on the Engineering Diffraction Fitting tab. This will display when the fit is in progress and whether the recent fit status was success or fail.</p></li>
</ul>
</section>
<section id="id2">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Bugfixes</a><a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Correct the tabbing order between widgets on the Engineering Diffraction interface.</p></li>
<li><p>Add a scrollbar to the GSASII tab to allow a smaller interface height, like the fitting tab.</p></li>
<li><p>SaveVulcanGSS algorithm marked as deprecated as of 2022-11-30</p></li>
<li><p>Check that there is enough data points before attempting to fit a diffraction peak in <a class="reference internal" href="../../algorithms/FitPeaks-v1.html#algm-fitpeaks"><span class="std std-ref">FitPeaks</span></a></p></li>
</ul>
</section>
</section>
<section id="single-crystal-diffraction">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Single Crystal Diffraction</a><a class="headerlink" href="#single-crystal-diffraction" title="Permalink to this heading">¶</a></h2>
<section id="id3">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">New features</a><a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>New algorithm <a class="reference internal" href="../../algorithms/SaveINS-v1.html#algm-saveins"><span class="std std-ref">SaveINS</span></a> to write a .ins input file for SHELX</p></li>
<li><p>Added new option to <a class="reference internal" href="../../algorithms/IntegratePeaksSkew-v1.html#algm-integratepeaksskew"><span class="std std-ref">IntegratePeaksSkew</span></a>: to get initial TOF window from back-to-back exponential coefficients if specified in the instrument parameters.xml</p></li>
<li><p>Added back-to-back exponential coefficients to SXD parameters.xml file</p></li>
<li><p>Simplified input arguments to <a class="reference internal" href="../../algorithms/IntegratePeaksSkew-v1.html#algm-integratepeaksskew"><span class="std std-ref">IntegratePeaksSkew</span></a>: the parameter <cite>FractionalTOFWindow</cite> has been removed, if a user wants to integrate with an initial window dTOF/TOF = constant for all peaks then this can be achieved by setting ThetaWidth = 0 - note this is technically a breaking change.</p></li>
<li><p>Parallelize loop over peaks in IntegratePEaksMD which provides significant speed-up for ellipsoid integration.</p></li>
<li><p>Exposed indexing tolerance for <a class="reference internal" href="../../algorithms/SCDCalibratePanels-v2.html#algm-scdcalibratepanels"><span class="std std-ref">SCDCalibratePanels</span></a> when using <cite>RecalculateUB</cite> option.</p></li>
<li><p>Added two options to <a class="reference internal" href="../../algorithms/IntegratePeaksSkew-v1.html#algm-integratepeaksskew"><span class="std std-ref">IntegratePeaksSkew</span></a>: to scale angular resolution parameter (<code class="docutils literal notranslate"><span class="pre">ThetaWidth</span></code>) by wavelength, and to specify minimum number of TOF bins in a valid peak (<code class="docutils literal notranslate"><span class="pre">NTOFBinsMin</span></code>).</p></li>
<li><p>Improve estimation of resolution parameters in <a class="reference internal" href="../../algorithms/IntegratePeaksSkew-v1.html#algm-integratepeaksskew"><span class="std std-ref">IntegratePeaksSkew</span></a> (more robust to outliers).</p></li>
<li><p>Made Lorentz correction in <a class="reference internal" href="../../algorithms/IntegratePeaksSkew-v1.html#algm-integratepeaksskew"><span class="std std-ref">IntegratePeaksSkew</span></a> optional.</p></li>
<li><p>Added back bank 14 to TOPAZ for a total of 20 banks</p></li>
</ul>
</section>
<section id="id4">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Bugfixes</a><a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Replaced deprecated NumPy <cite>np.int</cite> type in <a class="reference internal" href="../../algorithms/ConvertWANDSCDtoQ-v1.html#algm-convertwandscdtoq"><span class="std std-ref">ConvertWANDSCDtoQ</span></a>.</p></li>
<li><p><a class="reference internal" href="../../algorithms/IntegratePeaksProfileFitting-v1.html#algm-integratepeaksprofilefitting"><span class="std std-ref">IntegratePeaksProfileFitting</span></a> library <cite>ICCFitTools</cite> module updated to support more recent versions of SciPy where the factorial function moved from <cite>scipy.misc.factorial</cite> to <cite>scipy.special.factorial</cite>. On newer versions of SciPy, the algorithm previously failed.</p></li>
<li><p><a class="reference internal" href="../../algorithms/SaveReflections-v1.html#algm-savereflections"><span class="std std-ref">SaveReflections</span></a> now warns if an empty peak table is saved and doesn’t fail with an error</p></li>
<li><p>Replaced deprecated Matplotlib <cite>bivariate_normal</cite> function in <cite>BVGFitTools.py</cite></p></li>
<li><p>Ensuring colorscale max &gt; min (found for weak peaks with pixels having 0 intensity) in <a class="reference internal" href="../../algorithms/IntegratePeaksSkew-v1.html#algm-integratepeaksskew"><span class="std std-ref">IntegratePeaksSkew</span></a>.</p></li>
<li><p><a class="reference internal" href="../../algorithms/IntegratePeaksSkew-v1.html#algm-integratepeaksskew"><span class="std std-ref">IntegratePeaksSkew</span></a> will now close a generated figure if an error occured while trying to write to file (e.g. file of same name was already open)</p></li>
<li><p>Fix bug that didn’t set HKL of peak if <code class="docutils literal notranslate"><span class="pre">UpdatePeakPosition</span> <span class="pre">=</span> <span class="pre">True</span></code> in <a class="reference internal" href="../../algorithms/IntegratePeaksSkew-v1.html#algm-integratepeaksskew"><span class="std std-ref">IntegratePeaksSkew</span></a></p></li>
<li><p>Fix bugs in <a class="reference internal" href="../../algorithms/SelectCellWithForm-v1.html#algm-selectcellwithform"><span class="std std-ref">SelectCellWithForm</span></a> and ref:<cite>SelectCellOfType &lt;algm-SelectCellOfType&gt;</cite> that incorrectly transform modulation vectors.</p></li>
<li><p>Fix bug where modulation vectors are not transformed in <a class="reference internal" href="../../algorithms/TransformHKL-v1.html#algm-transformhkl"><span class="std std-ref">TransformHKL</span></a>.</p></li>
<li><p>Fix issue where <a class="reference internal" href="../../algorithms/LoadIsawPeaks-v1.html#algm-loadisawpeaks"><span class="std std-ref">LoadIsawPeaks</span></a> fails when loading peaks with modulation vectors that cannot recover modulated UB matrix.</p></li>
</ul>
<p><a class="reference internal" href="index.html#v6-6-0"><span class="std std-ref">Release 6.6.0</span></a></p>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="index.html" title="Previous Chapter: Mantid 6.6.0 Release Notes"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Mantid 6.6.0 ...</span>
    </a>
  </li>
  <li>
    <a href="direct_geometry.html" title="Next Chapter: Direct Geometry Changes"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Direct Geomet... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>