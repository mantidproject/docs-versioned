<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Direct Inelastic Changes</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Indirect Inelastic Changes" href="indirect_inelastic.html" />
    <link rel="prev" title="UI &amp; Usability Changes" href="ui.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="../index.html" >Release Notes</a> &#187;</li>
          
            <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Mantid 3.6.0 Release Notes</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">Direct Inelastic Changes</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="direct-inelastic-changes">
<h1>Direct Inelastic Changes<a class="headerlink" href="#direct-inelastic-changes" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#algorithms" id="id2">Algorithms</a></p></li>
<li><p><a class="reference internal" href="#isis-fixes" id="id3">ISIS Fixes</a></p></li>
<li><p><a class="reference internal" href="#other-fixes" id="id4">Other fixes</a></p></li>
</ul>
</nav>
<section id="algorithms">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Algorithms</a><a class="headerlink" href="#algorithms" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://github.com/mantidproject/mantid/issues/13566">Re#13566</a> New
<a class="reference internal" href="../../algorithms/GetAllEi-v1.html#algm-getallei"><span class="std std-ref">GetAllEi</span></a>
algorithm analyses chopper logs and signals on monitors to identify all
possible incident energies used in Direct inelastic experiments in
single or multi-rep mode. Internally the algorithm incorporates four
sub-algorithms used by instrument scientists on instruments with
different background, chopper system and signal quality so it can
reliably run on all these instruments. The algorithm is the basis of
changes to autoreduction, which allow instrument scientists and users to
reduce (convert to SPE) results of an inelastic experiment without any
user intervention.</p>
<p>ISIS inelastic instruments descriptions have been modified to contain
chopper location and other additional information necessary to calculate
time, when chopper lets neutrons trough from appropriate chopper logs.</p>
<p><a class="reference external" href="https://github.com/mantidproject/mantid/issues/14071">Re#14071</a>
<a class="reference internal" href="../../algorithms/RenameWorkspace-v1.html#algm-renameworkspace"><span class="std std-ref">RenameWorkspace</span></a> algorithm renames separate monitor workspace, if a
monitor workspace is attached to the current workspace. This allows
substantial simplification of the Direct Reduction workflow, where the
number of operations are performed on a workspace itself and the monitor
workspace, which is associated with the main workspace.</p>
<p><a class="reference external" href="https://github.com/mantidproject/mantid/issues/13980">Re#13980</a>
On the basis of changes outlined in
<a class="reference external" href="https://github.com/mantidproject/mantid/issues/13566">Re#13566</a> and
<a class="reference external" href="https://github.com/mantidproject/mantid/issues/14071">Re#14071</a>,
ISIS reduction now has the capability to identify incident energies used
in direct inelastic experiments and reduce data according to these
energies. <strong>AUTO</strong> key-word allow data reduction without providing a
guess for the incident energy. Reduction finishes as normal if no
energies were identified, returning the message stating the run is not
probably intended for reduction. This feature allows convenient use of
the ISIS autoreduction service to process data from direct inelastic
experiment without user or instrument scientist intervention.</p>
</section>
<section id="isis-fixes">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">ISIS Fixes</a><a class="headerlink" href="#isis-fixes" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://github.com/mantidproject/mantid/issues/14456">Re#14456</a>. A
number of bug-fixes and small modifications were performed in order to
enable correct background removal for direct inelastic reduction.</p>
<ul class="simple">
<li><p>The
<a class="reference internal" href="../../algorithms/CalculateFlatBackground-v1.html#algm-calculateflatbackground"><span class="std std-ref">CalculateFlatBackground</span></a>
algorithm has a new property <code class="docutils literal notranslate"><span class="pre">NullifyNegativeValues</span></code> which toggles
nullification of negative signals after background subtraction.</p></li>
<li><p>The error calculation procedure used by the
<a class="reference internal" href="../../algorithms/RemoveBackground-v1.html#algm-removebackground"><span class="std std-ref">RemoveBackground</span></a>
algorithm has been replaced by the procedure used in
<a class="reference internal" href="../../algorithms/CalculateFlatBackground-v1.html#algm-calculateflatbackground"><span class="std std-ref">CalculateFlatBackground</span></a> algorithm.
The previous procedure received many complaints and was therefore
deemed to be incorrect.</p></li>
<li><p><a class="reference internal" href="../../algorithms/RemoveBackground-v1.html#algm-removebackground"><span class="std std-ref">RemoveBackground</span></a>
has been modified to allow instrument scientists to nullify negative
signals on request.</p></li>
<li><p>New property <code class="docutils literal notranslate"><span class="pre">nullify_negative_signal</span></code> has been added to ISIS
reduction to toggle removal of negative signal according to
particular requests. The default behaviour for nullifying negative
signals has been defined in instrument definition files according to
user preference.</p></li>
<li><p>The negative signal removal, if requested, now occurs after the
spectra have been grouped according to the particular maps, which
substantially improves statistics and final background in the case
when negative signals are nullified.</p></li>
<li><p>Fixed bug causing reduction to fail if monitors are summed and
monitor-1 normalisation is requested.</p></li>
</ul>
<p><a class="reference external" href="https://github.com/mantidproject/mantid/issues/12403">Re#12403</a> LET
IDF has been modified using an embedded IDF correction mechanism which
was introduced in Mantid release 3.4. This mechanism allows users to
update the Instrument Definition (Files) (IDF) stored within nexus data
files. The exclusions based on run numbers, which had to be introduced
into ISIS direct inelastic reduction program were removed and this new
feature allows Instrument Definition information to be safely embedded
into the nexus files (or modified at a later stage).</p>
</section>
<section id="other-fixes">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Other fixes</a><a class="headerlink" href="#other-fixes" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Fixed problems with the direct geometry planning tool.
<a class="reference external" href="https://github.com/mantidproject/mantid/issues/15182">Re#15182</a></p></li>
</ul>
<p><a class="reference external" href="http://github.com/mantidproject/mantid/pulls?q=is%3Apr+milestone%3A%22Release+3.6%22+is%3Amerged+label%3A%22Component%3A+Direct+Inelastic%22">Full list of changes on github</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ui.html" title="Previous Chapter: UI & Usability Changes"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; UI & Usabilit...</span>
    </a>
  </li>
  <li>
    <a href="indirect_inelastic.html" title="Next Chapter: Indirect Inelastic Changes"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Indirect Inel... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>