<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>SANS TOML Files</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Scripting SANS Reductions" href="ScriptingSANSReductions.html" />
    <link rel="prev" title="Data reduction for reflectometry instruments at the ILL" href="ReflectometryILL.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Techniques</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">SANS TOML Files</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="sans-toml-files">
<span id="sans-toml-v1-ref"></span><h1>SANS TOML Files<a class="headerlink" href="#sans-toml-files" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#general-notes" id="id9">General Notes</a></p></li>
<li><p><a class="reference internal" href="#format-changes" id="id10">Format Changes</a></p>
<ul>
<li><p><a class="reference internal" href="#v0-mantid-6-3-to-v1-mantid-6-4" id="id11">V0 (Mantid 6.3+) to V1 (Mantid 6.4+)</a></p></li>
<li><p><a class="reference internal" href="#v0-mantid-6-1-x-to-v0-mantid-6-3" id="id12">V0 (Mantid 6.1.x) to V0 (Mantid 6.3+)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#new-fields" id="id13">New Fields</a></p>
<ul>
<li><p><a class="reference internal" href="#toml-file-version" id="id14">toml_file_version</a></p></li>
<li><p><a class="reference internal" href="#metadata" id="id15">Metadata</a></p></li>
<li><p><a class="reference internal" href="#instrument" id="id16">Instrument</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#conversion-from-legacy-user-files" id="id17">Conversion From Legacy User Files</a></p>
<ul>
<li><p><a class="reference internal" href="#layout" id="id18">Layout</a></p></li>
<li><p><a class="reference internal" href="#tips-for-converting" id="id19">Tips for converting</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#legacy-command-set" id="id20">Legacy Command Set</a></p>
<ul>
<li><p><a class="reference internal" href="#back-mon-times-t1-t2" id="id21">BACK/MON/TIMES t1 t2</a></p></li>
<li><p><a class="reference internal" href="#back-m-n-times-t1-t2" id="id22">BACK/M[n]/TIMES t1 t2</a></p></li>
<li><p><a class="reference internal" href="#compatibility-on" id="id23">COMPATIBILITY ON</a></p></li>
<li><p><a class="reference internal" href="#det-corr-front-rear-x-y-z-xtilt-ytilt-ztilt-rot-side-radius-n" id="id24">DET/CORR [FRONT][REAR] [X][Y][Z] [XTILT][YTILT][ZTILT] [ROT] [SIDE] [RADIUS] n</a></p></li>
<li><p><a class="reference internal" href="#det-rear-front-merged-both" id="id25">DET/[REAR][FRONT][MERGED][BOTH]</a></p></li>
<li><p><a class="reference internal" href="#det-rescale-n" id="id26">DET/RESCALE n</a></p></li>
<li><p><a class="reference internal" href="#det-rescale-fit-q1-q2" id="id27">DET/RESCALE/FIT [q1 q2]</a></p></li>
<li><p><a class="reference internal" href="#det-shift-y" id="id28">DET/SHIFT y</a></p></li>
<li><p><a class="reference internal" href="#det-shift-fit-q1-q2" id="id29">DET/SHIFT/FIT [q1 q2]</a></p></li>
<li><p><a class="reference internal" href="#det-overlap-q1-q2" id="id30">DET/OVERLAP q1 q2</a></p></li>
<li><p><a class="reference internal" href="#fit-centre-t1-t2" id="id31">FIT/CENTRE t1 t2</a></p></li>
<li><p><a class="reference internal" href="#fit-mid-hab-file-script-txt" id="id32">FIT/MID[/HAB]/FILE=script.txt</a></p></li>
<li><p><a class="reference internal" href="#fit-monitor-t1-t2" id="id33">FIT/MONITOR t1 t2</a></p></li>
<li><p><a class="reference internal" href="#fit-trans-clear-off" id="id34">FIT/TRANS[/CLEAR][/OFF]</a></p></li>
<li><p><a class="reference internal" href="#fit-trans-sample-can-linear-ylog-polynomialn-w1-w2" id="id35">FIT/TRANS[[/SAMPLE][/CAN]][/LINEAR][/YLOG][/POLYNOMIALn] [w1 w2]</a></p></li>
<li><p><a class="reference internal" href="#gravity-on-off" id="id36">GRAVITY[/ON/OFF]</a></p></li>
<li><p><a class="reference internal" href="#gravity-lextra-x" id="id37">GRAVITY/LEXTRA x</a></p></li>
<li><p><a class="reference internal" href="#l-eventstime-binning-string" id="id38">L/EVENTSTIME binning_string</a></p></li>
<li><p><a class="reference internal" href="#l-phi-nomirror-a-b" id="id39">L/PHI[/NOMIRROR] a b</a></p></li>
<li><p><a class="reference internal" href="#l-q-binning-string" id="id40">L/Q binning_string</a></p></li>
<li><p><a class="reference internal" href="#l-q-rcut-r" id="id41">L/Q/RCUT r</a></p></li>
<li><p><a class="reference internal" href="#l-q-wcut-w" id="id42">L/Q/WCUT w</a></p></li>
<li><p><a class="reference internal" href="#l-qxy-binning-string" id="id43">L/QXY binning_string</a></p></li>
<li><p><a class="reference internal" href="#l-r-r1-r2-rstep" id="id44">L/R r1 r2 [rstep]</a></p></li>
<li><p><a class="reference internal" href="#l-sp" id="id45">L/SP</a></p></li>
<li><p><a class="reference internal" href="#l-wav-binning-string" id="id46">L/WAV binning_string</a></p></li>
<li><p><a class="reference internal" href="#mask-clear-time" id="id47">MASK/CLEAR[/TIME]</a></p></li>
<li><p><a class="reference internal" href="#maskfile-mask-file-list" id="id48">MASKFILE=mask_file_list</a></p></li>
<li><p><a class="reference internal" href="#mask-front-rear-hn" id="id49">MASK[/FRONT][/REAR] Hn</a></p></li>
<li><p><a class="reference internal" href="#mask-front-rear-hn-hm" id="id50">MASK[/FRONT][/REAR] Hn&gt;Hm</a></p></li>
<li><p><a class="reference internal" href="#mask-front-rear-vn" id="id51">MASK[/FRONT][/REAR] Vn</a></p></li>
<li><p><a class="reference internal" href="#mask-front-rear-vn-vm" id="id52">MASK[/FRONT][/REAR] Vn&gt;Vm</a></p></li>
<li><p><a class="reference internal" href="#mask-x1-x2-y1-y2" id="id53">MASK x1 x2 y1 y2</a></p></li>
<li><p><a class="reference internal" href="#mask-line-a-b" id="id54">MASK/LINE a b</a></p></li>
<li><p><a class="reference internal" href="#mask-line-a-b-c-d" id="id55">MASK/LINE a b c d</a></p></li>
<li><p><a class="reference internal" href="#mask-sn" id="id56">MASK Sn</a></p></li>
<li><p><a class="reference internal" href="#mask-t-t1-t2" id="id57">MASK/T t1 t2</a></p></li>
<li><p><a class="reference internal" href="#mon-direct-front-hab-filename" id="id58">MON/DIRECT[/FRONT][/HAB]=filename</a></p></li>
<li><p><a class="reference internal" href="#mon-flat-front-rear-filename" id="id59">MON/FLAT[/FRONT][/REAR]=filename</a></p></li>
<li><p><a class="reference internal" href="#mon-habeff-a" id="id60">MON/HABEFF=a</a></p></li>
<li><p><a class="reference internal" href="#mon-habpath-on-off" id="id61">MON/HABPATH[/ON][/OFF]</a></p></li>
<li><p><a class="reference internal" href="#mon-length-z-s" id="id62">MON/LENGTH=z s</a></p></li>
<li><p><a class="reference internal" href="#mon-spectrum-n" id="id63">MON/SPECTRUM=n</a></p></li>
<li><p><a class="reference internal" href="#mon-interpolate" id="id64">MON [/INTERPOLATE]</a></p></li>
<li><p><a class="reference internal" href="#mon-trans-spectrum-n" id="id65">MON/TRANS/SPECTRUM=n</a></p></li>
<li><p><a class="reference internal" href="#mon-trans-interpolate" id="id66">MON/TRANS[/INTERPOLATE]</a></p></li>
<li><p><a class="reference internal" href="#print-string" id="id67">PRINT string</a></p></li>
<li><p><a class="reference internal" href="#qresol-on-off" id="id68">QRESOL[/ON][/OFF]</a></p></li>
<li><p><a class="reference internal" href="#qresol-moderator-filename" id="id69">QRESOL/MODERATOR=filename</a></p></li>
<li><p><a class="reference internal" href="#qresol-deltar-dr" id="id70">QRESOL/DELTAR=dr</a></p></li>
<li><p><a class="reference internal" href="#qresol-a1-x" id="id71">QRESOL/A1=x</a></p></li>
<li><p><a class="reference internal" href="#qresol-a2-x" id="id72">QRESOL/A2=x</a></p></li>
<li><p><a class="reference internal" href="#qresol-h1-x1-w1-y1-h2-x2-w2-y2" id="id73">QRESOL[/H1=x1][/W1=y1][/H2=x2][/W2=y2]</a></p></li>
<li><p><a class="reference internal" href="#qresol-lcollim-z" id="id74">QRESOL/LCOLLIM=z</a></p></li>
<li><p><a class="reference internal" href="#sample-offset-z" id="id75">SAMPLE/OFFSET z</a></p></li>
<li><p><a class="reference internal" href="#sample-path-on-off" id="id76">SAMPLE/PATH[/ON][/OFF]</a></p></li>
<li><p><a class="reference internal" href="#set-centre-a-b" id="id77">SET CENTRE a b</a></p></li>
<li><p><a class="reference internal" href="#set-centre-main-hab-a-b-c-d" id="id78">SET CENTRE[/MAIN][/HAB] a b [c d]</a></p></li>
<li><p><a class="reference internal" href="#set-scales-a-b-c-d-e" id="id79">SET SCALES a b c d e</a></p></li>
<li><p><a class="reference internal" href="#set-notables-bank-a-b-c-d-e" id="id80">SET[/NOTABLES] BANK a b c d e</a></p></li>
<li><p><a class="reference internal" href="#set-xcor-ycor-on-off-clear" id="id81">SET[/XCOR][/YCOR][/ON][/OFF][/CLEAR]</a></p></li>
<li><p><a class="reference internal" href="#set-notables-xcor-ycor-filename" id="id82">SET[/NOTABLES][/XCOR][/YCOR]=filename</a></p></li>
<li><p><a class="reference internal" href="#trans-mask-filename" id="id83">TRANS/MASK=filename</a></p></li>
<li><p><a class="reference internal" href="#trans-radius-r" id="id84">TRANS/RADIUS=r</a></p></li>
<li><p><a class="reference internal" href="#trans-roi-filename" id="id85">TRANS/ROI=filename</a></p></li>
<li><p><a class="reference internal" href="#trans-transpec-s" id="id86">TRANS/TRANSPEC=s</a></p></li>
<li><p><a class="reference internal" href="#trans-transpec-s-shift-dz" id="id87">TRANS/TRANSPEC=s/SHIFT=dz</a></p></li>
<li><p><a class="reference internal" href="#tubecalibfile-filename" id="id88">TUBECALIBFILE=filename</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="general-notes">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">General Notes</a><a class="headerlink" href="#general-notes" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Lengths are <em>always</em> specified in meters within TOML files, unlike previous legacy formats.</p></li>
<li><p>Angles are specified in degrees.</p></li>
</ul>
</section>
<section id="format-changes">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Format Changes</a><a class="headerlink" href="#format-changes" title="Permalink to this heading">¶</a></h2>
<section id="v0-mantid-6-3-to-v1-mantid-6-4">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">V0 (Mantid 6.3+) to V1 (Mantid 6.4+)</a><a class="headerlink" href="#v0-mantid-6-3-to-v1-mantid-6-4" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><em>norm_monitor</em> and <em>trans_monitor</em> in <em>instrument.configuration</em> now take a monitor name (e.g. “M1”) instead of a spectrum number</p></li>
<li><p><em>selected_monitor</em> in <em>normalisation</em> and <em>transmission</em> has been removed in favour of this change in <em>instrument.configuration</em></p></li>
<li><p><em>trans_monitor</em> can now have the value <em>“ROI”</em></p></li>
</ul>
</section>
<section id="v0-mantid-6-1-x-to-v0-mantid-6-3">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">V0 (Mantid 6.1.x) to V0 (Mantid 6.3+)</a><a class="headerlink" href="#v0-mantid-6-1-x-to-v0-mantid-6-3" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><em>normalisation</em> and <em>normalization</em> are both accepted and equivalent</p></li>
<li><p><em>detector.calibration</em> was renamed to <em>detector.correction</em></p></li>
<li><p><em>mask.beamstop_shadow</em> and <em>mask.mask_pixels</em> were moved to
<em>mask.spatial.beamstop_shadow</em> and <em>mask.spatial.mask_pixels</em></p></li>
<li><p><em>normalisation.all_monitors</em> was added to support <em>BACK/MON/TIMES</em></p></li>
<li><p><em>[gravity]</em> and <em>gravity.enabled</em> were merged into <em>instrument.configuration.gravity_enabled</em></p></li>
<li><p><em>detector.configuration.selected_detector</em> is now mandatory</p></li>
<li><p><em>detector.configuration.selected_detector</em> accepts <em>front</em> and <em>rear</em> instead of <em>HAB</em> and <em>LAB</em> respectively.</p></li>
<li><p><em>detector.configuration.all_centre</em> has been added to set the front and rear centre at the same time.</p></li>
<li><p><em>reduction.merged.shift.distance</em> was renamed from <cite>distance</cite> to <cite>factor</cite></p></li>
</ul>
</section>
</section>
<section id="new-fields">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">New Fields</a><a class="headerlink" href="#new-fields" title="Permalink to this heading">¶</a></h2>
<section id="toml-file-version">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">toml_file_version</a><a class="headerlink" href="#toml-file-version" title="Permalink to this heading">¶</a></h3>
<p>This is always the first line of the file and represents the TOML
file version. Long-term this allows us to make changes in a backwards compatible way.</p>
<p>Available TOML Versions:</p>
<ul class="simple">
<li><p>1</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># First line of file
toml_file_version = 1

# Everything else
</pre></div>
</div>
</section>
<section id="metadata">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Metadata</a><a class="headerlink" href="#metadata" title="Permalink to this heading">¶</a></h3>
<p>This is a free-form field, typically at the top of the file
to enter any user attributes. They are ignored by the TOML parser.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[metadata]
  created = &quot;1980-12-31&quot;
  weather_that_day = &quot;sunny&quot;
  this_is_toml = true
</pre></div>
</div>
</section>
<section id="instrument">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Instrument</a><a class="headerlink" href="#instrument" title="Permalink to this heading">¶</a></h3>
<p>This is a required entry to specify the instrument name and <cite>instrument.configuration</cite>, documented in the conversion guide below.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument]
  name = &quot;LARMOR&quot;  # or &quot;LOQ&quot; / &quot;SANS2D&quot; / &quot;ZOOM&quot;...etc.

[instrument.configuration]
  # ...
</pre></div>
</div>
</section>
</section>
<section id="conversion-from-legacy-user-files">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Conversion From Legacy User Files</a><a class="headerlink" href="#conversion-from-legacy-user-files" title="Permalink to this heading">¶</a></h2>
<section id="layout">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Layout</a><a class="headerlink" href="#layout" title="Permalink to this heading">¶</a></h3>
<p>This section is designed like a reference that users can paste straight into
existing TOML files, but means that the sections are listed alphabetically
by the <em>old</em> command name!</p>
<p><em>Note: TOML files use SI units rather than a mix of unit prefixes. For example,
you will need to convert any measurements in millimetres to meters.</em></p>
<p>The following is used to note optional qualifiers which were available in
the existing user file format: <cite>[ ]</cite>.</p>
<p>Examples are given in a way that they can be merged together where headers
match, for example these three examples:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[binning]
  wavelength = {start = 2.0, step=0.125, stop=14.0, type = &quot;Lin&quot;}
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[binning]
  [binning.1d_reduction]
    binning = &quot;0.02,0.05,0.5,-0.1,10.0&quot;
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[binning]
  [binning.2d_reduction]
    step = 0.002
    stop = 0.1
    type = &quot;Lin&quot;
</pre></div>
</div>
<p>Are combined into the following when writing the TOML file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[binning]
  wavelength = {start = 2.0, step=0.125, stop=14.0, type = &quot;Lin&quot;}

  [binning.1d_reduction]
    binning = &quot;0.02,0.05,0.5,-0.1,10.0&quot;

  [binning.2d_reduction]
    step = 0.002
    stop = 0.1
    type = &quot;Lin&quot;
</pre></div>
</div>
</section>
<section id="tips-for-converting">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Tips for converting</a><a class="headerlink" href="#tips-for-converting" title="Permalink to this heading">¶</a></h3>
<p>For converting existing files the following process is recommended:</p>
<ul class="simple">
<li><p>Make a copy of the existing (old-format) user file to work with</p></li>
<li><p>Create a <strong>blank</strong> TOML file (file.toml instead of file.txt)</p></li>
<li><p>Add the following to the start of the TOML file in the order shown:</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>toml_file_version = 1

[metadata]

[instrument]
  name = &quot;instrument&quot;  # give name of instrument

[instrument.configuration]
</pre></div>
</div>
<ul class="simple">
<li><p>Copy any comments from the old user file that need to be preserved
to <cite>[metadata]</cite> in the TOML user file and replace any leading
<cite>!</cite> with <cite>#</cite></p></li>
<li><p>Remove any commented out lines in the old user file (lines starting
with <cite>!</cite>)</p></li>
<li><p>Work down the old user file line-by-line using this guide to find
the new replacement TOML commands</p></li>
<li><p>Add the replacement TOML commands to the TOML user file</p></li>
<li><p>Delete each line from the old user file as conversion proceeds</p></li>
<li><p>When done, <strong>save</strong> the new TOML user file and delete the edited copy
of the old user file; <strong>do not delete the reference copy of the old
user file!!!</strong></p></li>
<li><p>Try the TOML user file in Mantid!</p></li>
</ul>
</section>
</section>
<section id="legacy-command-set">
<h2><a class="toc-backref" href="#id20" role="doc-backlink">Legacy Command Set</a><a class="headerlink" href="#legacy-command-set" title="Permalink to this heading">¶</a></h2>
<section id="back-mon-times-t1-t2">
<span id="back-mon-times-ref"></span><h3><a class="toc-backref" href="#id21" role="doc-backlink">BACK/MON/TIMES t1 t2</a><a class="headerlink" href="#back-mon-times-t1-t2" title="Permalink to this heading">¶</a></h3>
<p>BACK was used to specify a time window over which to estimate the
(time-independent) background on monitor spectra. This background
is then subtracted from the specified monitor spectra before the
data are rebinned into wavelength.</p>
<p>This particular command subtracts the <em>same</em> background level from
<em>all</em> monitors. The continued use of this method of monitor correction
is now deprecated. See also <a class="reference internal" href="#back-mn-times-ref"><span class="std std-ref">BACK/M[n]/TIMES t1 t2</span></a>.</p>
<p>Times were specified in microseconds.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[normalisation]
  [normalisation.all_monitors]
    background = [t1, t2]
    enabled = true
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>BACK/MON/TIMES 30000 40000
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[normalisation]
  [normalisation.all_monitors]
    background = [30000, 40000]
    enabled = true
</pre></div>
</div>
<p>Note: if using this, set any instances of use_own_background to false.</p>
</section>
<section id="back-m-n-times-t1-t2">
<span id="back-mn-times-ref"></span><h3><a class="toc-backref" href="#id22" role="doc-backlink">BACK/M[n]/TIMES t1 t2</a><a class="headerlink" href="#back-m-n-times-t1-t2" title="Permalink to this heading">¶</a></h3>
<p>This command was used to estimate and subtract the (time-independent)
background level on a specified monitor. See also <a class="reference internal" href="#back-mon-times-ref"><span class="std std-ref">BACK/MON/TIMES t1 t2</span></a>.</p>
<p>Times were specified in microseconds.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Note: both &quot;normalisation&quot; and &quot;normalisation&quot; are both accepted
[normalisation]
  [normalisation.monitor.Mn]
    spectrum_number = n
        use_own_background = true
    background = [t1, t2]
</pre></div>
</div>
<p><em>OR</em></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[transmission]
  [transmission.monitor.Mn]
    spectrum_number = n
        use_own_background = true
    background = [t1, t2]
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>BACK/M1 30000 40000
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[normalisation]
  [normalisation.monitor.M1]
    spectrum_number = 1
        use_own_background = true
    background = [30000.0, 40000.0]
</pre></div>
</div>
</section>
<section id="compatibility-on">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">COMPATIBILITY ON</a><a class="headerlink" href="#compatibility-on" title="Permalink to this heading">¶</a></h3>
<p>This command was used to allow event data to be reduced in
a manner that, so far as was possible, emulated the reduction
of histogram data. The primary use of this command was as a
diagnostic. Omitting this command was equivalent to
COMPATIBILITY OFF.</p>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>COMPATIBILITY ON
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported</p>
</section>
<section id="det-corr-front-rear-x-y-z-xtilt-ytilt-ztilt-rot-side-radius-n">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">DET/CORR [FRONT][REAR] [X][Y][Z] [XTILT][YTILT][ZTILT] [ROT] [SIDE] [RADIUS] n</a><a class="headerlink" href="#det-corr-front-rear-x-y-z-xtilt-ytilt-ztilt-rot-side-radius-n" title="Permalink to this heading">¶</a></h3>
<p>This command was used to fine tune the position of a specified
detector by applying a relative correction to the logged encoder
value. The parameter n could be a distance or an angle depending
on the specified context as shown below.</p>
<p>If specified, SIDE <em>applies a translation to the rotation axis of
the detector perpendicular to the plane of the detector</em>. RADIUS
<em>increases the apparent radius from the rotation axis of the detector
to the active plane</em>.</p>
<p>XYZ applies a translation to in the specified direction to a given bank
in the specified axis.</p>
<p>Tilt rotates a bank by the given number of degrees along the axis specified.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  [detector.correction.position]
    # Note fields can be added or omitted as required
    # This is the complete list of adjustments available
    front_x = a
    front_y = b
    front_z = c

    front_x_tilt = d
    front_y_tilt = e
    front_z_tilt = f

    front_rot = g
    front_side = h

    rear_x = a
    rear_y = b
    rear_z = c

    rear_x_tilt = d
    rear_y_tilt = e
    rear_z_tilt = f

    rear_rot = g
    rear_side = h
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DET/CORR FRONT X -33
DET/CORR FRONT Y -20
DET/CORR FRONT Z -47
DET/CORR FRONT XTILT -0.0850
DET/CORR FRONT YTILT 0.1419
DET/CORR FRONT ROT 0.0
DET/CORR FRONT SIDE 0.19
DET/CORR FRONT RADIUS 75.7
DET/CORR REAR X 0.0
DET/CORR REAR Z 58
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  [detector.correction.position]
    front_x = -0.033
    front_y = -0.020
    front_z = -0.047
    front_x_tilt = -0.000085
    front_y_tilt = 0.0001419
    front_radius = 0.0757
    front_rot = 0.0
    front_side = 0.00019
    rear_x = 0.0
    rear_z = 0.058
</pre></div>
</div>
</section>
<section id="det-rear-front-merged-both">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">DET/[REAR][FRONT][MERGED][BOTH]</a><a class="headerlink" href="#det-rear-front-merged-both" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify which detector(s) were to be
processed during data reduction.</p>
<p>On the LOQ instrument the qualifier <cite>/FRONT</cite> could be  equivalently replaced by <cite>/HAB</cite> (for
high-angle bank) in existing user files. Similarly, /MERGED and /MERGE were equivalent.</p>
<p>If an instrument only has one detector it is assumed to be
equivalent to the <em>rear</em> detector.</p>
<p>In TOML the detectors must be specified in lower case, and /BOTH
has been replaced by “all”.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector.configuration]
  selected_detector = &quot;rear&quot;
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DET/HAB
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector.configuration]
  # Accepts &quot;front&quot;, &quot;rear&quot;, &quot;merged&quot;, or &quot;all&quot;.
  selected_detector = &quot;front&quot;
</pre></div>
</div>
</section>
<section id="det-rescale-n">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">DET/RESCALE n</a><a class="headerlink" href="#det-rescale-n" title="Permalink to this heading">¶</a></h3>
<p>This command specified the factor by which the reduced <em>front</em>
detector data should be multiplied to allow it to overlap the
reduced rear detector data. If omitted n was assumed to be 1.0
(no rescaling). See also <a class="reference internal" href="#det-rescale-fit-ref"><span class="std std-ref">DET/RESCALE/FIT [q1 q2]</span></a> and <a class="reference internal" href="#det-shift-y-ref"><span class="std std-ref">DET/SHIFT y</span></a>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[reduction]
  [reduction.merged.rescale]
      factor = n
      use_fit = false  # Must be false for single value
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DET/RESCALE 0.123
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[reduction]
  [reduction.merged.rescale]
      factor = 0.123
      use_fit = false
</pre></div>
</div>
</section>
<section id="det-rescale-fit-q1-q2">
<span id="det-rescale-fit-ref"></span><h3><a class="toc-backref" href="#id27" role="doc-backlink">DET/RESCALE/FIT [q1 q2]</a><a class="headerlink" href="#det-rescale-fit-q1-q2" title="Permalink to this heading">¶</a></h3>
<p>This command was used to automatically estimate the factor by
which the reduced <em>front</em> detector data should be multiplied to
allow it to overlap the reduced rear detector data. A specific
Q-range over which to compare intensities could be optionally
specified. If omitted, all overlapping Q values were used. See
also <a class="reference internal" href="#det-rescale-fit-ref"><span class="std std-ref">DET/RESCALE/FIT [q1 q2]</span></a>.</p>
<p>Scattering vectors were specified in inverse Angstroms.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[reduction]
  [reduction.merged.rescale]
      min = q1
      max = q2
      use_fit = true  # Must be true for fitting
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DET/RESCALE/FIT 0.14 0.24
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[reduction]
  [reduction.merged.rescale]
    min = 0.14
    max = 0.24
    use_fit = true
</pre></div>
</div>
</section>
<section id="det-shift-y">
<span id="det-shift-y-ref"></span><h3><a class="toc-backref" href="#id28" role="doc-backlink">DET/SHIFT y</a><a class="headerlink" href="#det-shift-y" title="Permalink to this heading">¶</a></h3>
<p>This command specified the relative amount (a constant) by which the
reduced <em>front</em> detector data should be shifted in intensity to allow
it to overlap the reduced rear detector data. If omitted n was assumed
to be 0.0 (no shift). See also <a class="reference internal" href="#det-rescale-fit-ref"><span class="std std-ref">DET/RESCALE/FIT [q1 q2]</span></a> and <a class="reference internal" href="#det-shift-y-ref"><span class="std std-ref">DET/SHIFT y</span></a>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[reduction]
  [reduction.merged.shift]
      factor = y
      use_fit = false  # Must be false for single value
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DET/SHIFT 0.123
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[reduction]
  [reduction.merged.shift]
      factor = 0.123
      use_fit = false
</pre></div>
</div>
</section>
<section id="det-shift-fit-q1-q2">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">DET/SHIFT/FIT [q1 q2]</a><a class="headerlink" href="#det-shift-fit-q1-q2" title="Permalink to this heading">¶</a></h3>
<p>This command was used to automatically estimate the relative amount
(a constant) by which the reduced <em>front</em> detector data should be
shifted to allow it to overlap the reduced rear detector data. A
specific Q-range over which to compare intensities could be optionally
specified. If omitted, all overlapping Q values were used. See also
<a class="reference internal" href="#det-shift-y-ref"><span class="std std-ref">DET/SHIFT y</span></a>.</p>
<p>Scattering vectors were specified in inverse Angstroms.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[reduction]
  [reduction.merged.shift]
      min = q1
      max = q2
      use_fit = true  # Must be true for fitting
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DET/SHIFT/FIT 0.1 0.2
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[reduction]
  [reduction.merged.shift]
      min = 0.1
      max = 0.2
      use_fit = true
</pre></div>
</div>
</section>
<section id="det-overlap-q1-q2">
<h3><a class="toc-backref" href="#id30" role="doc-backlink">DET/OVERLAP q1 q2</a><a class="headerlink" href="#det-overlap-q1-q2" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the Q-range over which
merging of the rear and front detectors was to be done. If
omitted, all overlapping Q values were used.</p>
<p>Scattering vectors were specified in inverse Angstroms.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[reduction]
  [reduction.merged.merge_range]
    min = q1
    max = q2
    use_fit = true
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DET/OVERLAP 0.14 0.24
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[merged]
  [reduction.merged.merge_range]
      min = 0.14
      max = 0.24
      use_fit = true
</pre></div>
</div>
</section>
<section id="fit-centre-t1-t2">
<span id="fit-centre-ref"></span><h3><a class="toc-backref" href="#id31" role="doc-backlink">FIT/CENTRE t1 t2</a><a class="headerlink" href="#fit-centre-t1-t2" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify a time window within which
the ‘prompt spike’ could be found in <em>detector</em> spectra. This
information was used to remove the spike by interpolating
along the time-of-flight distribution. See also <a class="reference internal" href="#fit-monitor-ref"><span class="std std-ref">FIT/MONITOR t1 t2</span></a>.</p>
<p>Times were specified in microseconds.</p>
<p><strong>This command was never implemented in Mantid (but was in COLETTE)!</strong></p>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>FIT/CENTRE 19900 20500
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported</p>
</section>
<section id="fit-mid-hab-file-script-txt">
<h3><a class="toc-backref" href="#id32" role="doc-backlink">FIT/MID[/HAB]/FILE=script.txt</a><a class="headerlink" href="#fit-mid-hab-file-script-txt" title="Permalink to this heading">¶</a></h3>
<p>This command was used to drive automatic determination of the
coordinates of the centre of the scattering pattern on the
specified detector using a script file. It has been superseded
by the Beam Centre Finder tool in Mantid.</p>
<p>If /HAB (equivalent to the “front” detector) was omitted the
command applied to the “rear” detector.</p>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>FIT/MID/FILE=FIND_CENTRE128SC.COM
FIT/MID/HAB/FILE=FIND_CENTRE_HAB2.COM
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported</p>
</section>
<section id="fit-monitor-t1-t2">
<span id="fit-monitor-ref"></span><h3><a class="toc-backref" href="#id33" role="doc-backlink">FIT/MONITOR t1 t2</a><a class="headerlink" href="#fit-monitor-t1-t2" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify a time window within which
the ‘prompt spike’ could be found in <em>monitor</em> spectra. This
information was used to remove the spike by interpolating
along the time-of-flight distribution. See also <a class="reference internal" href="#fit-centre-ref"><span class="std std-ref">FIT/CENTRE t1 t2</span></a>.</p>
<p>Times were specified in microseconds.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  prompt_peak = {start = t1, stop = t2}
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>FIT/MONITOR 19900 20500
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  prompt_peak = {start = 19900.0, stop = 20500.0}
</pre></div>
</div>
</section>
<section id="fit-trans-clear-off">
<span id="trans-fitting-off-ref"></span><h3><a class="toc-backref" href="#id34" role="doc-backlink">FIT/TRANS[/CLEAR][/OFF]</a><a class="headerlink" href="#fit-trans-clear-off" title="Permalink to this heading">¶</a></h3>
<p>This command was used to disable fitting of the calculated
transmission data. See also <a class="reference internal" href="#fitting-on-ref"><span class="std std-ref">FIT/TRANS[[/SAMPLE][/CAN]][/LINEAR][/YLOG][/POLYNOMIALn] [w1 w2]</span></a>.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[transmission]
  [transmission.fitting]
    enabled = false
    parameters = {lambda_min = w1, lambda_max = w2}
    # Can be: &quot;Linear&quot; / &quot;Logarithmic&quot; / &quot;Polynomial&quot;
    function = &quot;Linear&quot;
    # Only used when set to &quot;Polynomial&quot;
    polynomial_order = 3
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>FIT/TRANS/OFF
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[transmission]
  [transmission.fitting]
    enabled = false
    parameters = {lambda_min = 3.0, lambda_max = 11.0}
    function = &quot;Linear&quot;
</pre></div>
</div>
</section>
<section id="fit-trans-sample-can-linear-ylog-polynomialn-w1-w2">
<span id="fitting-on-ref"></span><h3><a class="toc-backref" href="#id35" role="doc-backlink">FIT/TRANS[[/SAMPLE][/CAN]][/LINEAR][/YLOG][/POLYNOMIALn] [w1 w2]</a><a class="headerlink" href="#fit-trans-sample-can-linear-ylog-polynomialn-w1-w2" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify how the calculated transmission data
should be fitted. Subsequent data processing would then use transmission
values interpolated using the fit function. In some instances doing this
could improve the statistical quality of the transmission data. See also
<a class="reference internal" href="#trans-fitting-off-ref"><span class="std std-ref">FIT/TRANS[/CLEAR][/OFF]</span></a>.</p>
<p>Wavelengths were specified in Angstroms. If w1 and w2 were omitted then the
fit was applied to the full wavelength range.</p>
<p>The SAMPLE qualifier only applied the specified fit to the sample transmission
data. Similarly, the CAN qualifier only applied the specified fit to the can
transmission data. If neither of these qualifiers was present then the same fit
function was applied to both sets of transmission data.</p>
<p>The LINEAR (which could be abbreviated to LIN) qualifier implemented a fit
function of the form Y=mX+C.</p>
<p>The YLOG (which could be abbreviated to LOG) qualifier implemented a fit
function of the form Y=exp(aX)+C.</p>
<p>The POLYNOMIALn qualifier implemented a fit function of the form
Y=C0+C1X+C2X^2+…CnX^n where n&gt;2.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[transmission]
  [transmission.fitting]
    enabled = true
    parameters = {lambda_min = w1, lambda_max = w2}
    # Can be: &quot;Linear&quot; / &quot;Logarithmic&quot; / &quot;Polynomial&quot;
    function = &quot;Linear&quot;
    # Only used when set to &quot;Polynomial&quot;
    polynomial_order = 3
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>FIT/TRANS/LIN 3.0 11.0
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[transmission]
  [transmission.fitting]
    enabled = true
    parameters = {lambda_min = 3.0, lambda_max = 11.0}
    function = &quot;Linear&quot;
</pre></div>
</div>
</section>
<section id="gravity-on-off">
<span id="gravity-on-ref"></span><h3><a class="toc-backref" href="#id36" role="doc-backlink">GRAVITY[/ON/OFF]</a><a class="headerlink" href="#gravity-on-off" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify whether the detector data should be
corrected for the ballistic effects of gravity on the neutrons. This
correction is particularly important at long sample-detector distances
and/or when using long wavelengths. See also <a class="reference internal" href="#gravity-extra-len-ref"><span class="std std-ref">GRAVITY/LEXTRA x</span></a>.</p>
<p>If Q-resolution estimation is enabled (see QRESOL[/ON][/OFF]) any gravity
corrections will be included in that calculation too.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  gravity_enabled = true
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>GRAVITY/ON
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  gravity_enabled = true
</pre></div>
</div>
</section>
<section id="gravity-lextra-x">
<span id="gravity-extra-len-ref"></span><h3><a class="toc-backref" href="#id37" role="doc-backlink">GRAVITY/LEXTRA x</a><a class="headerlink" href="#gravity-lextra-x" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify an extra length that can be added
to the gravity correction. The extra length is only taken into account
when the gravity correction is enabled and the default value is x=0.0.
See also <a class="reference internal" href="#gravity-on-ref"><span class="std std-ref">GRAVITY[/ON/OFF]</span></a>.</p>
<p>Unless there is a reason not too, set the value of <em>gravity_extra_length</em> equal
to 0.5 * collimation_length. See also <a class="reference internal" href="#qresol-lcollim-z"><span class="std std-ref">QRESOL/LCOLLIM=z</span></a>.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  gravity_extra_length = x
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>GRAVITY/LEXTRA 2.0
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  gravity_extra_length = 2.0
</pre></div>
</div>
</section>
<section id="l-eventstime-binning-string">
<h3><a class="toc-backref" href="#id38" role="doc-backlink">L/EVENTSTIME binning_string</a><a class="headerlink" href="#l-eventstime-binning-string" title="Permalink to this heading">¶</a></h3>
<p>L was an accepted abbreviation for LIMIT.</p>
<p>This command was used to specify a binning scheme to be applied to
event mode data. The scheme comprised a comma-separated string of the
form t1,tstep1,t2,tstep2,t3… where t1, t2, t3, etc specified event
times and tstep1, tstep2, etc specified the binning interval between
those event times.</p>
<p>A positive tstep would result in linear (ie, equally-spaced) bins, whilst
a negative tstep would result in logarithmic (ie, geometrically-expanding)
bins.</p>
<p>All times and linear tsteps were specified in microseconds. Logarithmic
tsteps were specified as %/100.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[reduction.events]
  binning = &quot;str&quot;
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>L/EVENTSTIME 7000.0,500.0,60000.0
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[reduction.events]
  # A negative step (middle val) indicates Log
  # Therefore this is linear binning
  binning = &quot;7000.0,500.0,60000.0&quot;
</pre></div>
</div>
</section>
<section id="l-phi-nomirror-a-b">
<h3><a class="toc-backref" href="#id39" role="doc-backlink">L/PHI[/NOMIRROR] a b</a><a class="headerlink" href="#l-phi-nomirror-a-b" title="Permalink to this heading">¶</a></h3>
<p>L was an accepted abbreviation for LIMIT.</p>
<p>This command specified the azimuthal range of 2D detector data to be
included in data reduction.
Viewed along the direction of travel of
the neutrons 0 (or 360) degrees was at 3 O’clock, 90 degrees was at
12 O’clock, 180 (or -180) degrees was at 9 O’clock, and 270 (or -90)
degrees was at 6 O’clock. By default the mirror sector was always
included (ie, selecting a=-30 &amp; b=+30 would <em>also</em> include the sector
150-210), but this could be overridden with the /NOMIRROR qualifier.</p>
<p>Angles were specified in degrees.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  [mask.phi]
    mirror = bool
    start = a
    stop = b
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>L/PHI/NOMIRROR -45 45
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  [mask.phi]
    mirror = false
    start = -45
    stop = 45
</pre></div>
</div>
</section>
<section id="l-q-binning-string">
<span id="q-ref"></span><h3><a class="toc-backref" href="#id40" role="doc-backlink">L/Q binning_string</a><a class="headerlink" href="#l-q-binning-string" title="Permalink to this heading">¶</a></h3>
<p>L was an accepted abbreviation for LIMIT.</p>
<p>This command was used to specify a Q-binning scheme to be applied
during 1D data reduction. See also <a class="reference internal" href="#qxy-ref"><span class="std std-ref">L/QXY binning_string</span></a>.</p>
<p>For historical reasons, several variants of this command were
implemented but they can be summarised thus:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>L/Q q1 q2 qstep/LIN   same as   L/Q/LIN q1 q2 qstep
L/Q q1 q2 qstep/LOG   same as   L/Q/LOG q1 q2 qstep
    L/Q q1,qstep1,q2,qstep2,q3...
</pre></div>
</div>
<p>In the first two cases the type of Q-binning is fixed by the choice of
the LIN or LOG qualifier. But in the last case <em>variable</em> Q-binning
is permitted if required.</p>
<p>A positive qstep would result in linear (ie, equally-spaced) bins, whilst
a negative qstep would result in logarithmic (ie, geometrically-expanding)
bins.</p>
<p>All Q-values and linear qsteps were specified in inverse Angstroms. Logarithmic
qsteps were specified as %/100.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[binning.1d_reduction]
    # Negative indicates log
    binning = &quot;rebin_string&quot;
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>L/Q .02,0.05,0.5,-0.1,10
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[binning]
  [binning.1d_reduction]
    # Negative indicates log
    binning = &quot;0.02,0.05,0.5,-0.1,10.0&quot;
</pre></div>
</div>
</section>
<section id="l-q-rcut-r">
<span id="q-rcut-ref"></span><h3><a class="toc-backref" href="#id41" role="doc-backlink">L/Q/RCUT r</a><a class="headerlink" href="#l-q-rcut-r" title="Permalink to this heading">¶</a></h3>
<p>L was an accepted abbreviation for LIMIT.</p>
<p>This command was used to specify the ‘radius cut’ value, a construct
which could be used to improve the statistical uncertainty on Q bins
suffering from poor instrumental resolution. This command would typically,
but not exclusively, be used in conjunction with <a class="reference internal" href="#q-wcut-ref"><span class="std std-ref">L/Q/WCUT w</span></a>.</p>
<p>For more information, see the <a class="reference external" href="https://docs.mantidproject.org/nightly/algorithms/Q1D-v2.html">Q1D</a>
algorithm description.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[binning.1d_reduction]
    radius_cut = r
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>L/Q/RCUT 100
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[binning]
  [binning.1d_reduction]
    radius_cut = 0.1
</pre></div>
</div>
</section>
<section id="l-q-wcut-w">
<span id="q-wcut-ref"></span><h3><a class="toc-backref" href="#id42" role="doc-backlink">L/Q/WCUT w</a><a class="headerlink" href="#l-q-wcut-w" title="Permalink to this heading">¶</a></h3>
<p>L was an accepted abbreviation for LIMIT.</p>
<p>This command was used to specify the ‘wavelength cut’ value, a construct
which could be used to improve the statistical uncertainty on Q bins
suffering from poor instrumental resolution. This command would typically,
but not exclusively, be used in conjunction with <a class="reference internal" href="#q-rcut-ref"><span class="std std-ref">L/Q/RCUT r</span></a>.</p>
<p>For more information, see the <a class="reference external" href="https://docs.mantidproject.org/nightly/algorithms/Q1D-v2.html">Q1D</a>
algorithm description.</p>
<p>The cut-off wavelength was specified in Angstroms.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[binning.1d_reduction]
    wavelength_cut = w
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>L/Q/WCUT 8
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[binning]
  [binning.1d_reduction]
    wavelength_cut = 8.0
</pre></div>
</div>
</section>
<section id="l-qxy-binning-string">
<span id="qxy-ref"></span><h3><a class="toc-backref" href="#id43" role="doc-backlink">L/QXY binning_string</a><a class="headerlink" href="#l-qxy-binning-string" title="Permalink to this heading">¶</a></h3>
<p>L was an accepted abbreviation for LIMIT.</p>
<p>This command was used to specify a Q-binning scheme to be applied
during 2D data reduction. See also <a class="reference internal" href="#q-ref"><span class="std std-ref">L/Q binning_string</span></a>.</p>
<p>For historical reasons, several variants of this command were
implemented but they can be summarised thus:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>L/QXY 0 q2 qstep/LIN   same as   L/QXY/LIN 0 q2 qstep
L/QXY 0 q2 qstep/LOG   same as   L/QXY/LOG 0 q2 qstep
</pre></div>
</div>
<p>The type of Q-binning is fixed by the choice of the LIN or LOG
qualifier but variable binning is <strong>not</strong> permitted during 2D reductions.
Also note that the Q-range <em>must</em> start at zero.</p>
<p>All Q-values and linear qsteps were specified in inverse Angstroms.
Logarithmic qsteps were specified as %/100.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[binning]
  [binning.2d_reduction]
    #binning MUST start at 0.0
    step = step
    stop = stop
    #type can be &quot;Lin&quot; or &quot;Log&quot;
    type = &quot;Lin&quot;
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>L/QXY 0 0.1 .002/lin
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[binning]
  [binning.2d_reduction]
    step = 0.002
    stop = 0.1
    type = &quot;Lin&quot;
</pre></div>
</div>
</section>
<section id="l-r-r1-r2-rstep">
<h3><a class="toc-backref" href="#id44" role="doc-backlink">L/R r1 r2 [rstep]</a><a class="headerlink" href="#l-r-r1-r2-rstep" title="Permalink to this heading">¶</a></h3>
<p>L was an accepted abbreviation for LIMIT.</p>
<p>This command was used to specify the radii on the detector between
which the radial integration of the data was to be performed. Typically,
r1 would be set to be just outside the radius of the beamstop in use.</p>
<p>On the LOQ instrument the maximum values of r2 on the rear and front
detectors are 0.419 m and 0.750 m, respectively. But with the advent of the
TS2 SANS instruments with moving detectors a convenience was introduced to
make setting r2 easier and less prone to error: setting r2 = -0.001 m is
equivalent to using the maximum radius. <strong>But note it is not clear how this
is now achieved!</strong></p>
<p>On LOQ the rstep parameter originally specified the width of the virtual rings
used for the radial integration, a value of rstep = 0.003 m was typical.
However, at some point this rstep seemed to become optional, and indeed was
never used on some the TS2 instruments. <strong>How the virtual ring width was decided
in such cases is also unclear!</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  radius_limit = {min = 0.038, max = -0.001}
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>L/R 38 -1
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  radius_limit = {min = 0.038, max = -0.001}
</pre></div>
</div>
</section>
<section id="l-sp">
<h3><a class="toc-backref" href="#id45" role="doc-backlink">L/SP</a><a class="headerlink" href="#l-sp" title="Permalink to this heading">¶</a></h3>
<p>L was an accepted abbreviation for LIMIT.</p>
<p>This command was used to specify the detector spectra (ie, pixels) to be
included in the data reduction. Historically this mitigated computation
challenges. This command has effectively been superseded by the
DET/[REAR][FRONT][MERGED][BOTH] command.</p>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>L/SP 3 16386
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported</p>
</section>
<section id="l-wav-binning-string">
<h3><a class="toc-backref" href="#id46" role="doc-backlink">L/WAV binning_string</a><a class="headerlink" href="#l-wav-binning-string" title="Permalink to this heading">¶</a></h3>
<p>L was an accepted abbreviation for LIMIT.</p>
<p>This command was used to specify a wavelength-binning scheme to be
applied during data reduction.</p>
<p>For historical reasons, several variants of this command were
implemented but they can be summarised thus:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>L/WAV w1 w2 wstep/LIN   same as   L/WAV/LIN w1 w2 wstep
L/WAV w1 w2 wstep/LOG   same as   L/WAV/LOG w1 w2 wstep
</pre></div>
</div>
<p>The /LIN qualifier would result in linear (ie, equally-spaced) bins,
whilst the /LOG qualifier would result in logarithmic (ie,
geometrically-expanding) bins.</p>
<p>All wavelength-values and linear wsteps were specified in Angstroms.
Logarithmic wsteps were specified as %/100.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>wavelength = {start = min, step = step, stop = max, type = &quot;Lin&quot;}
# Alternative for ranges
wavelength = {binning = &quot;min,max&quot;, step = step, type = &quot;RangeLin&quot;}
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>L/WAV 2.0 14.0 0.125/LIN
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[binning]
  # Only for &quot;Lin&quot;, &quot;Log&quot;
  wavelength = {start = 2.0, step=0.125, stop=14.0, type = &quot;Lin&quot;}
  # Only for &quot;RangeLin&quot; or &quot;RangeLog&quot;
  wavelength = {binning=&quot;2.0-7.0, 7.0-14.0&quot;, step=0.125, type = &quot;RangeLin&quot;}
</pre></div>
</div>
</section>
<section id="mask-clear-time">
<h3><a class="toc-backref" href="#id47" role="doc-backlink">MASK/CLEAR[/TIME]</a><a class="headerlink" href="#mask-clear-time" title="Permalink to this heading">¶</a></h3>
<p>This command was used to clear any detector masks in operation. Without
the TIME qualifier only <em>spatial</em> masks were cleared; with the TIME
qualifier only time masks were cleared.</p>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MASK/CLEAR
MASK/CLEAR/TIME
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported</p>
</section>
<section id="maskfile-mask-file-list">
<h3><a class="toc-backref" href="#id48" role="doc-backlink">MASKFILE=mask_file_list</a><a class="headerlink" href="#maskfile-mask-file-list" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify one or more detector mask files to be
applied during data reduction to omit individual detector pixels or
regions of pixels from the calculation.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
mask_files = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MASKFILE=a.xml,b.xml,c.xml
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
mask_files = [&quot;a.xml&quot;, &quot;b.xml&quot;, &quot;c.xml&quot;]
</pre></div>
</div>
</section>
<section id="mask-front-rear-hn">
<span id="mask-h-ref"></span><h3><a class="toc-backref" href="#id49" role="doc-backlink">MASK[/FRONT][/REAR] Hn</a><a class="headerlink" href="#mask-front-rear-hn" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify a <strong>horizontal row</strong> of detector pixels
to be omitted from the calculation during data reduction. See also
<a class="reference internal" href="#mask-h-ref"><span class="std std-ref">MASK[/FRONT][/REAR] Hn</span></a>.</p>
<p>The TOML replacement command actually permits several rows to be
specified at once.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  [mask.spatial.rear]  # Or front
    detector_rows = [h1, h2, h3, ...hn]
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MASK/REAR H100
MASK/REAR H200
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  [mask.spatial.rear]
    # Masks horizontal 100 and 200
    detector_rows = [100, 200]
</pre></div>
</div>
<p><a class="reference internal" href="#mask-h-ref"><span class="std std-ref">MASK[/FRONT][/REAR] Hn</span></a></p>
</section>
<section id="mask-front-rear-hn-hm">
<h3><a class="toc-backref" href="#id50" role="doc-backlink">MASK[/FRONT][/REAR] Hn&gt;Hm</a><a class="headerlink" href="#mask-front-rear-hn-hm" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify several <strong>contiguous horizontal rows</strong>
of detector pixels to be omitted from the calculation during data reduction.
See also <a class="reference internal" href="#mask-h-ref"><span class="std std-ref">MASK[/FRONT][/REAR] Hn</span></a>.</p>
<p>The TOML replacement command actually permits multiple ranges of rows to be
specified at once.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  [mask.spatial.rear]  # Or front
    detector_row_ranges = [[x, y]]
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MASK/REAR H126&gt;H127
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  [mask.spatial.rear]
    # Masks horizontal 126 AND 127
    # Also includes 130-135 to show multiple can be masked
    detector_row_ranges = [[126, 127], [130, 135]]
</pre></div>
</div>
</section>
<section id="mask-front-rear-vn">
<span id="mask-v-ref"></span><h3><a class="toc-backref" href="#id51" role="doc-backlink">MASK[/FRONT][/REAR] Vn</a><a class="headerlink" href="#mask-front-rear-vn" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify a <strong>vertical column</strong> of detector pixels
to be omitted from the calculation during data reduction. See also
<a class="reference internal" href="#mask-v-ref"><span class="std std-ref">MASK[/FRONT][/REAR] Vn</span></a>.</p>
<p>The TOML replacement command actually permits several columns to be
specified at once.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  [mask.spatial.rear]  # Or front
    detector_rows = [v1, v2, v3, ...vn]
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MASK/REAR V100
MASK/REAR V200
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  [mask.spatial.rear]
    # Masks vertical 100 and 200
    detector_columns = [100, 200]
</pre></div>
</div>
<p><a class="reference internal" href="#mask-v-ref"><span class="std std-ref">MASK[/FRONT][/REAR] Vn</span></a></p>
</section>
<section id="mask-front-rear-vn-vm">
<h3><a class="toc-backref" href="#id52" role="doc-backlink">MASK[/FRONT][/REAR] Vn&gt;Vm</a><a class="headerlink" href="#mask-front-rear-vn-vm" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify several <strong>contiguous vertical columns</strong>
of detector pixels to be omitted from the calculation during data reduction.
See also <a class="reference internal" href="#mask-v-ref"><span class="std std-ref">MASK[/FRONT][/REAR] Vn</span></a>.</p>
<p>The TOML replacement command actually permits multiple ranges of columns to be
specified at once.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  [mask.spatial.rear]  # Or front
    detector_column_ranges = [[x, y]]
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MASK/REAR V126&gt;V127
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  [mask.spatial.rear]
    # Masks vertical 126 AND 127
    # Also includes 130-135 to show multiple can be masked
    detector_column_ranges = [[126, 127], [130, 135]]
</pre></div>
</div>
</section>
<section id="mask-x1-x2-y1-y2">
<h3><a class="toc-backref" href="#id53" role="doc-backlink">MASK x1 x2 y1 y2</a><a class="headerlink" href="#mask-x1-x2-y1-y2" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify a <strong>rectangular box</strong> of detector pixels
to be omitted from the calculation during data reduction.</p>
<p>The parameters were specified in mm.</p>
<p><strong>This command is not implemented in Mantid as there are other ways to
achieve the same outcome (eg, using the Instrument View tools).</strong> Also, a
combination of MASK[/FRONT][/REAR] Hn&gt;Hm and MASK[/FRONT][/REAR] Vn&gt;Vm
could be used to replicate some of the same functionality.</p>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MASK 0 40 0 40
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported</p>
</section>
<section id="mask-line-a-b">
<span id="mask-line-two-params"></span><h3><a class="toc-backref" href="#id54" role="doc-backlink">MASK/LINE a b</a><a class="headerlink" href="#mask-line-a-b" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify a <strong>diagonal line</strong> of detector pixels
to be omitted from the calculation during data reduction. See also
<a class="reference internal" href="#mask-line-four-params-ref"><span class="std std-ref">MASK/LINE a b c d</span></a>.</p>
<p>The line started at the centre of the scattering pattern (see SET CENTRE a b)
and extended to the edge of the pattern at the specified angle b with the
specified width a in mm. Only pixels wholly within the line were excluded. The
angle was defined in the same way as for L/PHI.</p>
<p>An infinite cylinder (length 100m) with the angle and width set by the user is
created in the plane of the detector from the point at which the transmitted
beam is incident on the detector.</p>
<p><a class="reference internal" href="../algorithms/MaskDetectorsInShape-v1.html#algm-maskdetectorsinshape"><span class="std std-ref">MaskDetectorsInShape v1</span></a> is subsequently used the apply the generated shape.
The central point of each detector must lie within the shape to be masked, partially
overlapping detectors (whose centre does not sit in the masked region) will not be masked.</p>
<p>The primary use of this command was to mask out the beamstop support arm on some
instruments.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>beamstop_shadow = {width = a, angle = b}
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MASK/LINE 30 170
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  beamstop_shadow = {width = 0.03, angle = 170.0}
</pre></div>
</div>
</section>
<section id="mask-line-a-b-c-d">
<span id="mask-line-four-params-ref"></span><h3><a class="toc-backref" href="#id55" role="doc-backlink">MASK/LINE a b c d</a><a class="headerlink" href="#mask-line-a-b-c-d" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify a <strong>diagonal line</strong> of detector pixels
to be omitted from the calculation during data reduction. See also <a class="reference internal" href="#mask-line-two-params"><span class="std std-ref">MASK/LINE a b</span></a>.</p>
<p>This command works identically to <a class="reference internal" href="#mask-line-two-params"><span class="std std-ref">MASK/LINE a b</span></a>. Instead of starting at (0, 0)
the coordinates for x and y (represented by c and d) are given by the user.</p>
<p>Note that whilst parameter a was given in mm, c and d were specified in metres
even in legacy files!</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>beamstop_shadow = {width = a, angle = b, x_pos = c, y_pos = d}
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MASK/LINE 30 170 0.3 0.1
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  beamstop_shadow = {width = 0.03, angle = 170.0, x_pos=0.3, y_pos=0.1}
</pre></div>
</div>
</section>
<section id="mask-sn">
<h3><a class="toc-backref" href="#id56" role="doc-backlink">MASK Sn</a><a class="headerlink" href="#mask-sn" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify individual detector spectra (ie, pixels)
to be omitted from the calculation during data reduction.</p>
<p>The TOML replacement command actually permits several spectra to be
specified at once.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  mask_pixels = [n1, n2, ...n]
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MASK S123
MASK S456
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  mask_pixels = [123, 456]
</pre></div>
</div>
</section>
<section id="mask-t-t1-t2">
<h3><a class="toc-backref" href="#id57" role="doc-backlink">MASK/T t1 t2</a><a class="headerlink" href="#mask-t-t1-t2" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify regions of the time-of-flight spectrum
<strong>in all spectra</strong> to be omitted from the calculation during data reduction.
Note that the action of this command differs from FIT/CENTRE and FIT/MONITOR.</p>
<p>Times were specified in microseconds.</p>
<p>The TOML replacement command actually permits multiple time ranges to be
specified at once.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  [mask.time]
    tof = [
        {start = t1, stop = t2},
        {start = t3, stop = t4},
        # ...etc
    ]
</pre></div>
</div>
<p><strong>Existing Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Note multiple lines can be collapsed into one section
MASK/T 19711.5 21228.5
MASK/T 39354.5 41348.5
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[mask]
  [mask.time]
    tof = [
      {start = 19711.5, stop = 21228.5},
      {start = 39354.5, stop = 41348.5}
    ]
</pre></div>
</div>
</section>
<section id="mon-direct-front-hab-filename">
<h3><a class="toc-backref" href="#id58" role="doc-backlink">MON/DIRECT[/FRONT][/HAB]=filename</a><a class="headerlink" href="#mon-direct-front-hab-filename" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the name of a file containing the ratio
of the efficiency of the detector to that of the incident beam monitor as
a function of wavelength.</p>
<p>If the /FRONT or /HAB qualifiers, which were equivalent (/HAB was retained
for backward compatibility), are omitted then the command was assumed to
refer to the rear detector.</p>
<p>The efficiency file was required to be in 1D RKH text format with data arranged
as wavelength (in Angstroms), efficiency ratio, uncertainty on efficiency ratio.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  [detector.correction.direct]
    rear_file = &quot;filename&quot;
    front_file = &quot;filename&quot;
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MON/DIRECT=DIRECT_RUN524.dat
MON/DIRECT/HAB=DIRECT_RUN524.dat
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  [detector.correction.direct]
    rear_file = &quot;DIRECT_RUN524.dat&quot;
    front_file = &quot;DIRECT_RUN524.dat&quot;
</pre></div>
</div>
</section>
<section id="mon-flat-front-rear-filename">
<h3><a class="toc-backref" href="#id59" role="doc-backlink">MON/FLAT[/FRONT][/REAR]=filename</a><a class="headerlink" href="#mon-flat-front-rear-filename" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the name of a file containing the relative
efficiency of the individual detector pixels, also known as the ‘flat cell’ or
‘flood source’ file.</p>
<p>If the /FRONT qualifier was omitted then the command was assumed to refer to
the rear detector.</p>
<p>The relative efficiency file was required to be in 1D RKH text format with
data arranged as spectrum number, relative efficiency, uncertainty on relative
efficiency.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  [detector.correction.flat]
    rear_file = &quot;str&quot;
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MON/FLAT=&quot;flat_file.091&quot;
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  [detector.correction.flat]
    rear_file = &quot;flat_file.091&quot;
</pre></div>
</div>
</section>
<section id="mon-habeff-a">
<span id="habeff-ref"></span><h3><a class="toc-backref" href="#id60" role="doc-backlink">MON/HABEFF=a</a><a class="headerlink" href="#mon-habeff-a" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify an approximate correction to the LOQ
instrument high-angle detector efficiencies arising from the longer path
length through the detection volume at high angles. See also <a class="reference internal" href="#habpath-ref"><span class="std std-ref">MON/HABPATH[/ON][/OFF]</span></a>.</p>
<p>The correction assumed a value (parameter a) for the efficiency at
1 Angstrom, the default value of which was 0.2. Setting a=1.0 was akin
to ignoring this correction.</p>
<p><strong>This command was never (knowingly) implemented in Mantid (but was in COLETTE)!</strong></p>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MON/HABEFF=0.2
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported</p>
</section>
<section id="mon-habpath-on-off">
<span id="habpath-ref"></span><h3><a class="toc-backref" href="#id61" role="doc-backlink">MON/HABPATH[/ON][/OFF]</a><a class="headerlink" href="#mon-habpath-on-off" title="Permalink to this heading">¶</a></h3>
<p>This command was used to activate a correction to calculated transmissions
on the LOQ instrument arising from the longer path length through the
sample/can at high angles. See also <a class="reference internal" href="#habeff-ref"><span class="std std-ref">MON/HABEFF=a</span></a>.</p>
<p><strong>This command was never implemented in Mantid (but was in COLETTE)! But see
SAMPLE/PATH[/ON][/OFF].</strong></p>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MON/HABPATH/ON
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported</p>
</section>
<section id="mon-length-z-s">
<h3><a class="toc-backref" href="#id62" role="doc-backlink">MON/LENGTH=z s</a><a class="headerlink" href="#mon-length-z-s" title="Permalink to this heading">¶</a></h3>
<p>This command was intended to override the default distance of the specified
monitor s stored in the Mantid Instrument Definition File in instances where
a very accurate time-of-flight calculation was required. The parameter z was
the moderator-monitor distance.</p>
<p><strong>This command was never (knowingly) implemented in Mantid!</strong> But see <a class="reference internal" href="#trans-transpec-ref"><span class="std std-ref">TRANS/TRANSPEC=s</span></a>.</p>
<p><strong>Replacement Example</strong></p>
<p>Unsupported</p>
</section>
<section id="mon-spectrum-n">
<h3><a class="toc-backref" href="#id63" role="doc-backlink">MON/SPECTRUM=n</a><a class="headerlink" href="#mon-spectrum-n" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify which monitor <em>spectrum</em> (not number) was to
be used for normalisation during data reduction.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  norm_monitor = &quot;Mn&quot;

[normalisation]
  #Normalisation monitor

  [normalisation.monitor.Ma]
    spectrum_number = n1

  [normalisation.monitor.Mb]
    spectrum_number = n2
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MON/SPECTRUM=1
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  norm_monitor = &quot;M1&quot;

[normalisation]
  [normalisation.monitor.M1]
    spectrum_number = 1
</pre></div>
</div>
</section>
<section id="mon-interpolate">
<span id="mon-interpolate-ref"></span><h3><a class="toc-backref" href="#id64" role="doc-backlink">MON [/INTERPOLATE]</a><a class="headerlink" href="#mon-interpolate" title="Permalink to this heading">¶</a></h3>
<p>The optional /INTERPOLATE qualifier could be used to apply an interpolating
rebin of the specified monitor spectrum. This could be useful as a means of
‘smoothing’ noisy monitor spectra where the normal rebin command generated
‘stepped’ histograms.</p>
<p>This command has been been made obsolete by the switch to monitors running
in Event mode.</p>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MON/SPECTRUM=1/INTERPOLATE
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported - Obsolete</p>
</section>
<section id="mon-trans-spectrum-n">
<h3><a class="toc-backref" href="#id65" role="doc-backlink">MON/TRANS/SPECTRUM=n</a><a class="headerlink" href="#mon-trans-spectrum-n" title="Permalink to this heading">¶</a></h3>
<p>This command could also be used to specify which monitor <em>spectrum</em> (not number) was to
be used for normalisation during data reduction. As the /TRANS qualifier was
present the command only applied to the normalisation of <em>transmission</em>
spectra.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  norm_monitor = &quot;Ma&quot;
  trans_monitor = &quot;Mb&quot;

[normalisation]
  #Normalisation monitor

  [normalisation.monitor.Ma]
    spectrum_number = n1

  [normalisation.monitor.Mb]
    spectrum_number = n2

  [normalisation.monitor.Mc]
    spectrum_number = n3

[transmission]
  [transmission.monitor.Mb]
    use_different_norm_monitor = true
    trans_norm_monitor = &quot;Mc&quot;
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MON/SPECTRUM=1
TRANS/TRANSPEC=2
MON/TRANS/SPECTRUM=4
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  norm_monitor = &quot;M1&quot;
  trans_monitor = &quot;M2&quot;

[normalisation]
  [normalisation.monitor.M1]
    spectrum_number = 1

  [normalisation.monitor.M4]
    spectrum_number = 4

[transmission]
  [transmission.monitor.M2]
    spectrum_number = 2
    use_different_norm_monitor = true
    trans_norm_monitor = &quot;M4&quot;

# If interpolation is also required:
[binning]
  [binning.2d_reduction]
    interpolate = true
</pre></div>
</div>
</section>
<section id="mon-trans-interpolate">
<h3><a class="toc-backref" href="#id66" role="doc-backlink">MON/TRANS[/INTERPOLATE]</a><a class="headerlink" href="#mon-trans-interpolate" title="Permalink to this heading">¶</a></h3>
<p>See <a class="reference internal" href="#mon-interpolate-ref"><span class="std std-ref">MON [/INTERPOLATE]</span></a>.</p>
</section>
<section id="print-string">
<h3><a class="toc-backref" href="#id67" role="doc-backlink">PRINT string</a><a class="headerlink" href="#print-string" title="Permalink to this heading">¶</a></h3>
<p>This command was used to write an arbitrary string to the Mantid Results
Log or Messages windows (depending on the Mantid version).</p>
<p>There is no equivalent of this command in TOML User Files but there are
still two ways to include equivalent information in the file:</p>
<ul class="simple">
<li><p>The first is within the [metadata] block at the top of the file; for
example:</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[metadata]
  name = &quot;Using beamstop M4 for transmissions&quot;
  created = &quot;2021-09-09&quot;
  original_file = &quot;USER_LOQ_211G_M4_hab_log.toml&quot;
  mantid_interface = &quot;SANS v2&quot;
</pre></div>
</div>
<ul class="simple">
<li><p>The other is in the form of comments; for example:</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  #Remember to use METRES!
  sample_aperture_diameter = 0.008  # Used for q_resolution
  sample_offset = 0.00              #(-11.0 + Lms) = -0.355 + flange-to-sample-distance
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>PRINT Using beamstop M4 for transmissions
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported</p>
</section>
<section id="qresol-on-off">
<h3><a class="toc-backref" href="#id68" role="doc-backlink">QRESOL[/ON][/OFF]</a><a class="headerlink" href="#qresol-on-off" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify whether data reduction should <em>also</em> calculate
an estimate of the Q-resolution. If gravity corrections are also enabled (see
GRAVITY[/ON/OFF]) these are included in the calculation.</p>
<p>For more information, see the
<a class="reference external" href="https://docs.mantidproject.org/nightly/algorithms/TOFSANSResolutionByPixel-v1.html">TOFSANSResolutionByPixel</a>
algorithm description.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[q_resolution]
  enabled = true  # Or false
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QRESOL/ON
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[q_resolution]
  enabled = true  # Or false
</pre></div>
</div>
</section>
<section id="qresol-moderator-filename">
<h3><a class="toc-backref" href="#id69" role="doc-backlink">QRESOL/MODERATOR=filename</a><a class="headerlink" href="#qresol-moderator-filename" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the name of a file containing the
moderator time spread as a function of wavelength. At ISIS these
data were produced from moderator performance simulations conducted
by R Bewley &amp; S Ansell. <strong>For sensible estimates of the Q-resolution
it is imperative that the moderator file be for the moderator in use!</strong></p>
<p>For more information, see the
<a class="reference external" href="https://docs.mantidproject.org/nightly/algorithms/TOFSANSResolutionByPixel-v1.html">TOFSANSResolutionByPixel</a>
algorithm description.</p>
<p>The moderator file was required to be in 1D RKH text format with
data arranged as wavelength (in Angstroms), time spread (in microseconds),
uncertainty on time spread (zero if unknown).</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[q_resolution]
  moderator_file = &quot;filename&quot;
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QRESOL/MODERATOR=ModeratorStdDev_TS2_SANS_LETexptl_07Aug2015.txt
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[q_resolution]
  moderator_file = &quot;ModeratorStdDev_TS2_SANS_LETexptl_07Aug2015.txt&quot;
</pre></div>
</div>
</section>
<section id="qresol-deltar-dr">
<h3><a class="toc-backref" href="#id70" role="doc-backlink">QRESOL/DELTAR=dr</a><a class="headerlink" href="#qresol-deltar-dr" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the width of the virtual rings used
for the radial integration. A value of 3 mm would be typical, otherwise
it would be sensible to use the rstep value specified in the
L/R r1 r2 [rstep] command if present.</p>
<p>For more information, see the
<a class="reference external" href="https://docs.mantidproject.org/nightly/algorithms/TOFSANSResolutionByPixel-v1.html">TOFSANSResolutionByPixel</a>
algorithm description.</p>
<p>The virtual ring width of the detector in meters.
This is used to calculate the Q Resolution from TOF SANS Data on a per-pixel
in <a class="reference internal" href="../algorithms/TOFSANSResolutionByPixel-v1.html#algm-tofsansresolutionbypixel"><span class="std std-ref">TOFSANSResolutionByPixel v1</span></a>.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[q_resolution]
  delta_r = dr
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QRESOL/DELTAR=3  # m
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[q_resolution]
  delta_r = 0.003  # mm
</pre></div>
</div>
</section>
<section id="qresol-a1-x">
<span id="a1-ref"></span><h3><a class="toc-backref" href="#id71" role="doc-backlink">QRESOL/A1=x</a><a class="headerlink" href="#qresol-a1-x" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the <strong>source</strong> aperture <em>diameter</em> to be
used in the estimation of the Q-resolution. See also <a class="reference internal" href="#a2-ref"><span class="std std-ref">QRESOL/A2=x</span></a> and
<a class="reference internal" href="#h1-w1-h2-w2-ref"><span class="std std-ref">QRESOL[/H1=x1][/W1=y1][/H2=x2][/W2=y2]</span></a>.</p>
<p>For more information, see the
<a class="reference external" href="https://docs.mantidproject.org/nightly/algorithms/TOFSANSResolutionByPixel-v1.html">TOFSANSResolutionByPixel</a>
algorithm description.</p>
<p><strong>This command assumes that the data were collected on an instrument with
pinhole collimation!</strong></p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[q_resolution]
  source_aperture = x
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QRESOL/A1=30
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[q_resolution]
  source_aperture = 0.03
</pre></div>
</div>
</section>
<section id="qresol-a2-x">
<span id="a2-ref"></span><h3><a class="toc-backref" href="#id72" role="doc-backlink">QRESOL/A2=x</a><a class="headerlink" href="#qresol-a2-x" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the <strong>sample</strong> aperture <em>diameter</em> to be
used in the estimation of the Q-resolution. See also <a class="reference internal" href="#a1-ref"><span class="std std-ref">QRESOL/A1=x</span></a> and
<a class="reference internal" href="#h1-w1-h2-w2-ref"><span class="std std-ref">QRESOL[/H1=x1][/W1=y1][/H2=x2][/W2=y2]</span></a>.</p>
<p>For more information, see the
<a class="reference external" href="https://docs.mantidproject.org/nightly/algorithms/TOFSANSResolutionByPixel-v1.html">TOFSANSResolutionByPixel</a>
algorithm description.</p>
<p><strong>This command assumes that the data were collected on an instrument with
pinhole collimation!</strong></p>
<p>The sample aperture will normally be smaller than the source aperture!</p>
<p>Note that because the source aperture size is frequently altered, the ISIS
SANS Group decided to place the TOML replacement in the [instrument.configuration]
block at the top of TOML User Files instead of the [q_resolution] block.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  sample_aperture_diameter = x
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QRESOL/A2=20
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  sample_aperture_diameter = 0.02
</pre></div>
</div>
</section>
<section id="qresol-h1-x1-w1-y1-h2-x2-w2-y2">
<span id="h1-w1-h2-w2-ref"></span><h3><a class="toc-backref" href="#id73" role="doc-backlink">QRESOL[/H1=x1][/W1=y1][/H2=x2][/W2=y2]</a><a class="headerlink" href="#qresol-h1-x1-w1-y1-h2-x2-w2-y2" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the <strong>source and sample</strong> slit sizes to be
used in the estimation of the Q-resolution. See also <a class="reference internal" href="#a1-ref"><span class="std std-ref">QRESOL/A1=x</span></a> and
<a class="reference internal" href="#a2-ref"><span class="std std-ref">QRESOL/A2=x</span></a>.</p>
<p>For more information, see the
<a class="reference external" href="https://docs.mantidproject.org/nightly/algorithms/TOFSANSResolutionByPixel-v1.html">TOFSANSResolutionByPixel</a>
algorithm description.</p>
<p><strong>This command assumes that the data were collected on an instrument with
slit/jaw collimation!</strong></p>
<p>The sample slit size will normally be smaller than the source slit size! But
the heights and widths of a slit do not have to be the same.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[q_resolution]
  h1 = x1
  w1 = y1
  h2 = x2
  w2 = y2
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QRESOL/H1=16.0
QRESOL/W1=16.0
QRESOL/H2=8.0
QRESOL/W2=8.0
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[q_resolution]
  h1 = 0.016
  w1 = 0.016
  h2 = 0.008
  w2 = 0.008
</pre></div>
</div>
</section>
<section id="qresol-lcollim-z">
<span id="id7"></span><h3><a class="toc-backref" href="#id74" role="doc-backlink">QRESOL/LCOLLIM=z</a><a class="headerlink" href="#qresol-lcollim-z" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the length of the collimation - the distance
between the source and sample apertures/slits/jaws - to be used in the
estimation of the Q-resolution.</p>
<p>For more information, see the
<a class="reference external" href="https://docs.mantidproject.org/nightly/algorithms/TOFSANSResolutionByPixel-v1.html">TOFSANSResolutionByPixel</a>
algorithm description.</p>
<p>Note that because the collimation length is frequently altered, the ISIS
SANS Group decided to place the TOML replacement in the [instrument.configuration]
block at the top of TOML User Files instead of the [q_resolution] block.</p>
<p>Also note that the collimation length was historically specified in metres too.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  collimation_length = z
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QRESOL/LCOLLIM=4.0
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  collimation_length = 4.0
</pre></div>
</div>
</section>
<section id="sample-offset-z">
<h3><a class="toc-backref" href="#id75" role="doc-backlink">SAMPLE/OFFSET z</a><a class="headerlink" href="#sample-offset-z" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify any correction to the default Z coordinate
in the Mantid Instrument Definition File defining the nominal position of the
sample. The offset is a relative value with positive offsets translating the
sample position <em>towards</em> the detector(s).</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  sample_offset = z
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SAMPLE/OFFSET -60
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  sample_offset = -0.06
</pre></div>
</div>
</section>
<section id="sample-path-on-off">
<h3><a class="toc-backref" href="#id76" role="doc-backlink">SAMPLE/PATH[/ON][/OFF]</a><a class="headerlink" href="#sample-path-on-off" title="Permalink to this heading">¶</a></h3>
<p>This command was used to activate a correction to calculated transmissions
arising from the longer path length through the sample/can at high angles.
Unlike MON/HABPATH[/ON][/OFF] this command was generic.</p>
<p>For more information, see the
<a class="reference external" href="https://docs.mantidproject.org/nightly/algorithms/SANSWideAngleCorrection-v1.html">SANSWideAngleCorrection</a>
algorithm description.</p>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SAMPLE/PATH/ON
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported, pending future discussion.</p>
</section>
<section id="set-centre-a-b">
<span id="set-centre-ref"></span><h3><a class="toc-backref" href="#id77" role="doc-backlink">SET CENTRE a b</a><a class="headerlink" href="#set-centre-a-b" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the (x,y) coordinates (in real-space) of
the centre of the scattering pattern on the rear (ie, main) detector. See
also SET CENTRE[/MAIN][/HAB] a b [c d].</p>
<p><strong>Warning: the TOML replacement for this command will apply the same
centre coordinates to a front detector if present. In most instances
this will not be sensible.</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  [detector.configuration]
    all_centre = {x=a, y=b}
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SET CENTRE 84.2 -196.5
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  [detector.configuration]
    # This will set both front and rear to the same centre values.
    all_centre = {x=0.0842, y=-0.1965}
</pre></div>
</div>
</section>
<section id="set-centre-main-hab-a-b-c-d">
<h3><a class="toc-backref" href="#id78" role="doc-backlink">SET CENTRE[/MAIN][/HAB] a b [c d]</a><a class="headerlink" href="#set-centre-main-hab-a-b-c-d" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the (x,y) coordinates (in real-space) of
the centre of the scattering pattern on a specific detector. Compare with
SET CENTRE a b.</p>
<p>If the /MAIN qualifier was omitted the command was assumed to apply to
the main (ie, rear) detector anyway. The /HAB qualifier was required to
specify the beam centre coordinates for a high-angle (ie, front) detector.</p>
<p>The parameters c and d allowed the size of the detector pixels in x &amp; y
to be passed to the data reduction.</p>
<p>Approximate centre coordinates on the ISIS SANS instruments (which should
be optimised using the beam centre finder tool!) are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>LARMOR: ( 0.020,  1.000)
LOQ:    ( 0.320,  0.320)
SANS2D: ( 0.100, -0.080)
ZOOM:   (-0.170, -0.050)
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  [detector.configuration]
    front_centre = {x=a, y=b}
    rear_centre = {x=a, y=b}
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SET CENTRE 324.31 328.547 5.00 5.00
SET CENTRE/HAB 317.92 325.498
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  [detector.configuration]
    # Note for identical results the values will
    # only take a and b in the above example due to a bug
    # with the legacy user file parser
    front_centre = {x=0.31792, y=0.325498}
    rear_centre = {x=0.32431, y=0.328547}
</pre></div>
</div>
</section>
<section id="set-scales-a-b-c-d-e">
<h3><a class="toc-backref" href="#id79" role="doc-backlink">SET SCALES a b c d e</a><a class="headerlink" href="#set-scales-a-b-c-d-e" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the absolute intensity calibration scale
factor (parameter a) to be applied to all intensity values at the end of
the data reduction calculation.</p>
<p>In the case of the LOQ instrument, it also allowed the relative scaling of
the four high-angle detector banks (parameters b, c, d &amp; e) to be accounted
for (as a*b, a*c, a*d &amp; a*e). For all other ISIS SANS instruments these
four parameters should be set to unity.</p>
<p><strong>Note: In 2020 it was discovered that due to a forever bug in the legacy
User File command parser the parameters b, c, d &amp; e have never been implemented
in Mantid.</strong> See this <a class="reference external" href="https://github.com/mantidproject/mantid/issues/27948">issue</a>.</p>
<p>All workspaces are currently scaled by the value represented by <cite>a</cite> for all values,
rather than on a per-bank basis.</p>
<p>The TOML replacement command allows separate but single scaling factors for
both rear and front detectors to be specified. But to maintain compatibility
<cite>front_scale</cite> is ignored by the parser and will not do anything.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  [detector.configuration]
    front_scale = a
    rear_scale = a
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SET SCALES 0.02938 1.0 1.0 1.0 1.0
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]
  [detector.configuration]
    front_scale = 1.0
    rear_scale = 0.02938
</pre></div>
</div>
</section>
<section id="set-notables-bank-a-b-c-d-e">
<h3><a class="toc-backref" href="#id80" role="doc-backlink">SET[/NOTABLES] BANK a b c d e</a><a class="headerlink" href="#set-notables-bank-a-b-c-d-e" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the physical location and orientation
of the four LOQ instrument high-angle detector modules.</p>
<p>The parameters were: an ISIS Detector ID Code, the distance from the
moderator (in metres), an anticlockwise rotation angle, and the x &amp; y
coordinates (in mm) of the first pixel on the specified module. Viewed
from the direction of travel of the neutrons, positive values of x &amp; y
corresponded to right and up, respectively.</p>
<p>The /NOTABLES (/NOTAB was also supported) qualifier could be used to
stop a redundant call to the routine mapping detectors.</p>
<p><strong>This command became redundant with improvements in the Mantid Instrument
Definition File.</strong></p>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SET/NOTAB BANK 305 11.582 0. 112.28 -245.19
SET/NOTAB BANK 304 11.582 90. 244.28 114.82
SET/NOTAB BANK 306 11.582 180. -115.72 246.82
SET/NOTAB BANK 307 11.582 270. -247.72 -113.19
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported</p>
</section>
<section id="set-xcor-ycor-on-off-clear">
<span id="clear-xcor-ycor-ref"></span><h3><a class="toc-backref" href="#id81" role="doc-backlink">SET[/XCOR][/YCOR][/ON][/OFF][/CLEAR]</a><a class="headerlink" href="#set-xcor-ycor-on-off-clear" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify if non-linear coordinate
corrections to LOQ instrument detector data should be applied
during data reduction. The /XCOR (/XC was also supported) qualifier
specified that detector x coordinates were to be corrected. Similarly,
the /YCOR (or /YC) qualifier specified that detector y coordinates
were to be corrected. See also <a class="reference internal" href="#set-xcor-ycor-ref"><span class="std std-ref">SET[/NOTABLES][/XCOR][/YCOR]=filename</span></a>.</p>
<p>The /CLEAR qualifier was equivalent to /OFF.</p>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SET/XCOR/ON
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported</p>
</section>
<section id="set-notables-xcor-ycor-filename">
<span id="set-xcor-ycor-ref"></span><h3><a class="toc-backref" href="#id82" role="doc-backlink">SET[/NOTABLES][/XCOR][/YCOR]=filename</a><a class="headerlink" href="#set-notables-xcor-ycor-filename" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify a file containing non-linear
coordinate corrections to LOQ instrument detector data. Separate files
were required for the x and y coordinates. See also <a class="reference internal" href="#clear-xcor-ycor-ref"><span class="std std-ref">SET[/XCOR][/YCOR][/ON][/OFF][/CLEAR]</span></a>.</p>
<p>The /NOTABLES (/NOTAB was also supported) qualifier could be used to
stop a redundant call to the routine mapping detectors if both x and y1
coordinates were being corrected (see example below).</p>
<p><strong>This command became redundant from Mantid 1.1.9556 and LOQ_Definition.xml valid from 2002-02-26.</strong></p>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SET/NOTAB/XC=xcorr.991_994
SET/YC=ycorr.991_994
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported</p>
</section>
<section id="trans-mask-filename">
<span id="trans-mask-ref"></span><h3><a class="toc-backref" href="#id83" role="doc-backlink">TRANS/MASK=filename</a><a class="headerlink" href="#trans-mask-filename" title="Permalink to this heading">¶</a></h3>
<p>This command was used in conjunction with TRANS/RADIUS=r or, more likely,
TRANS/ROI=filename to <em>exclude</em> regions of the detector specified by those
commands. See also <a class="reference internal" href="#trans-radius-ref"><span class="std std-ref">TRANS/RADIUS=r</span></a> and <a class="reference internal" href="#trans-roi-ref"><span class="std std-ref">TRANS/ROI=filename</span></a>.</p>
<p>filename was expected to be a Mantid mask file in XML format.</p>
<p><strong>Note that if also present a TRANS/TRANSPEC=s command would always supersede a
TRANS/MASK=filename command.</strong> See also <a class="reference internal" href="#trans-transpec-ref"><span class="std std-ref">TRANS/TRANSPEC=s</span></a>.</p>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>TRANS/ROI=select.xml
TRANS/MASK=exclude.xml
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported, see <a class="reference internal" href="#trans-roi-ref"><span class="std std-ref">TRANS/ROI=filename</span></a>.</p>
</section>
<section id="trans-radius-r">
<span id="trans-radius-ref"></span><h3><a class="toc-backref" href="#id84" role="doc-backlink">TRANS/RADIUS=r</a><a class="headerlink" href="#trans-radius-r" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify a circular region-of-interest (ROI) of radius r
on the detector taking the transmitted beam which was to be used in place of a
dedicated transmission monitor. The ROI was assumed to be centred on the beam
centre coordinates (see <a class="reference internal" href="#set-centre-ref"><span class="std std-ref">SET CENTRE a b</span></a>). See also <a class="reference internal" href="#trans-mask-ref"><span class="std std-ref">TRANS/MASK=filename</span></a>
and <a class="reference internal" href="#trans-roi-ref"><span class="std std-ref">TRANS/ROI=filename</span></a>.</p>
<p>For this command to have had any sensible purpose, it would have been necessary
for the detector beamstop to have been removed for transmission measurements.</p>
<p>The radius was specified in mm.</p>
<p><strong>Note that if also present a TRANS/TRANSPEC=s command would always supersede a
TRANS/RADIUS=r command.</strong> See also <a class="reference internal" href="#trans-transpec-ref"><span class="std std-ref">TRANS/TRANSPEC=s</span></a>.</p>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>TRANS/RADIUS=30
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<p>Unsupported, pending future discussion.</p>
</section>
<section id="trans-roi-filename">
<span id="trans-roi-ref"></span><h3><a class="toc-backref" href="#id85" role="doc-backlink">TRANS/ROI=filename</a><a class="headerlink" href="#trans-roi-filename" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify an arbitrary region-of-interest (ROI) on the
detector taking the transmitted beam which was to be used in place of a dedicated
transmission monitor. See also <a class="reference internal" href="#trans-mask-ref"><span class="std std-ref">TRANS/MASK=filename</span></a> and <a class="reference internal" href="#trans-radius-ref"><span class="std std-ref">TRANS/RADIUS=r</span></a>.</p>
<p>For this command to have had any sensible purpose, the ROI would have been needed
to have been outside of any masked regions of the detector (eg, the beamstop
and/or beamstop support arm shadows).</p>
<p>filename was expected to be a Mantid mask file in XML format.</p>
<p><strong>Note that if also present a TRANS/TRANSPEC=s command would always supersede a
TRANS/ROI=filename command.</strong> See also <a class="reference internal" href="#trans-transpec-ref"><span class="std std-ref">TRANS/TRANSPEC=s</span></a>.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  trans_monitor = &quot;ROI&quot;

[transmission]
  # This will be ignored:
  [transmission.monitor.Mn]
    spectrum_number = s

  [transmission.ROI]
    file = &quot;roi_file.xml&quot;
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>TRANS/ROI=filename.xml
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<blockquote>
<div><dl class="simple">
<dt>[instrument.configuration]</dt><dd><p>trans_monitor = “ROI”</p>
</dd>
</dl>
<p>[transmission]</p>
<blockquote>
<div><dl class="simple">
<dt>[transmission.ROI]</dt><dd><p>file = “filename.xml”</p>
</dd>
</dl>
</div></blockquote>
</div></blockquote>
</section>
<section id="trans-transpec-s">
<span id="trans-transpec-ref"></span><h3><a class="toc-backref" href="#id86" role="doc-backlink">TRANS/TRANSPEC=s</a><a class="headerlink" href="#trans-transpec-s" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify the spectrum (not monitor) <em>number</em>
containing the transmission data. The spectrum number and the monitor*
number may, or may not, be the same depending on the instrument!</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  # Where Mn is arbitrary but must match the section label
  trans_monitor = &quot;Mn&quot;

[transmission]
  [transmission.monitor.Mn]
    spectrum_number = s
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>TRANS/TRANSPEC=3
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  trans_monitor = &quot;M3&quot;

[transmission]
  [transmission.monitor.M3]
    spectrum_number = 3
</pre></div>
</div>
</section>
<section id="trans-transpec-s-shift-dz">
<h3><a class="toc-backref" href="#id87" role="doc-backlink">TRANS/TRANSPEC=s/SHIFT=dz</a><a class="headerlink" href="#trans-transpec-s-shift-dz" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify any correction to the default Z coordinate
in the Mantid Instrument Definition File defining the nominal position of the
transmission monitor represented by the specified spectrum number. The offset
is a relative value with positive offsets translating the sample position
<em>towards</em> the detector(s).</p>
<p>This command was typically used to fine tune the position of beamstop-mounted
transmission monitors.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  # Where Mn is arbitrary but must match the section label
  trans_monitor = &quot;Mn&quot;

[transmission]
  [transmission.monitor.Mn]
    spectrum_number = s
                shift = dz
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>TRANS/TRANSPEC=17788/SHIFT=-12
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[instrument.configuration]
  trans_monitor = &quot;M4&quot;

[transmission]
  [transmission.monitor.M4]
    spectrum_number = 17788
    shift = -0.012
</pre></div>
</div>
</section>
<section id="tubecalibfile-filename">
<h3><a class="toc-backref" href="#id88" role="doc-backlink">TUBECALIBFILE=filename</a><a class="headerlink" href="#tubecalibfile-filename" title="Permalink to this heading">¶</a></h3>
<p>This command was used to specify a spatial calibration file for tube
array detectors. Only one file could be specified, and so if an instrument
had more than one such detector the calibrations for each needed to
be amalgamated.</p>
<p><strong>Replacement</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]

[detector.correction.tube]
  file = &quot;filename&quot;
</pre></div>
</div>
<p><strong>Existing Example:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>TUBECALIBFILE=TUBE_SANS2D_BOTH_64393_15Mar20.nxs
</pre></div>
</div>
<p><strong>Replacement Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[detector]

[detector.correction.tube]
  file = &quot;TUBE_SANS2D_BOTH_64393_15Mar20.nxs&quot;
</pre></div>
</div>
<p><strong>Category</strong>: <a class="reference external" href="categories/Techniques.html">Techniques</a></p>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ReflectometryILL.html" title="Previous Chapter: Data reduction for reflectometry instruments at the ILL"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Data reductio...</span>
    </a>
  </li>
  <li>
    <a href="ScriptingSANSReductions.html" title="Next Chapter: Scripting SANS Reductions"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Scripting SAN... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>