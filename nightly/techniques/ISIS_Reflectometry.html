<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>ISIS Reflectometry</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data reduction for D7 instrument at the ILL" href="PolarisedDiffractionILL.html" />
    <link rel="prev" title="ISIS Powder Diffraction Scripts Workflow Diagrams" href="ISISPowder-Workflows-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Techniques</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">ISIS Reflectometry</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="isis-reflectometry">
<span id="id1"></span><h1>ISIS Reflectometry<a class="headerlink" href="#isis-reflectometry" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id6">Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id7">Introduction</a></p></li>
<li><p><a class="reference internal" href="#experimental-setup" id="id8">Experimental Setup</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#reduction" id="id9">Reduction</a></p>
<ul>
<li><p><a class="reference internal" href="#specular-reflection" id="id10">Specular Reflection</a></p>
<ul>
<li><p><a class="reference internal" href="#divergent-beam" id="id11">Divergent Beam</a></p></li>
<li><p><a class="reference internal" href="#non-flat-sample" id="id12">Non-Flat Sample</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#instruments" id="id13">Instruments</a></p>
<ul>
<li><p><a class="reference internal" href="#isis-instruments" id="id14">ISIS Instruments</a></p></li>
<li><p><a class="reference internal" href="#detectors" id="id15">Detectors</a></p></li>
<li><p><a class="reference internal" href="#instrument-definition-files" id="id16">Instrument Definition Files</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#mantid" id="id17">Mantid</a></p>
<ul>
<li><p><a class="reference internal" href="#algorithms" id="id18">Algorithms</a></p></li>
<li><p><a class="reference internal" href="#interface" id="id19">Interface</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>This document explains set up of reflectometry instruments at ISIS and how Mantid is used to perform reduction of ISIS reflectometry data.</p>
<section id="introduction">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h3>
<p>Reflectometry is a non-invasive technique that allows us to analyse the properties of planar media and surfaces such as biological and metallic thin films.</p>
<p>Interfaces and surfaces are scientifically crucial as they allow symmetry breaking, leading too many novel and interesting phenomena, such as ferroelectricity, wetting, adhesion and superconductivity. Interfaces are also critical in governing many important chemical and biological processes such as corrosion, catalysis and how cell membranes and antimicrobials work. Reflectivity is unique in its ability to probe buried interfaces while still providing the ensemble average of the properties of these buried interfaces. Most other probes are surface limited and local in nature.</p>
<p>Reflectivity occurs whenever there is an equivalent refractive index change across a material boundary/interface; this is analogous to how light (travelling through air) reflects off the surface of water (our interface of interest). As a result it is very sensitive to the structural/magnetic profile of interfaces. Reflectivity allows the structural, sometimes called “nuclear”, scattering length density (SLD) depth profile to be obtained via a modelling and iterative fitting process. The SLD profile is the important piece of information that the reflectivity technique provides.</p>
<p>To obtain the SLD profile, a model of the sample is used to create an initial SLD profile that via a fast Fourier transform is turned into a reflectivity curve. This curve is then compared to the actual reflectivity data curve. The iterative fitting procedure is used to modify the initial model and SLD profile until the generated reflectivity matches, to some goodness of fit metric, the actual data. Then end result being the final SLD profile.</p>
<p>Assuming the most common model and parametrisation type, based on layers, then the SLD can then be deconvolved into a series of layers each with three fundamental properties: (1) The structural layer thicknesses, (2) interface roughness/grading (3) density/composition. These three properties can be linked back to a wealth of technological and scientifically relevant phenomena. Further to this, by polarising the incident neutron beam the magnetic equivalents of the above can also be obtained. It is also important to note that there are other models and parameterisation schemes that can be used, to generate SLD profiles.</p>
<p>A reflectivity measurement is made by shining a collimated beam (low angular divergence) of neutrons onto a flat surface and the reflected intensity is measured as a function of angle and neutron wavelength. Reflectivity has two fundamental modes of operation. (1) Monochromatic (angle dispersive, fixed incident wavelength) and chromatic (wavelength dispersive, fixed angle). (2) Chromatic is usually referred to as Time of Flight (<span class="math notranslate nohighlight">\(TOF\)</span>) and <span class="math notranslate nohighlight">\(TOF\)</span> is the primary mode of operation on all the ISIS reflectometers and what is referred to throughout this document.</p>
<p>Further to this, there are two geometric modes of operation. By far the most common is specular reflectivity. In this case the angle of incidence is equal to the angle of reflection or <span class="math notranslate nohighlight">\(\theta_i = \theta_f\)</span>. This is called the specular condition. It provides the SLD profile/information that is directly normal or perpendicular to the surface of the sample. Secondly there is off-specular reflectivity where the angle of incidence is not equal to the angle of reflection or <span class="math notranslate nohighlight">\(\theta_i \ne \theta_f\)</span> . This provides structural information in the plane of the sample.</p>
<p>As a quick aside it is worth mentioning that there is an added complication in describing scattering geometries in that different techniques, sources and institutions use different notations for the same things. For instance the specular condition can also be referred to as the <span class="math notranslate nohighlight">\(\frac{\theta}{2\theta}\)</span> (where <span class="math notranslate nohighlight">\(2\theta\)</span> is the scattering/detector angle and <span class="math notranslate nohighlight">\(\theta\)</span> the sample angle) or <span class="math notranslate nohighlight">\(\frac{\omega}{\theta}\)</span> (where <span class="math notranslate nohighlight">\(\theta\)</span> is not the scattering/detector angle and <span class="math notranslate nohighlight">\(\omega\)</span> the sample angle) conditions. At ISIS reflectometers for historic reasons the detector angle is referred to as <span class="math notranslate nohighlight">\(\theta\)</span> and the sample angle as <span class="math notranslate nohighlight">\(\Phi\)</span>.</p>
<p>For more information, see the <a class="reference external" href="https://www.isis.stfc.ac.uk/Pages/Reflectometry.aspx">ISIS website</a>.</p>
</section>
<section id="experimental-setup">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Experimental Setup</a><a class="headerlink" href="#experimental-setup" title="Permalink to this heading">¶</a></h3>
<p>The main components in the instrument are shown below:</p>
<figure class="align-center">
<img alt="Diagram showing the basic setup of ISIS Reflectometry instruments" src="../_images/ISISReflectometry_setup_diagram.png" />
</figure>
<p>The basic reflectometry instrument setup as used on the Inter, Crisp and Surf beamlines. The black line is the incident beam and the red line the reflected beam. The dotted black line is the horizon of the sample which is at an angle <span class="math notranslate nohighlight">\(\theta_i\)</span> with respect to the incident beam. There are several caveats; the diagram depicts what happens with the 1D linear detectors’ on Inter, Crisp and Surf. In the case of the 0D point detectors on these beamlines the detector changes angle such that the beam is always perpendicular incident on the 0D detector surface. On Polref and Offspec, the detector plane rotates with the detector angle such that the beam is always perpendicular incident on the detector plane whether it is a 0D, 1D or 2D detector. This needs to be taken account of in the IDF depending on the beamline and detector in use.</p>
<ul class="simple">
<li><p><em>Source</em>: The source of neutrons</p></li>
<li><p><em>Sample</em>: The planar material under analysis</p></li>
<li><p><em>Slits</em>: These are used to collimate the beam. These have two primary effects:</p>
<ul>
<li><p>They set the angular divergence/resolution <span class="math notranslate nohighlight">\(\alpha\)</span> of the beamline via the collimation equation <span class="math notranslate nohighlight">\(\alpha = \frac{S_1+S_2}{L}\)</span>, where <span class="math notranslate nohighlight">\(S_1,S_2\)</span> are the widths of the slit gaps and <span class="math notranslate nohighlight">\(L\)</span> is the distance between Slit 1 and Slit 2. The resolution is often defined as <span class="math notranslate nohighlight">\(\frac{\delta Q}{Q}\)</span>, where <span class="math notranslate nohighlight">\(Q\)</span> is the momentum transfer. Please see the <a class="reference internal" href="../algorithms/NRCalculateSlitResolution-v1.html#algm-nrcalculateslitresolution"><span class="std std-ref">NRCalculateSlitResolution v1</span></a> algorithm for more details.</p></li>
<li><p>They set the illuminated area on the sample. There are two regimes, under and over illumination and ideally you want to be under illuminating but that is not always possible as in the case of small samples.</p></li>
</ul>
</li>
<li><p><em>Monitors</em>: These are low efficiency detectors used to normalize the detector signal and mainly provide scaling.</p></li>
<li><p><em>Detectors</em>: These are high efficiency detectors. Scattered neutrons are recorded by a detector or banks of detectors located at different <em>scattering angles</em>, <span class="math notranslate nohighlight">\(2\theta_{det}\)</span>. Note that the terminology here differs from that in neutron diffraction, where <span class="math notranslate nohighlight">\(\theta\)</span> is referred to as the scattering angle rather than <span class="math notranslate nohighlight">\(2\theta\)</span>. We define three types of general geometry of detector:</p>
<ul>
<li><p><em>0D</em> or <em>point detectors</em>, where a simple tube is used to integrate intensity, the detector itself has no position sensitivity, just the angle it is positioned at.</p></li>
<li><p><em>1D</em> also referred to as <em>linear</em>, <em>area</em> or <em>multidetector</em>’s, where a stack of tubes/pixels is used to integrate intensity with either vertical or horizontal position sensitivity equal to the pixel size.</p></li>
<li><p><em>2D</em>, which can also be referred to as an <em>area</em> detector. Similar to the 1D but with both vertical and horizontal position sensitivity. Note pixels may not be uniform in horizontal/vertical size.</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(\theta_i\)</span>: the <em>incident angle</em>, that is, the angle between the incident beam and the sample, commonly called the sample angle or at ISIS reflectometers the <span class="math notranslate nohighlight">\(\Phi\)</span> axis.</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta_f\)</span>: the <em>final angle</em>, that is, the angle between the reflected beam and the sample. At ISIS reflectometers this is referred to as <span class="math notranslate nohighlight">\(\theta\)</span>. In specular reflection, <span class="math notranslate nohighlight">\(\theta_i = \theta_f\)</span> and in off-specular analysis <span class="math notranslate nohighlight">\(\theta_i \neq \theta_f\)</span>.</p></li>
</ul>
<p>In addition, some instruments also use:</p>
<ul class="simple">
<li><p><em>Supermirrors</em>: Some samples, such as liquids, cannot be angled. Therefore non-polarising “supermirrors” can be used to change the incident angle of the beam to enable multiple angles to be measured from the surface.</p></li>
<li><p><em>Polarizers</em>: Magnetic sensitivity is acquired by polarizing the neutron beam, via polarizing supermirrors.  Neutrons are in essence like little bar magnets; however the north/south alignment (referred to as the spin direction) is initially completely random. A polarizer is a magnetic supermirror where the magnetization direction of the mirror can be set by an applied magnetic field. When neutrons bounce off the polarizer, the neutrons align either parallel (spin “up”) or anti-parallel (spin “down”) to the magnetization direction of the mirror. The handy trick is that the refractive index of the magnetic mirror has a magnetic component, such that spin up neutrons have a different angle of reflection to spin down neutrons. Hence it is possible to reflect just one spin state down the beamline, while the other is rejected. It should be noted at this point that 50% of the incident flux is lost during this process.</p></li>
</ul>
</section>
</section>
<section id="reduction">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Reduction</a><a class="headerlink" href="#reduction" title="Permalink to this heading">¶</a></h2>
<p>The main reduction algorithm is <a class="reference internal" href="../algorithms/ReflectometryReductionOneAuto-v3.html#algm-reflectometryreductiononeauto"><span class="std std-ref">ReflectometryReductionOneAuto v3</span></a>, which can be used from a python script or via the <a class="reference internal" href="../interfaces/reflectometry/ISIS%20Reflectometry.html#interface-isis-refl"><span class="std std-ref">ISIS Reflectometry Interface</span></a>. It currently only deals with specular reflection, but off-specular analysis is planned. It also currently only deals with point detectors or linear detectors, but 2D detectors are planned.</p>
<section id="specular-reflection">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Specular Reflection</a><a class="headerlink" href="#specular-reflection" title="Permalink to this heading">¶</a></h3>
<p>In an experiment, the reflected intensity, <span class="math notranslate nohighlight">\(I\)</span> (i.e. the number of neutrons received at the detector) is measured as a function of time-of-flight, <span class="math notranslate nohighlight">\(TOF\)</span>. The desired outcome of the reduction is a one-dimensional plot (summed over the detectors) of reflectivity normalised by an un-reflected beam, <span class="math notranslate nohighlight">\(\frac{I}{I_0}\)</span> against momentum transfer, <span class="math notranslate nohighlight">\(Q\)</span>. <span class="math notranslate nohighlight">\(\frac{I}{I_0}\)</span> is referred to as reflectivity and is dimensionless and by definition. Total reflection, below the critical edge is then by definition <span class="math notranslate nohighlight">\(\frac{I}{I_0} = 1\)</span></p>
<p>To achieve this, the input workspace in <span class="math notranslate nohighlight">\(TOF\)</span> is first converted to wavelength, <span class="math notranslate nohighlight">\(\lambda\)</span>, and normalised by some combination of monitors and direct beam transmission runs, that have all also been converted to <span class="math notranslate nohighlight">\(\lambda\)</span>. It is critical that the detector and monitor workspaces all have the same binning regarding number of bins and bin size in <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
<p>The workspace is summed over all detectors in the region of interest, using either constant-<span class="math notranslate nohighlight">\(\lambda\)</span> or constant-<span class="math notranslate nohighlight">\(Q\)</span> binning. The result is a one-dimensional array of <span class="math notranslate nohighlight">\(I\)</span> against <span class="math notranslate nohighlight">\(\lambda\)</span>. The summed workspace is converted to <span class="math notranslate nohighlight">\(Q\)</span> and rebinned to the required resolution, as determined either by the slits or the user. The <a class="reference internal" href="../algorithms/NRCalculateSlitResolution-v1.html#algm-nrcalculateslitresolution"><span class="std std-ref">NRCalculateSlitResolution v1</span></a> algorithm is used to calculate the slit resolution.</p>
<p>The resulting one-dimensional plot of <span class="math notranslate nohighlight">\(I\)</span> against <span class="math notranslate nohighlight">\(Q\)</span> is typically referred to as <code class="docutils literal notranslate"><span class="pre">IvsQ</span></code>. <a class="reference internal" href="../algorithms/ReflectometryReductionOneAuto-v3.html#algm-reflectometryreductiononeauto"><span class="std std-ref">ReflectometryReductionOneAuto v3</span></a> also outputs the unbinned workspace in <span class="math notranslate nohighlight">\(Q\)</span>, as well as the summed workspace in <span class="math notranslate nohighlight">\(\lambda\)</span>, and these are typically referred to as <code class="docutils literal notranslate"><span class="pre">IvsQ_unbinned</span></code> and <code class="docutils literal notranslate"><span class="pre">IvsLam</span></code> respectively.</p>
<p>A standard measurement will involve sample under certain conditions (temperature, magnetic field, etc) being measured at two or three different incident angles, <span class="math notranslate nohighlight">\(\theta_i\)</span>. This means that we typically end up with two or three <span class="math notranslate nohighlight">\(TOF\)</span> workspaces that are combined (stitched) and processed to give a single plot covering a larger range of <span class="math notranslate nohighlight">\(Q\)</span>. The stitching is achieved using the <a class="reference internal" href="../algorithms/Stitch1D-v3.html#algm-stitch1d"><span class="std std-ref">Stitch1D v3</span></a> and <a class="reference internal" href="../algorithms/Stitch1DMany-v1.html#algm-stitch1dmany"><span class="std std-ref">Stitch1DMany v1</span></a> algorithms.</p>
<p>The actual reduction is relatively simple and produces a simple one dimensional plot which can be saved as an ASCII file. However, there can be many files to deal with and we need to make sure that we process the correct runs together and with the correct parameters, transmission runs etc.</p>
<section id="divergent-beam">
<h4><a class="toc-backref" href="#id11" role="doc-backlink">Divergent Beam</a><a class="headerlink" href="#divergent-beam" title="Permalink to this heading">¶</a></h4>
<p>If the divergence of the input beam is significant, we need to take the variability in <span class="math notranslate nohighlight">\(\theta_i\)</span> and <span class="math notranslate nohighlight">\(\theta_f\)</span> into account. Consider a range of incident angles on a sample of fixed orientation:</p>
<figure class="align-center" id="id2">
<img alt="Diagram showing the divergent beam case" src="../_images/ISISReflectometry_divergent_beam_diagram.png" />
<figcaption>
<p><span class="caption-text">A range of incident angles from a divergent beam on a sample of fixed orientation <span class="math notranslate nohighlight">\(\theta_i\)</span>. The black lines show the expected beam and reflection directions, and the red lines show a divergent beam path and reflection.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The difference between the actual and expected beam directions is the same as that between the actual and expected reflection directions:</p>
<p><span class="math notranslate nohighlight">\(\phi = 2\theta_{det} - 2\theta_i\)</span></p>
<p>Therefore, <span class="math notranslate nohighlight">\(\theta_f\)</span> can be calculated as:</p>
<p><span class="math notranslate nohighlight">\(\theta_f = \theta_i + \phi = 2\theta_{det} - \theta_i\)</span></p>
<p>The effect of the divergence is that the data follow lines of constant-<span class="math notranslate nohighlight">\(Q\)</span>. Therefore we need to sum along lines of constant-<span class="math notranslate nohighlight">\(Q\)</span> rather than constant-<span class="math notranslate nohighlight">\(\lambda\)</span>. <a class="reference internal" href="../algorithms/ReflectometryReductionOneAuto-v3.html#algm-reflectometryreductiononeauto"><span class="std std-ref">ReflectometryReductionOneAuto v3</span></a> has an option to do this.</p>
<figure class="align-center" id="id3">
<img alt="Plot showing the measured intensity" src="../_images/ISISReflectometry_divergent_beam_measured.png" />
<figcaption>
<p><span class="caption-text">Measured intensity for each detector vs <span class="math notranslate nohighlight">\(TOF\)</span>. The data follow lines of constant <span class="math notranslate nohighlight">\(Q\)</span>.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id4">
<img alt="Plot showing the reduced data" src="../_images/ISISReflectometry_divergent_beam_result.png" />
<figcaption>
<p><span class="caption-text">The reduced data as a plot of <span class="math notranslate nohighlight">\(I\)</span> vs <span class="math notranslate nohighlight">\(Q\)</span>, showing the improved resolution when summing in <span class="math notranslate nohighlight">\(Q\)</span> rather than <span class="math notranslate nohighlight">\(\lambda\)</span></span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="non-flat-sample">
<h4><a class="toc-backref" href="#id12" role="doc-backlink">Non-Flat Sample</a><a class="headerlink" href="#non-flat-sample" title="Permalink to this heading">¶</a></h4>
<p>A bent sample causes variability in the reflected angle, <span class="math notranslate nohighlight">\(\theta_f\)</span>. It can be considered as a flat sample of variable orientation:</p>
<figure class="align-center" id="id5">
<img alt="Diagram showing the non-flat sample case" src="../_images/ISISReflectometry_non_flat_sample_diagram.png" />
<figcaption>
<p><span class="caption-text">Divergence in the reflected angle from a non-flat sample is considered as a flat sample of variable orientation. The black lines show the incident beam and the expected reflection direction with the sample horizon at <span class="math notranslate nohighlight">\(\theta_i\)</span>. The red line shows a divergent reflected beam, and the dotted blue line shows the related sample horizon.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The difference between the actual and expected reflection directions is:</p>
<p><span class="math notranslate nohighlight">\(\phi = 2\theta_{det} - 2\theta_i\)</span></p>
<p>Therefore, <span class="math notranslate nohighlight">\(\theta_f\)</span> can be calculated as:</p>
<p><span class="math notranslate nohighlight">\(\theta_f = \theta_i + \frac{\phi}{2} = \frac{2\theta_{det}}{2}\)</span></p>
<p>Similarly to the divergent beam case, the data should be summed along lines of constant-<span class="math notranslate nohighlight">\(Q\)</span> using the relevant options in <a class="reference internal" href="../algorithms/ReflectometryReductionOneAuto-v3.html#algm-reflectometryreductiononeauto"><span class="std std-ref">ReflectometryReductionOneAuto v3</span></a>.</p>
</section>
</section>
</section>
<section id="instruments">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Instruments</a><a class="headerlink" href="#instruments" title="Permalink to this heading">¶</a></h2>
<section id="isis-instruments">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">ISIS Instruments</a><a class="headerlink" href="#isis-instruments" title="Permalink to this heading">¶</a></h3>
<p>There are five reflectometry instruments at ISIS:</p>
<ul class="simple">
<li><p><em>Inter</em>: High-intensity reflectometer. Specialised for free liquid surfaces.</p></li>
<li><p><em>Offspec</em>: Polarised neutron reflectometer with optional polarisation analysis, using a high resolution position sensitive detector. Used to study magnetic ordering in and between the layers and surfaces of thin film materials.</p></li>
<li><p><em>Polref</em>: Polarised neutron reflectometer. Used to study magnetic ordering in and between the layers and surfaces of thin film materials.</p></li>
<li><p><em>Crisp</em>: Designed for studies of a wide range of interfacial phenomena.</p></li>
<li><p><em>Surf</em>: Optimised for higher flux and short wavelengths. Designed for liquid interface research.</p></li>
</ul>
</section>
<section id="detectors">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Detectors</a><a class="headerlink" href="#detectors" title="Permalink to this heading">¶</a></h3>
<p>Currently at ISIS we deal with two types of detector: point-detectors (e.g. Inter) or multi-/linear-detectors (e.g. Polref and Offspec). Note that most instruments have both point and linear detectors. We are expecting to add 2D detectors in the near future.</p>
<p>Because runs are performed at different incident angles, the <strong>detectors are moved</strong> between different runs. Some instruments (e.g. Inter) move detectors vertically, whereas others (Polref, Offspec) rotate them around the sample.</p>
<p>Historically, detector positions needed to be adjusted within the reflectometry reduction algorithms. The <a class="reference internal" href="../algorithms/SpecularReflectionPositionCorrect-v2.html#algm-specularreflectionpositioncorrect"><span class="std std-ref">SpecularReflectionPositionCorrect v2</span></a> algorithm deals with this. However, some instruments (e.g. Inter) now move detectors to the correct position on load, so correcting positions within the reflectometry algorithms is not required. This is the preferred approach going forward.</p>
</section>
<section id="instrument-definition-files">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Instrument Definition Files</a><a class="headerlink" href="#instrument-definition-files" title="Permalink to this heading">¶</a></h3>
<p>Mantid can handle instruments with different <strong>reference frames</strong> because it uses the beam direction, sample position, detector positions, etc. The reference frames currently used by ISIS reflectometry instruments are:</p>
<ul class="simple">
<li><p>Inter, Offspec, Crisp and Surf define the beam direction along the <span class="math notranslate nohighlight">\(z\)</span> axis and <em>Up</em> (perpendicular to the beam) along the <span class="math notranslate nohighlight">\(y\)</span> axis.</p></li>
<li><p>Polref defines the beam direction along the <span class="math notranslate nohighlight">\(x\)</span> axis and <em>Up</em> along the <span class="math notranslate nohighlight">\(z\)</span> axis.</p></li>
</ul>
<p>The way in which <strong>components are arranged</strong> in the IDF is different. Some instruments, such as Offspec, have a component “DetectorBench” that is the parent component of all the detectors. Others don’t have this component. This has to be taken into account when moving detectors.</p>
<p>Some of the instrument IDFs are set up such that detectors are at the correct <strong>position on loading</strong> a run. Some instruments are not be set up to do this yet, so <a class="reference internal" href="../algorithms/ReflectometryReductionOneAuto-v3.html#algm-reflectometryreductiononeauto"><span class="std std-ref">ReflectometryReductionOneAuto v3</span></a> has an option to correct detector positions using another algorithm, <a class="reference internal" href="../algorithms/SpecularReflectionPositionCorrect-v2.html#algm-specularreflectionpositioncorrect"><span class="std std-ref">SpecularReflectionPositionCorrect v2</span></a>. It is important that the detectors are in the correct position in order for Mantid algorithms to produce the correct results, otherwise some calculations (e.g. the conversion from <span class="math notranslate nohighlight">\(\lambda\)</span> to <span class="math notranslate nohighlight">\(Q\)</span>) will be wrong. There are plans to try and harmonise the IDF’s as much as possible.</p>
</section>
</section>
<section id="mantid">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Mantid</a><a class="headerlink" href="#mantid" title="Permalink to this heading">¶</a></h2>
<section id="algorithms">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Algorithms</a><a class="headerlink" href="#algorithms" title="Permalink to this heading">¶</a></h3>
<p>The main reduction algorithm is <a class="reference internal" href="../algorithms/ReflectometryReductionOneAuto-v3.html#algm-reflectometryreductiononeauto"><span class="std std-ref">ReflectometryReductionOneAuto v3</span></a>. This sets a lot of the input properties from defaults in the instrument parameter file. It must also populate some input properties so that they can be updated in the GUI (this has to work both for single period datasets and multi period datasets). This algorithm is a wrapper around <a class="reference internal" href="../algorithms/ReflectometryReductionOne-v2.html#algm-reflectometryreductionone"><span class="std std-ref">ReflectometryReductionOne v2</span></a>, which actually does the work. This arrangement seems to be unusual in Mantid.</p>
<p><a class="reference internal" href="../algorithms/SpecularReflectionPositionCorrect-v2.html#algm-specularreflectionpositioncorrect"><span class="std std-ref">SpecularReflectionPositionCorrect v2</span></a> can be used to correct detector positions if they are not at the correct position when loaded. It can shift them vertically or rotate then around the sample position. This algorithm is called as a child by <a class="reference internal" href="../algorithms/ReflectometryReductionOneAuto-v3.html#algm-reflectometryreductiononeauto"><span class="std std-ref">ReflectometryReductionOneAuto v3</span></a>.</p>
<p>Related to <a class="reference internal" href="../algorithms/ReflectometryReductionOne-v2.html#algm-reflectometryreductionone"><span class="std std-ref">ReflectometryReductionOne v2</span></a> and <a class="reference internal" href="../algorithms/ReflectometryReductionOneAuto-v3.html#algm-reflectometryreductiononeauto"><span class="std std-ref">ReflectometryReductionOneAuto v3</span></a> we also have <a class="reference internal" href="../algorithms/CreateTransmissionWorkspace-v2.html#algm-createtransmissionworkspace"><span class="std std-ref">CreateTransmissionWorkspace v2</span></a> and <a class="reference internal" href="../algorithms/CreateTransmissionWorkspaceAuto-v2.html#algm-createtransmissionworkspaceauto"><span class="std std-ref">CreateTransmissionWorkspaceAuto v2</span></a>, which converts transmission run(s) to wavelength and stitches transmission runs together when two are provided.</p>
<p><a class="reference internal" href="../algorithms/Stitch1DMany-v1.html#algm-stitch1dmany"><span class="std std-ref">Stitch1DMany v1</span></a> does the work to stitch multiple runs together, which is quite a complicated operation.</p>
<p><a class="reference internal" href="../algorithms/ConvertToReflectometryQ-v2.html#algm-converttoreflectometryq"><span class="std std-ref">ConvertToReflectometryQ v2</span></a>: This algorithm is generally used to examine off-specular scattering. The input is a workspace in wavelength, and the output is a <span class="math notranslate nohighlight">\(QxQz\)</span> map (or <span class="math notranslate nohighlight">\(KiKf\)</span> or <span class="math notranslate nohighlight">\(PiPf\)</span>). It doesn’t normalize by monitors, transmission run, etc (in fact, scientists typically run <a class="reference internal" href="../algorithms/ReflectometryReductionOneAuto-v3.html#algm-reflectometryreductiononeauto"><span class="std std-ref">ReflectometryReductionOneAuto v3</span></a> prior to running this algorithm, so that they obtain the normalized intensity). This algorithm is generally used to examine off-specular scattering.</p>
</section>
<section id="interface">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Interface</a><a class="headerlink" href="#interface" title="Permalink to this heading">¶</a></h3>
<p>The <a class="reference internal" href="../interfaces/reflectometry/ISIS%20Reflectometry.html#interface-isis-refl"><span class="std std-ref">ISIS Reflectometry Interface</span></a> provides a graphical front-end for the <a class="reference internal" href="../algorithms/ReflectometryReductionOneAuto-v3.html#algm-reflectometryreductiononeauto"><span class="std std-ref">ReflectometryReductionOneAuto v3</span></a> algorithm. It includes the facility to:</p>
<ul class="simple">
<li><p>batch process all runs from an experiment (or a selected subset);</p></li>
<li><p>apply default settings, which can be overridden on a per-run basis;</p></li>
<li><p>process data in histogram or event modes;</p></li>
<li><p>output processing steps to an IPython notebook; and</p></li>
<li><p>output reduced data to ASCII files.</p></li>
</ul>
<p>See the <a class="reference internal" href="../interfaces/reflectometry/ISIS%20Reflectometry.html#interface-isis-refl"><span class="std std-ref">full documentation</span></a> for more information.</p>
<p><strong>Category</strong>: <a class="reference external" href="categories/Techniques.html">Techniques</a></p>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ISISPowder-Workflows-v1.html" title="Previous Chapter: ISIS Powder Diffraction Scripts Workflow Diagrams"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; ISIS Powder D...</span>
    </a>
  </li>
  <li>
    <a href="PolarisedDiffractionILL.html" title="Next Chapter: Data reduction for D7 instrument at the ILL"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Data reductio... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>