<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Asymmetric Pearson VII</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="BSpline" href="BSpline.html" />
    <link rel="prev" title="ActivationmeV" href="ActivationmeV.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Fit Functions</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">Asymmetric Pearson VII</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="asymmetric-pearson-vii">
<span id="func-asymmetricpearsonvii"></span><h1>Asymmetric Pearson VII<a class="headerlink" href="#asymmetric-pearson-vii" title="Permalink to this heading">¶</a></h1>
<section id="description">
<span id="index-0"></span><h2>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>The asymmetric Pearson VII function (sometimes it is also referred to as the split-Pearson VII function) is a function that combines
two Pearson VII distributions so to fit sharp peak curves <a class="footnote-reference brackets" href="#id4" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. It is useful for analysis of X-ray diffraction peaks which consist of two separable components.</p>
<p>In one of the representations, the asymmetric Pearson VII function <span class="math notranslate nohighlight">\(A(x)\)</span> can be written as a superposition of the “left” and “right” Pearson VII functions <span class="math notranslate nohighlight">\(P_L(x)\)</span> and <span class="math notranslate nohighlight">\(P_R(x)\)</span> <a class="footnote-reference brackets" href="#id5" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>,</p>
<div class="math notranslate nohighlight">
\[A(x) = P_L(x) \, \theta(x_0 - x) + P_R(x) \, \theta(x - x_0) = P_L(x) \, \theta(x_0 - x) + P_R(x) \, \left(1 - \theta(x_0 - x) \right),\]</div>
<p>where <span class="math notranslate nohighlight">\(x_0\)</span> is the value when the function changes between the left and right Pearson VII, and this is usually chosen to be the peak centre. Moreover, <span class="math notranslate nohighlight">\(\theta\)</span> denotes the Heavyside step function with <span class="math notranslate nohighlight">\(\theta(y \ge 0) = 1\)</span> and <span class="math notranslate nohighlight">\(\theta(y &lt; 0)=0\)</span>, and <span class="math notranslate nohighlight">\(P(x)\)</span> denotes the Pearson VII function. This function takes four additional parameters and in general is defined as</p>
<div class="math notranslate nohighlight">
\[P(x, h, x_0, \Gamma, m) = \frac{h}{\left(1 + \left[ \frac{2 (x-x_0) \sqrt{2^{1/m}-1}}{\Gamma} \right]^2 \right)^m} \, .\]</div>
<p>The four free parameters that the Pearson VII function <span class="math notranslate nohighlight">\(P(x, h, x_0, \Gamma, m)\)</span> takes represent the following quantities</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(h\)</span> - the height of the peak</p></li>
<li><p><span class="math notranslate nohighlight">\(x_0\)</span> - the location (centre) of the peak</p></li>
<li><p><span class="math notranslate nohighlight">\(\Gamma\)</span> - the full width at half maximum</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> - the function’s shape parameter</p></li>
</ul>
<p>The parameter <span class="math notranslate nohighlight">\(m\)</span> can take values in the range <span class="math notranslate nohighlight">\([0, \infty)\)</span> and it determines whether <span class="math notranslate nohighlight">\(P(x, h, x_0, \Gamma, m)\)</span> is more close to a Lorentzian or a Gaussian. When <span class="math notranslate nohighlight">\(m=1\)</span> it’s a Lorentzian, whereas when <span class="math notranslate nohighlight">\(m \rightarrow \infty\)</span> it’s a Gaussian. The “left” and “right” Pearson VII functions <span class="math notranslate nohighlight">\(P_L(x)\)</span> and <span class="math notranslate nohighlight">\(P_R(x)\)</span> take identical parameters <span class="math notranslate nohighlight">\(h, x_0, \Gamma\)</span>, but diffent <span class="math notranslate nohighlight">\(m\)</span>, so that</p>
<div class="math notranslate nohighlight">
\[P_L \equiv P(x, h, x_0, \Gamma, m_L),\]</div>
<div class="math notranslate nohighlight">
\[P_R \equiv P(x, h, x_0, \Gamma, m_R).\]</div>
<p>In other words, it is assumed that the asymmetric Pearson VII function uses two halves of the Pearson VII with a common  peak hight, peak centre, and full width at half maximum. As a result, the asymmetric Pearson VII distribution takes five parameters: <span class="math notranslate nohighlight">\(h, x_0, \Gamma, m_L, m_R\)</span>. For the sake of stability of the numerical implementation of asymmetric Pearson VII distribution in Mantid, one operates with the weight parameter <span class="math notranslate nohighlight">\(w \equiv 1/\Gamma\)</span>, i. e. <span class="math notranslate nohighlight">\(A = A(x, h, x_0, w, m_L, m_R)\)</span>.</p>
</section>
<section id="analytic-derivatives">
<h2>Analytic Derivatives<a class="headerlink" href="#analytic-derivatives" title="Permalink to this heading">¶</a></h2>
<p>Below is the list of analytic derivatives of <span class="math notranslate nohighlight">\(P = P(x, h, x_0, w, m)\)</span> with respect to <span class="math notranslate nohighlight">\(h, x_0, w, m\)</span>:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial P}{\partial h} = \frac{1}{d^m},\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial P}{\partial x_0} = \frac{8 h m (x - x_0) \left( 2^{1/m} - 1 \right) w^2}{d^{m + 1}},\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial P}{\partial w} = - \frac{8 h m (x - x_0)^2 \left( 2^{1/m} - 1 \right) w}{d^{m + 1}},\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial P}{\partial m} = \frac{h}{d^{m + 1}} \left[ \frac{4 (x - x_0)^2 w^2 2^{1/m} \ln 2}{m d} - \ln \frac{1}{d} \right],\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[d \equiv \frac{1}{\left( 1 + 4 \left( x - x_0 \right)^2 \left( 2^{1/m} - 1 \right) w^2 \right)} \, .\]</div>
</section>
<section id="asymptotic-behavior">
<h2>Asymptotic Behavior<a class="headerlink" href="#asymptotic-behavior" title="Permalink to this heading">¶</a></h2>
<p>The numerical calculation of  <span class="math notranslate nohighlight">\(P(x, h, x_0, w, m)\)</span> and its partial derivatives is complicated by singularities as <span class="math notranslate nohighlight">\(m \rightarrow 0\)</span>. For this reason, one needs to operate with a limit of the corresponding expressions:</p>
<div class="math notranslate nohighlight">
\[\lim_{m \rightarrow 0} P(x, h, x_0, w, m) = \frac{h}{2} \, ,\]</div>
<div class="math notranslate nohighlight">
\[\lim_{m \rightarrow 0} \, \frac{\partial P(x, h, x_0, w, m)}{\partial h} = \frac{1}{2} \, ,\]</div>
<div class="math notranslate nohighlight">
\[\lim_{m \rightarrow 0} \, \frac{\partial P(x, h, x_0, w, m)}{\partial x_0} = 0 \, ,\]</div>
<div class="math notranslate nohighlight">
\[\lim_{m \rightarrow 0} \, \frac{\partial P(x, h, x_0, w, m)}{\partial w} = 0 \, ,\]</div>
<div class="math notranslate nohighlight">
\[\lim_{m \rightarrow 0} \, \frac{\partial P(x, h, x_0, w, m)}{\partial m} = - \frac{h}{2} \, \ln \left[ 4(x-x_0)^2 w^2 \right] \, .\]</div>
<p>The figure below illustrates the comparison of shapes between various symmetric <a class="footnote-reference brackets" href="#id6" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> and asymmetric Pearson VII distributions plotted for <span class="math notranslate nohighlight">\(h_0 = 0.7297\)</span>, <span class="math notranslate nohighlight">\(x_{00} = 0.0035\)</span>, <span class="math notranslate nohighlight">\(w_0 = 5.7215\)</span>.</p>
<figure class="align-default">
<img alt="AsymmetricPearsonVII.png" src="../../_images/AsymmetricPearsonVII.png" />
</figure>
</section>
<section id="properties-fitting-parameters">
<h2>Properties (fitting parameters)<a class="headerlink" href="#properties-fitting-parameters" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PeakHeight</p></td>
<td><p>1.0</p></td>
<td><p>Hight of the peak</p></td>
</tr>
<tr class="row-odd"><td><p>PeakCentre</p></td>
<td><p>0.0</p></td>
<td><p>Location of the peak</p></td>
</tr>
<tr class="row-even"><td><p>Width</p></td>
<td><p>0.1</p></td>
<td><p>Full width at half maximum</p></td>
</tr>
<tr class="row-odd"><td><p>LeftShape</p></td>
<td><p>1.0</p></td>
<td><p>Left shape parameter</p></td>
</tr>
<tr class="row-even"><td><p>RightShape</p></td>
<td><p>1.0</p></td>
<td><p>Right shape parameter</p></td>
</tr>
</tbody>
</table>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id4" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Gupta, S. K. Peak Decomposition using Pearson Type VII Function, <a class="reference external" href="https://doi.org/10.1107/S0021889897011047">J. Appl. Cryst. (1998). 31, 474-476</a></p>
</aside>
<aside class="footnote brackets" id="id5" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Lifshin, E. (Ed.). (1999), X-ray Characterization of Materials, WILEY-VCH, <a class="reference external" href="https://doi.org/10.1002/9783527613748">https://doi.org/10.1002/9783527613748</a></p>
</aside>
<aside class="footnote brackets" id="id6" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="http://pd.chem.ucl.ac.uk/pdnn/peaks/pvii.htm">http://pd.chem.ucl.ac.uk/pdnn/peaks/pvii.htm</a></p>
</aside>
</aside>
<p><strong>Categories</strong>: <a class="reference external" href="categories/FitFunctions.html">FitFunctions</a> | <a class="reference external" href="categories/XrayDiffraction.html">XrayDiffraction</a></p>
</section>
<section id="source">
<h2>Source<a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/CurveFitting/inc/MantidCurveFitting/Functions/AsymmetricPearsonVII.h">AsymmetricPearsonVII.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/aa570da6f199141cd8ad987bf9b9b9281a1b5e33/Framework/CurveFitting/src/Functions/AsymmetricPearsonVII.cpp">AsymmetricPearsonVII.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ActivationmeV.html" title="Previous Chapter: ActivationmeV"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; ActivationmeV</span>
    </a>
  </li>
  <li>
    <a href="BSpline.html" title="Next Chapter: BSpline"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">BSpline &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>