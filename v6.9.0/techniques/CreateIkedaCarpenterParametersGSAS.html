<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Create Ikeda Carpenter Parameters GSAS</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=5b08953a"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Crystal Field Examples" href="CrystalField.html" />
    <link rel="prev" title="Create Ikeda Carpenter Parameters Fullprof" href="CreateIkedaCarpenterParametersFullprof.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.9</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Techniques</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">Create Ikeda Carpenter Parameters GSAS</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="create-ikeda-carpenter-parameters-gsas">
<span id="createikedacarpenterparametersgsas"></span><h1>Create Ikeda Carpenter Parameters GSAS<a class="headerlink" href="#create-ikeda-carpenter-parameters-gsas" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#annotating-gsas-gem-instrument-parameter-file" id="id2">Annotating GSAS GEM instrument parameter file</a></p></li>
<li><p><a class="reference internal" href="#converting-gsas-parameters-into-mantid-parameters" id="id3">Converting GSAS parameters into Mantid parameters</a></p></li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>Here we show how to take a Fullprof parameter file containing <a class="reference internal" href="../fitting/fitfunctions/IkedaCarpenterPV.html#func-ikedacarpenterpv"><span class="std std-ref">Ikeda-Carpenter-Pseudo-Voigt</span></a> parameters and translate these
into equivalent parameters for the Mantid implementation of this function.</p>
</section>
<section id="annotating-gsas-gem-instrument-parameter-file">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Annotating GSAS GEM instrument parameter file</a><a class="headerlink" href="#annotating-gsas-gem-instrument-parameter-file" title="Link to this heading">¶</a></h2>
<p>This GSAS file is one generated for the GEM instrument at ISIS.
The syntax is described in some detail from page 221 in the GSAS Technical Manual in section entitled “Instrument Parameter File”.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>COMM  Y2O3  +  Si  cycle 13/2
INS   BANK  6
INS   HTYPE   PNTR
INS  1 ICONS    746.96     -0.24      3.04
INS  1BNKPAR    2.3696      9.39      0.00    .00000     .3000    1    1
INS  1I ITYP    0    1.000     25.000       2
INS  1PRCF      2   15   0.00100
INS  1PRCF 1   0.000000E+00   0.200000E+00   0.317927E+02   0.544205E+02
INS  1PRCF 2   0.000000E+00   0.176802E+03   0.000000E+00   0.000000E+00
INS  1PRCF 3   0.000000E+00   0.000000E+00   0.000000E+00   0.000000E+00
INS  1PRCF 4   0.000000E+00   0.000000E+00   0.000000E+00
INS  2 ICONS   1482.98      0.98     12.65
INS  2BNKPAR    1.7714     17.98      0.00    .00000     .3000    1    1
INS  2I ITYP    0    1.000     21.000       2
INS  2PRCF      2   15   0.00100
INS  2PRCF 1   0.000000E+00   0.200000E+00   0.317927E+02   0.544205E+02
INS  2PRCF 2   0.000000E+00   0.295572E+03  -0.134662E+01   0.000000E+00
INS  2PRCF 3   0.361229E+01   0.000000E+00   0.000000E+00   0.000000E+00
INS  2PRCF 4   0.000000E+00   0.000000E+00   0.000000E+00
INS  3 ICONS   2813.67      1.41      6.22
INS  3BNKPAR    1.4450     34.96      0.00    .00000     .3000    1    1
INS  3I ITYP    0    1.000     20.000       2
INS  3PRCF      2   15   0.00100
INS  3PRCF 1   0.000000E+00   0.200000E+00   0.317927E+02   0.544205E+02
INS  3PRCF 2   0.000000E+00   0.280289E+03   0.272947E+01   0.000000E+00
INS  3PRCF 3   0.444792E+01   0.000000E+00   0.000000E+00   0.000000E+00
INS  3PRCF 4   0.000000E+00   0.000000E+00   0.000000E+00
INS  4 ICONS   4844.99     -1.73     -1.50
INS  4BNKPAR    1.2212     63.62      0.00    .00000     .3000    1    1
INS  4I ITYP    0    1.000     20.000       2
INS  4PRCF      2   15   0.00100
INS  4PRCF 1   0.000000E+00   0.200000E+00   0.317927E+02   0.544205E+02
INS  4PRCF 2   0.000000E+00   0.202940E+03   0.446899E+01   0.000000E+00
INS  4PRCF 3   0.416948E+01   0.000000E+00   0.000000E+00   0.000000E+00
INS  4PRCF 4   0.000000E+00   0.000000E+00   0.000000E+00
INS  5 ICONS   6662.11     -4.58     -2.30
INS  5BNKPAR    1.3793      91.37     0.00    .00000     .3000    1    1
INS  5I ITYP    0    1.000     18.000       2
INS  5PRCF      2   15   0.00100
INS  5PRCF 1   0.000000E+00   0.200000E+00   0.317927E+02   0.544205E+02
INS  5PRCF 2   0.000000E+00   0.111084E+03  -0.175113E+01   0.000000E+00
INS  5PRCF 3   0.284103E+01   0.000000E+00   0.000000E+00   0.000000E+00
INS  5PRCF 4   0.000000E+00   0.000000E+00   0.000000E+00
INS  6 ICONS   9084.64     -8.58     -2.85
INS  6BNKPAR    1.3554     154.46     0.00    .00000     .3000    1    1
</pre></div>
</div>
<p>The annotation of this file is as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>COMM  Y2O3  +  Si  cycle 13/2
</pre></div>
</div>
<p>Is a comment.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>INS   BANK  6
</pre></div>
</div>
<p>Tells that this file contains parameters for 6 different banks, where a bank can be mean any collection of detector on an instrument.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>INS   HTYPE   PNTR
</pre></div>
</div>
<p>Specify histogram type used in obtaining the fitting paramters.
Here PNTR, which is <code class="docutils literal notranslate"><span class="pre">P</span></code> for powder data, <code class="docutils literal notranslate"><span class="pre">N</span></code> for neutron data, <code class="docutils literal notranslate"><span class="pre">T</span></code> for time-of-flight data, and the last letter is a status flag,
<code class="docutils literal notranslate"><span class="pre">R</span></code> stands for ‘read powder data’. Initially we may have a test in Mantid that checks if it is this type and if not tells the user that this is not supported.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>INS  1 ICONS    746.96     -0.24      3.04
INS  1BNKPAR    2.3696      9.39      0.00    .00000     .3000    1    1
INS  1I ITYP    0    1.000     25.000       2
</pre></div>
</div>
<p>These three lines are not relevant to Mantid.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>INS  1PRCF      2   15   0.00100
</pre></div>
</div>
<p>This tells you which profile function, <code class="docutils literal notranslate"><span class="pre">NTYP</span></code>, this file contains parameters for.
Here <code class="docutils literal notranslate"><span class="pre">NTYP=2</span></code>, which is the GSAS Ikeda-Carpenter-pseudo-voigt function described from page 144 in the GSAS Technical Manual.
The following number, <code class="docutils literal notranslate"><span class="pre">15</span></code>, is the number of parameters of this function and the last number, <code class="docutils literal notranslate"><span class="pre">0.00100</span></code>, is not relevant to Mantid.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>INS  1PRCF 1   0.000000E+00   0.200000E+00   0.317927E+02   0.544205E+02
INS  1PRCF 2   0.000000E+00   0.176802E+03   0.000000E+00   0.000000E+00
INS  1PRCF 3   0.000000E+00   0.000000E+00   0.000000E+00   0.000000E+00
INS  1PRCF 4   0.000000E+00   0.000000E+00   0.000000E+00
</pre></div>
</div>
<p>These lines are the actual the 15 GSAS parameters for this profile function.
From page 147 in the GSAS manual these 15 parameters are, in the order listed, the values of:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&quot;alp-0&quot;, &quot;alp-1&quot;, &quot;beta&quot;,  &quot;switch&quot;,
&quot;sig-0&quot;, &quot;sig-1&quot;, &quot;sig-2&quot;, &quot;gam-0&quot;,
&quot;gam-1&quot;, &quot;gam-2&quot;, &quot;stec&quot;,  &quot;ptec&quot;,
&quot;difc&quot;,  &quot;difa&quot; &amp; &quot;zero&quot;.
</pre></div>
</div>
<p>The rest of the file is a repeat for the remaining 5 banks.</p>
</section>
<section id="converting-gsas-parameters-into-mantid-parameters">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Converting GSAS parameters into Mantid parameters</a><a class="headerlink" href="#converting-gsas-parameters-into-mantid-parameters" title="Link to this heading">¶</a></h2>
<p>From comparing the formula for the fitting function <a class="reference internal" href="../fitting/fitfunctions/IkedaCarpenterPV.html#func-ikedacarpenterpv"><span class="std std-ref">IkedaCarpenterPV</span></a> with formulas in the
GSAS Technical Manual the conversion equations are estimated to be:</p>
<div class="math notranslate nohighlight">
\[Alpha0 = alp \mbox{-}0\]</div>
<div class="math notranslate nohighlight">
\[Alpha1 = alp \mbox{-}1\]</div>
<div class="math notranslate nohighlight">
\[Beta0 = beta\]</div>
<div class="math notranslate nohighlight">
\[Kappa = switch\]</div>
<div class="math notranslate nohighlight">
\[SigmaSquared = sig \mbox{-}0 + sig \mbox{-}1 * d^2 + sig \mbox{-}2 * d^4\]</div>
<div class="math notranslate nohighlight">
\[Gamma = gam \mbox{-}0 + gam \mbox{-}1 * d + gam \mbox{-}2 * d^2\]</div>
<p>Where <span class="math notranslate nohighlight">\(d\)</span> is the dSpacing at the centre of the peak.</p>
<p>Note for now I have ignored GSAS parameters <code class="docutils literal notranslate"><span class="pre">stec</span></code> and <code class="docutils literal notranslate"><span class="pre">ptec</span></code>.
In code it should be checked that these are zero and if not a warning returned to the user.
I believe the remaining three parameter <code class="docutils literal notranslate"><span class="pre">difc</span></code>, <code class="docutils literal notranslate"><span class="pre">difa</span></code> and <code class="docutils literal notranslate"><span class="pre">zero</span></code> can be ignored for the exercise here.</p>
<p>The syntax for a Mantid parameter file is described <a class="reference internal" href="../concepts/InstrumentDefinitionFile.html#instrumentdefinitionfile"><span class="std std-ref">here</span></a>,
in particular look for the section on fitting <a class="reference internal" href="../concepts/InstrumentDefinitionFile.html#using-parameter"><span class="std std-ref">parameter</span></a> on that page.</p>
<p>So the translation of the example above for bank 1 into <a class="reference internal" href="../fitting/fitfunctions/IkedaCarpenterPV.html#func-ikedacarpenterpv"><span class="std std-ref">IkedaCarpenterPV</span></a> parameters gives:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;parameter name=&quot;IkedaCarpenterPV:Alpha0&quot; type=&quot;fitting&quot;&gt;
  &lt;formula eq=&quot;0.0&quot; result-unit=&quot;TOF&quot;/&gt;
  &lt;fixed /&gt;
&lt;/parameter&gt;
&lt;parameter name=&quot;IkedaCarpenterPV:Alpha1&quot; type=&quot;fitting&quot;&gt;
  &lt;formula eq=&quot;0.200000&quot; result-unit=&quot;TOF&quot;/&gt;
  &lt;fixed /&gt;
&lt;/parameter&gt;
&lt;parameter name=&quot;IkedaCarpenterPV:Beta0&quot; type=&quot;fitting&quot;&gt;
  &lt;formula eq=&quot;31.7927&quot; result-unit=&quot;TOF&quot;/&gt;
  &lt;fixed /&gt;
&lt;/parameter&gt;
&lt;parameter name=&quot;IkedaCarpenterPV:Kappa&quot; type=&quot;fitting&quot;&gt;
  &lt;formula eq=&quot;54.4205&quot;/&gt;
  &lt;fixed /&gt;
&lt;/parameter&gt;
&lt;parameter name=&quot;IkedaCarpenterPV:SigmaSquared&quot; type=&quot;fitting&quot;&gt;
  &lt;formula eq=&quot;0.0 + 176.802*centre^2 + 0.0*centre^4&quot; unit=&quot;dSpacing&quot; result-unit=&quot;TOF^2&quot;/&gt;
&lt;/parameter&gt;
&lt;parameter name=&quot;IkedaCarpenterPV:Gamma&quot; type=&quot;fitting&quot;&gt;
  &lt;formula eq=&quot;0.0 + 0.0*centre + 0.0*centre^2&quot; unit=&quot;dSpacing&quot; result-unit=&quot;TOF&quot;/&gt;
&lt;/parameter&gt;
</pre></div>
</div>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="CreateIkedaCarpenterParametersFullprof.html" title="Previous Chapter: Create Ikeda Carpenter Parameters Fullprof"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Create Ikeda ...</span>
    </a>
  </li>
  <li>
    <a href="CrystalField.html" title="Next Chapter: Crystal Field Examples"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Crystal Field... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>