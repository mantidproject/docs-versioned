<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SaveHKL v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=5b08953a"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SaveHKLCW v1" href="SaveHKLCW-v1.html" />
    <link rel="prev" title="SaveGSSCW v1" href="SaveGSSCW-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.9</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">SaveHKL v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="savehkl-v1">
<span id="algm-savehkl"></span><span id="algm-savehkl-v1"></span><h1>SaveHKL v1<a class="headerlink" href="#savehkl-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id3">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id4">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id5">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id6">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id7">Usage</a></p></li>
<li><p><a class="reference internal" href="#references" id="id8">References</a></p></li>
<li><p><a class="reference internal" href="#source" id="id9">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Save a PeaksWorkspace to a ASCII .hkl file.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="LoadHKL-v1.html#algm-loadhkl"><span class="std std-ref">LoadHKL</span></a>, <a class="reference internal" href="SaveHKLCW-v1.html#algm-savehklcw"><span class="std std-ref">SaveHKLCW</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p>PeaksWorkspace</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>An input PeaksWorkspace.</p></td>
</tr>
<tr class="row-odd"><td><p>ScalePeaks</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>1</p></td>
<td><p>Multiply FSQ and sig(FSQ) by scaleFactor</p></td>
</tr>
<tr class="row-even"><td><p>MinDSpacing</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Minimum d-spacing (Angstroms)</p></td>
</tr>
<tr class="row-odd"><td><p>MinWavelength</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>Minimum wavelength (Angstroms)</p></td>
</tr>
<tr class="row-even"><td><p>MaxWavelength</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>100</p></td>
<td><p>Maximum wavelength (Angstroms)</p></td>
</tr>
<tr class="row-odd"><td><p>AppendFile</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Append to file if true. Use same corrections as file. If false, new file (default).</p></td>
</tr>
<tr class="row-even"><td><p>ApplyAnvredCorrections</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Apply anvred corrections to peaks if true. If false, no corrections during save (default).</p></td>
</tr>
<tr class="row-odd"><td><p>LinearScatteringCoef</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Linear scattering coefficient in 1/cm if not set with SetSampleMaterial</p></td>
</tr>
<tr class="row-even"><td><p>LinearAbsorptionCoef</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Linear absorption coefficient at 1.8 Angstroms in 1/cm if not set with SetSampleMaterial</p></td>
</tr>
<tr class="row-odd"><td><p>Radius</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Radius of the sample in centimeters</p></td>
</tr>
<tr class="row-even"><td><p>PowerLambda</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>4</p></td>
<td><p>Power of lambda</p></td>
</tr>
<tr class="row-odd"><td><p>SpectraFile</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Spectrum data read from a spectrum file. Allowed extensions: [‘.dat’]</p></td>
</tr>
<tr class="row-even"><td><p>Filename</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Path to an hkl file to save. Allowed extensions: [‘.hkl’]</p></td>
</tr>
<tr class="row-odd"><td><p>SortBy</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Sort the histograms by bank, run number or both (default). Allowed values: [‘Bank’, ‘RunNumber’, ‘’]</p></td>
</tr>
<tr class="row-even"><td><p>MinIsigI</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The minimum I/sig(I) ratio</p></td>
</tr>
<tr class="row-odd"><td><p>WidthBorder</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Width of border of detectors</p></td>
</tr>
<tr class="row-even"><td><p>MinIntensity</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>The minimum Intensity</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p>PeaksWorkspace</p></td>
<td><p>SaveHKLOutput</p></td>
<td><p>Output PeaksWorkspace</p></td>
</tr>
<tr class="row-even"><td><p>HKLDecimalPlaces</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Number of decimal places for fractional HKL.  Default is integer HKL.</p></td>
</tr>
<tr class="row-odd"><td><p>DirectionCosines</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Extra columns (22 total) in file if true for direction cosines. If false, original 14 columns (default).</p></td>
</tr>
<tr class="row-even"><td><p>UBFilename</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Path to an ISAW-style UB matrix text file only needed for DirectionCosines if workspace does not have lattice. Allowed extensions: [‘.mat’, ‘.ub’, ‘.txt’]</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>SaveHKL outputs the peaks with corrections applied in a format
that works successfully in GSAS and SHELX. Peaks that have not been
integrated and also peaks that were not indexed are removed.</p>
<p><cite>hklFile.write(‘%4d%4d%4d%8.2f%8.2f%4d%8.4f%7.4f%7d%7d%7.4f%4d%9.5f%9.4f\n’%
(H, K, L, FSQ, SIGFSQ, hstnum, WL, TBAR, CURHST, SEQNUM, TRANSMISSION,
DN, TWOTH, DSP))</cite></p>
<p>HKL is flipped by -1 due to different q convention in ISAW vs Mantid.</p>
<p>FSQ = integrated intensity of peak (scaled)</p>
<p>SIGFSQ = sigma from integrating peak</p>
<p>hstnum = number of sample orientation (starting at 1)</p>
<p>WL = wavelength of peak</p>
<p>TBAR = output of absorption correction (-log(transmission)/mu)</p>
<p>CURHST = run number of sample</p>
<p>SEQNUM = peak number (unique number for each peak in file)</p>
<p>TRANSMISSION = output of absorption correction (exp(-mu*tbar))</p>
<p>DN = detector bank number</p>
<p>TWOTH = two-theta scattering angle</p>
<p>DSP = d-Spacing of peak (Angstroms)/TR</p>
<p>Last line must have all 0’s</p>
<p>Direction cosines are required for certain absorption and extinction corrections. They are calculated according to <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>
and are the dot products of the scattered and reverse incident beam directions with the direction of the reciprocal
lattice vectors. The components are interleaved starting with the reverse incident part.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Example - a simple example of running SaveHKL.</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;MyPeaks.hkl&quot;</span><span class="p">)</span>

<span class="c1">#load a peaks workspace from file</span>
<span class="n">peaks</span> <span class="o">=</span> <span class="n">LoadIsawPeaks</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Peaks5637.integrate&#39;</span><span class="p">)</span>
<span class="n">SaveHKL</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
<p><strong>Example - an example of running SaveHKL with sorting and filtering options.</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="c1">#load a peaks workspace from file</span>
<span class="n">peaks</span> <span class="o">=</span> <span class="n">LoadIsawPeaks</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Peaks5637.integrate&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of peaks in table </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">peaks</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()))</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;MyPeaks.hkl&quot;</span><span class="p">)</span>
<span class="n">SaveHKL</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">MinWavelength</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">MaxWavelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">MinDSpacing</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">SortBy</span><span class="o">=</span><span class="s1">&#39;Bank&#39;</span><span class="p">)</span>

<span class="n">peaks</span> <span class="o">=</span> <span class="n">LoadHKL</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of peaks in table </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">peaks</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Number of peaks in table 434
Number of peaks in table 234
</pre></div>
</div>
<p><strong>Example - SaveHKL with shape from SetSample</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;MyPeaks.hkl&quot;</span><span class="p">)</span>

<span class="c1"># load a peaks workspace from file</span>
<span class="n">peaks</span> <span class="o">=</span> <span class="n">LoadIsawPeaks</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;SXD23767.peaks&#39;</span><span class="p">)</span>
<span class="n">SetSample</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span>
          <span class="n">Geometry</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Shape&#39;</span><span class="p">:</span> <span class="s1">&#39;Cylinder&#39;</span><span class="p">,</span> <span class="s1">&#39;Height&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>
                    <span class="s1">&#39;Radius&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                    <span class="s1">&#39;Center&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]},</span>
          <span class="n">Material</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ChemicalFormula&#39;</span><span class="p">:</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;SampleNumberDensity&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
<span class="n">SaveHKL</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</section>
<section id="references">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">References</a><a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<ol class="upperalpha simple">
<li><p>Katrusiak, <em>Absorption Correction for Crystal-Environment Attachments from Direction Cosines</em>, Zeitschrift für Kristallographie - Crystalline Materials, <strong>216</strong> (2001) 646–647. doi: <a class="reference external" href="http://dx.doi.org/10.1524/zkri.216.12.646.22488">10.1524/zkri.216.12.646.22488</a></p></li>
</ol>
</aside>
</aside>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Crystal/DataHandling.html">Crystal\DataHandling</a> | <a class="reference external" href="categories/DataHandling/Text.html">DataHandling\Text</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/66c74f87d9b779695dc85b538bc48767c5975b19/Framework/Crystal/inc/MantidCrystal/SaveHKL.h">SaveHKL.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/66c74f87d9b779695dc85b538bc48767c5975b19/Framework/Crystal/src/SaveHKL.cpp">SaveHKL.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="SaveGSSCW-v1.html" title="Previous Chapter: SaveGSSCW v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SaveGSSCW v1</span>
    </a>
  </li>
  <li>
    <a href="SaveHKLCW-v1.html" title="Next Chapter: SaveHKLCW v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SaveHKLCW v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>