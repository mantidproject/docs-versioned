<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>RotateInstrumentComponent v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=5b08953a"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="RotateSource v1" href="RotateSource-v1.html" />
    <link rel="prev" title="RingProfile v1" href="RingProfile-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.9</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">RotateInstrumentComponent v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="rotateinstrumentcomponent-v1">
<span id="algm-rotateinstrumentcomponent"></span><span id="algm-rotateinstrumentcomponent-v1"></span><h1>RotateInstrumentComponent v1<a class="headerlink" href="#rotateinstrumentcomponent-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id6">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id7">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id8">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id9">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id10">Usage</a></p>
<ul>
<li><p><a class="reference internal" href="#example-1-rotating-a-bank-around-the-y-axis" id="id11">Example 1: Rotating a bank around the Y Axis</a></p>
<ul>
<li><p><a class="reference internal" href="#output" id="id12">Output</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#example-2-rotating-a-bank-around-the-z-axis" id="id13">Example 2: Rotating a bank around the Z Axis</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id14">Output</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#example-3-rotating-a-single-detector" id="id15">Example 3: Rotating a single detector</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id16">Output</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#source" id="id17">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Rotates an instrument component.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="MoveInstrumentComponent-v1.html#algm-moveinstrumentcomponent"><span class="std std-ref">MoveInstrumentComponent</span></a>, <a class="reference internal" href="SetInstrumentParameter-v1.html#algm-setinstrumentparameter"><span class="std std-ref">SetInstrumentParameter</span></a></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Workspace</p></td>
<td><p>InOut</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>The name of the workspace for which the new instrument configuration will have an effect. Any other workspaces stored in the analysis data service will be unaffected.</p></td>
</tr>
<tr class="row-odd"><td><p>ComponentName</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The name of the component to rotate. Component names are defined in the instrument definition files.</p></td>
</tr>
<tr class="row-even"><td><p>DetectorID</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>-1</p></td>
<td><p>The ID of the detector to rotate. If both the component name and the detector ID are set the latter will be used.</p></td>
</tr>
<tr class="row-odd"><td><p>X</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The x-part of the rotation axis.</p></td>
</tr>
<tr class="row-even"><td><p>Y</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The y-part of the rotation axis.</p></td>
</tr>
<tr class="row-odd"><td><p>Z</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The z-part of the rotation axis.</p></td>
</tr>
<tr class="row-even"><td><p>Angle</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>0</p></td>
<td><p>The angle of rotation in degrees.</p></td>
</tr>
<tr class="row-odd"><td><p>RelativeRotation</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>The property defining how the rotation should be interpreted. If true it is a relative rotation. Otherwise it is an absolute rotation.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>RotateInstrumentComponent rotates a component around an axis of rotation
by an angle given in degrees. Rotation by 0 degrees does not change the
component’s orientation. The rotation axis (X,Y,Z) must be given in the
co-ordinate system attached to the component and rotates with it.
The centre of rotation is the centre of the component to be rotated,
and any children of that component (such as detectors in a bank, or pixels in a tube)
are moved and rotated along with the component.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<section id="example-1-rotating-a-bank-around-the-y-axis">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Example 1: Rotating a bank around the Y Axis</a><a class="headerlink" href="#example-1-rotating-a-bank-around-the-y-axis" title="Link to this heading">¶</a></h3>
<figure class="align-center" id="id3">
<img alt="RotateBank90.png‎" src="../_images/RotateBank90.png" />
<figcaption>
<p><span class="caption-text">Rotating a bank around the 90° round Y Axis.  The centre of rotation is the centre of the component to be rotated, and any children of that component (such as each detector in this instance) are moved and rotated along with the bank.</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load a MUSR file</span>
<span class="n">musr</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s1">&#39;MUSR00015189&#39;</span><span class="p">)</span>
<span class="c1"># and use the first workspace in the workspace group</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;musr_1&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">pos3D_as_str</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot; Produces a string with a V3D position (x, y, z) from a V3D object,</span>
<span class="sd">       using a fixed limited number of digits (for robust string comparisons).</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">def</span> <span class="nf">nz</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Handles potential issues with +-0 (for 6 digits text output) &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-7</span> <span class="k">else</span> <span class="n">value</span>

   <span class="n">precision</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
   <span class="n">format_str</span> <span class="o">=</span> <span class="s1">&#39;[{0:.&#39;</span><span class="o">+</span><span class="n">precision</span><span class="o">+</span><span class="s1">&#39;f}, {1:.&#39;</span><span class="o">+</span><span class="n">precision</span><span class="o">+</span><span class="s1">&#39;f}, {2:.&#39;</span><span class="o">+</span><span class="n">precision</span><span class="o">+</span><span class="s1">&#39;f}]&#39;</span>
   <span class="n">result</span> <span class="o">=</span> <span class="n">format_str</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nz</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">getX</span><span class="p">()),</span> <span class="n">nz</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">getY</span><span class="p">()),</span> <span class="n">nz</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">getZ</span><span class="p">()))</span>
   <span class="k">return</span> <span class="n">result</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original positions of detectors 1 and 2&#39;</span><span class="p">)</span>
<span class="n">opos1</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="n">opos2</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Det 1: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">opos1</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Det 2: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">opos2</span><span class="p">)))</span>

<span class="c1"># Rotate bank &#39;back&#39; around the Z axis by 90</span>
<span class="n">RotateInstrumentComponent</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="n">ComponentName</span><span class="o">=</span><span class="s1">&#39;back&#39;</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Angle</span><span class="o">=</span><span class="mf">90.0</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Positions of detectors 1 and 2 after rotation&#39;</span><span class="p">)</span>
<span class="n">pos1</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="n">pos2</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Det 1: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">pos1</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Det 2: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">pos2</span><span class="p">)))</span>
</pre></div>
</div>
<section id="output">
<h4><a class="toc-backref" href="#id12" role="doc-backlink">Output</a><a class="headerlink" href="#output" title="Link to this heading">¶</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original positions of detectors 1 and 2
Det 1: [-0.088815, -0.108221, 0.145000]
Det 2: [-0.065996, -0.123469, 0.145000]
Positions of detectors 1 and 2 after rotation
Det 1: [0.000000, -0.108221, 0.233815]
Det 2: [0.000000, -0.123469, 0.210996]
</pre></div>
</div>
</section>
</section>
<section id="example-2-rotating-a-bank-around-the-z-axis">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Example 2: Rotating a bank around the Z Axis</a><a class="headerlink" href="#example-2-rotating-a-bank-around-the-z-axis" title="Link to this heading">¶</a></h3>
<figure class="align-center" id="id4">
<img alt="RotateBank3Dets.png‎" src="../_images/RotateBank3Dets.png" />
<figcaption>
<p><span class="caption-text">Rotating the bank around the Z Axis.  The centre of rotation is the centre of the bank, so the detectors are translated and rotated to match.</span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load a MUSR file</span>
<span class="n">musr</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s1">&#39;MUSR00015189&#39;</span><span class="p">)</span>
<span class="c1"># and use the first workspace in the workspace group</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;musr_1&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">pos3D_as_str</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot; Produces a string with a V3D position (x, y, z) from a V3D object,</span>
<span class="sd">       using a fixed limited number of digits (for robust string comparisons).</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">def</span> <span class="nf">nz</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Handles potential issues with +-0 (for 6 digits text output) &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-7</span> <span class="k">else</span> <span class="n">value</span>

   <span class="n">precision</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
   <span class="n">format_str</span> <span class="o">=</span> <span class="s1">&#39;[{0:.&#39;</span><span class="o">+</span><span class="n">precision</span><span class="o">+</span><span class="s1">&#39;f}, {1:.&#39;</span><span class="o">+</span><span class="n">precision</span><span class="o">+</span><span class="s1">&#39;f}, {2:.&#39;</span><span class="o">+</span><span class="n">precision</span><span class="o">+</span><span class="s1">&#39;f}]&#39;</span>
   <span class="n">result</span> <span class="o">=</span> <span class="n">format_str</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nz</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">getX</span><span class="p">()),</span> <span class="n">nz</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">getY</span><span class="p">()),</span> <span class="n">nz</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">getZ</span><span class="p">()))</span>
   <span class="k">return</span> <span class="n">result</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original positions of detectors 1 and 4&#39;</span><span class="p">)</span>
<span class="n">opos1</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="n">opos4</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Det 1: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">opos1</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Det 4: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">opos4</span><span class="p">)))</span>

<span class="c1"># Rotate bank &#39;back&#39; around the Z axis by 3 detectors.</span>
<span class="n">RotateInstrumentComponent</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="n">ComponentName</span><span class="o">=</span><span class="s1">&#39;back&#39;</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Angle</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="mf">360.0</span> <span class="o">/</span> <span class="mi">32</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Positions of detector 1 after rotation&#39;</span><span class="p">)</span>
<span class="n">pos1</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Det 1: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">pos1</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Detector 1 took place of detector 4&#39;</span><span class="p">)</span>
</pre></div>
</div>
<section id="id1">
<h4><a class="toc-backref" href="#id14" role="doc-backlink">Output</a><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original positions of detectors 1 and 4
Det 1: [-0.088815, -0.108221, 0.145000]
Det 4: [-0.013722, -0.139326, 0.145000]
Positions of detector 1 after rotation
Det 1: [-0.013722, -0.139326, 0.145000]
Detector 1 took place of detector 4
</pre></div>
</div>
</section>
</section>
<section id="example-3-rotating-a-single-detector">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Example 3: Rotating a single detector</a><a class="headerlink" href="#example-3-rotating-a-single-detector" title="Link to this heading">¶</a></h3>
<figure class="align-center" id="id5">
<img alt="RotateDetector.png‎" src="../_images/RotateDetector.png" />
<figcaption>
<p><span class="caption-text">Rotating the detector around the Z Axis by 90 degrees.  The centre of rotation is the centre of the detector.</span><a class="headerlink" href="#id5" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Load a MUSR file</span>
<span class="n">musr</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s1">&#39;MUSR00015189&#39;</span><span class="p">)</span>
<span class="c1"># and use the first workspace in the workspace group</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;musr_1&#39;</span><span class="p">]</span>

<span class="c1"># Rotating a detector doesn&#39;t change its position, just its orientation</span>

<span class="c1"># Original position of detector 33</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">())</span>

<span class="c1"># Caclulate the solid angles for all detectors in the instrument</span>
<span class="c1"># The result is a single-bin workspace with solid angles for all spectra in ws</span>
<span class="n">saws</span> <span class="o">=</span> <span class="n">SolidAngle</span><span class="p">(</span> <span class="n">ws</span> <span class="p">)</span>
<span class="c1"># Collect the solid angles from the first bin in saws and save them in numpy array.</span>
<span class="c1"># Numpy module makes it easy to manipulate arrays</span>
<span class="n">sa1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span> <span class="n">saws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">saws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span> <span class="p">]</span> <span class="p">)</span>

<span class="c1"># Rotate detector 33 around the Z axis by 90 degrees.</span>
<span class="n">RotateInstrumentComponent</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="n">DetectorID</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Angle</span><span class="o">=</span><span class="mi">90</span> <span class="p">)</span>

<span class="c1"># Check the position of detector 33 stays unchanged</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">())</span>

<span class="c1"># Calculate the solid angles after rotation</span>
<span class="n">saws</span> <span class="o">=</span> <span class="n">SolidAngle</span><span class="p">(</span> <span class="n">ws</span> <span class="p">)</span>
<span class="n">sa2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span> <span class="n">saws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">saws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span> <span class="p">]</span> <span class="p">)</span>

<span class="c1"># Take element by element difference of the solid angles</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">sa2</span> <span class="o">-</span> <span class="n">sa1</span>
<span class="c1"># numpy.set_printoptions is not stable across versions.</span>
<span class="c1"># manually print array to ensure consistent display for tests</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">diff_as_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">diff_as_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{: .5f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">diff</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">])</span>
    <span class="n">diff_as_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diff_as_str</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The non-zero difference </span><span class="si">{:.13f}</span><span class="s1"> is due to detector </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">diff</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">getID</span><span class="p">()))</span>
</pre></div>
</div>
<section id="id2">
<h4><a class="toc-backref" href="#id16" role="doc-backlink">Output</a><a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> [0.0888151,-0.108221,-0.145]
 [0.0888151,-0.108221,-0.145]
  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000
  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000
  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000
  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000
 -0.04645  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000
  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000
  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000
  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000

 The non-zero difference -0.0464531276188 is due to detector 33
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/DataHandling/Instrument.html">DataHandling\Instrument</a></p>
</section>
</section>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/66c74f87d9b779695dc85b538bc48767c5975b19/Framework/DataHandling/inc/MantidDataHandling/RotateInstrumentComponent.h">RotateInstrumentComponent.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/66c74f87d9b779695dc85b538bc48767c5975b19/Framework/DataHandling/src/RotateInstrumentComponent.cpp">RotateInstrumentComponent.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="RingProfile-v1.html" title="Previous Chapter: RingProfile v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; RingProfile v1</span>
    </a>
  </li>
  <li>
    <a href="RotateSource-v1.html" title="Next Chapter: RotateSource v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">RotateSource v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>