<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>StartLiveData v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=5b08953a"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="StatisticsOfPeaksWorkspace v1" href="StatisticsOfPeaksWorkspace-v1.html" />
    <link rel="prev" title="Squares v1" href="Squares-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.9</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">StartLiveData v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="startlivedata-v1">
<span id="algm-startlivedata"></span><span id="algm-startlivedata-v1"></span><h1>StartLiveData v1<a class="headerlink" href="#startlivedata-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id2">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id3">Description</a></p>
<ul>
<li><p><a class="reference internal" href="#listener-properties" id="id4">Listener Properties</a></p>
<ul>
<li><p><a class="reference internal" href="#kafkaeventlistener" id="id5">KafkaEventListener</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#live-plots" id="id6">Live Plots</a></p></li>
<li><p><a class="reference internal" href="#run-transition-behavior" id="id7">Run Transition Behavior</a></p></li>
<li><p><a class="reference internal" href="#multiple-live-data-sessions" id="id8">Multiple Live Data Sessions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage" id="id9">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id10">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Begin live data monitoring.</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FromNow</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>True</p></td>
<td><p>Process live data starting from the current time only.</p></td>
</tr>
<tr class="row-odd"><td><p>FromStartOfRun</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Record live data, but go back to the start of the run and process all data since then.</p></td>
</tr>
<tr class="row-even"><td><p>FromTime</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Record live data, but go back to a specific time and process all data since then. You must specify the StartTime property if this is checked.</p></td>
</tr>
<tr class="row-odd"><td><p>UpdateEvery</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p>30</p></td>
<td><p>Frequency of updates, in seconds. Default 30. If you specify 0, MonitorLiveData will not launch and you will get only one chunk.</p></td>
</tr>
<tr class="row-even"><td><p>Instrument</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of the instrument to monitor. Allowed values: [‘ALF’, ‘ARGUS’, ‘CHRONUS’, ‘CRISP’, ‘EMU’, ‘ENGIN-X’, ‘ENGIN-X_EVENT’, ‘GEM’, ‘HET’, ‘HIFI’, ‘HRPD’, ‘IMAT’, ‘INES’, ‘INTER’, ‘IRIS’, ‘LARMOR’, ‘LET’, ‘LET_EVENT’, ‘LOQ’, ‘MAPS’, ‘MARI’, ‘MERLIN’, ‘MERLIN_EVENT’, ‘MUSR’, ‘NGEM’, ‘NIMROD’, ‘OFFSPEC’, ‘OFFSPEC_EVENT’, ‘OSIRIS’, ‘PEARL’, ‘POLARIS’, ‘POLREF’, ‘SANDALS’, ‘SANS2D’, ‘SANS2D_EVENT’, ‘SURF’, ‘SXD’, ‘TOSCA’, ‘VESUVIO’, ‘WISH’, ‘ZOOM’]</p></td>
</tr>
<tr class="row-odd"><td><p>Connection</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Selects the listener connection entry to use. Default connection will be used if not specified</p></td>
</tr>
<tr class="row-even"><td><p>Listener</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Name of the listener class to use. If specified, overrides class specified by Connection. Allowed values: [‘FakeEventDataListener’, ‘FileEventDataListener’, ‘ISISHistoDataListener’, ‘ISISLiveEventDataListener’, ‘KafkaEventListener’, ‘KafkaHistoListener’, ‘SINQHMListener’, ‘SNSLiveEventDataListener’, ‘’]</p></td>
</tr>
<tr class="row-odd"><td><p>Address</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Address for the listener to connect to. If specified, overrides address specified by Connection.</p></td>
</tr>
<tr class="row-even"><td><p>StartTime</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Absolute start time, if you selected FromTime. Specify the date/time in UTC time, in ISO8601 format, e.g. 2010-09-14T04:20:12.95</p></td>
</tr>
<tr class="row-odd"><td><p>ProcessingAlgorithm</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Name of the algorithm that will be run to process each chunk of data. Optional. If blank, no processing will occur.</p></td>
</tr>
<tr class="row-even"><td><p>ProcessingProperties</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The properties to pass to the ProcessingAlgorithm, as a single string. The format is propName=value;propName=value</p></td>
</tr>
<tr class="row-odd"><td><p>ProcessingScript</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>A Python script that will be run to process each chunk of data. Only for command line usage, does not appear on the user interface.</p></td>
</tr>
<tr class="row-even"><td><p>ProcessingScriptFilename</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>A Python script that will be run to process each chunk of data. Only for command line usage, does not appear on the user interface. Allowed values: [‘py’]</p></td>
</tr>
<tr class="row-odd"><td><p>AccumulationMethod</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Add</p></td>
<td><p>Method to use for accumulating each chunk of live data.  - Add: the processed chunk will be summed to the previous outpu (default).  - Replace: the processed chunk will replace the previous output.  - Append: the spectra of the chunk will be appended to the output workspace, increasing its size. Allowed values: [‘Add’, ‘Replace’, ‘Append’]</p></td>
</tr>
<tr class="row-even"><td><p>PreserveEvents</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Preserve events after performing the Processing step. Default False. This only applies if the ProcessingAlgorithm produces an EventWorkspace. It is strongly recommended to keep this unchecked, because preserving events may cause significant slowdowns when the run becomes large!</p></td>
</tr>
<tr class="row-odd"><td><p>PostProcessingAlgorithm</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Name of the algorithm that will be run to process the accumulated data. Optional. If blank, no post-processing will occur.</p></td>
</tr>
<tr class="row-even"><td><p>PostProcessingProperties</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The properties to pass to the PostProcessingAlgorithm, as a single string. The format is propName=value;propName=value</p></td>
</tr>
<tr class="row-odd"><td><p>PostProcessingScript</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>A Python script that will be run to process the accumulated data.</p></td>
</tr>
<tr class="row-even"><td><p>PostProcessingScriptFilename</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Python script that will be run to process the accumulated data. Allowed values: [‘py’]</p></td>
</tr>
<tr class="row-odd"><td><p>RunTransitionBehavior</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Restart</p></td>
<td><p>What to do at run start/end boundaries?  - Restart: the previously accumulated data is discarded.  - Stop: live data monitoring ends.  - Rename: the previous workspaces are renamed, and monitoring continues with cleared ones. Allowed values: [‘Restart’, ‘Stop’, ‘Rename’]</p></td>
</tr>
<tr class="row-even"><td><p>AccumulationWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td></td>
<td><p>Optional, unless performing PostProcessing:  Give the name of the intermediate, accumulation workspace.  This is the workspace after accumulation but before post-processing steps.</p></td>
</tr>
<tr class="row-odd"><td><p>OutputWorkspace</p></td>
<td><p>Output</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>Name of the processed output workspace.</p></td>
</tr>
<tr class="row-even"><td><p>LastTimeStamp</p></td>
<td><p>Output</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The time stamp of the last event, frame or pulse recorded. Date/time is in UTC time, in ISO8601 format, e.g. 2010-09-14T04:20:12.95</p></td>
</tr>
<tr class="row-odd"><td><p>MonitorLiveData</p></td>
<td><p>Output</p></td>
<td><p>IAlgorithm</p></td>
<td></td>
<td><p>A handle to the MonitorLiveData algorithm instance that continues to read live data after this algorithm completes.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">StartLiveData</span></code> algorithm launches a background job that monitors and
processes live data.</p>
<p>The background algorithm started is <a class="reference internal" href="MonitorLiveData-v1.html#algm-monitorlivedata"><span class="std std-ref">MonitorLiveData v1</span></a>, which
simply calls <a class="reference internal" href="LoadLiveData-v1.html#algm-loadlivedata"><span class="std std-ref">LoadLiveData v1</span></a> at a fixed interval.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For details on the way to specify the data processing steps, see
<a class="reference internal" href="LoadLiveData-v1.html#algm-loadlivedata"><span class="std std-ref">LoadLiveData</span></a>.</p>
</div>
<p>Instructions for setting up a “fake” data stream are found <a class="reference external" href="https://developer.mantidproject.org/Testing/LiveData/LiveDataTests.html#live-data-testing" title="(in MantidProject vmaster)"><span class="xref std std-ref">here</span></a>.</p>
<section id="listener-properties">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Listener Properties</a><a class="headerlink" href="#listener-properties" title="Link to this heading">¶</a></h3>
<p>Specific LiveListeners may provide their own properties, in addition to
properties provided by StartLiveData. For convenience and accessibility, these
properties are made available through StartLiveData as well.</p>
<p>In the StartLiveData algorithm dialog, a group box called “Listener Properties”
will appear at the bottom of the sidebar on the left, if the currently selected
listener provides additional properties.</p>
<p>In the Python API, these listener properties may also be set as keyword
arguments when calling StartLiveData. For example, in this code snippet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">StartLiveData</span><span class="p">(</span><span class="n">Instrument</span><span class="o">=</span><span class="s1">&#39;ISIS_Histogram&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;wsOut&#39;</span><span class="p">,</span> <span class="n">UpdateEvery</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
              <span class="n">AccumulationMethod</span><span class="o">=</span><span class="s1">&#39;Replace&#39;</span><span class="p">,</span> <span class="n">PeriodList</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">SpectraList</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<p>PeriodList and SpectraList are properties of the ISISHistoDataListener. They
are available as arguments in this call because Instrument is set to
‘ISIS_Histogram’, which uses that listener.</p>
<section id="kafkaeventlistener">
<h4><a class="toc-backref" href="#id5" role="doc-backlink">KafkaEventListener</a><a class="headerlink" href="#kafkaeventlistener" title="Link to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">BufferThreshold</span></code> defines the number of events (default 1000000) to hold in the intermediate buffer before it is flushed to the streamed EventWorkspace.
This parameter must be tuned to the data you are streaming.
Setting this parameter too high for your event rate will cause behaviour that make live streaming appear to have stalled.
Setting this too low may cause performance issues with high count rates.</p>
<p>There is no general rule for deriving this parameter that will give the best performance.
To ensure that live streaming remains responsive this parameter should be set to <code class="docutils literal notranslate"><span class="pre">UpdateEvery</span></code> times the approximate event rate.
Due to the nature of the intermediate buffer it is not possible to avoid having to know the approximate event rate before streaming.</p>
<p>25000000 has shown to work well for simulated LOKI data at 10e7 events per second.</p>
</section>
</section>
<section id="live-plots">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Live Plots</a><a class="headerlink" href="#live-plots" title="Link to this heading">¶</a></h3>
<p>Once live data monitoring has started, you can open a plot and as the data is
acquired, this plot updates automatically.</p>
<p>StartLiveData algorithm returns after the first chunk of data has been
loaded and processed. This makes it simple to write a script that will
open a live plot. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">StartLiveData</span><span class="p">(</span><span class="n">UpdateEvery</span><span class="o">=</span><span class="s1">&#39;1.0&#39;</span><span class="p">,</span><span class="n">Instrument</span><span class="o">=</span><span class="s1">&#39;FakeEventDataListener&#39;</span><span class="p">,</span>
  <span class="n">ProcessingAlgorithm</span><span class="o">=</span><span class="s1">&#39;Rebin&#39;</span><span class="p">,</span><span class="n">ProcessingProperties</span><span class="o">=</span><span class="s1">&#39;Params=10e3,1000,60e3;PreserveEvents=1&#39;</span><span class="p">,</span>
  <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;live&#39;</span><span class="p">)</span>
<span class="n">plotSpectrum</span><span class="p">(</span><span class="s1">&#39;live&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="run-transition-behavior">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Run Transition Behavior</a><a class="headerlink" href="#run-transition-behavior" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>When the experimenter starts and stops a run, the Live Data Listener
receives this as a signal.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">RunTransitionBehavior</span></code> property specifies what to do at these
run transitions.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Restart</span></code>: the accumulated data (from the previous run if a run has
just ended or from the time between runs a if a run has just
started) is discarded as soon as the next chunk of data arrives.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Stop</span></code>: live data monitoring ends. It will have to be restarted
manually.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Rename</span></code>: the previous workspaces are renamed, and monitoring
continues with cleared ones. The run number, if found, is used to
rename the old workspaces.</p>
<ul>
<li><p>There is a check for available memory before renaming; if there
is not enough memory, the old data is discarded.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Note that LiveData continues monitoring even if outside of a run
(i.e. before a run begins you will still receive live data).</p></li>
</ul>
</section>
<section id="multiple-live-data-sessions">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Multiple Live Data Sessions</a><a class="headerlink" href="#multiple-live-data-sessions" title="Link to this heading">¶</a></h3>
<p>It is possible to have multiple live data sessions running at the same
time. Simply call <code class="docutils literal notranslate"><span class="pre">StartLiveData</span></code> more than once, but make sure to specify
unique names for the <code class="docutils literal notranslate"><span class="pre">OutputWorkspace</span></code>.</p>
<p>Please note that you may be limited in how much simultaneous processing
you can do by your available memory and CPUs.</p>
</section>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Example 1:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">startFakeDAE</span><span class="p">():</span>
    <span class="c1"># This will generate 2000 events roughly every 20ms, so about 50,000 events/sec</span>
    <span class="c1"># They will be randomly shared across the 100 spectra</span>
    <span class="c1"># and have a time of flight between 10,000 and 20,000</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">FakeISISEventDAE</span><span class="p">(</span><span class="n">NPeriods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NSpectra</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">Rate</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">NEvents</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="k">def</span> <span class="nf">captureLive</span><span class="p">():</span>
    <span class="n">ConfigService</span><span class="o">.</span><span class="n">setFacility</span><span class="p">(</span><span class="s2">&quot;TEST_LIVE&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># start a Live data listener updating every second, that rebins the data</span>
        <span class="c1"># and replaces the results each time with those of the last second.</span>
        <span class="n">StartLiveData</span><span class="p">(</span><span class="n">Instrument</span><span class="o">=</span><span class="s1">&#39;ISIS_Event&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;wsOut&#39;</span><span class="p">,</span> <span class="n">UpdateEvery</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                      <span class="n">ProcessingAlgorithm</span><span class="o">=</span><span class="s1">&#39;Rebin&#39;</span><span class="p">,</span> <span class="n">ProcessingProperties</span><span class="o">=</span><span class="s1">&#39;Params=10000,1000,20000;PreserveEvents=1&#39;</span><span class="p">,</span>
                      <span class="n">AccumulationMethod</span><span class="o">=</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="n">PreserveEvents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># give it a couple of seconds before stopping it</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># This will cancel both algorithms</span>
        <span class="c1"># you can do the same in the GUI</span>
        <span class="c1"># by clicking on the details button on the bottom right</span>
        <span class="n">AlgorithmManager</span><span class="o">.</span><span class="n">cancelAll</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#--------------------------------------------------------------------------------------------------</span>

<span class="n">oldFacility</span> <span class="o">=</span> <span class="n">ConfigService</span><span class="o">.</span><span class="n">getFacility</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="n">thread</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span> <span class="o">=</span> <span class="n">startFakeDAE</span><span class="p">)</span>
<span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># give it a small amount of time to get ready</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">thread</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unable to start FakeDAE&quot;</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">captureLive</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error occurred starting live data&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span> <span class="c1"># this must get hit</span>

<span class="c1"># put back the facility</span>
<span class="n">ConfigService</span><span class="o">.</span><span class="n">setFacility</span><span class="p">(</span><span class="n">oldFacility</span><span class="p">)</span>

<span class="c1">#get the output workspace</span>
<span class="n">wsOut</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s2">&quot;wsOut&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The workspace contains </span><span class="si">%i</span><span class="s2"> events&quot;</span> <span class="o">%</span> <span class="n">wsOut</span><span class="o">.</span><span class="n">getNumberEvents</span><span class="p">())</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> The workspace contains ... events
</pre></div>
</div>
<p><strong>Example 2:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">startFakeDAE</span><span class="p">():</span>
    <span class="c1"># This will generate 5 periods of histogram data, 10 spectra in each period,</span>
    <span class="c1"># 100 bins in each spectrum</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">FakeISISHistoDAE</span><span class="p">(</span><span class="n">NPeriods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">NSpectra</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">NBins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="k">def</span> <span class="nf">captureLive</span><span class="p">():</span>
    <span class="n">ConfigService</span><span class="o">.</span><span class="n">setFacility</span><span class="p">(</span><span class="s2">&quot;TEST_LIVE&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Start a Live data listener updating every second,</span>
        <span class="c1"># that replaces the results each time with those of the last second.</span>
        <span class="c1"># Load only spectra 2,4, and 6 from periods 1 and 3</span>
        <span class="n">StartLiveData</span><span class="p">(</span><span class="n">Instrument</span><span class="o">=</span><span class="s1">&#39;ISIS_Histogram&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;wsOut&#39;</span><span class="p">,</span> <span class="n">UpdateEvery</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                      <span class="n">AccumulationMethod</span><span class="o">=</span><span class="s1">&#39;Replace&#39;</span><span class="p">,</span> <span class="n">PeriodList</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">SpectraList</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>

        <span class="c1"># give it a couple of seconds before stopping it</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># This will cancel both algorithms</span>
        <span class="c1"># you can do the same in the GUI</span>
        <span class="c1"># by clicking on the details button on the bottom right</span>
        <span class="n">AlgorithmManager</span><span class="o">.</span><span class="n">cancelAll</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#--------------------------------------------------------------------------------------------------</span>

<span class="n">oldFacility</span> <span class="o">=</span> <span class="n">ConfigService</span><span class="o">.</span><span class="n">getFacility</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="n">thread</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span> <span class="o">=</span> <span class="n">startFakeDAE</span><span class="p">)</span>
<span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># give it a small amount of time to get ready</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">thread</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unable to start FakeDAE&quot;</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">captureLive</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error occurred starting live data&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span> <span class="c1"># this must get hit</span>

<span class="c1"># put back the facility</span>
<span class="n">ConfigService</span><span class="o">.</span><span class="n">setFacility</span><span class="p">(</span><span class="n">oldFacility</span><span class="p">)</span>

<span class="c1">#get the output workspace</span>
<span class="n">wsOut</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s2">&quot;wsOut&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The workspace contains </span><span class="si">%i</span><span class="s2"> periods&quot;</span> <span class="o">%</span> <span class="n">wsOut</span><span class="o">.</span><span class="n">getNumberOfEntries</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Each period   contains </span><span class="si">%i</span><span class="s2"> spectra&quot;</span> <span class="o">%</span> <span class="n">wsOut</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> The workspace contains ... periods
 Each period   contains ... spectra
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/DataHandling/LiveData.html">DataHandling\LiveData</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/66c74f87d9b779695dc85b538bc48767c5975b19/Framework/LiveData/inc/MantidLiveData/StartLiveData.h">StartLiveData.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/66c74f87d9b779695dc85b538bc48767c5975b19/Framework/LiveData/src/StartLiveData.cpp">StartLiveData.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="Squares-v1.html" title="Previous Chapter: Squares v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Squares v1</span>
    </a>
  </li>
  <li>
    <a href="StatisticsOfPeaksWorkspace-v1.html" title="Next Chapter: StatisticsOfPeaksWorkspace v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">StatisticsOfP... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>