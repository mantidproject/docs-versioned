<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>GeneratePythonScript v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=5b08953a"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GetAllEi v1" href="GetAllEi-v1.html" />
    <link rel="prev" title="GeneratePythonFitScript v1" href="GeneratePythonFitScript-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.9</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">GeneratePythonScript v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="generatepythonscript-v1">
<span id="algm-generatepythonscript"></span><span id="algm-generatepythonscript-v1"></span><h1>GeneratePythonScript v1<a class="headerlink" href="#generatepythonscript-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p>
<ul>
<li><p><a class="reference internal" href="#see-also" id="id2">See Also</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id3">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id5">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id6">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>An Algorithm to generate a Python script file to reproduce the history of a workspace.</p>
<section id="see-also">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="RecordPythonScript-v1.html#algm-recordpythonscript"><span class="std std-ref">RecordPythonScript</span></a>, <a class="reference internal" href="GenerateIPythonNotebook-v1.html#algm-generateipythonnotebook"><span class="std std-ref">GenerateIPythonNotebook</span></a></p>
<p>This algorithm is also known as: <strong>ExportHistory</strong></p>
</section>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>An input workspace.</p></td>
</tr>
<tr class="row-odd"><td><p>Filename</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The name of the file into which the workspace history will be generated. Allowed extensions: [‘.py’]</p></td>
</tr>
<tr class="row-even"><td><p>ScriptText</p></td>
<td><p>Output</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Saves the history of the workspace to a variable.</p></td>
</tr>
<tr class="row-odd"><td><p>UnrollAll</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Unroll all algorithms to show just their child algorithms.</p></td>
</tr>
<tr class="row-even"><td><p>StartTimestamp</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The filter start time in the format YYYY-MM-DD HH:mm:ss</p></td>
</tr>
<tr class="row-odd"><td><p>EndTimestamp</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>The filter end time in the format YYYY-MM-DD HH:mm:ss</p></td>
</tr>
<tr class="row-even"><td><p>AppendTimestamp</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Appends the time the command was run as a comment afterwards</p></td>
</tr>
<tr class="row-odd"><td><p>SpecifyAlgorithmVersions</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td><p>Specify Old</p></td>
<td><p>When to specify which algorithm version was used by Mantid. Allowed values: [‘Specify Old’, ‘Specify All’, ‘Specify None’]</p></td>
</tr>
<tr class="row-even"><td><p>IgnoreTheseAlgs</p></td>
<td><p>Input</p></td>
<td><p>str list</p></td>
<td></td>
<td><p>A list of algorithms to filter out of the built script</p></td>
</tr>
<tr class="row-odd"><td><p>IgnoreTheseAlgProperties</p></td>
<td><p>Input</p></td>
<td><p>list of str lists</p></td>
<td></td>
<td><p>A list of algorithm properties to filter out of the built script</p></td>
</tr>
<tr class="row-even"><td><p>AppendExecCount</p></td>
<td><p>Input</p></td>
<td><p>boolean</p></td>
<td><p>False</p></td>
<td><p>Whether execCount should be appended to the end of the built string</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>Retrieves the algorithm history of the workspace and saves it to a
Python script file or Python variable.</p>
<p>A time range can be specified which will restrict the algorithms in
the scrit to those which were executed between the given times,
if no end time was specified then algorithms from the start time up
to the current time will be included in the generated script.</p>
<p>Start and end times are given in ISO8601 format: YYYY-MM-DD HH:mm:ss,
for example 3:25 PM on July the 4th 2014 would be 2014-07-04 15:25:00.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Example - generate a python script for a workspace:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#create a workspace and run some operations on it</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CropWorkspace</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">XMin</span><span class="o">=</span><span class="mf">7828.162291</span><span class="p">,</span> <span class="n">XMax</span><span class="o">=</span><span class="mf">11980.906921</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">Power</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Exponent</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s2">&quot;MyTestWorkspace&quot;</span><span class="p">)</span>

<span class="n">script_text</span> <span class="o">=</span> <span class="n">GeneratePythonScript</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">script_text</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Python script generated by Mantid
# Version ...
# SHA-1 ...

from mantid.simpleapi import *

CreateSampleWorkspace(OutputWorkspace=&#39;ws&#39;)
CropWorkspace(InputWorkspace=&#39;ws&#39;, OutputWorkspace=&#39;ws&#39;, XMin=7828.1622909999996, XMax=11980.906921)
Power(InputWorkspace=&#39;ws&#39;, OutputWorkspace=&#39;ws&#39;, Exponent=1.5)
RenameWorkspace(InputWorkspace=&#39;ws&#39;, OutputWorkspace=&#39;MyTestWorkspace&#39;)
</pre></div>
</div>
<p><strong>Example - generate a python script giving a range of start times:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Do some operations on the workspace with a pause between them</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CropWorkspace</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">XMin</span><span class="o">=</span><span class="mf">7828.162291</span><span class="p">,</span> <span class="n">XMax</span><span class="o">=</span><span class="mf">11980.906921</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">Power</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Exponent</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s2">&quot;MyTestWorkspace&quot;</span><span class="p">)</span>

<span class="c1"># Get the execution time of the last algorithm and subtract 1 second</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;MyTestWorkspace&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getHistory</span><span class="p">()</span>
<span class="n">last</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">getAlgorithmHistory</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">from_time</span> <span class="o">=</span> <span class="n">last</span><span class="o">.</span><span class="n">executionDate</span><span class="p">()</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e9</span><span class="p">)</span>

<span class="c1"># Generate a script with a given start time</span>
<span class="n">script_text</span> <span class="o">=</span> <span class="n">GeneratePythonScript</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">StartTimestamp</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">from_time</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">script_text</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Python script generated by Mantid
# Version ...
# SHA-1 ...

from mantid.simpleapi import *

Power(InputWorkspace=&#39;ws&#39;, OutputWorkspace=&#39;ws&#39;, Exponent=1.5)
RenameWorkspace(InputWorkspace=&#39;ws&#39;, OutputWorkspace=&#39;MyTestWorkspace&#39;)
</pre></div>
</div>
<p><strong>Example - generate a python script and save it to file:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="c1">#create a workspace and run some operations on it</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CropWorkspace</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">XMin</span><span class="o">=</span><span class="mf">7828.162291</span><span class="p">,</span> <span class="n">XMax</span><span class="o">=</span><span class="mf">11980.906921</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">Power</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Exponent</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s2">&quot;MyTestWorkspace&quot;</span><span class="p">)</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s1">&#39;myscript.py&#39;</span><span class="p">)</span>
<span class="n">GeneratePythonScript</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Filename</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">script</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">script</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Python script generated by Mantid
# Version ...
# SHA-1 ...

from mantid.simpleapi import *

CreateSampleWorkspace(OutputWorkspace=&#39;ws&#39;)
CropWorkspace(InputWorkspace=&#39;ws&#39;, OutputWorkspace=&#39;ws&#39;, XMin=7828.1622909999996, XMax=11980.906921)
Power(InputWorkspace=&#39;ws&#39;, OutputWorkspace=&#39;ws&#39;, Exponent=1.5)
RenameWorkspace(InputWorkspace=&#39;ws&#39;, OutputWorkspace=&#39;MyTestWorkspace&#39;)
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Utility/Python.html">Utility\Python</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/66c74f87d9b779695dc85b538bc48767c5975b19/Framework/Algorithms/inc/MantidAlgorithms/GeneratePythonScript.h">GeneratePythonScript.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/66c74f87d9b779695dc85b538bc48767c5975b19/Framework/Algorithms/src/GeneratePythonScript.cpp">GeneratePythonScript.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="GeneratePythonFitScript-v1.html" title="Previous Chapter: GeneratePythonFitScript v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; GeneratePytho...</span>
    </a>
  </li>
  <li>
    <a href="GetAllEi-v1.html" title="Next Chapter: GetAllEi v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">GetAllEi v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>